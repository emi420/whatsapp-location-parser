(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))u(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const y of g.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&u(y)}).observe(document,{childList:!0,subtree:!0});function i(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function u(d){if(d.ep)return;d.ep=!0;const g=i(d);fetch(d.href,g)}})();var cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ip(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function eA(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var i=function u(){return this instanceof u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var d=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(i,u,d.get?d:{enumerable:!0,get:function(){return e[u]}})}),i}var PS={exports:{}},ug={},AS={exports:{}},dr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op=Symbol.for("react.element"),tA=Symbol.for("react.portal"),rA=Symbol.for("react.fragment"),nA=Symbol.for("react.strict_mode"),iA=Symbol.for("react.profiler"),oA=Symbol.for("react.provider"),sA=Symbol.for("react.context"),aA=Symbol.for("react.forward_ref"),lA=Symbol.for("react.suspense"),uA=Symbol.for("react.memo"),cA=Symbol.for("react.lazy"),Nw=Symbol.iterator;function hA(e){return e===null||typeof e!="object"?null:(e=Nw&&e[Nw]||e["@@iterator"],typeof e=="function"?e:null)}var MS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zS=Object.assign,DS={};function $c(e,t,i){this.props=e,this.context=t,this.refs=DS,this.updater=i||MS}$c.prototype.isReactComponent={};$c.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$c.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function RS(){}RS.prototype=$c.prototype;function Av(e,t,i){this.props=e,this.context=t,this.refs=DS,this.updater=i||MS}var Mv=Av.prototype=new RS;Mv.constructor=Av;zS(Mv,$c.prototype);Mv.isPureReactComponent=!0;var $w=Array.isArray,LS=Object.prototype.hasOwnProperty,zv={current:null},FS={key:!0,ref:!0,__self:!0,__source:!0};function OS(e,t,i){var u,d={},g=null,y=null;if(t!=null)for(u in t.ref!==void 0&&(y=t.ref),t.key!==void 0&&(g=""+t.key),t)LS.call(t,u)&&!FS.hasOwnProperty(u)&&(d[u]=t[u]);var c=arguments.length-2;if(c===1)d.children=i;else if(1<c){for(var T=Array(c),P=0;P<c;P++)T[P]=arguments[P+2];d.children=T}if(e&&e.defaultProps)for(u in c=e.defaultProps,c)d[u]===void 0&&(d[u]=c[u]);return{$$typeof:op,type:e,key:g,ref:y,props:d,_owner:zv.current}}function dA(e,t){return{$$typeof:op,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Dv(e){return typeof e=="object"&&e!==null&&e.$$typeof===op}function pA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var jw=/\/+/g;function h_(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pA(""+e.key):t.toString(36)}function qf(e,t,i,u,d){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var y=!1;if(e===null)y=!0;else switch(g){case"string":case"number":y=!0;break;case"object":switch(e.$$typeof){case op:case tA:y=!0}}if(y)return y=e,d=d(y),e=u===""?"."+h_(y,0):u,$w(d)?(i="",e!=null&&(i=e.replace(jw,"$&/")+"/"),qf(d,t,i,"",function(P){return P})):d!=null&&(Dv(d)&&(d=dA(d,i+(!d.key||y&&y.key===d.key?"":(""+d.key).replace(jw,"$&/")+"/")+e)),t.push(d)),1;if(y=0,u=u===""?".":u+":",$w(e))for(var c=0;c<e.length;c++){g=e[c];var T=u+h_(g,c);y+=qf(g,t,i,T,d)}else if(T=hA(e),typeof T=="function")for(e=T.call(e),c=0;!(g=e.next()).done;)g=g.value,T=u+h_(g,c++),y+=qf(g,t,i,T,d);else if(g==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return y}function wf(e,t,i){if(e==null)return e;var u=[],d=0;return qf(e,u,"","",function(g){return t.call(i,g,d++)}),u}function fA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pi={current:null},Xf={transition:null},mA={ReactCurrentDispatcher:Pi,ReactCurrentBatchConfig:Xf,ReactCurrentOwner:zv};function BS(){throw Error("act(...) is not supported in production builds of React.")}dr.Children={map:wf,forEach:function(e,t,i){wf(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return wf(e,function(){t++}),t},toArray:function(e){return wf(e,function(t){return t})||[]},only:function(e){if(!Dv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};dr.Component=$c;dr.Fragment=rA;dr.Profiler=iA;dr.PureComponent=Av;dr.StrictMode=nA;dr.Suspense=lA;dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mA;dr.act=BS;dr.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=zS({},e.props),d=e.key,g=e.ref,y=e._owner;if(t!=null){if(t.ref!==void 0&&(g=t.ref,y=zv.current),t.key!==void 0&&(d=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(T in t)LS.call(t,T)&&!FS.hasOwnProperty(T)&&(u[T]=t[T]===void 0&&c!==void 0?c[T]:t[T])}var T=arguments.length-2;if(T===1)u.children=i;else if(1<T){c=Array(T);for(var P=0;P<T;P++)c[P]=arguments[P+2];u.children=c}return{$$typeof:op,type:e.type,key:d,ref:g,props:u,_owner:y}};dr.createContext=function(e){return e={$$typeof:sA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oA,_context:e},e.Consumer=e};dr.createElement=OS;dr.createFactory=function(e){var t=OS.bind(null,e);return t.type=e,t};dr.createRef=function(){return{current:null}};dr.forwardRef=function(e){return{$$typeof:aA,render:e}};dr.isValidElement=Dv;dr.lazy=function(e){return{$$typeof:cA,_payload:{_status:-1,_result:e},_init:fA}};dr.memo=function(e,t){return{$$typeof:uA,type:e,compare:t===void 0?null:t}};dr.startTransition=function(e){var t=Xf.transition;Xf.transition={};try{e()}finally{Xf.transition=t}};dr.unstable_act=BS;dr.useCallback=function(e,t){return Pi.current.useCallback(e,t)};dr.useContext=function(e){return Pi.current.useContext(e)};dr.useDebugValue=function(){};dr.useDeferredValue=function(e){return Pi.current.useDeferredValue(e)};dr.useEffect=function(e,t){return Pi.current.useEffect(e,t)};dr.useId=function(){return Pi.current.useId()};dr.useImperativeHandle=function(e,t,i){return Pi.current.useImperativeHandle(e,t,i)};dr.useInsertionEffect=function(e,t){return Pi.current.useInsertionEffect(e,t)};dr.useLayoutEffect=function(e,t){return Pi.current.useLayoutEffect(e,t)};dr.useMemo=function(e,t){return Pi.current.useMemo(e,t)};dr.useReducer=function(e,t,i){return Pi.current.useReducer(e,t,i)};dr.useRef=function(e){return Pi.current.useRef(e)};dr.useState=function(e){return Pi.current.useState(e)};dr.useSyncExternalStore=function(e,t,i){return Pi.current.useSyncExternalStore(e,t,i)};dr.useTransition=function(){return Pi.current.useTransition()};dr.version="18.3.1";AS.exports=dr;var $t=AS.exports;const Ec=ip($t);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gA=$t,yA=Symbol.for("react.element"),_A=Symbol.for("react.fragment"),vA=Object.prototype.hasOwnProperty,xA=gA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wA={key:!0,ref:!0,__self:!0,__source:!0};function NS(e,t,i){var u,d={},g=null,y=null;i!==void 0&&(g=""+i),t.key!==void 0&&(g=""+t.key),t.ref!==void 0&&(y=t.ref);for(u in t)vA.call(t,u)&&!wA.hasOwnProperty(u)&&(d[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps,t)d[u]===void 0&&(d[u]=t[u]);return{$$typeof:yA,type:e,key:g,ref:y,props:d,_owner:xA.current}}ug.Fragment=_A;ug.jsx=NS;ug.jsxs=NS;PS.exports=ug;var Je=PS.exports,n0={},$S={exports:{}},bo={},jS={exports:{}},US={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Be,Le){var Ke=Be.length;Be.push(Le);e:for(;0<Ke;){var xe=Ke-1>>>1,Te=Be[xe];if(0<d(Te,Le))Be[xe]=Le,Be[Ke]=Te,Ke=xe;else break e}}function i(Be){return Be.length===0?null:Be[0]}function u(Be){if(Be.length===0)return null;var Le=Be[0],Ke=Be.pop();if(Ke!==Le){Be[0]=Ke;e:for(var xe=0,Te=Be.length,ft=Te>>>1;xe<ft;){var nt=2*(xe+1)-1,rt=Be[nt],qt=nt+1,Kt=Be[qt];if(0>d(rt,Ke))qt<Te&&0>d(Kt,rt)?(Be[xe]=Kt,Be[qt]=Ke,xe=qt):(Be[xe]=rt,Be[nt]=Ke,xe=nt);else if(qt<Te&&0>d(Kt,Ke))Be[xe]=Kt,Be[qt]=Ke,xe=qt;else break e}}return Le}function d(Be,Le){var Ke=Be.sortIndex-Le.sortIndex;return Ke!==0?Ke:Be.id-Le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var y=Date,c=y.now();e.unstable_now=function(){return y.now()-c}}var T=[],P=[],R=1,D=null,A=3,N=!1,X=!1,U=!1,te=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(Be){for(var Le=i(P);Le!==null;){if(Le.callback===null)u(P);else if(Le.startTime<=Be)u(P),Le.sortIndex=Le.expirationTime,t(T,Le);else break;Le=i(P)}}function ne(Be){if(U=!1,q(Be),!X)if(i(T)!==null)X=!0,_t(se);else{var Le=i(P);Le!==null&&ye(ne,Le.startTime-Be)}}function se(Be,Le){X=!1,U&&(U=!1,F(Oe),Oe=-1),N=!0;var Ke=A;try{for(q(Le),D=i(T);D!==null&&(!(D.expirationTime>Le)||Be&&!it());){var xe=D.callback;if(typeof xe=="function"){D.callback=null,A=D.priorityLevel;var Te=xe(D.expirationTime<=Le);Le=e.unstable_now(),typeof Te=="function"?D.callback=Te:D===i(T)&&u(T),q(Le)}else u(T);D=i(T)}if(D!==null)var ft=!0;else{var nt=i(P);nt!==null&&ye(ne,nt.startTime-Le),ft=!1}return ft}finally{D=null,A=Ke,N=!1}}var Ee=!1,ge=null,Oe=-1,Fe=5,Ge=-1;function it(){return!(e.unstable_now()-Ge<Fe)}function ve(){if(ge!==null){var Be=e.unstable_now();Ge=Be;var Le=!0;try{Le=ge(!0,Be)}finally{Le?je():(Ee=!1,ge=null)}}else Ee=!1}var je;if(typeof $=="function")je=function(){$(ve)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Re=H.port2;H.port1.onmessage=ve,je=function(){Re.postMessage(null)}}else je=function(){te(ve,0)};function _t(Be){ge=Be,Ee||(Ee=!0,je())}function ye(Be,Le){Oe=te(function(){Be(e.unstable_now())},Le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Be){Be.callback=null},e.unstable_continueExecution=function(){X||N||(X=!0,_t(se))},e.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Fe=0<Be?Math.floor(1e3/Be):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return i(T)},e.unstable_next=function(Be){switch(A){case 1:case 2:case 3:var Le=3;break;default:Le=A}var Ke=A;A=Le;try{return Be()}finally{A=Ke}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Be,Le){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var Ke=A;A=Be;try{return Le()}finally{A=Ke}},e.unstable_scheduleCallback=function(Be,Le,Ke){var xe=e.unstable_now();switch(typeof Ke=="object"&&Ke!==null?(Ke=Ke.delay,Ke=typeof Ke=="number"&&0<Ke?xe+Ke:xe):Ke=xe,Be){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=Ke+Te,Be={id:R++,callback:Le,priorityLevel:Be,startTime:Ke,expirationTime:Te,sortIndex:-1},Ke>xe?(Be.sortIndex=Ke,t(P,Be),i(T)===null&&Be===i(P)&&(U?(F(Oe),Oe=-1):U=!0,ye(ne,Ke-xe))):(Be.sortIndex=Te,t(T,Be),X||N||(X=!0,_t(se))),Be},e.unstable_shouldYield=it,e.unstable_wrapCallback=function(Be){var Le=A;return function(){var Ke=A;A=Le;try{return Be.apply(this,arguments)}finally{A=Ke}}}})(US);jS.exports=US;var bA=jS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SA=$t,wo=bA;function lt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VS=new Set,Rd={};function iu(e,t){kc(e,t),kc(e+"Capture",t)}function kc(e,t){for(Rd[e]=t,e=0;e<t.length;e++)VS.add(t[e])}var Zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),i0=Object.prototype.hasOwnProperty,EA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Uw={},Vw={};function kA(e){return i0.call(Vw,e)?!0:i0.call(Uw,e)?!1:EA.test(e)?Vw[e]=!0:(Uw[e]=!0,!1)}function TA(e,t,i,u){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return u?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function CA(e,t,i,u){if(t===null||typeof t>"u"||TA(e,t,i,u))return!0;if(u)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ai(e,t,i,u,d,g,y){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=y}var Kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Kn[e]=new Ai(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Kn[t]=new Ai(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Kn[e]=new Ai(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Kn[e]=new Ai(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Kn[e]=new Ai(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Kn[e]=new Ai(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Kn[e]=new Ai(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Kn[e]=new Ai(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Kn[e]=new Ai(e,5,!1,e.toLowerCase(),null,!1,!1)});var Rv=/[\-:]([a-z])/g;function Lv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Rv,Lv);Kn[t]=new Ai(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Rv,Lv);Kn[t]=new Ai(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Rv,Lv);Kn[t]=new Ai(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Kn[e]=new Ai(e,1,!1,e.toLowerCase(),null,!1,!1)});Kn.xlinkHref=new Ai("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Kn[e]=new Ai(e,1,!1,e.toLowerCase(),null,!0,!0)});function Fv(e,t,i,u){var d=Kn.hasOwnProperty(t)?Kn[t]:null;(d!==null?d.type!==0:u||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(CA(t,i,d,u)&&(i=null),u||d===null?kA(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):d.mustUseProperty?e[d.propertyName]=i===null?d.type===3?!1:"":i:(t=d.attributeName,u=d.attributeNamespace,i===null?e.removeAttribute(t):(d=d.type,i=d===3||d===4&&i===!0?"":""+i,u?e.setAttributeNS(u,t,i):e.setAttribute(t,i))))}var Js=SA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bf=Symbol.for("react.element"),ic=Symbol.for("react.portal"),oc=Symbol.for("react.fragment"),Ov=Symbol.for("react.strict_mode"),o0=Symbol.for("react.profiler"),HS=Symbol.for("react.provider"),GS=Symbol.for("react.context"),Bv=Symbol.for("react.forward_ref"),s0=Symbol.for("react.suspense"),a0=Symbol.for("react.suspense_list"),Nv=Symbol.for("react.memo"),Oa=Symbol.for("react.lazy"),ZS=Symbol.for("react.offscreen"),Hw=Symbol.iterator;function rd(e){return e===null||typeof e!="object"?null:(e=Hw&&e[Hw]||e["@@iterator"],typeof e=="function"?e:null)}var hn=Object.assign,d_;function hd(e){if(d_===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);d_=t&&t[1]||""}return`
`+d_+e}var p_=!1;function f_(e,t){if(!e||p_)return"";p_=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(P){var u=P}Reflect.construct(e,[],t)}else{try{t.call()}catch(P){u=P}e.call(t.prototype)}else{try{throw Error()}catch(P){u=P}e()}}catch(P){if(P&&u&&typeof P.stack=="string"){for(var d=P.stack.split(`
`),g=u.stack.split(`
`),y=d.length-1,c=g.length-1;1<=y&&0<=c&&d[y]!==g[c];)c--;for(;1<=y&&0<=c;y--,c--)if(d[y]!==g[c]){if(y!==1||c!==1)do if(y--,c--,0>c||d[y]!==g[c]){var T=`
`+d[y].replace(" at new "," at ");return e.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",e.displayName)),T}while(1<=y&&0<=c);break}}}finally{p_=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?hd(e):""}function IA(e){switch(e.tag){case 5:return hd(e.type);case 16:return hd("Lazy");case 13:return hd("Suspense");case 19:return hd("SuspenseList");case 0:case 2:case 15:return e=f_(e.type,!1),e;case 11:return e=f_(e.type.render,!1),e;case 1:return e=f_(e.type,!0),e;default:return""}}function l0(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case oc:return"Fragment";case ic:return"Portal";case o0:return"Profiler";case Ov:return"StrictMode";case s0:return"Suspense";case a0:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case GS:return(e.displayName||"Context")+".Consumer";case HS:return(e._context.displayName||"Context")+".Provider";case Bv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nv:return t=e.displayName||null,t!==null?t:l0(e.type)||"Memo";case Oa:t=e._payload,e=e._init;try{return l0(e(t))}catch{}}return null}function PA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return l0(t);case 8:return t===Ov?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function el(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function WS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function AA(e){var t=WS(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),u=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var d=i.get,g=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return d.call(this)},set:function(y){u=""+y,g.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return u},setValue:function(y){u=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Sf(e){e._valueTracker||(e._valueTracker=AA(e))}function qS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),u="";return e&&(u=WS(e)?e.checked?"true":"false":e.value),e=u,e!==i?(t.setValue(e),!0):!1}function bm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function u0(e,t){var i=t.checked;return hn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function Gw(e,t){var i=t.defaultValue==null?"":t.defaultValue,u=t.checked!=null?t.checked:t.defaultChecked;i=el(t.value!=null?t.value:i),e._wrapperState={initialChecked:u,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function XS(e,t){t=t.checked,t!=null&&Fv(e,"checked",t,!1)}function c0(e,t){XS(e,t);var i=el(t.value),u=t.type;if(i!=null)u==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?h0(e,t.type,i):t.hasOwnProperty("defaultValue")&&h0(e,t.type,el(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Zw(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var u=t.type;if(!(u!=="submit"&&u!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function h0(e,t,i){(t!=="number"||bm(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var dd=Array.isArray;function _c(e,t,i,u){if(e=e.options,t){t={};for(var d=0;d<i.length;d++)t["$"+i[d]]=!0;for(i=0;i<e.length;i++)d=t.hasOwnProperty("$"+e[i].value),e[i].selected!==d&&(e[i].selected=d),d&&u&&(e[i].defaultSelected=!0)}else{for(i=""+el(i),t=null,d=0;d<e.length;d++){if(e[d].value===i){e[d].selected=!0,u&&(e[d].defaultSelected=!0);return}t!==null||e[d].disabled||(t=e[d])}t!==null&&(t.selected=!0)}}function d0(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(lt(91));return hn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ww(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(lt(92));if(dd(i)){if(1<i.length)throw Error(lt(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:el(i)}}function KS(e,t){var i=el(t.value),u=el(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),u!=null&&(e.defaultValue=""+u)}function qw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function YS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function p0(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?YS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ef,JS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,u,d){MSApp.execUnsafeLocalFunction(function(){return e(t,i,u,d)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ef=Ef||document.createElement("div"),Ef.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ef.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ld(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var xd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},MA=["Webkit","ms","Moz","O"];Object.keys(xd).forEach(function(e){MA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xd[t]=xd[e]})});function QS(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||xd.hasOwnProperty(e)&&xd[e]?(""+t).trim():t+"px"}function eE(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var u=i.indexOf("--")===0,d=QS(i,t[i],u);i==="float"&&(i="cssFloat"),u?e.setProperty(i,d):e[i]=d}}var zA=hn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function f0(e,t){if(t){if(zA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(lt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(lt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(lt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(lt(62))}}function m0(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g0=null;function $v(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var y0=null,vc=null,xc=null;function Xw(e){if(e=lp(e)){if(typeof y0!="function")throw Error(lt(280));var t=e.stateNode;t&&(t=fg(t),y0(e.stateNode,e.type,t))}}function tE(e){vc?xc?xc.push(e):xc=[e]:vc=e}function rE(){if(vc){var e=vc,t=xc;if(xc=vc=null,Xw(e),t)for(e=0;e<t.length;e++)Xw(t[e])}}function nE(e,t){return e(t)}function iE(){}var m_=!1;function oE(e,t,i){if(m_)return e(t,i);m_=!0;try{return nE(e,t,i)}finally{m_=!1,(vc!==null||xc!==null)&&(iE(),rE())}}function Fd(e,t){var i=e.stateNode;if(i===null)return null;var u=fg(i);if(u===null)return null;i=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(lt(231,t,typeof i));return i}var _0=!1;if(Zs)try{var nd={};Object.defineProperty(nd,"passive",{get:function(){_0=!0}}),window.addEventListener("test",nd,nd),window.removeEventListener("test",nd,nd)}catch{_0=!1}function DA(e,t,i,u,d,g,y,c,T){var P=Array.prototype.slice.call(arguments,3);try{t.apply(i,P)}catch(R){this.onError(R)}}var wd=!1,Sm=null,Em=!1,v0=null,RA={onError:function(e){wd=!0,Sm=e}};function LA(e,t,i,u,d,g,y,c,T){wd=!1,Sm=null,DA.apply(RA,arguments)}function FA(e,t,i,u,d,g,y,c,T){if(LA.apply(this,arguments),wd){if(wd){var P=Sm;wd=!1,Sm=null}else throw Error(lt(198));Em||(Em=!0,v0=P)}}function ou(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function sE(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kw(e){if(ou(e)!==e)throw Error(lt(188))}function OA(e){var t=e.alternate;if(!t){if(t=ou(e),t===null)throw Error(lt(188));return t!==e?null:e}for(var i=e,u=t;;){var d=i.return;if(d===null)break;var g=d.alternate;if(g===null){if(u=d.return,u!==null){i=u;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===i)return Kw(d),e;if(g===u)return Kw(d),t;g=g.sibling}throw Error(lt(188))}if(i.return!==u.return)i=d,u=g;else{for(var y=!1,c=d.child;c;){if(c===i){y=!0,i=d,u=g;break}if(c===u){y=!0,u=d,i=g;break}c=c.sibling}if(!y){for(c=g.child;c;){if(c===i){y=!0,i=g,u=d;break}if(c===u){y=!0,u=g,i=d;break}c=c.sibling}if(!y)throw Error(lt(189))}}if(i.alternate!==u)throw Error(lt(190))}if(i.tag!==3)throw Error(lt(188));return i.stateNode.current===i?e:t}function aE(e){return e=OA(e),e!==null?lE(e):null}function lE(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lE(e);if(t!==null)return t;e=e.sibling}return null}var uE=wo.unstable_scheduleCallback,Yw=wo.unstable_cancelCallback,BA=wo.unstable_shouldYield,NA=wo.unstable_requestPaint,yn=wo.unstable_now,$A=wo.unstable_getCurrentPriorityLevel,jv=wo.unstable_ImmediatePriority,cE=wo.unstable_UserBlockingPriority,km=wo.unstable_NormalPriority,jA=wo.unstable_LowPriority,hE=wo.unstable_IdlePriority,cg=null,vs=null;function UA(e){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(cg,e,void 0,(e.current.flags&128)===128)}catch{}}var Yo=Math.clz32?Math.clz32:GA,VA=Math.log,HA=Math.LN2;function GA(e){return e>>>=0,e===0?32:31-(VA(e)/HA|0)|0}var kf=64,Tf=4194304;function pd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Tm(e,t){var i=e.pendingLanes;if(i===0)return 0;var u=0,d=e.suspendedLanes,g=e.pingedLanes,y=i&268435455;if(y!==0){var c=y&~d;c!==0?u=pd(c):(g&=y,g!==0&&(u=pd(g)))}else y=i&~d,y!==0?u=pd(y):g!==0&&(u=pd(g));if(u===0)return 0;if(t!==0&&t!==u&&!(t&d)&&(d=u&-u,g=t&-t,d>=g||d===16&&(g&4194240)!==0))return t;if(u&4&&(u|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=u;0<t;)i=31-Yo(t),d=1<<i,u|=e[i],t&=~d;return u}function ZA(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WA(e,t){for(var i=e.suspendedLanes,u=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes;0<g;){var y=31-Yo(g),c=1<<y,T=d[y];T===-1?(!(c&i)||c&u)&&(d[y]=ZA(c,t)):T<=t&&(e.expiredLanes|=c),g&=~c}}function x0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dE(){var e=kf;return kf<<=1,!(kf&4194240)&&(kf=64),e}function g_(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function sp(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yo(t),e[t]=i}function qA(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<i;){var d=31-Yo(i),g=1<<d;t[d]=0,u[d]=-1,e[d]=-1,i&=~g}}function Uv(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var u=31-Yo(i),d=1<<u;d&t|e[u]&t&&(e[u]|=t),i&=~d}}var zr=0;function pE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var fE,Vv,mE,gE,yE,w0=!1,Cf=[],Za=null,Wa=null,qa=null,Od=new Map,Bd=new Map,Na=[],XA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jw(e,t){switch(e){case"focusin":case"focusout":Za=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":qa=null;break;case"pointerover":case"pointerout":Od.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bd.delete(t.pointerId)}}function id(e,t,i,u,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:t,domEventName:i,eventSystemFlags:u,nativeEvent:g,targetContainers:[d]},t!==null&&(t=lp(t),t!==null&&Vv(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,d!==null&&t.indexOf(d)===-1&&t.push(d),e)}function KA(e,t,i,u,d){switch(t){case"focusin":return Za=id(Za,e,t,i,u,d),!0;case"dragenter":return Wa=id(Wa,e,t,i,u,d),!0;case"mouseover":return qa=id(qa,e,t,i,u,d),!0;case"pointerover":var g=d.pointerId;return Od.set(g,id(Od.get(g)||null,e,t,i,u,d)),!0;case"gotpointercapture":return g=d.pointerId,Bd.set(g,id(Bd.get(g)||null,e,t,i,u,d)),!0}return!1}function _E(e){var t=Nl(e.target);if(t!==null){var i=ou(t);if(i!==null){if(t=i.tag,t===13){if(t=sE(i),t!==null){e.blockedOn=t,yE(e.priority,function(){mE(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Kf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=b0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var u=new i.constructor(i.type,i);g0=u,i.target.dispatchEvent(u),g0=null}else return t=lp(i),t!==null&&Vv(t),e.blockedOn=i,!1;t.shift()}return!0}function Qw(e,t,i){Kf(e)&&i.delete(t)}function YA(){w0=!1,Za!==null&&Kf(Za)&&(Za=null),Wa!==null&&Kf(Wa)&&(Wa=null),qa!==null&&Kf(qa)&&(qa=null),Od.forEach(Qw),Bd.forEach(Qw)}function od(e,t){e.blockedOn===t&&(e.blockedOn=null,w0||(w0=!0,wo.unstable_scheduleCallback(wo.unstable_NormalPriority,YA)))}function Nd(e){function t(d){return od(d,e)}if(0<Cf.length){od(Cf[0],e);for(var i=1;i<Cf.length;i++){var u=Cf[i];u.blockedOn===e&&(u.blockedOn=null)}}for(Za!==null&&od(Za,e),Wa!==null&&od(Wa,e),qa!==null&&od(qa,e),Od.forEach(t),Bd.forEach(t),i=0;i<Na.length;i++)u=Na[i],u.blockedOn===e&&(u.blockedOn=null);for(;0<Na.length&&(i=Na[0],i.blockedOn===null);)_E(i),i.blockedOn===null&&Na.shift()}var wc=Js.ReactCurrentBatchConfig,Cm=!0;function JA(e,t,i,u){var d=zr,g=wc.transition;wc.transition=null;try{zr=1,Hv(e,t,i,u)}finally{zr=d,wc.transition=g}}function QA(e,t,i,u){var d=zr,g=wc.transition;wc.transition=null;try{zr=4,Hv(e,t,i,u)}finally{zr=d,wc.transition=g}}function Hv(e,t,i,u){if(Cm){var d=b0(e,t,i,u);if(d===null)T_(e,t,u,Im,i),Jw(e,u);else if(KA(d,e,t,i,u))u.stopPropagation();else if(Jw(e,u),t&4&&-1<XA.indexOf(e)){for(;d!==null;){var g=lp(d);if(g!==null&&fE(g),g=b0(e,t,i,u),g===null&&T_(e,t,u,Im,i),g===d)break;d=g}d!==null&&u.stopPropagation()}else T_(e,t,u,null,i)}}var Im=null;function b0(e,t,i,u){if(Im=null,e=$v(u),e=Nl(e),e!==null)if(t=ou(e),t===null)e=null;else if(i=t.tag,i===13){if(e=sE(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Im=e,null}function vE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($A()){case jv:return 1;case cE:return 4;case km:case jA:return 16;case hE:return 536870912;default:return 16}default:return 16}}var ja=null,Gv=null,Yf=null;function xE(){if(Yf)return Yf;var e,t=Gv,i=t.length,u,d="value"in ja?ja.value:ja.textContent,g=d.length;for(e=0;e<i&&t[e]===d[e];e++);var y=i-e;for(u=1;u<=y&&t[i-u]===d[g-u];u++);return Yf=d.slice(e,1<u?1-u:void 0)}function Jf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function If(){return!0}function eb(){return!1}function So(e){function t(i,u,d,g,y){this._reactName=i,this._targetInst=d,this.type=u,this.nativeEvent=g,this.target=y,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(i=e[c],this[c]=i?i(g):g[c]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?If:eb,this.isPropagationStopped=eb,this}return hn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=If)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=If)},persist:function(){},isPersistent:If}),t}var jc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zv=So(jc),ap=hn({},jc,{view:0,detail:0}),eM=So(ap),y_,__,sd,hg=hn({},ap,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sd&&(sd&&e.type==="mousemove"?(y_=e.screenX-sd.screenX,__=e.screenY-sd.screenY):__=y_=0,sd=e),y_)},movementY:function(e){return"movementY"in e?e.movementY:__}}),tb=So(hg),tM=hn({},hg,{dataTransfer:0}),rM=So(tM),nM=hn({},ap,{relatedTarget:0}),v_=So(nM),iM=hn({},jc,{animationName:0,elapsedTime:0,pseudoElement:0}),oM=So(iM),sM=hn({},jc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aM=So(sM),lM=hn({},jc,{data:0}),rb=So(lM),uM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hM[e])?!!t[e]:!1}function Wv(){return dM}var pM=hn({},ap,{key:function(e){if(e.key){var t=uM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Jf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?cM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wv,charCode:function(e){return e.type==="keypress"?Jf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Jf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),fM=So(pM),mM=hn({},hg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nb=So(mM),gM=hn({},ap,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wv}),yM=So(gM),_M=hn({},jc,{propertyName:0,elapsedTime:0,pseudoElement:0}),vM=So(_M),xM=hn({},hg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),wM=So(xM),bM=[9,13,27,32],qv=Zs&&"CompositionEvent"in window,bd=null;Zs&&"documentMode"in document&&(bd=document.documentMode);var SM=Zs&&"TextEvent"in window&&!bd,wE=Zs&&(!qv||bd&&8<bd&&11>=bd),ib=" ",ob=!1;function bE(e,t){switch(e){case"keyup":return bM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var sc=!1;function EM(e,t){switch(e){case"compositionend":return SE(t);case"keypress":return t.which!==32?null:(ob=!0,ib);case"textInput":return e=t.data,e===ib&&ob?null:e;default:return null}}function kM(e,t){if(sc)return e==="compositionend"||!qv&&bE(e,t)?(e=xE(),Yf=Gv=ja=null,sc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wE&&t.locale!=="ko"?null:t.data;default:return null}}var TM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!TM[e.type]:t==="textarea"}function EE(e,t,i,u){tE(u),t=Pm(t,"onChange"),0<t.length&&(i=new Zv("onChange","change",null,i,u),e.push({event:i,listeners:t}))}var Sd=null,$d=null;function CM(e){LE(e,0)}function dg(e){var t=uc(e);if(qS(t))return e}function IM(e,t){if(e==="change")return t}var kE=!1;if(Zs){var x_;if(Zs){var w_="oninput"in document;if(!w_){var ab=document.createElement("div");ab.setAttribute("oninput","return;"),w_=typeof ab.oninput=="function"}x_=w_}else x_=!1;kE=x_&&(!document.documentMode||9<document.documentMode)}function lb(){Sd&&(Sd.detachEvent("onpropertychange",TE),$d=Sd=null)}function TE(e){if(e.propertyName==="value"&&dg($d)){var t=[];EE(t,$d,e,$v(e)),oE(CM,t)}}function PM(e,t,i){e==="focusin"?(lb(),Sd=t,$d=i,Sd.attachEvent("onpropertychange",TE)):e==="focusout"&&lb()}function AM(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return dg($d)}function MM(e,t){if(e==="click")return dg(t)}function zM(e,t){if(e==="input"||e==="change")return dg(t)}function DM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ts=typeof Object.is=="function"?Object.is:DM;function jd(e,t){if(ts(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),u=Object.keys(t);if(i.length!==u.length)return!1;for(u=0;u<i.length;u++){var d=i[u];if(!i0.call(t,d)||!ts(e[d],t[d]))return!1}return!0}function ub(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cb(e,t){var i=ub(e);e=0;for(var u;i;){if(i.nodeType===3){if(u=e+i.textContent.length,e<=t&&u>=t)return{node:i,offset:t-e};e=u}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ub(i)}}function CE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function IE(){for(var e=window,t=bm();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=bm(e.document)}return t}function Xv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function RM(e){var t=IE(),i=e.focusedElem,u=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&CE(i.ownerDocument.documentElement,i)){if(u!==null&&Xv(i)){if(t=u.start,e=u.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var d=i.textContent.length,g=Math.min(u.start,d);u=u.end===void 0?g:Math.min(u.end,d),!e.extend&&g>u&&(d=u,u=g,g=d),d=cb(i,g);var y=cb(i,u);d&&y&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==y.node||e.focusOffset!==y.offset)&&(t=t.createRange(),t.setStart(d.node,d.offset),e.removeAllRanges(),g>u?(e.addRange(t),e.extend(y.node,y.offset)):(t.setEnd(y.node,y.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var LM=Zs&&"documentMode"in document&&11>=document.documentMode,ac=null,S0=null,Ed=null,E0=!1;function hb(e,t,i){var u=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;E0||ac==null||ac!==bm(u)||(u=ac,"selectionStart"in u&&Xv(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ed&&jd(Ed,u)||(Ed=u,u=Pm(S0,"onSelect"),0<u.length&&(t=new Zv("onSelect","select",null,t,i),e.push({event:t,listeners:u}),t.target=ac)))}function Pf(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var lc={animationend:Pf("Animation","AnimationEnd"),animationiteration:Pf("Animation","AnimationIteration"),animationstart:Pf("Animation","AnimationStart"),transitionend:Pf("Transition","TransitionEnd")},b_={},PE={};Zs&&(PE=document.createElement("div").style,"AnimationEvent"in window||(delete lc.animationend.animation,delete lc.animationiteration.animation,delete lc.animationstart.animation),"TransitionEvent"in window||delete lc.transitionend.transition);function pg(e){if(b_[e])return b_[e];if(!lc[e])return e;var t=lc[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in PE)return b_[e]=t[i];return e}var AE=pg("animationend"),ME=pg("animationiteration"),zE=pg("animationstart"),DE=pg("transitionend"),RE=new Map,db="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rl(e,t){RE.set(e,t),iu(t,[e])}for(var S_=0;S_<db.length;S_++){var E_=db[S_],FM=E_.toLowerCase(),OM=E_[0].toUpperCase()+E_.slice(1);rl(FM,"on"+OM)}rl(AE,"onAnimationEnd");rl(ME,"onAnimationIteration");rl(zE,"onAnimationStart");rl("dblclick","onDoubleClick");rl("focusin","onFocus");rl("focusout","onBlur");rl(DE,"onTransitionEnd");kc("onMouseEnter",["mouseout","mouseover"]);kc("onMouseLeave",["mouseout","mouseover"]);kc("onPointerEnter",["pointerout","pointerover"]);kc("onPointerLeave",["pointerout","pointerover"]);iu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));iu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));iu("onBeforeInput",["compositionend","keypress","textInput","paste"]);iu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));iu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));iu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BM=new Set("cancel close invalid load scroll toggle".split(" ").concat(fd));function pb(e,t,i){var u=e.type||"unknown-event";e.currentTarget=i,FA(u,t,void 0,e),e.currentTarget=null}function LE(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var u=e[i],d=u.event;u=u.listeners;e:{var g=void 0;if(t)for(var y=u.length-1;0<=y;y--){var c=u[y],T=c.instance,P=c.currentTarget;if(c=c.listener,T!==g&&d.isPropagationStopped())break e;pb(d,c,P),g=T}else for(y=0;y<u.length;y++){if(c=u[y],T=c.instance,P=c.currentTarget,c=c.listener,T!==g&&d.isPropagationStopped())break e;pb(d,c,P),g=T}}}if(Em)throw e=v0,Em=!1,v0=null,e}function qr(e,t){var i=t[P0];i===void 0&&(i=t[P0]=new Set);var u=e+"__bubble";i.has(u)||(FE(t,e,2,!1),i.add(u))}function k_(e,t,i){var u=0;t&&(u|=4),FE(i,e,u,t)}var Af="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[Af]){e[Af]=!0,VS.forEach(function(i){i!=="selectionchange"&&(BM.has(i)||k_(i,!1,e),k_(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Af]||(t[Af]=!0,k_("selectionchange",!1,t))}}function FE(e,t,i,u){switch(vE(t)){case 1:var d=JA;break;case 4:d=QA;break;default:d=Hv}i=d.bind(null,t,i,e),d=void 0,!_0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(d=!0),u?d!==void 0?e.addEventListener(t,i,{capture:!0,passive:d}):e.addEventListener(t,i,!0):d!==void 0?e.addEventListener(t,i,{passive:d}):e.addEventListener(t,i,!1)}function T_(e,t,i,u,d){var g=u;if(!(t&1)&&!(t&2)&&u!==null)e:for(;;){if(u===null)return;var y=u.tag;if(y===3||y===4){var c=u.stateNode.containerInfo;if(c===d||c.nodeType===8&&c.parentNode===d)break;if(y===4)for(y=u.return;y!==null;){var T=y.tag;if((T===3||T===4)&&(T=y.stateNode.containerInfo,T===d||T.nodeType===8&&T.parentNode===d))return;y=y.return}for(;c!==null;){if(y=Nl(c),y===null)return;if(T=y.tag,T===5||T===6){u=g=y;continue e}c=c.parentNode}}u=u.return}oE(function(){var P=g,R=$v(i),D=[];e:{var A=RE.get(e);if(A!==void 0){var N=Zv,X=e;switch(e){case"keypress":if(Jf(i)===0)break e;case"keydown":case"keyup":N=fM;break;case"focusin":X="focus",N=v_;break;case"focusout":X="blur",N=v_;break;case"beforeblur":case"afterblur":N=v_;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=tb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=rM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=yM;break;case AE:case ME:case zE:N=oM;break;case DE:N=vM;break;case"scroll":N=eM;break;case"wheel":N=wM;break;case"copy":case"cut":case"paste":N=aM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=nb}var U=(t&4)!==0,te=!U&&e==="scroll",F=U?A!==null?A+"Capture":null:A;U=[];for(var $=P,q;$!==null;){q=$;var ne=q.stateNode;if(q.tag===5&&ne!==null&&(q=ne,F!==null&&(ne=Fd($,F),ne!=null&&U.push(Vd($,ne,q)))),te)break;$=$.return}0<U.length&&(A=new N(A,X,null,i,R),D.push({event:A,listeners:U}))}}if(!(t&7)){e:{if(A=e==="mouseover"||e==="pointerover",N=e==="mouseout"||e==="pointerout",A&&i!==g0&&(X=i.relatedTarget||i.fromElement)&&(Nl(X)||X[Ws]))break e;if((N||A)&&(A=R.window===R?R:(A=R.ownerDocument)?A.defaultView||A.parentWindow:window,N?(X=i.relatedTarget||i.toElement,N=P,X=X?Nl(X):null,X!==null&&(te=ou(X),X!==te||X.tag!==5&&X.tag!==6)&&(X=null)):(N=null,X=P),N!==X)){if(U=tb,ne="onMouseLeave",F="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(U=nb,ne="onPointerLeave",F="onPointerEnter",$="pointer"),te=N==null?A:uc(N),q=X==null?A:uc(X),A=new U(ne,$+"leave",N,i,R),A.target=te,A.relatedTarget=q,ne=null,Nl(R)===P&&(U=new U(F,$+"enter",X,i,R),U.target=q,U.relatedTarget=te,ne=U),te=ne,N&&X)t:{for(U=N,F=X,$=0,q=U;q;q=tc(q))$++;for(q=0,ne=F;ne;ne=tc(ne))q++;for(;0<$-q;)U=tc(U),$--;for(;0<q-$;)F=tc(F),q--;for(;$--;){if(U===F||F!==null&&U===F.alternate)break t;U=tc(U),F=tc(F)}U=null}else U=null;N!==null&&fb(D,A,N,U,!1),X!==null&&te!==null&&fb(D,te,X,U,!0)}}e:{if(A=P?uc(P):window,N=A.nodeName&&A.nodeName.toLowerCase(),N==="select"||N==="input"&&A.type==="file")var se=IM;else if(sb(A))if(kE)se=zM;else{se=AM;var Ee=PM}else(N=A.nodeName)&&N.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(se=MM);if(se&&(se=se(e,P))){EE(D,se,i,R);break e}Ee&&Ee(e,A,P),e==="focusout"&&(Ee=A._wrapperState)&&Ee.controlled&&A.type==="number"&&h0(A,"number",A.value)}switch(Ee=P?uc(P):window,e){case"focusin":(sb(Ee)||Ee.contentEditable==="true")&&(ac=Ee,S0=P,Ed=null);break;case"focusout":Ed=S0=ac=null;break;case"mousedown":E0=!0;break;case"contextmenu":case"mouseup":case"dragend":E0=!1,hb(D,i,R);break;case"selectionchange":if(LM)break;case"keydown":case"keyup":hb(D,i,R)}var ge;if(qv)e:{switch(e){case"compositionstart":var Oe="onCompositionStart";break e;case"compositionend":Oe="onCompositionEnd";break e;case"compositionupdate":Oe="onCompositionUpdate";break e}Oe=void 0}else sc?bE(e,i)&&(Oe="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(Oe="onCompositionStart");Oe&&(wE&&i.locale!=="ko"&&(sc||Oe!=="onCompositionStart"?Oe==="onCompositionEnd"&&sc&&(ge=xE()):(ja=R,Gv="value"in ja?ja.value:ja.textContent,sc=!0)),Ee=Pm(P,Oe),0<Ee.length&&(Oe=new rb(Oe,e,null,i,R),D.push({event:Oe,listeners:Ee}),ge?Oe.data=ge:(ge=SE(i),ge!==null&&(Oe.data=ge)))),(ge=SM?EM(e,i):kM(e,i))&&(P=Pm(P,"onBeforeInput"),0<P.length&&(R=new rb("onBeforeInput","beforeinput",null,i,R),D.push({event:R,listeners:P}),R.data=ge))}LE(D,t)})}function Vd(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Pm(e,t){for(var i=t+"Capture",u=[];e!==null;){var d=e,g=d.stateNode;d.tag===5&&g!==null&&(d=g,g=Fd(e,i),g!=null&&u.unshift(Vd(e,g,d)),g=Fd(e,t),g!=null&&u.push(Vd(e,g,d))),e=e.return}return u}function tc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function fb(e,t,i,u,d){for(var g=t._reactName,y=[];i!==null&&i!==u;){var c=i,T=c.alternate,P=c.stateNode;if(T!==null&&T===u)break;c.tag===5&&P!==null&&(c=P,d?(T=Fd(i,g),T!=null&&y.unshift(Vd(i,T,c))):d||(T=Fd(i,g),T!=null&&y.push(Vd(i,T,c)))),i=i.return}y.length!==0&&e.push({event:t,listeners:y})}var NM=/\r\n?/g,$M=/\u0000|\uFFFD/g;function mb(e){return(typeof e=="string"?e:""+e).replace(NM,`
`).replace($M,"")}function Mf(e,t,i){if(t=mb(t),mb(e)!==t&&i)throw Error(lt(425))}function Am(){}var k0=null,T0=null;function C0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var I0=typeof setTimeout=="function"?setTimeout:void 0,jM=typeof clearTimeout=="function"?clearTimeout:void 0,gb=typeof Promise=="function"?Promise:void 0,UM=typeof queueMicrotask=="function"?queueMicrotask:typeof gb<"u"?function(e){return gb.resolve(null).then(e).catch(VM)}:I0;function VM(e){setTimeout(function(){throw e})}function C_(e,t){var i=t,u=0;do{var d=i.nextSibling;if(e.removeChild(i),d&&d.nodeType===8)if(i=d.data,i==="/$"){if(u===0){e.removeChild(d),Nd(t);return}u--}else i!=="$"&&i!=="$?"&&i!=="$!"||u++;i=d}while(i);Nd(t)}function Xa(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Uc=Math.random().toString(36).slice(2),_s="__reactFiber$"+Uc,Hd="__reactProps$"+Uc,Ws="__reactContainer$"+Uc,P0="__reactEvents$"+Uc,HM="__reactListeners$"+Uc,GM="__reactHandles$"+Uc;function Nl(e){var t=e[_s];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Ws]||i[_s]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=yb(e);e!==null;){if(i=e[_s])return i;e=yb(e)}return t}e=i,i=e.parentNode}return null}function lp(e){return e=e[_s]||e[Ws],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function uc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(lt(33))}function fg(e){return e[Hd]||null}var A0=[],cc=-1;function nl(e){return{current:e}}function Jr(e){0>cc||(e.current=A0[cc],A0[cc]=null,cc--)}function Hr(e,t){cc++,A0[cc]=e.current,e.current=t}var tl={},pi=nl(tl),Wi=nl(!1),Yl=tl;function Tc(e,t){var i=e.type.contextTypes;if(!i)return tl;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===t)return u.__reactInternalMemoizedMaskedChildContext;var d={},g;for(g in i)d[g]=t[g];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=d),d}function qi(e){return e=e.childContextTypes,e!=null}function Mm(){Jr(Wi),Jr(pi)}function _b(e,t,i){if(pi.current!==tl)throw Error(lt(168));Hr(pi,t),Hr(Wi,i)}function OE(e,t,i){var u=e.stateNode;if(t=t.childContextTypes,typeof u.getChildContext!="function")return i;u=u.getChildContext();for(var d in u)if(!(d in t))throw Error(lt(108,PA(e)||"Unknown",d));return hn({},i,u)}function zm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||tl,Yl=pi.current,Hr(pi,e),Hr(Wi,Wi.current),!0}function vb(e,t,i){var u=e.stateNode;if(!u)throw Error(lt(169));i?(e=OE(e,t,Yl),u.__reactInternalMemoizedMergedChildContext=e,Jr(Wi),Jr(pi),Hr(pi,e)):Jr(Wi),Hr(Wi,i)}var Us=null,mg=!1,I_=!1;function BE(e){Us===null?Us=[e]:Us.push(e)}function ZM(e){mg=!0,BE(e)}function il(){if(!I_&&Us!==null){I_=!0;var e=0,t=zr;try{var i=Us;for(zr=1;e<i.length;e++){var u=i[e];do u=u(!0);while(u!==null)}Us=null,mg=!1}catch(d){throw Us!==null&&(Us=Us.slice(e+1)),uE(jv,il),d}finally{zr=t,I_=!1}}return null}var hc=[],dc=0,Dm=null,Rm=0,zo=[],Do=0,Jl=null,Vs=1,Hs="";function Dl(e,t){hc[dc++]=Rm,hc[dc++]=Dm,Dm=e,Rm=t}function NE(e,t,i){zo[Do++]=Vs,zo[Do++]=Hs,zo[Do++]=Jl,Jl=e;var u=Vs;e=Hs;var d=32-Yo(u)-1;u&=~(1<<d),i+=1;var g=32-Yo(t)+d;if(30<g){var y=d-d%5;g=(u&(1<<y)-1).toString(32),u>>=y,d-=y,Vs=1<<32-Yo(t)+d|i<<d|u,Hs=g+e}else Vs=1<<g|i<<d|u,Hs=e}function Kv(e){e.return!==null&&(Dl(e,1),NE(e,1,0))}function Yv(e){for(;e===Dm;)Dm=hc[--dc],hc[dc]=null,Rm=hc[--dc],hc[dc]=null;for(;e===Jl;)Jl=zo[--Do],zo[Do]=null,Hs=zo[--Do],zo[Do]=null,Vs=zo[--Do],zo[Do]=null}var xo=null,vo=null,rn=!1,Ko=null;function $E(e,t){var i=Ro(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function xb(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xo=e,vo=Xa(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xo=e,vo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=Jl!==null?{id:Vs,overflow:Hs}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Ro(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,xo=e,vo=null,!0):!1;default:return!1}}function M0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function z0(e){if(rn){var t=vo;if(t){var i=t;if(!xb(e,t)){if(M0(e))throw Error(lt(418));t=Xa(i.nextSibling);var u=xo;t&&xb(e,t)?$E(u,i):(e.flags=e.flags&-4097|2,rn=!1,xo=e)}}else{if(M0(e))throw Error(lt(418));e.flags=e.flags&-4097|2,rn=!1,xo=e}}}function wb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xo=e}function zf(e){if(e!==xo)return!1;if(!rn)return wb(e),rn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!C0(e.type,e.memoizedProps)),t&&(t=vo)){if(M0(e))throw jE(),Error(lt(418));for(;t;)$E(e,t),t=Xa(t.nextSibling)}if(wb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(lt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){vo=Xa(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}vo=null}}else vo=xo?Xa(e.stateNode.nextSibling):null;return!0}function jE(){for(var e=vo;e;)e=Xa(e.nextSibling)}function Cc(){vo=xo=null,rn=!1}function Jv(e){Ko===null?Ko=[e]:Ko.push(e)}var WM=Js.ReactCurrentBatchConfig;function ad(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(lt(309));var u=i.stateNode}if(!u)throw Error(lt(147,e));var d=u,g=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===g?t.ref:(t=function(y){var c=d.refs;y===null?delete c[g]:c[g]=y},t._stringRef=g,t)}if(typeof e!="string")throw Error(lt(284));if(!i._owner)throw Error(lt(290,e))}return e}function Df(e,t){throw e=Object.prototype.toString.call(t),Error(lt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bb(e){var t=e._init;return t(e._payload)}function UE(e){function t(F,$){if(e){var q=F.deletions;q===null?(F.deletions=[$],F.flags|=16):q.push($)}}function i(F,$){if(!e)return null;for(;$!==null;)t(F,$),$=$.sibling;return null}function u(F,$){for(F=new Map;$!==null;)$.key!==null?F.set($.key,$):F.set($.index,$),$=$.sibling;return F}function d(F,$){return F=Qa(F,$),F.index=0,F.sibling=null,F}function g(F,$,q){return F.index=q,e?(q=F.alternate,q!==null?(q=q.index,q<$?(F.flags|=2,$):q):(F.flags|=2,$)):(F.flags|=1048576,$)}function y(F){return e&&F.alternate===null&&(F.flags|=2),F}function c(F,$,q,ne){return $===null||$.tag!==6?($=L_(q,F.mode,ne),$.return=F,$):($=d($,q),$.return=F,$)}function T(F,$,q,ne){var se=q.type;return se===oc?R(F,$,q.props.children,ne,q.key):$!==null&&($.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===Oa&&bb(se)===$.type)?(ne=d($,q.props),ne.ref=ad(F,$,q),ne.return=F,ne):(ne=om(q.type,q.key,q.props,null,F.mode,ne),ne.ref=ad(F,$,q),ne.return=F,ne)}function P(F,$,q,ne){return $===null||$.tag!==4||$.stateNode.containerInfo!==q.containerInfo||$.stateNode.implementation!==q.implementation?($=F_(q,F.mode,ne),$.return=F,$):($=d($,q.children||[]),$.return=F,$)}function R(F,$,q,ne,se){return $===null||$.tag!==7?($=Zl(q,F.mode,ne,se),$.return=F,$):($=d($,q),$.return=F,$)}function D(F,$,q){if(typeof $=="string"&&$!==""||typeof $=="number")return $=L_(""+$,F.mode,q),$.return=F,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case bf:return q=om($.type,$.key,$.props,null,F.mode,q),q.ref=ad(F,null,$),q.return=F,q;case ic:return $=F_($,F.mode,q),$.return=F,$;case Oa:var ne=$._init;return D(F,ne($._payload),q)}if(dd($)||rd($))return $=Zl($,F.mode,q,null),$.return=F,$;Df(F,$)}return null}function A(F,$,q,ne){var se=$!==null?$.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return se!==null?null:c(F,$,""+q,ne);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case bf:return q.key===se?T(F,$,q,ne):null;case ic:return q.key===se?P(F,$,q,ne):null;case Oa:return se=q._init,A(F,$,se(q._payload),ne)}if(dd(q)||rd(q))return se!==null?null:R(F,$,q,ne,null);Df(F,q)}return null}function N(F,$,q,ne,se){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return F=F.get(q)||null,c($,F,""+ne,se);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case bf:return F=F.get(ne.key===null?q:ne.key)||null,T($,F,ne,se);case ic:return F=F.get(ne.key===null?q:ne.key)||null,P($,F,ne,se);case Oa:var Ee=ne._init;return N(F,$,q,Ee(ne._payload),se)}if(dd(ne)||rd(ne))return F=F.get(q)||null,R($,F,ne,se,null);Df($,ne)}return null}function X(F,$,q,ne){for(var se=null,Ee=null,ge=$,Oe=$=0,Fe=null;ge!==null&&Oe<q.length;Oe++){ge.index>Oe?(Fe=ge,ge=null):Fe=ge.sibling;var Ge=A(F,ge,q[Oe],ne);if(Ge===null){ge===null&&(ge=Fe);break}e&&ge&&Ge.alternate===null&&t(F,ge),$=g(Ge,$,Oe),Ee===null?se=Ge:Ee.sibling=Ge,Ee=Ge,ge=Fe}if(Oe===q.length)return i(F,ge),rn&&Dl(F,Oe),se;if(ge===null){for(;Oe<q.length;Oe++)ge=D(F,q[Oe],ne),ge!==null&&($=g(ge,$,Oe),Ee===null?se=ge:Ee.sibling=ge,Ee=ge);return rn&&Dl(F,Oe),se}for(ge=u(F,ge);Oe<q.length;Oe++)Fe=N(ge,F,Oe,q[Oe],ne),Fe!==null&&(e&&Fe.alternate!==null&&ge.delete(Fe.key===null?Oe:Fe.key),$=g(Fe,$,Oe),Ee===null?se=Fe:Ee.sibling=Fe,Ee=Fe);return e&&ge.forEach(function(it){return t(F,it)}),rn&&Dl(F,Oe),se}function U(F,$,q,ne){var se=rd(q);if(typeof se!="function")throw Error(lt(150));if(q=se.call(q),q==null)throw Error(lt(151));for(var Ee=se=null,ge=$,Oe=$=0,Fe=null,Ge=q.next();ge!==null&&!Ge.done;Oe++,Ge=q.next()){ge.index>Oe?(Fe=ge,ge=null):Fe=ge.sibling;var it=A(F,ge,Ge.value,ne);if(it===null){ge===null&&(ge=Fe);break}e&&ge&&it.alternate===null&&t(F,ge),$=g(it,$,Oe),Ee===null?se=it:Ee.sibling=it,Ee=it,ge=Fe}if(Ge.done)return i(F,ge),rn&&Dl(F,Oe),se;if(ge===null){for(;!Ge.done;Oe++,Ge=q.next())Ge=D(F,Ge.value,ne),Ge!==null&&($=g(Ge,$,Oe),Ee===null?se=Ge:Ee.sibling=Ge,Ee=Ge);return rn&&Dl(F,Oe),se}for(ge=u(F,ge);!Ge.done;Oe++,Ge=q.next())Ge=N(ge,F,Oe,Ge.value,ne),Ge!==null&&(e&&Ge.alternate!==null&&ge.delete(Ge.key===null?Oe:Ge.key),$=g(Ge,$,Oe),Ee===null?se=Ge:Ee.sibling=Ge,Ee=Ge);return e&&ge.forEach(function(ve){return t(F,ve)}),rn&&Dl(F,Oe),se}function te(F,$,q,ne){if(typeof q=="object"&&q!==null&&q.type===oc&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case bf:e:{for(var se=q.key,Ee=$;Ee!==null;){if(Ee.key===se){if(se=q.type,se===oc){if(Ee.tag===7){i(F,Ee.sibling),$=d(Ee,q.props.children),$.return=F,F=$;break e}}else if(Ee.elementType===se||typeof se=="object"&&se!==null&&se.$$typeof===Oa&&bb(se)===Ee.type){i(F,Ee.sibling),$=d(Ee,q.props),$.ref=ad(F,Ee,q),$.return=F,F=$;break e}i(F,Ee);break}else t(F,Ee);Ee=Ee.sibling}q.type===oc?($=Zl(q.props.children,F.mode,ne,q.key),$.return=F,F=$):(ne=om(q.type,q.key,q.props,null,F.mode,ne),ne.ref=ad(F,$,q),ne.return=F,F=ne)}return y(F);case ic:e:{for(Ee=q.key;$!==null;){if($.key===Ee)if($.tag===4&&$.stateNode.containerInfo===q.containerInfo&&$.stateNode.implementation===q.implementation){i(F,$.sibling),$=d($,q.children||[]),$.return=F,F=$;break e}else{i(F,$);break}else t(F,$);$=$.sibling}$=F_(q,F.mode,ne),$.return=F,F=$}return y(F);case Oa:return Ee=q._init,te(F,$,Ee(q._payload),ne)}if(dd(q))return X(F,$,q,ne);if(rd(q))return U(F,$,q,ne);Df(F,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,$!==null&&$.tag===6?(i(F,$.sibling),$=d($,q),$.return=F,F=$):(i(F,$),$=L_(q,F.mode,ne),$.return=F,F=$),y(F)):i(F,$)}return te}var Ic=UE(!0),VE=UE(!1),Lm=nl(null),Fm=null,pc=null,Qv=null;function e1(){Qv=pc=Fm=null}function t1(e){var t=Lm.current;Jr(Lm),e._currentValue=t}function D0(e,t,i){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===i)break;e=e.return}}function bc(e,t){Fm=e,Qv=pc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gi=!0),e.firstContext=null)}function Fo(e){var t=e._currentValue;if(Qv!==e)if(e={context:e,memoizedValue:t,next:null},pc===null){if(Fm===null)throw Error(lt(308));pc=e,Fm.dependencies={lanes:0,firstContext:e}}else pc=pc.next=e;return t}var $l=null;function r1(e){$l===null?$l=[e]:$l.push(e)}function HE(e,t,i,u){var d=t.interleaved;return d===null?(i.next=i,r1(t)):(i.next=d.next,d.next=i),t.interleaved=i,qs(e,u)}function qs(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Ba=!1;function n1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ka(e,t,i){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,br&2){var d=u.pending;return d===null?t.next=t:(t.next=d.next,d.next=t),u.pending=t,qs(e,i)}return d=u.interleaved,d===null?(t.next=t,r1(u)):(t.next=d.next,d.next=t),u.interleaved=t,qs(e,i)}function Qf(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,Uv(e,i)}}function Sb(e,t){var i=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,i===u)){var d=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var y={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};g===null?d=g=y:g=g.next=y,i=i.next}while(i!==null);g===null?d=g=t:g=g.next=t}else d=g=t;i={baseState:u.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:u.shared,effects:u.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Om(e,t,i,u){var d=e.updateQueue;Ba=!1;var g=d.firstBaseUpdate,y=d.lastBaseUpdate,c=d.shared.pending;if(c!==null){d.shared.pending=null;var T=c,P=T.next;T.next=null,y===null?g=P:y.next=P,y=T;var R=e.alternate;R!==null&&(R=R.updateQueue,c=R.lastBaseUpdate,c!==y&&(c===null?R.firstBaseUpdate=P:c.next=P,R.lastBaseUpdate=T))}if(g!==null){var D=d.baseState;y=0,R=P=T=null,c=g;do{var A=c.lane,N=c.eventTime;if((u&A)===A){R!==null&&(R=R.next={eventTime:N,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var X=e,U=c;switch(A=t,N=i,U.tag){case 1:if(X=U.payload,typeof X=="function"){D=X.call(N,D,A);break e}D=X;break e;case 3:X.flags=X.flags&-65537|128;case 0:if(X=U.payload,A=typeof X=="function"?X.call(N,D,A):X,A==null)break e;D=hn({},D,A);break e;case 2:Ba=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,A=d.effects,A===null?d.effects=[c]:A.push(c))}else N={eventTime:N,lane:A,tag:c.tag,payload:c.payload,callback:c.callback,next:null},R===null?(P=R=N,T=D):R=R.next=N,y|=A;if(c=c.next,c===null){if(c=d.shared.pending,c===null)break;A=c,c=A.next,A.next=null,d.lastBaseUpdate=A,d.shared.pending=null}}while(!0);if(R===null&&(T=D),d.baseState=T,d.firstBaseUpdate=P,d.lastBaseUpdate=R,t=d.shared.interleaved,t!==null){d=t;do y|=d.lane,d=d.next;while(d!==t)}else g===null&&(d.shared.lanes=0);eu|=y,e.lanes=y,e.memoizedState=D}}function Eb(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var u=e[t],d=u.callback;if(d!==null){if(u.callback=null,u=i,typeof d!="function")throw Error(lt(191,d));d.call(u)}}}var up={},xs=nl(up),Gd=nl(up),Zd=nl(up);function jl(e){if(e===up)throw Error(lt(174));return e}function i1(e,t){switch(Hr(Zd,t),Hr(Gd,e),Hr(xs,up),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:p0(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=p0(t,e)}Jr(xs),Hr(xs,t)}function Pc(){Jr(xs),Jr(Gd),Jr(Zd)}function ZE(e){jl(Zd.current);var t=jl(xs.current),i=p0(t,e.type);t!==i&&(Hr(Gd,e),Hr(xs,i))}function o1(e){Gd.current===e&&(Jr(xs),Jr(Gd))}var un=nl(0);function Bm(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var P_=[];function s1(){for(var e=0;e<P_.length;e++)P_[e]._workInProgressVersionPrimary=null;P_.length=0}var em=Js.ReactCurrentDispatcher,A_=Js.ReactCurrentBatchConfig,Ql=0,cn=null,Cn=null,Bn=null,Nm=!1,kd=!1,Wd=0,qM=0;function ui(){throw Error(lt(321))}function a1(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!ts(e[i],t[i]))return!1;return!0}function l1(e,t,i,u,d,g){if(Ql=g,cn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,em.current=e===null||e.memoizedState===null?JM:QM,e=i(u,d),kd){g=0;do{if(kd=!1,Wd=0,25<=g)throw Error(lt(301));g+=1,Bn=Cn=null,t.updateQueue=null,em.current=e3,e=i(u,d)}while(kd)}if(em.current=$m,t=Cn!==null&&Cn.next!==null,Ql=0,Bn=Cn=cn=null,Nm=!1,t)throw Error(lt(300));return e}function u1(){var e=Wd!==0;return Wd=0,e}function gs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?cn.memoizedState=Bn=e:Bn=Bn.next=e,Bn}function Oo(){if(Cn===null){var e=cn.alternate;e=e!==null?e.memoizedState:null}else e=Cn.next;var t=Bn===null?cn.memoizedState:Bn.next;if(t!==null)Bn=t,Cn=e;else{if(e===null)throw Error(lt(310));Cn=e,e={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},Bn===null?cn.memoizedState=Bn=e:Bn=Bn.next=e}return Bn}function qd(e,t){return typeof t=="function"?t(e):t}function M_(e){var t=Oo(),i=t.queue;if(i===null)throw Error(lt(311));i.lastRenderedReducer=e;var u=Cn,d=u.baseQueue,g=i.pending;if(g!==null){if(d!==null){var y=d.next;d.next=g.next,g.next=y}u.baseQueue=d=g,i.pending=null}if(d!==null){g=d.next,u=u.baseState;var c=y=null,T=null,P=g;do{var R=P.lane;if((Ql&R)===R)T!==null&&(T=T.next={lane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),u=P.hasEagerState?P.eagerState:e(u,P.action);else{var D={lane:R,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null};T===null?(c=T=D,y=u):T=T.next=D,cn.lanes|=R,eu|=R}P=P.next}while(P!==null&&P!==g);T===null?y=u:T.next=c,ts(u,t.memoizedState)||(Gi=!0),t.memoizedState=u,t.baseState=y,t.baseQueue=T,i.lastRenderedState=u}if(e=i.interleaved,e!==null){d=e;do g=d.lane,cn.lanes|=g,eu|=g,d=d.next;while(d!==e)}else d===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function z_(e){var t=Oo(),i=t.queue;if(i===null)throw Error(lt(311));i.lastRenderedReducer=e;var u=i.dispatch,d=i.pending,g=t.memoizedState;if(d!==null){i.pending=null;var y=d=d.next;do g=e(g,y.action),y=y.next;while(y!==d);ts(g,t.memoizedState)||(Gi=!0),t.memoizedState=g,t.baseQueue===null&&(t.baseState=g),i.lastRenderedState=g}return[g,u]}function WE(){}function qE(e,t){var i=cn,u=Oo(),d=t(),g=!ts(u.memoizedState,d);if(g&&(u.memoizedState=d,Gi=!0),u=u.queue,c1(YE.bind(null,i,u,e),[e]),u.getSnapshot!==t||g||Bn!==null&&Bn.memoizedState.tag&1){if(i.flags|=2048,Xd(9,KE.bind(null,i,u,d,t),void 0,null),$n===null)throw Error(lt(349));Ql&30||XE(i,t,d)}return d}function XE(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=cn.updateQueue,t===null?(t={lastEffect:null,stores:null},cn.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function KE(e,t,i,u){t.value=i,t.getSnapshot=u,JE(t)&&QE(e)}function YE(e,t,i){return i(function(){JE(t)&&QE(e)})}function JE(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!ts(e,i)}catch{return!0}}function QE(e){var t=qs(e,1);t!==null&&Jo(t,e,1,-1)}function kb(e){var t=gs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qd,lastRenderedState:e},t.queue=e,e=e.dispatch=YM.bind(null,cn,e),[t.memoizedState,e]}function Xd(e,t,i,u){return e={tag:e,create:t,destroy:i,deps:u,next:null},t=cn.updateQueue,t===null?(t={lastEffect:null,stores:null},cn.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(u=i.next,i.next=e,e.next=u,t.lastEffect=e)),e}function ek(){return Oo().memoizedState}function tm(e,t,i,u){var d=gs();cn.flags|=e,d.memoizedState=Xd(1|t,i,void 0,u===void 0?null:u)}function gg(e,t,i,u){var d=Oo();u=u===void 0?null:u;var g=void 0;if(Cn!==null){var y=Cn.memoizedState;if(g=y.destroy,u!==null&&a1(u,y.deps)){d.memoizedState=Xd(t,i,g,u);return}}cn.flags|=e,d.memoizedState=Xd(1|t,i,g,u)}function Tb(e,t){return tm(8390656,8,e,t)}function c1(e,t){return gg(2048,8,e,t)}function tk(e,t){return gg(4,2,e,t)}function rk(e,t){return gg(4,4,e,t)}function nk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ik(e,t,i){return i=i!=null?i.concat([e]):null,gg(4,4,nk.bind(null,t,e),i)}function h1(){}function ok(e,t){var i=Oo();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&a1(t,u[1])?u[0]:(i.memoizedState=[e,t],e)}function sk(e,t){var i=Oo();t=t===void 0?null:t;var u=i.memoizedState;return u!==null&&t!==null&&a1(t,u[1])?u[0]:(e=e(),i.memoizedState=[e,t],e)}function ak(e,t,i){return Ql&21?(ts(i,t)||(i=dE(),cn.lanes|=i,eu|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gi=!0),e.memoizedState=i)}function XM(e,t){var i=zr;zr=i!==0&&4>i?i:4,e(!0);var u=A_.transition;A_.transition={};try{e(!1),t()}finally{zr=i,A_.transition=u}}function lk(){return Oo().memoizedState}function KM(e,t,i){var u=Ja(e);if(i={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null},uk(e))ck(t,i);else if(i=HE(e,t,i,u),i!==null){var d=Ii();Jo(i,e,u,d),hk(i,t,u)}}function YM(e,t,i){var u=Ja(e),d={lane:u,action:i,hasEagerState:!1,eagerState:null,next:null};if(uk(e))ck(t,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=t.lastRenderedReducer,g!==null))try{var y=t.lastRenderedState,c=g(y,i);if(d.hasEagerState=!0,d.eagerState=c,ts(c,y)){var T=t.interleaved;T===null?(d.next=d,r1(t)):(d.next=T.next,T.next=d),t.interleaved=d;return}}catch{}finally{}i=HE(e,t,d,u),i!==null&&(d=Ii(),Jo(i,e,u,d),hk(i,t,u))}}function uk(e){var t=e.alternate;return e===cn||t!==null&&t===cn}function ck(e,t){kd=Nm=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function hk(e,t,i){if(i&4194240){var u=t.lanes;u&=e.pendingLanes,i|=u,t.lanes=i,Uv(e,i)}}var $m={readContext:Fo,useCallback:ui,useContext:ui,useEffect:ui,useImperativeHandle:ui,useInsertionEffect:ui,useLayoutEffect:ui,useMemo:ui,useReducer:ui,useRef:ui,useState:ui,useDebugValue:ui,useDeferredValue:ui,useTransition:ui,useMutableSource:ui,useSyncExternalStore:ui,useId:ui,unstable_isNewReconciler:!1},JM={readContext:Fo,useCallback:function(e,t){return gs().memoizedState=[e,t===void 0?null:t],e},useContext:Fo,useEffect:Tb,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,tm(4194308,4,nk.bind(null,t,e),i)},useLayoutEffect:function(e,t){return tm(4194308,4,e,t)},useInsertionEffect:function(e,t){return tm(4,2,e,t)},useMemo:function(e,t){var i=gs();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var u=gs();return t=i!==void 0?i(t):t,u.memoizedState=u.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},u.queue=e,e=e.dispatch=KM.bind(null,cn,e),[u.memoizedState,e]},useRef:function(e){var t=gs();return e={current:e},t.memoizedState=e},useState:kb,useDebugValue:h1,useDeferredValue:function(e){return gs().memoizedState=e},useTransition:function(){var e=kb(!1),t=e[0];return e=XM.bind(null,e[1]),gs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var u=cn,d=gs();if(rn){if(i===void 0)throw Error(lt(407));i=i()}else{if(i=t(),$n===null)throw Error(lt(349));Ql&30||XE(u,t,i)}d.memoizedState=i;var g={value:i,getSnapshot:t};return d.queue=g,Tb(YE.bind(null,u,g,e),[e]),u.flags|=2048,Xd(9,KE.bind(null,u,g,i,t),void 0,null),i},useId:function(){var e=gs(),t=$n.identifierPrefix;if(rn){var i=Hs,u=Vs;i=(u&~(1<<32-Yo(u)-1)).toString(32)+i,t=":"+t+"R"+i,i=Wd++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=qM++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},QM={readContext:Fo,useCallback:ok,useContext:Fo,useEffect:c1,useImperativeHandle:ik,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:sk,useReducer:M_,useRef:ek,useState:function(){return M_(qd)},useDebugValue:h1,useDeferredValue:function(e){var t=Oo();return ak(t,Cn.memoizedState,e)},useTransition:function(){var e=M_(qd)[0],t=Oo().memoizedState;return[e,t]},useMutableSource:WE,useSyncExternalStore:qE,useId:lk,unstable_isNewReconciler:!1},e3={readContext:Fo,useCallback:ok,useContext:Fo,useEffect:c1,useImperativeHandle:ik,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:sk,useReducer:z_,useRef:ek,useState:function(){return z_(qd)},useDebugValue:h1,useDeferredValue:function(e){var t=Oo();return Cn===null?t.memoizedState=e:ak(t,Cn.memoizedState,e)},useTransition:function(){var e=z_(qd)[0],t=Oo().memoizedState;return[e,t]},useMutableSource:WE,useSyncExternalStore:qE,useId:lk,unstable_isNewReconciler:!1};function Wo(e,t){if(e&&e.defaultProps){t=hn({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function R0(e,t,i,u){t=e.memoizedState,i=i(u,t),i=i==null?t:hn({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var yg={isMounted:function(e){return(e=e._reactInternals)?ou(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var u=Ii(),d=Ja(e),g=Gs(u,d);g.payload=t,i!=null&&(g.callback=i),t=Ka(e,g,d),t!==null&&(Jo(t,e,d,u),Qf(t,e,d))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var u=Ii(),d=Ja(e),g=Gs(u,d);g.tag=1,g.payload=t,i!=null&&(g.callback=i),t=Ka(e,g,d),t!==null&&(Jo(t,e,d,u),Qf(t,e,d))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Ii(),u=Ja(e),d=Gs(i,u);d.tag=2,t!=null&&(d.callback=t),t=Ka(e,d,u),t!==null&&(Jo(t,e,u,i),Qf(t,e,u))}};function Cb(e,t,i,u,d,g,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,g,y):t.prototype&&t.prototype.isPureReactComponent?!jd(i,u)||!jd(d,g):!0}function dk(e,t,i){var u=!1,d=tl,g=t.contextType;return typeof g=="object"&&g!==null?g=Fo(g):(d=qi(t)?Yl:pi.current,u=t.contextTypes,g=(u=u!=null)?Tc(e,d):tl),t=new t(i,g),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=yg,e.stateNode=t,t._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=g),t}function Ib(e,t,i,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,u),t.state!==e&&yg.enqueueReplaceState(t,t.state,null)}function L0(e,t,i,u){var d=e.stateNode;d.props=i,d.state=e.memoizedState,d.refs={},n1(e);var g=t.contextType;typeof g=="object"&&g!==null?d.context=Fo(g):(g=qi(t)?Yl:pi.current,d.context=Tc(e,g)),d.state=e.memoizedState,g=t.getDerivedStateFromProps,typeof g=="function"&&(R0(e,t,g,i),d.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(t=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),t!==d.state&&yg.enqueueReplaceState(d,d.state,null),Om(e,i,d,u),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Ac(e,t){try{var i="",u=t;do i+=IA(u),u=u.return;while(u);var d=i}catch(g){d=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:t,stack:d,digest:null}}function D_(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function F0(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var t3=typeof WeakMap=="function"?WeakMap:Map;function pk(e,t,i){i=Gs(-1,i),i.tag=3,i.payload={element:null};var u=t.value;return i.callback=function(){Um||(Um=!0,Z0=u),F0(e,t)},i}function fk(e,t,i){i=Gs(-1,i),i.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var d=t.value;i.payload=function(){return u(d)},i.callback=function(){F0(e,t)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(i.callback=function(){F0(e,t),typeof u!="function"&&(Ya===null?Ya=new Set([this]):Ya.add(this));var y=t.stack;this.componentDidCatch(t.value,{componentStack:y!==null?y:""})}),i}function Pb(e,t,i){var u=e.pingCache;if(u===null){u=e.pingCache=new t3;var d=new Set;u.set(t,d)}else d=u.get(t),d===void 0&&(d=new Set,u.set(t,d));d.has(i)||(d.add(i),e=m3.bind(null,e,t,i),t.then(e,e))}function Ab(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Mb(e,t,i,u,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=Gs(-1,1),t.tag=2,Ka(i,t,1))),i.lanes|=1),e)}var r3=Js.ReactCurrentOwner,Gi=!1;function Si(e,t,i,u){t.child=e===null?VE(t,null,i,u):Ic(t,e.child,i,u)}function zb(e,t,i,u,d){i=i.render;var g=t.ref;return bc(t,d),u=l1(e,t,i,u,g,d),i=u1(),e!==null&&!Gi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~d,Xs(e,t,d)):(rn&&i&&Kv(t),t.flags|=1,Si(e,t,u,d),t.child)}function Db(e,t,i,u,d){if(e===null){var g=i.type;return typeof g=="function"&&!v1(g)&&g.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=g,mk(e,t,g,u,d)):(e=om(i.type,null,u,t,t.mode,d),e.ref=t.ref,e.return=t,t.child=e)}if(g=e.child,!(e.lanes&d)){var y=g.memoizedProps;if(i=i.compare,i=i!==null?i:jd,i(y,u)&&e.ref===t.ref)return Xs(e,t,d)}return t.flags|=1,e=Qa(g,u),e.ref=t.ref,e.return=t,t.child=e}function mk(e,t,i,u,d){if(e!==null){var g=e.memoizedProps;if(jd(g,u)&&e.ref===t.ref)if(Gi=!1,t.pendingProps=u=g,(e.lanes&d)!==0)e.flags&131072&&(Gi=!0);else return t.lanes=e.lanes,Xs(e,t,d)}return O0(e,t,i,u,d)}function gk(e,t,i){var u=t.pendingProps,d=u.children,g=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hr(mc,fo),fo|=i;else{if(!(i&1073741824))return e=g!==null?g.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Hr(mc,fo),fo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=g!==null?g.baseLanes:i,Hr(mc,fo),fo|=u}else g!==null?(u=g.baseLanes|i,t.memoizedState=null):u=i,Hr(mc,fo),fo|=u;return Si(e,t,d,i),t.child}function yk(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function O0(e,t,i,u,d){var g=qi(i)?Yl:pi.current;return g=Tc(t,g),bc(t,d),i=l1(e,t,i,u,g,d),u=u1(),e!==null&&!Gi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~d,Xs(e,t,d)):(rn&&u&&Kv(t),t.flags|=1,Si(e,t,i,d),t.child)}function Rb(e,t,i,u,d){if(qi(i)){var g=!0;zm(t)}else g=!1;if(bc(t,d),t.stateNode===null)rm(e,t),dk(t,i,u),L0(t,i,u,d),u=!0;else if(e===null){var y=t.stateNode,c=t.memoizedProps;y.props=c;var T=y.context,P=i.contextType;typeof P=="object"&&P!==null?P=Fo(P):(P=qi(i)?Yl:pi.current,P=Tc(t,P));var R=i.getDerivedStateFromProps,D=typeof R=="function"||typeof y.getSnapshotBeforeUpdate=="function";D||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(c!==u||T!==P)&&Ib(t,y,u,P),Ba=!1;var A=t.memoizedState;y.state=A,Om(t,u,y,d),T=t.memoizedState,c!==u||A!==T||Wi.current||Ba?(typeof R=="function"&&(R0(t,i,R,u),T=t.memoizedState),(c=Ba||Cb(t,i,c,u,A,T,P))?(D||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(t.flags|=4194308)):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=T),y.props=u,y.state=T,y.context=P,u=c):(typeof y.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{y=t.stateNode,GE(e,t),c=t.memoizedProps,P=t.type===t.elementType?c:Wo(t.type,c),y.props=P,D=t.pendingProps,A=y.context,T=i.contextType,typeof T=="object"&&T!==null?T=Fo(T):(T=qi(i)?Yl:pi.current,T=Tc(t,T));var N=i.getDerivedStateFromProps;(R=typeof N=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(c!==D||A!==T)&&Ib(t,y,u,T),Ba=!1,A=t.memoizedState,y.state=A,Om(t,u,y,d);var X=t.memoizedState;c!==D||A!==X||Wi.current||Ba?(typeof N=="function"&&(R0(t,i,N,u),X=t.memoizedState),(P=Ba||Cb(t,i,P,u,A,X,T)||!1)?(R||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,X,T),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,X,T)),typeof y.componentDidUpdate=="function"&&(t.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof y.componentDidUpdate!="function"||c===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=X),y.props=u,y.state=X,y.context=T,u=P):(typeof y.componentDidUpdate!="function"||c===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),u=!1)}return B0(e,t,i,u,g,d)}function B0(e,t,i,u,d,g){yk(e,t);var y=(t.flags&128)!==0;if(!u&&!y)return d&&vb(t,i,!1),Xs(e,t,g);u=t.stateNode,r3.current=t;var c=y&&typeof i.getDerivedStateFromError!="function"?null:u.render();return t.flags|=1,e!==null&&y?(t.child=Ic(t,e.child,null,g),t.child=Ic(t,null,c,g)):Si(e,t,c,g),t.memoizedState=u.state,d&&vb(t,i,!0),t.child}function _k(e){var t=e.stateNode;t.pendingContext?_b(e,t.pendingContext,t.pendingContext!==t.context):t.context&&_b(e,t.context,!1),i1(e,t.containerInfo)}function Lb(e,t,i,u,d){return Cc(),Jv(d),t.flags|=256,Si(e,t,i,u),t.child}var N0={dehydrated:null,treeContext:null,retryLane:0};function $0(e){return{baseLanes:e,cachePool:null,transitions:null}}function vk(e,t,i){var u=t.pendingProps,d=un.current,g=!1,y=(t.flags&128)!==0,c;if((c=y)||(c=e!==null&&e.memoizedState===null?!1:(d&2)!==0),c?(g=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),Hr(un,d&1),e===null)return z0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(y=u.children,e=u.fallback,g?(u=t.mode,g=t.child,y={mode:"hidden",children:y},!(u&1)&&g!==null?(g.childLanes=0,g.pendingProps=y):g=xg(y,u,0,null),e=Zl(e,u,i,null),g.return=t,e.return=t,g.sibling=e,t.child=g,t.child.memoizedState=$0(i),t.memoizedState=N0,e):d1(t,y));if(d=e.memoizedState,d!==null&&(c=d.dehydrated,c!==null))return n3(e,t,y,u,c,d,i);if(g){g=u.fallback,y=t.mode,d=e.child,c=d.sibling;var T={mode:"hidden",children:u.children};return!(y&1)&&t.child!==d?(u=t.child,u.childLanes=0,u.pendingProps=T,t.deletions=null):(u=Qa(d,T),u.subtreeFlags=d.subtreeFlags&14680064),c!==null?g=Qa(c,g):(g=Zl(g,y,i,null),g.flags|=2),g.return=t,u.return=t,u.sibling=g,t.child=u,u=g,g=t.child,y=e.child.memoizedState,y=y===null?$0(i):{baseLanes:y.baseLanes|i,cachePool:null,transitions:y.transitions},g.memoizedState=y,g.childLanes=e.childLanes&~i,t.memoizedState=N0,u}return g=e.child,e=g.sibling,u=Qa(g,{mode:"visible",children:u.children}),!(t.mode&1)&&(u.lanes=i),u.return=t,u.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=u,t.memoizedState=null,u}function d1(e,t){return t=xg({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rf(e,t,i,u){return u!==null&&Jv(u),Ic(t,e.child,null,i),e=d1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function n3(e,t,i,u,d,g,y){if(i)return t.flags&256?(t.flags&=-257,u=D_(Error(lt(422))),Rf(e,t,y,u)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(g=u.fallback,d=t.mode,u=xg({mode:"visible",children:u.children},d,0,null),g=Zl(g,d,y,null),g.flags|=2,u.return=t,g.return=t,u.sibling=g,t.child=u,t.mode&1&&Ic(t,e.child,null,y),t.child.memoizedState=$0(y),t.memoizedState=N0,g);if(!(t.mode&1))return Rf(e,t,y,null);if(d.data==="$!"){if(u=d.nextSibling&&d.nextSibling.dataset,u)var c=u.dgst;return u=c,g=Error(lt(419)),u=D_(g,u,void 0),Rf(e,t,y,u)}if(c=(y&e.childLanes)!==0,Gi||c){if(u=$n,u!==null){switch(y&-y){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(u.suspendedLanes|y)?0:d,d!==0&&d!==g.retryLane&&(g.retryLane=d,qs(e,d),Jo(u,e,d,-1))}return _1(),u=D_(Error(lt(421))),Rf(e,t,y,u)}return d.data==="$?"?(t.flags|=128,t.child=e.child,t=g3.bind(null,e),d._reactRetry=t,null):(e=g.treeContext,vo=Xa(d.nextSibling),xo=t,rn=!0,Ko=null,e!==null&&(zo[Do++]=Vs,zo[Do++]=Hs,zo[Do++]=Jl,Vs=e.id,Hs=e.overflow,Jl=t),t=d1(t,u.children),t.flags|=4096,t)}function Fb(e,t,i){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),D0(e.return,t,i)}function R_(e,t,i,u,d){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:i,tailMode:d}:(g.isBackwards=t,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=i,g.tailMode=d)}function xk(e,t,i){var u=t.pendingProps,d=u.revealOrder,g=u.tail;if(Si(e,t,u.children,i),u=un.current,u&2)u=u&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Fb(e,i,t);else if(e.tag===19)Fb(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(Hr(un,u),!(t.mode&1))t.memoizedState=null;else switch(d){case"forwards":for(i=t.child,d=null;i!==null;)e=i.alternate,e!==null&&Bm(e)===null&&(d=i),i=i.sibling;i=d,i===null?(d=t.child,t.child=null):(d=i.sibling,i.sibling=null),R_(t,!1,d,i,g);break;case"backwards":for(i=null,d=t.child,t.child=null;d!==null;){if(e=d.alternate,e!==null&&Bm(e)===null){t.child=d;break}e=d.sibling,d.sibling=i,i=d,d=e}R_(t,!0,i,null,g);break;case"together":R_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xs(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),eu|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(lt(153));if(t.child!==null){for(e=t.child,i=Qa(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=Qa(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function i3(e,t,i){switch(t.tag){case 3:_k(t),Cc();break;case 5:ZE(t);break;case 1:qi(t.type)&&zm(t);break;case 4:i1(t,t.stateNode.containerInfo);break;case 10:var u=t.type._context,d=t.memoizedProps.value;Hr(Lm,u._currentValue),u._currentValue=d;break;case 13:if(u=t.memoizedState,u!==null)return u.dehydrated!==null?(Hr(un,un.current&1),t.flags|=128,null):i&t.child.childLanes?vk(e,t,i):(Hr(un,un.current&1),e=Xs(e,t,i),e!==null?e.sibling:null);Hr(un,un.current&1);break;case 19:if(u=(i&t.childLanes)!==0,e.flags&128){if(u)return xk(e,t,i);t.flags|=128}if(d=t.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Hr(un,un.current),u)break;return null;case 22:case 23:return t.lanes=0,gk(e,t,i)}return Xs(e,t,i)}var wk,j0,bk,Sk;wk=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};j0=function(){};bk=function(e,t,i,u){var d=e.memoizedProps;if(d!==u){e=t.stateNode,jl(xs.current);var g=null;switch(i){case"input":d=u0(e,d),u=u0(e,u),g=[];break;case"select":d=hn({},d,{value:void 0}),u=hn({},u,{value:void 0}),g=[];break;case"textarea":d=d0(e,d),u=d0(e,u),g=[];break;default:typeof d.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=Am)}f0(i,u);var y;i=null;for(P in d)if(!u.hasOwnProperty(P)&&d.hasOwnProperty(P)&&d[P]!=null)if(P==="style"){var c=d[P];for(y in c)c.hasOwnProperty(y)&&(i||(i={}),i[y]="")}else P!=="dangerouslySetInnerHTML"&&P!=="children"&&P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(Rd.hasOwnProperty(P)?g||(g=[]):(g=g||[]).push(P,null));for(P in u){var T=u[P];if(c=d!=null?d[P]:void 0,u.hasOwnProperty(P)&&T!==c&&(T!=null||c!=null))if(P==="style")if(c){for(y in c)!c.hasOwnProperty(y)||T&&T.hasOwnProperty(y)||(i||(i={}),i[y]="");for(y in T)T.hasOwnProperty(y)&&c[y]!==T[y]&&(i||(i={}),i[y]=T[y])}else i||(g||(g=[]),g.push(P,i)),i=T;else P==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,c=c?c.__html:void 0,T!=null&&c!==T&&(g=g||[]).push(P,T)):P==="children"?typeof T!="string"&&typeof T!="number"||(g=g||[]).push(P,""+T):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&(Rd.hasOwnProperty(P)?(T!=null&&P==="onScroll"&&qr("scroll",e),g||c===T||(g=[])):(g=g||[]).push(P,T))}i&&(g=g||[]).push("style",i);var P=g;(t.updateQueue=P)&&(t.flags|=4)}};Sk=function(e,t,i,u){i!==u&&(t.flags|=4)};function ld(e,t){if(!rn)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function ci(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,u=0;if(t)for(var d=e.child;d!==null;)i|=d.lanes|d.childLanes,u|=d.subtreeFlags&14680064,u|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)i|=d.lanes|d.childLanes,u|=d.subtreeFlags,u|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=u,e.childLanes=i,t}function o3(e,t,i){var u=t.pendingProps;switch(Yv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ci(t),null;case 1:return qi(t.type)&&Mm(),ci(t),null;case 3:return u=t.stateNode,Pc(),Jr(Wi),Jr(pi),s1(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(zf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ko!==null&&(X0(Ko),Ko=null))),j0(e,t),ci(t),null;case 5:o1(t);var d=jl(Zd.current);if(i=t.type,e!==null&&t.stateNode!=null)bk(e,t,i,u,d),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!u){if(t.stateNode===null)throw Error(lt(166));return ci(t),null}if(e=jl(xs.current),zf(t)){u=t.stateNode,i=t.type;var g=t.memoizedProps;switch(u[_s]=t,u[Hd]=g,e=(t.mode&1)!==0,i){case"dialog":qr("cancel",u),qr("close",u);break;case"iframe":case"object":case"embed":qr("load",u);break;case"video":case"audio":for(d=0;d<fd.length;d++)qr(fd[d],u);break;case"source":qr("error",u);break;case"img":case"image":case"link":qr("error",u),qr("load",u);break;case"details":qr("toggle",u);break;case"input":Gw(u,g),qr("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!g.multiple},qr("invalid",u);break;case"textarea":Ww(u,g),qr("invalid",u)}f0(i,g),d=null;for(var y in g)if(g.hasOwnProperty(y)){var c=g[y];y==="children"?typeof c=="string"?u.textContent!==c&&(g.suppressHydrationWarning!==!0&&Mf(u.textContent,c,e),d=["children",c]):typeof c=="number"&&u.textContent!==""+c&&(g.suppressHydrationWarning!==!0&&Mf(u.textContent,c,e),d=["children",""+c]):Rd.hasOwnProperty(y)&&c!=null&&y==="onScroll"&&qr("scroll",u)}switch(i){case"input":Sf(u),Zw(u,g,!0);break;case"textarea":Sf(u),qw(u);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(u.onclick=Am)}u=d,t.updateQueue=u,u!==null&&(t.flags|=4)}else{y=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=YS(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=y.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=y.createElement(i,{is:u.is}):(e=y.createElement(i),i==="select"&&(y=e,u.multiple?y.multiple=!0:u.size&&(y.size=u.size))):e=y.createElementNS(e,i),e[_s]=t,e[Hd]=u,wk(e,t,!1,!1),t.stateNode=e;e:{switch(y=m0(i,u),i){case"dialog":qr("cancel",e),qr("close",e),d=u;break;case"iframe":case"object":case"embed":qr("load",e),d=u;break;case"video":case"audio":for(d=0;d<fd.length;d++)qr(fd[d],e);d=u;break;case"source":qr("error",e),d=u;break;case"img":case"image":case"link":qr("error",e),qr("load",e),d=u;break;case"details":qr("toggle",e),d=u;break;case"input":Gw(e,u),d=u0(e,u),qr("invalid",e);break;case"option":d=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},d=hn({},u,{value:void 0}),qr("invalid",e);break;case"textarea":Ww(e,u),d=d0(e,u),qr("invalid",e);break;default:d=u}f0(i,d),c=d;for(g in c)if(c.hasOwnProperty(g)){var T=c[g];g==="style"?eE(e,T):g==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&JS(e,T)):g==="children"?typeof T=="string"?(i!=="textarea"||T!=="")&&Ld(e,T):typeof T=="number"&&Ld(e,""+T):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Rd.hasOwnProperty(g)?T!=null&&g==="onScroll"&&qr("scroll",e):T!=null&&Fv(e,g,T,y))}switch(i){case"input":Sf(e),Zw(e,u,!1);break;case"textarea":Sf(e),qw(e);break;case"option":u.value!=null&&e.setAttribute("value",""+el(u.value));break;case"select":e.multiple=!!u.multiple,g=u.value,g!=null?_c(e,!!u.multiple,g,!1):u.defaultValue!=null&&_c(e,!!u.multiple,u.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Am)}switch(i){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ci(t),null;case 6:if(e&&t.stateNode!=null)Sk(e,t,e.memoizedProps,u);else{if(typeof u!="string"&&t.stateNode===null)throw Error(lt(166));if(i=jl(Zd.current),jl(xs.current),zf(t)){if(u=t.stateNode,i=t.memoizedProps,u[_s]=t,(g=u.nodeValue!==i)&&(e=xo,e!==null))switch(e.tag){case 3:Mf(u.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Mf(u.nodeValue,i,(e.mode&1)!==0)}g&&(t.flags|=4)}else u=(i.nodeType===9?i:i.ownerDocument).createTextNode(u),u[_s]=t,t.stateNode=u}return ci(t),null;case 13:if(Jr(un),u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rn&&vo!==null&&t.mode&1&&!(t.flags&128))jE(),Cc(),t.flags|=98560,g=!1;else if(g=zf(t),u!==null&&u.dehydrated!==null){if(e===null){if(!g)throw Error(lt(318));if(g=t.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(lt(317));g[_s]=t}else Cc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ci(t),g=!1}else Ko!==null&&(X0(Ko),Ko=null),g=!0;if(!g)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(t.child.flags|=8192,t.mode&1&&(e===null||un.current&1?In===0&&(In=3):_1())),t.updateQueue!==null&&(t.flags|=4),ci(t),null);case 4:return Pc(),j0(e,t),e===null&&Ud(t.stateNode.containerInfo),ci(t),null;case 10:return t1(t.type._context),ci(t),null;case 17:return qi(t.type)&&Mm(),ci(t),null;case 19:if(Jr(un),g=t.memoizedState,g===null)return ci(t),null;if(u=(t.flags&128)!==0,y=g.rendering,y===null)if(u)ld(g,!1);else{if(In!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(y=Bm(e),y!==null){for(t.flags|=128,ld(g,!1),u=y.updateQueue,u!==null&&(t.updateQueue=u,t.flags|=4),t.subtreeFlags=0,u=i,i=t.child;i!==null;)g=i,e=u,g.flags&=14680066,y=g.alternate,y===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=y.childLanes,g.lanes=y.lanes,g.child=y.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=y.memoizedProps,g.memoizedState=y.memoizedState,g.updateQueue=y.updateQueue,g.type=y.type,e=y.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Hr(un,un.current&1|2),t.child}e=e.sibling}g.tail!==null&&yn()>Mc&&(t.flags|=128,u=!0,ld(g,!1),t.lanes=4194304)}else{if(!u)if(e=Bm(y),e!==null){if(t.flags|=128,u=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),ld(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!rn)return ci(t),null}else 2*yn()-g.renderingStartTime>Mc&&i!==1073741824&&(t.flags|=128,u=!0,ld(g,!1),t.lanes=4194304);g.isBackwards?(y.sibling=t.child,t.child=y):(i=g.last,i!==null?i.sibling=y:t.child=y,g.last=y)}return g.tail!==null?(t=g.tail,g.rendering=t,g.tail=t.sibling,g.renderingStartTime=yn(),t.sibling=null,i=un.current,Hr(un,u?i&1|2:i&1),t):(ci(t),null);case 22:case 23:return y1(),u=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(t.flags|=8192),u&&t.mode&1?fo&1073741824&&(ci(t),t.subtreeFlags&6&&(t.flags|=8192)):ci(t),null;case 24:return null;case 25:return null}throw Error(lt(156,t.tag))}function s3(e,t){switch(Yv(t),t.tag){case 1:return qi(t.type)&&Mm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Pc(),Jr(Wi),Jr(pi),s1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return o1(t),null;case 13:if(Jr(un),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(lt(340));Cc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Jr(un),null;case 4:return Pc(),null;case 10:return t1(t.type._context),null;case 22:case 23:return y1(),null;case 24:return null;default:return null}}var Lf=!1,di=!1,a3=typeof WeakSet=="function"?WeakSet:Set,zt=null;function fc(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(u){mn(e,t,u)}else i.current=null}function U0(e,t,i){try{i()}catch(u){mn(e,t,u)}}var Ob=!1;function l3(e,t){if(k0=Cm,e=IE(),Xv(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var u=i.getSelection&&i.getSelection();if(u&&u.rangeCount!==0){i=u.anchorNode;var d=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var y=0,c=-1,T=-1,P=0,R=0,D=e,A=null;t:for(;;){for(var N;D!==i||d!==0&&D.nodeType!==3||(c=y+d),D!==g||u!==0&&D.nodeType!==3||(T=y+u),D.nodeType===3&&(y+=D.nodeValue.length),(N=D.firstChild)!==null;)A=D,D=N;for(;;){if(D===e)break t;if(A===i&&++P===d&&(c=y),A===g&&++R===u&&(T=y),(N=D.nextSibling)!==null)break;D=A,A=D.parentNode}D=N}i=c===-1||T===-1?null:{start:c,end:T}}else i=null}i=i||{start:0,end:0}}else i=null;for(T0={focusedElem:e,selectionRange:i},Cm=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){t=zt;try{var X=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(X!==null){var U=X.memoizedProps,te=X.memoizedState,F=t.stateNode,$=F.getSnapshotBeforeUpdate(t.elementType===t.type?U:Wo(t.type,U),te);F.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var q=t.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(ne){mn(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}return X=Ob,Ob=!1,X}function Td(e,t,i){var u=t.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var d=u=u.next;do{if((d.tag&e)===e){var g=d.destroy;d.destroy=void 0,g!==void 0&&U0(t,i,g)}d=d.next}while(d!==u)}}function _g(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var u=i.create;i.destroy=u()}i=i.next}while(i!==t)}}function V0(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function Ek(e){var t=e.alternate;t!==null&&(e.alternate=null,Ek(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_s],delete t[Hd],delete t[P0],delete t[HM],delete t[GM])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kk(e){return e.tag===5||e.tag===3||e.tag===4}function Bb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function H0(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Am));else if(u!==4&&(e=e.child,e!==null))for(H0(e,t,i),e=e.sibling;e!==null;)H0(e,t,i),e=e.sibling}function G0(e,t,i){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(G0(e,t,i),e=e.sibling;e!==null;)G0(e,t,i),e=e.sibling}var Wn=null,Xo=!1;function Da(e,t,i){for(i=i.child;i!==null;)Tk(e,t,i),i=i.sibling}function Tk(e,t,i){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(cg,i)}catch{}switch(i.tag){case 5:di||fc(i,t);case 6:var u=Wn,d=Xo;Wn=null,Da(e,t,i),Wn=u,Xo=d,Wn!==null&&(Xo?(e=Wn,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Wn.removeChild(i.stateNode));break;case 18:Wn!==null&&(Xo?(e=Wn,i=i.stateNode,e.nodeType===8?C_(e.parentNode,i):e.nodeType===1&&C_(e,i),Nd(e)):C_(Wn,i.stateNode));break;case 4:u=Wn,d=Xo,Wn=i.stateNode.containerInfo,Xo=!0,Da(e,t,i),Wn=u,Xo=d;break;case 0:case 11:case 14:case 15:if(!di&&(u=i.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){d=u=u.next;do{var g=d,y=g.destroy;g=g.tag,y!==void 0&&(g&2||g&4)&&U0(i,t,y),d=d.next}while(d!==u)}Da(e,t,i);break;case 1:if(!di&&(fc(i,t),u=i.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=i.memoizedProps,u.state=i.memoizedState,u.componentWillUnmount()}catch(c){mn(i,t,c)}Da(e,t,i);break;case 21:Da(e,t,i);break;case 22:i.mode&1?(di=(u=di)||i.memoizedState!==null,Da(e,t,i),di=u):Da(e,t,i);break;default:Da(e,t,i)}}function Nb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new a3),t.forEach(function(u){var d=y3.bind(null,e,u);i.has(u)||(i.add(u),u.then(d,d))})}}function Zo(e,t){var i=t.deletions;if(i!==null)for(var u=0;u<i.length;u++){var d=i[u];try{var g=e,y=t,c=y;e:for(;c!==null;){switch(c.tag){case 5:Wn=c.stateNode,Xo=!1;break e;case 3:Wn=c.stateNode.containerInfo,Xo=!0;break e;case 4:Wn=c.stateNode.containerInfo,Xo=!0;break e}c=c.return}if(Wn===null)throw Error(lt(160));Tk(g,y,d),Wn=null,Xo=!1;var T=d.alternate;T!==null&&(T.return=null),d.return=null}catch(P){mn(d,t,P)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ck(t,e),t=t.sibling}function Ck(e,t){var i=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Zo(t,e),ds(e),u&4){try{Td(3,e,e.return),_g(3,e)}catch(U){mn(e,e.return,U)}try{Td(5,e,e.return)}catch(U){mn(e,e.return,U)}}break;case 1:Zo(t,e),ds(e),u&512&&i!==null&&fc(i,i.return);break;case 5:if(Zo(t,e),ds(e),u&512&&i!==null&&fc(i,i.return),e.flags&32){var d=e.stateNode;try{Ld(d,"")}catch(U){mn(e,e.return,U)}}if(u&4&&(d=e.stateNode,d!=null)){var g=e.memoizedProps,y=i!==null?i.memoizedProps:g,c=e.type,T=e.updateQueue;if(e.updateQueue=null,T!==null)try{c==="input"&&g.type==="radio"&&g.name!=null&&XS(d,g),m0(c,y);var P=m0(c,g);for(y=0;y<T.length;y+=2){var R=T[y],D=T[y+1];R==="style"?eE(d,D):R==="dangerouslySetInnerHTML"?JS(d,D):R==="children"?Ld(d,D):Fv(d,R,D,P)}switch(c){case"input":c0(d,g);break;case"textarea":KS(d,g);break;case"select":var A=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!g.multiple;var N=g.value;N!=null?_c(d,!!g.multiple,N,!1):A!==!!g.multiple&&(g.defaultValue!=null?_c(d,!!g.multiple,g.defaultValue,!0):_c(d,!!g.multiple,g.multiple?[]:"",!1))}d[Hd]=g}catch(U){mn(e,e.return,U)}}break;case 6:if(Zo(t,e),ds(e),u&4){if(e.stateNode===null)throw Error(lt(162));d=e.stateNode,g=e.memoizedProps;try{d.nodeValue=g}catch(U){mn(e,e.return,U)}}break;case 3:if(Zo(t,e),ds(e),u&4&&i!==null&&i.memoizedState.isDehydrated)try{Nd(t.containerInfo)}catch(U){mn(e,e.return,U)}break;case 4:Zo(t,e),ds(e);break;case 13:Zo(t,e),ds(e),d=e.child,d.flags&8192&&(g=d.memoizedState!==null,d.stateNode.isHidden=g,!g||d.alternate!==null&&d.alternate.memoizedState!==null||(m1=yn())),u&4&&Nb(e);break;case 22:if(R=i!==null&&i.memoizedState!==null,e.mode&1?(di=(P=di)||R,Zo(t,e),di=P):Zo(t,e),ds(e),u&8192){if(P=e.memoizedState!==null,(e.stateNode.isHidden=P)&&!R&&e.mode&1)for(zt=e,R=e.child;R!==null;){for(D=zt=R;zt!==null;){switch(A=zt,N=A.child,A.tag){case 0:case 11:case 14:case 15:Td(4,A,A.return);break;case 1:fc(A,A.return);var X=A.stateNode;if(typeof X.componentWillUnmount=="function"){u=A,i=A.return;try{t=u,X.props=t.memoizedProps,X.state=t.memoizedState,X.componentWillUnmount()}catch(U){mn(u,i,U)}}break;case 5:fc(A,A.return);break;case 22:if(A.memoizedState!==null){jb(D);continue}}N!==null?(N.return=A,zt=N):jb(D)}R=R.sibling}e:for(R=null,D=e;;){if(D.tag===5){if(R===null){R=D;try{d=D.stateNode,P?(g=d.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(c=D.stateNode,T=D.memoizedProps.style,y=T!=null&&T.hasOwnProperty("display")?T.display:null,c.style.display=QS("display",y))}catch(U){mn(e,e.return,U)}}}else if(D.tag===6){if(R===null)try{D.stateNode.nodeValue=P?"":D.memoizedProps}catch(U){mn(e,e.return,U)}}else if((D.tag!==22&&D.tag!==23||D.memoizedState===null||D===e)&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===e)break e;for(;D.sibling===null;){if(D.return===null||D.return===e)break e;R===D&&(R=null),D=D.return}R===D&&(R=null),D.sibling.return=D.return,D=D.sibling}}break;case 19:Zo(t,e),ds(e),u&4&&Nb(e);break;case 21:break;default:Zo(t,e),ds(e)}}function ds(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(kk(i)){var u=i;break e}i=i.return}throw Error(lt(160))}switch(u.tag){case 5:var d=u.stateNode;u.flags&32&&(Ld(d,""),u.flags&=-33);var g=Bb(e);G0(e,g,d);break;case 3:case 4:var y=u.stateNode.containerInfo,c=Bb(e);H0(e,c,y);break;default:throw Error(lt(161))}}catch(T){mn(e,e.return,T)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function u3(e,t,i){zt=e,Ik(e)}function Ik(e,t,i){for(var u=(e.mode&1)!==0;zt!==null;){var d=zt,g=d.child;if(d.tag===22&&u){var y=d.memoizedState!==null||Lf;if(!y){var c=d.alternate,T=c!==null&&c.memoizedState!==null||di;c=Lf;var P=di;if(Lf=y,(di=T)&&!P)for(zt=d;zt!==null;)y=zt,T=y.child,y.tag===22&&y.memoizedState!==null?Ub(d):T!==null?(T.return=y,zt=T):Ub(d);for(;g!==null;)zt=g,Ik(g),g=g.sibling;zt=d,Lf=c,di=P}$b(e)}else d.subtreeFlags&8772&&g!==null?(g.return=d,zt=g):$b(e)}}function $b(e){for(;zt!==null;){var t=zt;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:di||_g(5,t);break;case 1:var u=t.stateNode;if(t.flags&4&&!di)if(i===null)u.componentDidMount();else{var d=t.elementType===t.type?i.memoizedProps:Wo(t.type,i.memoizedProps);u.componentDidUpdate(d,i.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var g=t.updateQueue;g!==null&&Eb(t,g,u);break;case 3:var y=t.updateQueue;if(y!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}Eb(t,y,i)}break;case 5:var c=t.stateNode;if(i===null&&t.flags&4){i=c;var T=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&i.focus();break;case"img":T.src&&(i.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var P=t.alternate;if(P!==null){var R=P.memoizedState;if(R!==null){var D=R.dehydrated;D!==null&&Nd(D)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}di||t.flags&512&&V0(t)}catch(A){mn(t,t.return,A)}}if(t===e){zt=null;break}if(i=t.sibling,i!==null){i.return=t.return,zt=i;break}zt=t.return}}function jb(e){for(;zt!==null;){var t=zt;if(t===e){zt=null;break}var i=t.sibling;if(i!==null){i.return=t.return,zt=i;break}zt=t.return}}function Ub(e){for(;zt!==null;){var t=zt;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{_g(4,t)}catch(T){mn(t,i,T)}break;case 1:var u=t.stateNode;if(typeof u.componentDidMount=="function"){var d=t.return;try{u.componentDidMount()}catch(T){mn(t,d,T)}}var g=t.return;try{V0(t)}catch(T){mn(t,g,T)}break;case 5:var y=t.return;try{V0(t)}catch(T){mn(t,y,T)}}}catch(T){mn(t,t.return,T)}if(t===e){zt=null;break}var c=t.sibling;if(c!==null){c.return=t.return,zt=c;break}zt=t.return}}var c3=Math.ceil,jm=Js.ReactCurrentDispatcher,p1=Js.ReactCurrentOwner,Lo=Js.ReactCurrentBatchConfig,br=0,$n=null,Sn=null,Xn=0,fo=0,mc=nl(0),In=0,Kd=null,eu=0,vg=0,f1=0,Cd=null,Hi=null,m1=0,Mc=1/0,$s=null,Um=!1,Z0=null,Ya=null,Ff=!1,Ua=null,Vm=0,Id=0,W0=null,nm=-1,im=0;function Ii(){return br&6?yn():nm!==-1?nm:nm=yn()}function Ja(e){return e.mode&1?br&2&&Xn!==0?Xn&-Xn:WM.transition!==null?(im===0&&(im=dE()),im):(e=zr,e!==0||(e=window.event,e=e===void 0?16:vE(e.type)),e):1}function Jo(e,t,i,u){if(50<Id)throw Id=0,W0=null,Error(lt(185));sp(e,i,u),(!(br&2)||e!==$n)&&(e===$n&&(!(br&2)&&(vg|=i),In===4&&$a(e,Xn)),Xi(e,u),i===1&&br===0&&!(t.mode&1)&&(Mc=yn()+500,mg&&il()))}function Xi(e,t){var i=e.callbackNode;WA(e,t);var u=Tm(e,e===$n?Xn:0);if(u===0)i!==null&&Yw(i),e.callbackNode=null,e.callbackPriority=0;else if(t=u&-u,e.callbackPriority!==t){if(i!=null&&Yw(i),t===1)e.tag===0?ZM(Vb.bind(null,e)):BE(Vb.bind(null,e)),UM(function(){!(br&6)&&il()}),i=null;else{switch(pE(u)){case 1:i=jv;break;case 4:i=cE;break;case 16:i=km;break;case 536870912:i=hE;break;default:i=km}i=Fk(i,Pk.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function Pk(e,t){if(nm=-1,im=0,br&6)throw Error(lt(327));var i=e.callbackNode;if(Sc()&&e.callbackNode!==i)return null;var u=Tm(e,e===$n?Xn:0);if(u===0)return null;if(u&30||u&e.expiredLanes||t)t=Hm(e,u);else{t=u;var d=br;br|=2;var g=Mk();($n!==e||Xn!==t)&&($s=null,Mc=yn()+500,Gl(e,t));do try{p3();break}catch(c){Ak(e,c)}while(!0);e1(),jm.current=g,br=d,Sn!==null?t=0:($n=null,Xn=0,t=In)}if(t!==0){if(t===2&&(d=x0(e),d!==0&&(u=d,t=q0(e,d))),t===1)throw i=Kd,Gl(e,0),$a(e,u),Xi(e,yn()),i;if(t===6)$a(e,u);else{if(d=e.current.alternate,!(u&30)&&!h3(d)&&(t=Hm(e,u),t===2&&(g=x0(e),g!==0&&(u=g,t=q0(e,g))),t===1))throw i=Kd,Gl(e,0),$a(e,u),Xi(e,yn()),i;switch(e.finishedWork=d,e.finishedLanes=u,t){case 0:case 1:throw Error(lt(345));case 2:Rl(e,Hi,$s);break;case 3:if($a(e,u),(u&130023424)===u&&(t=m1+500-yn(),10<t)){if(Tm(e,0)!==0)break;if(d=e.suspendedLanes,(d&u)!==u){Ii(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=I0(Rl.bind(null,e,Hi,$s),t);break}Rl(e,Hi,$s);break;case 4:if($a(e,u),(u&4194240)===u)break;for(t=e.eventTimes,d=-1;0<u;){var y=31-Yo(u);g=1<<y,y=t[y],y>d&&(d=y),u&=~g}if(u=d,u=yn()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*c3(u/1960))-u,10<u){e.timeoutHandle=I0(Rl.bind(null,e,Hi,$s),u);break}Rl(e,Hi,$s);break;case 5:Rl(e,Hi,$s);break;default:throw Error(lt(329))}}}return Xi(e,yn()),e.callbackNode===i?Pk.bind(null,e):null}function q0(e,t){var i=Cd;return e.current.memoizedState.isDehydrated&&(Gl(e,t).flags|=256),e=Hm(e,t),e!==2&&(t=Hi,Hi=i,t!==null&&X0(t)),e}function X0(e){Hi===null?Hi=e:Hi.push.apply(Hi,e)}function h3(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var u=0;u<i.length;u++){var d=i[u],g=d.getSnapshot;d=d.value;try{if(!ts(g(),d))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $a(e,t){for(t&=~f1,t&=~vg,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Yo(t),u=1<<i;e[i]=-1,t&=~u}}function Vb(e){if(br&6)throw Error(lt(327));Sc();var t=Tm(e,0);if(!(t&1))return Xi(e,yn()),null;var i=Hm(e,t);if(e.tag!==0&&i===2){var u=x0(e);u!==0&&(t=u,i=q0(e,u))}if(i===1)throw i=Kd,Gl(e,0),$a(e,t),Xi(e,yn()),i;if(i===6)throw Error(lt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Rl(e,Hi,$s),Xi(e,yn()),null}function g1(e,t){var i=br;br|=1;try{return e(t)}finally{br=i,br===0&&(Mc=yn()+500,mg&&il())}}function tu(e){Ua!==null&&Ua.tag===0&&!(br&6)&&Sc();var t=br;br|=1;var i=Lo.transition,u=zr;try{if(Lo.transition=null,zr=1,e)return e()}finally{zr=u,Lo.transition=i,br=t,!(br&6)&&il()}}function y1(){fo=mc.current,Jr(mc)}function Gl(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,jM(i)),Sn!==null)for(i=Sn.return;i!==null;){var u=i;switch(Yv(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Mm();break;case 3:Pc(),Jr(Wi),Jr(pi),s1();break;case 5:o1(u);break;case 4:Pc();break;case 13:Jr(un);break;case 19:Jr(un);break;case 10:t1(u.type._context);break;case 22:case 23:y1()}i=i.return}if($n=e,Sn=e=Qa(e.current,null),Xn=fo=t,In=0,Kd=null,f1=vg=eu=0,Hi=Cd=null,$l!==null){for(t=0;t<$l.length;t++)if(i=$l[t],u=i.interleaved,u!==null){i.interleaved=null;var d=u.next,g=i.pending;if(g!==null){var y=g.next;g.next=d,u.next=y}i.pending=u}$l=null}return e}function Ak(e,t){do{var i=Sn;try{if(e1(),em.current=$m,Nm){for(var u=cn.memoizedState;u!==null;){var d=u.queue;d!==null&&(d.pending=null),u=u.next}Nm=!1}if(Ql=0,Bn=Cn=cn=null,kd=!1,Wd=0,p1.current=null,i===null||i.return===null){In=1,Kd=t,Sn=null;break}e:{var g=e,y=i.return,c=i,T=t;if(t=Xn,c.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var P=T,R=c,D=R.tag;if(!(R.mode&1)&&(D===0||D===11||D===15)){var A=R.alternate;A?(R.updateQueue=A.updateQueue,R.memoizedState=A.memoizedState,R.lanes=A.lanes):(R.updateQueue=null,R.memoizedState=null)}var N=Ab(y);if(N!==null){N.flags&=-257,Mb(N,y,c,g,t),N.mode&1&&Pb(g,P,t),t=N,T=P;var X=t.updateQueue;if(X===null){var U=new Set;U.add(T),t.updateQueue=U}else X.add(T);break e}else{if(!(t&1)){Pb(g,P,t),_1();break e}T=Error(lt(426))}}else if(rn&&c.mode&1){var te=Ab(y);if(te!==null){!(te.flags&65536)&&(te.flags|=256),Mb(te,y,c,g,t),Jv(Ac(T,c));break e}}g=T=Ac(T,c),In!==4&&(In=2),Cd===null?Cd=[g]:Cd.push(g),g=y;do{switch(g.tag){case 3:g.flags|=65536,t&=-t,g.lanes|=t;var F=pk(g,T,t);Sb(g,F);break e;case 1:c=T;var $=g.type,q=g.stateNode;if(!(g.flags&128)&&(typeof $.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Ya===null||!Ya.has(q)))){g.flags|=65536,t&=-t,g.lanes|=t;var ne=fk(g,c,t);Sb(g,ne);break e}}g=g.return}while(g!==null)}Dk(i)}catch(se){t=se,Sn===i&&i!==null&&(Sn=i=i.return);continue}break}while(!0)}function Mk(){var e=jm.current;return jm.current=$m,e===null?$m:e}function _1(){(In===0||In===3||In===2)&&(In=4),$n===null||!(eu&268435455)&&!(vg&268435455)||$a($n,Xn)}function Hm(e,t){var i=br;br|=2;var u=Mk();($n!==e||Xn!==t)&&($s=null,Gl(e,t));do try{d3();break}catch(d){Ak(e,d)}while(!0);if(e1(),br=i,jm.current=u,Sn!==null)throw Error(lt(261));return $n=null,Xn=0,In}function d3(){for(;Sn!==null;)zk(Sn)}function p3(){for(;Sn!==null&&!BA();)zk(Sn)}function zk(e){var t=Lk(e.alternate,e,fo);e.memoizedProps=e.pendingProps,t===null?Dk(e):Sn=t,p1.current=null}function Dk(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=s3(i,t),i!==null){i.flags&=32767,Sn=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{In=6,Sn=null;return}}else if(i=o3(i,t,fo),i!==null){Sn=i;return}if(t=t.sibling,t!==null){Sn=t;return}Sn=t=e}while(t!==null);In===0&&(In=5)}function Rl(e,t,i){var u=zr,d=Lo.transition;try{Lo.transition=null,zr=1,f3(e,t,i,u)}finally{Lo.transition=d,zr=u}return null}function f3(e,t,i,u){do Sc();while(Ua!==null);if(br&6)throw Error(lt(327));i=e.finishedWork;var d=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(lt(177));e.callbackNode=null,e.callbackPriority=0;var g=i.lanes|i.childLanes;if(qA(e,g),e===$n&&(Sn=$n=null,Xn=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Ff||(Ff=!0,Fk(km,function(){return Sc(),null})),g=(i.flags&15990)!==0,i.subtreeFlags&15990||g){g=Lo.transition,Lo.transition=null;var y=zr;zr=1;var c=br;br|=4,p1.current=null,l3(e,i),Ck(i,e),RM(T0),Cm=!!k0,T0=k0=null,e.current=i,u3(i),NA(),br=c,zr=y,Lo.transition=g}else e.current=i;if(Ff&&(Ff=!1,Ua=e,Vm=d),g=e.pendingLanes,g===0&&(Ya=null),UA(i.stateNode),Xi(e,yn()),t!==null)for(u=e.onRecoverableError,i=0;i<t.length;i++)d=t[i],u(d.value,{componentStack:d.stack,digest:d.digest});if(Um)throw Um=!1,e=Z0,Z0=null,e;return Vm&1&&e.tag!==0&&Sc(),g=e.pendingLanes,g&1?e===W0?Id++:(Id=0,W0=e):Id=0,il(),null}function Sc(){if(Ua!==null){var e=pE(Vm),t=Lo.transition,i=zr;try{if(Lo.transition=null,zr=16>e?16:e,Ua===null)var u=!1;else{if(e=Ua,Ua=null,Vm=0,br&6)throw Error(lt(331));var d=br;for(br|=4,zt=e.current;zt!==null;){var g=zt,y=g.child;if(zt.flags&16){var c=g.deletions;if(c!==null){for(var T=0;T<c.length;T++){var P=c[T];for(zt=P;zt!==null;){var R=zt;switch(R.tag){case 0:case 11:case 15:Td(8,R,g)}var D=R.child;if(D!==null)D.return=R,zt=D;else for(;zt!==null;){R=zt;var A=R.sibling,N=R.return;if(Ek(R),R===P){zt=null;break}if(A!==null){A.return=N,zt=A;break}zt=N}}}var X=g.alternate;if(X!==null){var U=X.child;if(U!==null){X.child=null;do{var te=U.sibling;U.sibling=null,U=te}while(U!==null)}}zt=g}}if(g.subtreeFlags&2064&&y!==null)y.return=g,zt=y;else e:for(;zt!==null;){if(g=zt,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Td(9,g,g.return)}var F=g.sibling;if(F!==null){F.return=g.return,zt=F;break e}zt=g.return}}var $=e.current;for(zt=$;zt!==null;){y=zt;var q=y.child;if(y.subtreeFlags&2064&&q!==null)q.return=y,zt=q;else e:for(y=$;zt!==null;){if(c=zt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:_g(9,c)}}catch(se){mn(c,c.return,se)}if(c===y){zt=null;break e}var ne=c.sibling;if(ne!==null){ne.return=c.return,zt=ne;break e}zt=c.return}}if(br=d,il(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(cg,e)}catch{}u=!0}return u}finally{zr=i,Lo.transition=t}}return!1}function Hb(e,t,i){t=Ac(i,t),t=pk(e,t,1),e=Ka(e,t,1),t=Ii(),e!==null&&(sp(e,1,t),Xi(e,t))}function mn(e,t,i){if(e.tag===3)Hb(e,e,i);else for(;t!==null;){if(t.tag===3){Hb(t,e,i);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ya===null||!Ya.has(u))){e=Ac(i,e),e=fk(t,e,1),t=Ka(t,e,1),e=Ii(),t!==null&&(sp(t,1,e),Xi(t,e));break}}t=t.return}}function m3(e,t,i){var u=e.pingCache;u!==null&&u.delete(t),t=Ii(),e.pingedLanes|=e.suspendedLanes&i,$n===e&&(Xn&i)===i&&(In===4||In===3&&(Xn&130023424)===Xn&&500>yn()-m1?Gl(e,0):f1|=i),Xi(e,t)}function Rk(e,t){t===0&&(e.mode&1?(t=Tf,Tf<<=1,!(Tf&130023424)&&(Tf=4194304)):t=1);var i=Ii();e=qs(e,t),e!==null&&(sp(e,t,i),Xi(e,i))}function g3(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),Rk(e,i)}function y3(e,t){var i=0;switch(e.tag){case 13:var u=e.stateNode,d=e.memoizedState;d!==null&&(i=d.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(lt(314))}u!==null&&u.delete(t),Rk(e,i)}var Lk;Lk=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wi.current)Gi=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return Gi=!1,i3(e,t,i);Gi=!!(e.flags&131072)}else Gi=!1,rn&&t.flags&1048576&&NE(t,Rm,t.index);switch(t.lanes=0,t.tag){case 2:var u=t.type;rm(e,t),e=t.pendingProps;var d=Tc(t,pi.current);bc(t,i),d=l1(null,t,u,e,d,i);var g=u1();return t.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qi(u)?(g=!0,zm(t)):g=!1,t.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,n1(t),d.updater=yg,t.stateNode=d,d._reactInternals=t,L0(t,u,e,i),t=B0(null,t,u,!0,g,i)):(t.tag=0,rn&&g&&Kv(t),Si(null,t,d,i),t=t.child),t;case 16:u=t.elementType;e:{switch(rm(e,t),e=t.pendingProps,d=u._init,u=d(u._payload),t.type=u,d=t.tag=v3(u),e=Wo(u,e),d){case 0:t=O0(null,t,u,e,i);break e;case 1:t=Rb(null,t,u,e,i);break e;case 11:t=zb(null,t,u,e,i);break e;case 14:t=Db(null,t,u,Wo(u.type,e),i);break e}throw Error(lt(306,u,""))}return t;case 0:return u=t.type,d=t.pendingProps,d=t.elementType===u?d:Wo(u,d),O0(e,t,u,d,i);case 1:return u=t.type,d=t.pendingProps,d=t.elementType===u?d:Wo(u,d),Rb(e,t,u,d,i);case 3:e:{if(_k(t),e===null)throw Error(lt(387));u=t.pendingProps,g=t.memoizedState,d=g.element,GE(e,t),Om(t,u,null,i);var y=t.memoizedState;if(u=y.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:y.cache,pendingSuspenseBoundaries:y.pendingSuspenseBoundaries,transitions:y.transitions},t.updateQueue.baseState=g,t.memoizedState=g,t.flags&256){d=Ac(Error(lt(423)),t),t=Lb(e,t,u,i,d);break e}else if(u!==d){d=Ac(Error(lt(424)),t),t=Lb(e,t,u,i,d);break e}else for(vo=Xa(t.stateNode.containerInfo.firstChild),xo=t,rn=!0,Ko=null,i=VE(t,null,u,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Cc(),u===d){t=Xs(e,t,i);break e}Si(e,t,u,i)}t=t.child}return t;case 5:return ZE(t),e===null&&z0(t),u=t.type,d=t.pendingProps,g=e!==null?e.memoizedProps:null,y=d.children,C0(u,d)?y=null:g!==null&&C0(u,g)&&(t.flags|=32),yk(e,t),Si(e,t,y,i),t.child;case 6:return e===null&&z0(t),null;case 13:return vk(e,t,i);case 4:return i1(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=Ic(t,null,u,i):Si(e,t,u,i),t.child;case 11:return u=t.type,d=t.pendingProps,d=t.elementType===u?d:Wo(u,d),zb(e,t,u,d,i);case 7:return Si(e,t,t.pendingProps,i),t.child;case 8:return Si(e,t,t.pendingProps.children,i),t.child;case 12:return Si(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(u=t.type._context,d=t.pendingProps,g=t.memoizedProps,y=d.value,Hr(Lm,u._currentValue),u._currentValue=y,g!==null)if(ts(g.value,y)){if(g.children===d.children&&!Wi.current){t=Xs(e,t,i);break e}}else for(g=t.child,g!==null&&(g.return=t);g!==null;){var c=g.dependencies;if(c!==null){y=g.child;for(var T=c.firstContext;T!==null;){if(T.context===u){if(g.tag===1){T=Gs(-1,i&-i),T.tag=2;var P=g.updateQueue;if(P!==null){P=P.shared;var R=P.pending;R===null?T.next=T:(T.next=R.next,R.next=T),P.pending=T}}g.lanes|=i,T=g.alternate,T!==null&&(T.lanes|=i),D0(g.return,i,t),c.lanes|=i;break}T=T.next}}else if(g.tag===10)y=g.type===t.type?null:g.child;else if(g.tag===18){if(y=g.return,y===null)throw Error(lt(341));y.lanes|=i,c=y.alternate,c!==null&&(c.lanes|=i),D0(y,i,t),y=g.sibling}else y=g.child;if(y!==null)y.return=g;else for(y=g;y!==null;){if(y===t){y=null;break}if(g=y.sibling,g!==null){g.return=y.return,y=g;break}y=y.return}g=y}Si(e,t,d.children,i),t=t.child}return t;case 9:return d=t.type,u=t.pendingProps.children,bc(t,i),d=Fo(d),u=u(d),t.flags|=1,Si(e,t,u,i),t.child;case 14:return u=t.type,d=Wo(u,t.pendingProps),d=Wo(u.type,d),Db(e,t,u,d,i);case 15:return mk(e,t,t.type,t.pendingProps,i);case 17:return u=t.type,d=t.pendingProps,d=t.elementType===u?d:Wo(u,d),rm(e,t),t.tag=1,qi(u)?(e=!0,zm(t)):e=!1,bc(t,i),dk(t,u,d),L0(t,u,d,i),B0(null,t,u,!0,e,i);case 19:return xk(e,t,i);case 22:return gk(e,t,i)}throw Error(lt(156,t.tag))};function Fk(e,t){return uE(e,t)}function _3(e,t,i,u){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ro(e,t,i,u){return new _3(e,t,i,u)}function v1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function v3(e){if(typeof e=="function")return v1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Bv)return 11;if(e===Nv)return 14}return 2}function Qa(e,t){var i=e.alternate;return i===null?(i=Ro(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function om(e,t,i,u,d,g){var y=2;if(u=e,typeof e=="function")v1(e)&&(y=1);else if(typeof e=="string")y=5;else e:switch(e){case oc:return Zl(i.children,d,g,t);case Ov:y=8,d|=8;break;case o0:return e=Ro(12,i,t,d|2),e.elementType=o0,e.lanes=g,e;case s0:return e=Ro(13,i,t,d),e.elementType=s0,e.lanes=g,e;case a0:return e=Ro(19,i,t,d),e.elementType=a0,e.lanes=g,e;case ZS:return xg(i,d,g,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case HS:y=10;break e;case GS:y=9;break e;case Bv:y=11;break e;case Nv:y=14;break e;case Oa:y=16,u=null;break e}throw Error(lt(130,e==null?e:typeof e,""))}return t=Ro(y,i,t,d),t.elementType=e,t.type=u,t.lanes=g,t}function Zl(e,t,i,u){return e=Ro(7,e,u,t),e.lanes=i,e}function xg(e,t,i,u){return e=Ro(22,e,u,t),e.elementType=ZS,e.lanes=i,e.stateNode={isHidden:!1},e}function L_(e,t,i){return e=Ro(6,e,null,t),e.lanes=i,e}function F_(e,t,i){return t=Ro(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function x3(e,t,i,u,d){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g_(0),this.expirationTimes=g_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g_(0),this.identifierPrefix=u,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function x1(e,t,i,u,d,g,y,c,T){return e=new x3(e,t,i,c,T),t===1?(t=1,g===!0&&(t|=8)):t=0,g=Ro(3,null,null,t),e.current=g,g.stateNode=e,g.memoizedState={element:u,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},n1(g),e}function w3(e,t,i){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ic,key:u==null?null:""+u,children:e,containerInfo:t,implementation:i}}function Ok(e){if(!e)return tl;e=e._reactInternals;e:{if(ou(e)!==e||e.tag!==1)throw Error(lt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(lt(171))}if(e.tag===1){var i=e.type;if(qi(i))return OE(e,i,t)}return t}function Bk(e,t,i,u,d,g,y,c,T){return e=x1(i,u,!0,e,d,g,y,c,T),e.context=Ok(null),i=e.current,u=Ii(),d=Ja(i),g=Gs(u,d),g.callback=t??null,Ka(i,g,d),e.current.lanes=d,sp(e,d,u),Xi(e,u),e}function wg(e,t,i,u){var d=t.current,g=Ii(),y=Ja(d);return i=Ok(i),t.context===null?t.context=i:t.pendingContext=i,t=Gs(g,y),t.payload={element:e},u=u===void 0?null:u,u!==null&&(t.callback=u),e=Ka(d,t,y),e!==null&&(Jo(e,d,y,g),Qf(e,d,y)),y}function Gm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function w1(e,t){Gb(e,t),(e=e.alternate)&&Gb(e,t)}function b3(){return null}var Nk=typeof reportError=="function"?reportError:function(e){console.error(e)};function b1(e){this._internalRoot=e}bg.prototype.render=b1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(lt(409));wg(e,t,null,null)};bg.prototype.unmount=b1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;tu(function(){wg(null,e,null,null)}),t[Ws]=null}};function bg(e){this._internalRoot=e}bg.prototype.unstable_scheduleHydration=function(e){if(e){var t=gE();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Na.length&&t!==0&&t<Na[i].priority;i++);Na.splice(i,0,e),i===0&&_E(e)}};function S1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Sg(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Zb(){}function S3(e,t,i,u,d){if(d){if(typeof u=="function"){var g=u;u=function(){var P=Gm(y);g.call(P)}}var y=Bk(t,u,e,0,null,!1,!1,"",Zb);return e._reactRootContainer=y,e[Ws]=y.current,Ud(e.nodeType===8?e.parentNode:e),tu(),y}for(;d=e.lastChild;)e.removeChild(d);if(typeof u=="function"){var c=u;u=function(){var P=Gm(T);c.call(P)}}var T=x1(e,0,!1,null,null,!1,!1,"",Zb);return e._reactRootContainer=T,e[Ws]=T.current,Ud(e.nodeType===8?e.parentNode:e),tu(function(){wg(t,T,i,u)}),T}function Eg(e,t,i,u,d){var g=i._reactRootContainer;if(g){var y=g;if(typeof d=="function"){var c=d;d=function(){var T=Gm(y);c.call(T)}}wg(t,y,e,d)}else y=S3(i,t,e,d,u);return Gm(y)}fE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=pd(t.pendingLanes);i!==0&&(Uv(t,i|1),Xi(t,yn()),!(br&6)&&(Mc=yn()+500,il()))}break;case 13:tu(function(){var u=qs(e,1);if(u!==null){var d=Ii();Jo(u,e,1,d)}}),w1(e,1)}};Vv=function(e){if(e.tag===13){var t=qs(e,134217728);if(t!==null){var i=Ii();Jo(t,e,134217728,i)}w1(e,134217728)}};mE=function(e){if(e.tag===13){var t=Ja(e),i=qs(e,t);if(i!==null){var u=Ii();Jo(i,e,t,u)}w1(e,t)}};gE=function(){return zr};yE=function(e,t){var i=zr;try{return zr=e,t()}finally{zr=i}};y0=function(e,t,i){switch(t){case"input":if(c0(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var u=i[t];if(u!==e&&u.form===e.form){var d=fg(u);if(!d)throw Error(lt(90));qS(u),c0(u,d)}}}break;case"textarea":KS(e,i);break;case"select":t=i.value,t!=null&&_c(e,!!i.multiple,t,!1)}};nE=g1;iE=tu;var E3={usingClientEntryPoint:!1,Events:[lp,uc,fg,tE,rE,g1]},ud={findFiberByHostInstance:Nl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k3={bundleType:ud.bundleType,version:ud.version,rendererPackageName:ud.rendererPackageName,rendererConfig:ud.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Js.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=aE(e),e===null?null:e.stateNode},findFiberByHostInstance:ud.findFiberByHostInstance||b3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{cg=Of.inject(k3),vs=Of}catch{}}bo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E3;bo.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S1(t))throw Error(lt(200));return w3(e,t,null,i)};bo.createRoot=function(e,t){if(!S1(e))throw Error(lt(299));var i=!1,u="",d=Nk;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onRecoverableError!==void 0&&(d=t.onRecoverableError)),t=x1(e,1,!1,null,null,i,!1,u,d),e[Ws]=t.current,Ud(e.nodeType===8?e.parentNode:e),new b1(t)};bo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(lt(188)):(e=Object.keys(e).join(","),Error(lt(268,e)));return e=aE(t),e=e===null?null:e.stateNode,e};bo.flushSync=function(e){return tu(e)};bo.hydrate=function(e,t,i){if(!Sg(t))throw Error(lt(200));return Eg(null,e,t,!0,i)};bo.hydrateRoot=function(e,t,i){if(!S1(e))throw Error(lt(405));var u=i!=null&&i.hydratedSources||null,d=!1,g="",y=Nk;if(i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(g=i.identifierPrefix),i.onRecoverableError!==void 0&&(y=i.onRecoverableError)),t=Bk(t,null,e,1,i??null,d,!1,g,y),e[Ws]=t.current,Ud(e),u)for(e=0;e<u.length;e++)i=u[e],d=i._getVersion,d=d(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,d]:t.mutableSourceEagerHydrationData.push(i,d);return new bg(t)};bo.render=function(e,t,i){if(!Sg(t))throw Error(lt(200));return Eg(null,e,t,!1,i)};bo.unmountComponentAtNode=function(e){if(!Sg(e))throw Error(lt(40));return e._reactRootContainer?(tu(function(){Eg(null,null,e,!1,function(){e._reactRootContainer=null,e[Ws]=null})}),!0):!1};bo.unstable_batchedUpdates=g1;bo.unstable_renderSubtreeIntoContainer=function(e,t,i,u){if(!Sg(i))throw Error(lt(200));if(e==null||e._reactInternals===void 0)throw Error(lt(38));return Eg(e,t,i,!1,u)};bo.version="18.3.1-next-f1338f8080-20240426";function $k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($k)}catch(e){console.error(e)}}$k(),$S.exports=bo;var jk=$S.exports,Wb=jk;n0.createRoot=Wb.createRoot,n0.hydrateRoot=Wb.hydrateRoot;const T3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='80'%20height='48'%20viewBox='0%200%2080%2048'%3e%3cg%20fill='%23D73F3F'%20fill-rule='evenodd'%3e%3cpath%20d='M37.02656,20.77496%20C37.02656,20.29096%2037.12976,19.85896%2037.33616,19.48616%20C37.54096,19.11176%2037.81296,18.80696%2038.15056,18.56376%20C38.48656,18.32136%2038.86496,18.13736%2039.28576,18.01336%20C39.70496,17.89016%2040.12736,17.82776%2040.55376,17.82776%20C40.97856,17.82776%2041.40256,17.89016%2041.82336,18.01336%20C42.24176,18.13736%2042.62016,18.32136%2042.95616,18.56376%20C43.29456,18.80696%2043.56576,19.11176%2043.77216,19.48616%20C43.97856,19.85896%2044.08096,20.29096%2044.08096,20.77496%20L44.08096,27.14696%20C44.08096,27.64136%2043.97856,28.07496%2043.77216,28.44216%20C43.56576,28.81096%2043.29456,29.11416%2042.95616,29.35736%20C42.62016,29.60136%2042.24176,29.78616%2041.82336,29.90856%20C41.40256,30.03176%2040.97856,30.09336%2040.55376,30.09336%20C40.12736,30.09336%2039.70496,30.03176%2039.28576,29.90856%20C38.86496,29.78616%2038.48656,29.60136%2038.15056,29.35736%20C37.81296,29.11416%2037.54096,28.81096%2037.33616,28.44216%20C37.12976,28.07496%2037.02656,27.64136%2037.02656,27.14696%20L37.02656,20.77496%20Z%20M39.05136,27.15016%20C39.05136,27.56536%2039.28256,27.87496%2039.56576,28.07176%20C39.84736,28.27016%2040.18096,28.37496%2040.56576,28.37496%20C40.94896,28.37496%2041.28416,28.27016%2041.56656,28.07176%20C41.84736,27.87496%2042.00816,27.56536%2042.00816,27.15016%20L42.00816,20.77816%20C42.00816,20.36136%2041.84736,20.05256%2041.56656,19.85576%20C41.28416,19.65816%2040.94896,19.52536%2040.56576,19.52536%20C40.18096,19.52536%2039.84736,19.65816%2039.56576,19.85576%20C39.28256,20.05256%2039.05136,20.36136%2039.05136,20.77816%20L39.05136,27.15016%20Z'/%3e%3cpolygon%20points='33.379%2017.815%2033.379%2022.99%2030.152%2022.99%2030.152%2017.815%2028.387%2017.815%2028.387%2030.1%2030.152%2030.1%2030.152%2024.923%2033.379%2024.923%2033.379%2030.1%2035.278%2030.1%2035.278%2017.815'/%3e%3cpolygon%20points='52.431%2017.815%2045.426%2017.815%2045.426%2019.622%2048.015%2019.622%2047.985%2030.1%2049.847%2030.1%2049.847%2019.622%2052.431%2019.622'/%3e%3cpath%20d='M65.42344,28.7668%20L79.67944,28.7668%20L71.15544,19.1684%20L62.66904,9.57%20L54.18104,0.000400000001%20L11.53944,0.000400000001%20L20.02584,9.57%20L5.73784,9.57%20L14.22584,19.1684%20L14.29144,19.2332%20L0.000239999999,19.2332%20L8.52184,28.8316%20L17.01304,38.43%20L25.50024,48.0004%20L68.14184,48.0004%20L59.65064,38.43%20L59.58824,38.3364%20L73.87864,38.3364%20L65.42344,28.7668%20Z%20M39.83944,39.9492%20C30.31864,39.9492%2022.60104,32.8084%2022.60104,24.0012%20C22.60104,15.1908%2030.31864,8.05%2039.83944,8.05%20C49.36104,8.05%2057.07944,15.1908%2057.07944,24.0012%20C57.07944,32.8084%2049.36104,39.9492%2039.83944,39.9492%20Z'/%3e%3c/g%3e%3c/svg%3e";var Zi=function(){return Zi=Object.assign||function(t){for(var i,u=1,d=arguments.length;u<d;u++){i=arguments[u];for(var g in i)Object.prototype.hasOwnProperty.call(i,g)&&(t[g]=i[g])}return t},Zi.apply(this,arguments)};function Zm(e,t,i){if(i||arguments.length===2)for(var u=0,d=t.length,g;u<d;u++)(g||!(u in t))&&(g||(g=Array.prototype.slice.call(t,0,u)),g[u]=t[u]);return e.concat(g||Array.prototype.slice.call(t))}var Xr="-ms-",Pd="-moz-",Pr="-webkit-",Uk="comm",kg="rule",E1="decl",C3="@import",Vk="@keyframes",I3="@layer",Hk=Math.abs,k1=String.fromCharCode,K0=Object.assign;function P3(e,t){return Nn(e,0)^45?(((t<<2^Nn(e,0))<<2^Nn(e,1))<<2^Nn(e,2))<<2^Nn(e,3):0}function Gk(e){return e.trim()}function js(e,t){return(e=t.exec(e))?e[0]:e}function sr(e,t,i){return e.replace(t,i)}function sm(e,t,i){return e.indexOf(t,i)}function Nn(e,t){return e.charCodeAt(t)|0}function zc(e,t,i){return e.slice(t,i)}function ys(e){return e.length}function Zk(e){return e.length}function md(e,t){return t.push(e),e}function A3(e,t){return e.map(t).join("")}function qb(e,t){return e.filter(function(i){return!js(i,t)})}var Tg=1,Dc=1,Wk=0,Bo=0,bn=0,Vc="";function Cg(e,t,i,u,d,g,y,c){return{value:e,root:t,parent:i,type:u,props:d,children:g,line:Tg,column:Dc,length:y,return:"",siblings:c}}function Ra(e,t){return K0(Cg("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function rc(e){for(;e.root;)e=Ra(e.root,{children:[e]});md(e,e.siblings)}function M3(){return bn}function z3(){return bn=Bo>0?Nn(Vc,--Bo):0,Dc--,bn===10&&(Dc=1,Tg--),bn}function Qo(){return bn=Bo<Wk?Nn(Vc,Bo++):0,Dc++,bn===10&&(Dc=1,Tg++),bn}function Wl(){return Nn(Vc,Bo)}function am(){return Bo}function Ig(e,t){return zc(Vc,e,t)}function Y0(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function D3(e){return Tg=Dc=1,Wk=ys(Vc=e),Bo=0,[]}function R3(e){return Vc="",e}function O_(e){return Gk(Ig(Bo-1,J0(e===91?e+2:e===40?e+1:e)))}function L3(e){for(;(bn=Wl())&&bn<33;)Qo();return Y0(e)>2||Y0(bn)>3?"":" "}function F3(e,t){for(;--t&&Qo()&&!(bn<48||bn>102||bn>57&&bn<65||bn>70&&bn<97););return Ig(e,am()+(t<6&&Wl()==32&&Qo()==32))}function J0(e){for(;Qo();)switch(bn){case e:return Bo;case 34:case 39:e!==34&&e!==39&&J0(bn);break;case 40:e===41&&J0(e);break;case 92:Qo();break}return Bo}function O3(e,t){for(;Qo()&&e+bn!==57;)if(e+bn===84&&Wl()===47)break;return"/*"+Ig(t,Bo-1)+"*"+k1(e===47?e:Qo())}function B3(e){for(;!Y0(Wl());)Qo();return Ig(e,Bo)}function N3(e){return R3(lm("",null,null,null,[""],e=D3(e),0,[0],e))}function lm(e,t,i,u,d,g,y,c,T){for(var P=0,R=0,D=y,A=0,N=0,X=0,U=1,te=1,F=1,$=0,q="",ne=d,se=g,Ee=u,ge=q;te;)switch(X=$,$=Qo()){case 40:if(X!=108&&Nn(ge,D-1)==58){sm(ge+=sr(O_($),"&","&\f"),"&\f",Hk(P?c[P-1]:0))!=-1&&(F=-1);break}case 34:case 39:case 91:ge+=O_($);break;case 9:case 10:case 13:case 32:ge+=L3(X);break;case 92:ge+=F3(am()-1,7);continue;case 47:switch(Wl()){case 42:case 47:md($3(O3(Qo(),am()),t,i,T),T);break;default:ge+="/"}break;case 123*U:c[P++]=ys(ge)*F;case 125*U:case 59:case 0:switch($){case 0:case 125:te=0;case 59+R:F==-1&&(ge=sr(ge,/\f/g,"")),N>0&&ys(ge)-D&&md(N>32?Kb(ge+";",u,i,D-1,T):Kb(sr(ge," ","")+";",u,i,D-2,T),T);break;case 59:ge+=";";default:if(md(Ee=Xb(ge,t,i,P,R,d,c,q,ne=[],se=[],D,g),g),$===123)if(R===0)lm(ge,t,Ee,Ee,ne,g,D,c,se);else switch(A===99&&Nn(ge,3)===110?100:A){case 100:case 108:case 109:case 115:lm(e,Ee,Ee,u&&md(Xb(e,Ee,Ee,0,0,d,c,q,d,ne=[],D,se),se),d,se,D,c,u?ne:se);break;default:lm(ge,Ee,Ee,Ee,[""],se,0,c,se)}}P=R=N=0,U=F=1,q=ge="",D=y;break;case 58:D=1+ys(ge),N=X;default:if(U<1){if($==123)--U;else if($==125&&U++==0&&z3()==125)continue}switch(ge+=k1($),$*U){case 38:F=R>0?1:(ge+="\f",-1);break;case 44:c[P++]=(ys(ge)-1)*F,F=1;break;case 64:Wl()===45&&(ge+=O_(Qo())),A=Wl(),R=D=ys(q=ge+=B3(am())),$++;break;case 45:X===45&&ys(ge)==2&&(U=0)}}return g}function Xb(e,t,i,u,d,g,y,c,T,P,R,D){for(var A=d-1,N=d===0?g:[""],X=Zk(N),U=0,te=0,F=0;U<u;++U)for(var $=0,q=zc(e,A+1,A=Hk(te=y[U])),ne=e;$<X;++$)(ne=Gk(te>0?N[$]+" "+q:sr(q,/&\f/g,N[$])))&&(T[F++]=ne);return Cg(e,t,i,d===0?kg:c,T,P,R,D)}function $3(e,t,i,u){return Cg(e,t,i,Uk,k1(M3()),zc(e,2,-2),0,u)}function Kb(e,t,i,u,d){return Cg(e,t,i,E1,zc(e,0,u),zc(e,u+1,-1),u,d)}function qk(e,t,i){switch(P3(e,t)){case 5103:return Pr+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Pr+e+e;case 4789:return Pd+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Pr+e+Pd+e+Xr+e+e;case 5936:switch(Nn(e,t+11)){case 114:return Pr+e+Xr+sr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Pr+e+Xr+sr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Pr+e+Xr+sr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return Pr+e+Xr+e+e;case 6165:return Pr+e+Xr+"flex-"+e+e;case 5187:return Pr+e+sr(e,/(\w+).+(:[^]+)/,Pr+"box-$1$2"+Xr+"flex-$1$2")+e;case 5443:return Pr+e+Xr+"flex-item-"+sr(e,/flex-|-self/g,"")+(js(e,/flex-|baseline/)?"":Xr+"grid-row-"+sr(e,/flex-|-self/g,""))+e;case 4675:return Pr+e+Xr+"flex-line-pack"+sr(e,/align-content|flex-|-self/g,"")+e;case 5548:return Pr+e+Xr+sr(e,"shrink","negative")+e;case 5292:return Pr+e+Xr+sr(e,"basis","preferred-size")+e;case 6060:return Pr+"box-"+sr(e,"-grow","")+Pr+e+Xr+sr(e,"grow","positive")+e;case 4554:return Pr+sr(e,/([^-])(transform)/g,"$1"+Pr+"$2")+e;case 6187:return sr(sr(sr(e,/(zoom-|grab)/,Pr+"$1"),/(image-set)/,Pr+"$1"),e,"")+e;case 5495:case 3959:return sr(e,/(image-set\([^]*)/,Pr+"$1$`$1");case 4968:return sr(sr(e,/(.+:)(flex-)?(.*)/,Pr+"box-pack:$3"+Xr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Pr+e+e;case 4200:if(!js(e,/flex-|baseline/))return Xr+"grid-column-align"+zc(e,t)+e;break;case 2592:case 3360:return Xr+sr(e,"template-","")+e;case 4384:case 3616:return i&&i.some(function(u,d){return t=d,js(u.props,/grid-\w+-end/)})?~sm(e+(i=i[t].value),"span",0)?e:Xr+sr(e,"-start","")+e+Xr+"grid-row-span:"+(~sm(i,"span",0)?js(i,/\d+/):+js(i,/\d+/)-+js(e,/\d+/))+";":Xr+sr(e,"-start","")+e;case 4896:case 4128:return i&&i.some(function(u){return js(u.props,/grid-\w+-start/)})?e:Xr+sr(sr(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return sr(e,/(.+)-inline(.+)/,Pr+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ys(e)-1-t>6)switch(Nn(e,t+1)){case 109:if(Nn(e,t+4)!==45)break;case 102:return sr(e,/(.+:)(.+)-([^]+)/,"$1"+Pr+"$2-$3$1"+Pd+(Nn(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~sm(e,"stretch",0)?qk(sr(e,"stretch","fill-available"),t,i)+e:e}break;case 5152:case 5920:return sr(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(u,d,g,y,c,T,P){return Xr+d+":"+g+P+(y?Xr+d+"-span:"+(c?T:+T-+g)+P:"")+e});case 4949:if(Nn(e,t+6)===121)return sr(e,":",":"+Pr)+e;break;case 6444:switch(Nn(e,Nn(e,14)===45?18:11)){case 120:return sr(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Pr+(Nn(e,14)===45?"inline-":"")+"box$3$1"+Pr+"$2$3$1"+Xr+"$2box$3")+e;case 100:return sr(e,":",":"+Xr)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return sr(e,"scroll-","scroll-snap-")+e}return e}function Wm(e,t){for(var i="",u=0;u<e.length;u++)i+=t(e[u],u,e,t)||"";return i}function j3(e,t,i,u){switch(e.type){case I3:if(e.children.length)break;case C3:case E1:return e.return=e.return||e.value;case Uk:return"";case Vk:return e.return=e.value+"{"+Wm(e.children,u)+"}";case kg:if(!ys(e.value=e.props.join(",")))return""}return ys(i=Wm(e.children,u))?e.return=e.value+"{"+i+"}":""}function U3(e){var t=Zk(e);return function(i,u,d,g){for(var y="",c=0;c<t;c++)y+=e[c](i,u,d,g)||"";return y}}function V3(e){return function(t){t.root||(t=t.return)&&e(t)}}function H3(e,t,i,u){if(e.length>-1&&!e.return)switch(e.type){case E1:e.return=qk(e.value,e.length,i);return;case Vk:return Wm([Ra(e,{value:sr(e.value,"@","@"+Pr)})],u);case kg:if(e.length)return A3(i=e.props,function(d){switch(js(d,u=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":rc(Ra(e,{props:[sr(d,/:(read-\w+)/,":"+Pd+"$1")]})),rc(Ra(e,{props:[d]})),K0(e,{props:qb(i,u)});break;case"::placeholder":rc(Ra(e,{props:[sr(d,/:(plac\w+)/,":"+Pr+"input-$1")]})),rc(Ra(e,{props:[sr(d,/:(plac\w+)/,":"+Pd+"$1")]})),rc(Ra(e,{props:[sr(d,/:(plac\w+)/,Xr+"input-$1")]})),rc(Ra(e,{props:[d]})),K0(e,{props:qb(i,u)});break}return""})}}var G3={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},po={},Rc=typeof process<"u"&&po!==void 0&&(po.REACT_APP_SC_ATTR||po.SC_ATTR)||"data-styled",Xk="active",Kk="data-styled-version",Pg="6.1.13",T1=`/*!sc*/
`,qm=typeof window<"u"&&"HTMLElement"in window,Z3=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&po!==void 0&&po.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&po.REACT_APP_SC_DISABLE_SPEEDY!==""?po.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&po.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&po!==void 0&&po.SC_DISABLE_SPEEDY!==void 0&&po.SC_DISABLE_SPEEDY!==""&&po.SC_DISABLE_SPEEDY!=="false"&&po.SC_DISABLE_SPEEDY),Ag=Object.freeze([]),Lc=Object.freeze({});function W3(e,t,i){return i===void 0&&(i=Lc),e.theme!==i.theme&&e.theme||t||i.theme}var Yk=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),q3=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,X3=/(^-|-$)/g;function Yb(e){return e.replace(q3,"-").replace(X3,"")}var K3=/(a)(d)/gi,Bf=52,Jb=function(e){return String.fromCharCode(e+(e>25?39:97))};function Q0(e){var t,i="";for(t=Math.abs(e);t>Bf;t=t/Bf|0)i=Jb(t%Bf)+i;return(Jb(t%Bf)+i).replace(K3,"$1-$2")}var B_,Jk=5381,gc=function(e,t){for(var i=t.length;i;)e=33*e^t.charCodeAt(--i);return e},Qk=function(e){return gc(Jk,e)};function Y3(e){return Q0(Qk(e)>>>0)}function J3(e){return e.displayName||e.name||"Component"}function N_(e){return typeof e=="string"&&!0}var eT=typeof Symbol=="function"&&Symbol.for,tT=eT?Symbol.for("react.memo"):60115,Q3=eT?Symbol.for("react.forward_ref"):60112,ez={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},tz={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},rT={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},rz=((B_={})[Q3]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},B_[tT]=rT,B_);function Qb(e){return("type"in(t=e)&&t.type.$$typeof)===tT?rT:"$$typeof"in e?rz[e.$$typeof]:ez;var t}var nz=Object.defineProperty,iz=Object.getOwnPropertyNames,e2=Object.getOwnPropertySymbols,oz=Object.getOwnPropertyDescriptor,sz=Object.getPrototypeOf,t2=Object.prototype;function nT(e,t,i){if(typeof t!="string"){if(t2){var u=sz(t);u&&u!==t2&&nT(e,u,i)}var d=iz(t);e2&&(d=d.concat(e2(t)));for(var g=Qb(e),y=Qb(t),c=0;c<d.length;++c){var T=d[c];if(!(T in tz||i&&i[T]||y&&T in y||g&&T in g)){var P=oz(t,T);try{nz(e,T,P)}catch{}}}}return e}function Fc(e){return typeof e=="function"}function C1(e){return typeof e=="object"&&"styledComponentId"in e}function Ul(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function r2(e,t){if(e.length===0)return"";for(var i=e[0],u=1;u<e.length;u++)i+=e[u];return i}function Yd(e){return e!==null&&typeof e=="object"&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function ev(e,t,i){if(i===void 0&&(i=!1),!i&&!Yd(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var u=0;u<t.length;u++)e[u]=ev(e[u],t[u]);else if(Yd(t))for(var u in t)e[u]=ev(e[u],t[u]);return e}function I1(e,t){Object.defineProperty(e,"toString",{value:t})}function cp(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var az=function(){function e(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return e.prototype.indexOfGroup=function(t){for(var i=0,u=0;u<t;u++)i+=this.groupSizes[u];return i},e.prototype.insertRules=function(t,i){if(t>=this.groupSizes.length){for(var u=this.groupSizes,d=u.length,g=d;t>=g;)if((g<<=1)<0)throw cp(16,"".concat(t));this.groupSizes=new Uint32Array(g),this.groupSizes.set(u),this.length=g;for(var y=d;y<g;y++)this.groupSizes[y]=0}for(var c=this.indexOfGroup(t+1),T=(y=0,i.length);y<T;y++)this.tag.insertRule(c,i[y])&&(this.groupSizes[t]++,c++)},e.prototype.clearGroup=function(t){if(t<this.length){var i=this.groupSizes[t],u=this.indexOfGroup(t),d=u+i;this.groupSizes[t]=0;for(var g=u;g<d;g++)this.tag.deleteRule(u)}},e.prototype.getGroup=function(t){var i="";if(t>=this.length||this.groupSizes[t]===0)return i;for(var u=this.groupSizes[t],d=this.indexOfGroup(t),g=d+u,y=d;y<g;y++)i+="".concat(this.tag.getRule(y)).concat(T1);return i},e}(),um=new Map,Xm=new Map,cm=1,Nf=function(e){if(um.has(e))return um.get(e);for(;Xm.has(cm);)cm++;var t=cm++;return um.set(e,t),Xm.set(t,e),t},lz=function(e,t){cm=t+1,um.set(e,t),Xm.set(t,e)},uz="style[".concat(Rc,"][").concat(Kk,'="').concat(Pg,'"]'),cz=new RegExp("^".concat(Rc,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),hz=function(e,t,i){for(var u,d=i.split(","),g=0,y=d.length;g<y;g++)(u=d[g])&&e.registerName(t,u)},dz=function(e,t){for(var i,u=((i=t.textContent)!==null&&i!==void 0?i:"").split(T1),d=[],g=0,y=u.length;g<y;g++){var c=u[g].trim();if(c){var T=c.match(cz);if(T){var P=0|parseInt(T[1],10),R=T[2];P!==0&&(lz(R,P),hz(e,R,T[3]),e.getTag().insertRules(P,d)),d.length=0}else d.push(c)}}},n2=function(e){for(var t=document.querySelectorAll(uz),i=0,u=t.length;i<u;i++){var d=t[i];d&&d.getAttribute(Rc)!==Xk&&(dz(e,d),d.parentNode&&d.parentNode.removeChild(d))}};function pz(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var iT=function(e){var t=document.head,i=e||t,u=document.createElement("style"),d=function(c){var T=Array.from(c.querySelectorAll("style[".concat(Rc,"]")));return T[T.length-1]}(i),g=d!==void 0?d.nextSibling:null;u.setAttribute(Rc,Xk),u.setAttribute(Kk,Pg);var y=pz();return y&&u.setAttribute("nonce",y),i.insertBefore(u,g),u},fz=function(){function e(t){this.element=iT(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(i){if(i.sheet)return i.sheet;for(var u=document.styleSheets,d=0,g=u.length;d<g;d++){var y=u[d];if(y.ownerNode===i)return y}throw cp(17)}(this.element),this.length=0}return e.prototype.insertRule=function(t,i){try{return this.sheet.insertRule(i,t),this.length++,!0}catch{return!1}},e.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.prototype.getRule=function(t){var i=this.sheet.cssRules[t];return i&&i.cssText?i.cssText:""},e}(),mz=function(){function e(t){this.element=iT(t),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(t,i){if(t<=this.length&&t>=0){var u=document.createTextNode(i);return this.element.insertBefore(u,this.nodes[t]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},e}(),gz=function(){function e(t){this.rules=[],this.length=0}return e.prototype.insertRule=function(t,i){return t<=this.length&&(this.rules.splice(t,0,i),this.length++,!0)},e.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},e}(),i2=qm,yz={isServer:!qm,useCSSOMInjection:!Z3},oT=function(){function e(t,i,u){t===void 0&&(t=Lc),i===void 0&&(i={});var d=this;this.options=Zi(Zi({},yz),t),this.gs=i,this.names=new Map(u),this.server=!!t.isServer,!this.server&&qm&&i2&&(i2=!1,n2(this)),I1(this,function(){return function(g){for(var y=g.getTag(),c=y.length,T="",P=function(D){var A=function(F){return Xm.get(F)}(D);if(A===void 0)return"continue";var N=g.names.get(A),X=y.getGroup(D);if(N===void 0||!N.size||X.length===0)return"continue";var U="".concat(Rc,".g").concat(D,'[id="').concat(A,'"]'),te="";N!==void 0&&N.forEach(function(F){F.length>0&&(te+="".concat(F,","))}),T+="".concat(X).concat(U,'{content:"').concat(te,'"}').concat(T1)},R=0;R<c;R++)P(R);return T}(d)})}return e.registerId=function(t){return Nf(t)},e.prototype.rehydrate=function(){!this.server&&qm&&n2(this)},e.prototype.reconstructWithOptions=function(t,i){return i===void 0&&(i=!0),new e(Zi(Zi({},this.options),t),this.gs,i&&this.names||void 0)},e.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(t=function(i){var u=i.useCSSOMInjection,d=i.target;return i.isServer?new gz(d):u?new fz(d):new mz(d)}(this.options),new az(t)));var t},e.prototype.hasNameForId=function(t,i){return this.names.has(t)&&this.names.get(t).has(i)},e.prototype.registerName=function(t,i){if(Nf(t),this.names.has(t))this.names.get(t).add(i);else{var u=new Set;u.add(i),this.names.set(t,u)}},e.prototype.insertRules=function(t,i,u){this.registerName(t,i),this.getTag().insertRules(Nf(t),u)},e.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.prototype.clearRules=function(t){this.getTag().clearGroup(Nf(t)),this.clearNames(t)},e.prototype.clearTag=function(){this.tag=void 0},e}(),_z=/&/g,vz=/^\s*\/\/.*$/gm;function sT(e,t){return e.map(function(i){return i.type==="rule"&&(i.value="".concat(t," ").concat(i.value),i.value=i.value.replaceAll(",",",".concat(t," ")),i.props=i.props.map(function(u){return"".concat(t," ").concat(u)})),Array.isArray(i.children)&&i.type!=="@keyframes"&&(i.children=sT(i.children,t)),i})}function xz(e){var t,i,u,d=Lc,g=d.options,y=g===void 0?Lc:g,c=d.plugins,T=c===void 0?Ag:c,P=function(A,N,X){return X.startsWith(i)&&X.endsWith(i)&&X.replaceAll(i,"").length>0?".".concat(t):A},R=T.slice();R.push(function(A){A.type===kg&&A.value.includes("&")&&(A.props[0]=A.props[0].replace(_z,i).replace(u,P))}),y.prefix&&R.push(H3),R.push(j3);var D=function(A,N,X,U){N===void 0&&(N=""),X===void 0&&(X=""),U===void 0&&(U="&"),t=U,i=N,u=new RegExp("\\".concat(i,"\\b"),"g");var te=A.replace(vz,""),F=N3(X||N?"".concat(X," ").concat(N," { ").concat(te," }"):te);y.namespace&&(F=sT(F,y.namespace));var $=[];return Wm(F,U3(R.concat(V3(function(q){return $.push(q)})))),$};return D.hash=T.length?T.reduce(function(A,N){return N.name||cp(15),gc(A,N.name)},Jk).toString():"",D}var wz=new oT,tv=xz(),aT=Ec.createContext({shouldForwardProp:void 0,styleSheet:wz,stylis:tv});aT.Consumer;Ec.createContext(void 0);function o2(){return $t.useContext(aT)}var bz=function(){function e(t,i){var u=this;this.inject=function(d,g){g===void 0&&(g=tv);var y=u.name+g.hash;d.hasNameForId(u.id,y)||d.insertRules(u.id,y,g(u.rules,y,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=i,I1(this,function(){throw cp(12,String(u.name))})}return e.prototype.getName=function(t){return t===void 0&&(t=tv),this.name+t.hash},e}(),Sz=function(e){return e>="A"&&e<="Z"};function s2(e){for(var t="",i=0;i<e.length;i++){var u=e[i];if(i===1&&u==="-"&&e[0]==="-")return e;Sz(u)?t+="-"+u.toLowerCase():t+=u}return t.startsWith("ms-")?"-"+t:t}var lT=function(e){return e==null||e===!1||e===""},uT=function(e){var t,i,u=[];for(var d in e){var g=e[d];e.hasOwnProperty(d)&&!lT(g)&&(Array.isArray(g)&&g.isCss||Fc(g)?u.push("".concat(s2(d),":"),g,";"):Yd(g)?u.push.apply(u,Zm(Zm(["".concat(d," {")],uT(g),!1),["}"],!1)):u.push("".concat(s2(d),": ").concat((t=d,(i=g)==null||typeof i=="boolean"||i===""?"":typeof i!="number"||i===0||t in G3||t.startsWith("--")?String(i).trim():"".concat(i,"px")),";")))}return u};function ql(e,t,i,u){if(lT(e))return[];if(C1(e))return[".".concat(e.styledComponentId)];if(Fc(e)){if(!Fc(g=e)||g.prototype&&g.prototype.isReactComponent||!t)return[e];var d=e(t);return ql(d,t,i,u)}var g;return e instanceof bz?i?(e.inject(i,u),[e.getName(u)]):[e]:Yd(e)?uT(e):Array.isArray(e)?Array.prototype.concat.apply(Ag,e.map(function(y){return ql(y,t,i,u)})):[e.toString()]}function Ez(e){for(var t=0;t<e.length;t+=1){var i=e[t];if(Fc(i)&&!C1(i))return!1}return!0}var kz=Qk(Pg),Tz=function(){function e(t,i,u){this.rules=t,this.staticRulesId="",this.isStatic=(u===void 0||u.isStatic)&&Ez(t),this.componentId=i,this.baseHash=gc(kz,i),this.baseStyle=u,oT.registerId(i)}return e.prototype.generateAndInjectStyles=function(t,i,u){var d=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,i,u):"";if(this.isStatic&&!u.hash)if(this.staticRulesId&&i.hasNameForId(this.componentId,this.staticRulesId))d=Ul(d,this.staticRulesId);else{var g=r2(ql(this.rules,t,i,u)),y=Q0(gc(this.baseHash,g)>>>0);if(!i.hasNameForId(this.componentId,y)){var c=u(g,".".concat(y),void 0,this.componentId);i.insertRules(this.componentId,y,c)}d=Ul(d,y),this.staticRulesId=y}else{for(var T=gc(this.baseHash,u.hash),P="",R=0;R<this.rules.length;R++){var D=this.rules[R];if(typeof D=="string")P+=D;else if(D){var A=r2(ql(D,t,i,u));T=gc(T,A+R),P+=A}}if(P){var N=Q0(T>>>0);i.hasNameForId(this.componentId,N)||i.insertRules(this.componentId,N,u(P,".".concat(N),void 0,this.componentId)),d=Ul(d,N)}}return d},e}(),cT=Ec.createContext(void 0);cT.Consumer;var $_={};function Cz(e,t,i){var u=C1(e),d=e,g=!N_(e),y=t.attrs,c=y===void 0?Ag:y,T=t.componentId,P=T===void 0?function(ne,se){var Ee=typeof ne!="string"?"sc":Yb(ne);$_[Ee]=($_[Ee]||0)+1;var ge="".concat(Ee,"-").concat(Y3(Pg+Ee+$_[Ee]));return se?"".concat(se,"-").concat(ge):ge}(t.displayName,t.parentComponentId):T,R=t.displayName,D=R===void 0?function(ne){return N_(ne)?"styled.".concat(ne):"Styled(".concat(J3(ne),")")}(e):R,A=t.displayName&&t.componentId?"".concat(Yb(t.displayName),"-").concat(t.componentId):t.componentId||P,N=u&&d.attrs?d.attrs.concat(c).filter(Boolean):c,X=t.shouldForwardProp;if(u&&d.shouldForwardProp){var U=d.shouldForwardProp;if(t.shouldForwardProp){var te=t.shouldForwardProp;X=function(ne,se){return U(ne,se)&&te(ne,se)}}else X=U}var F=new Tz(i,A,u?d.componentStyle:void 0);function $(ne,se){return function(Ee,ge,Oe){var Fe=Ee.attrs,Ge=Ee.componentStyle,it=Ee.defaultProps,ve=Ee.foldedComponentIds,je=Ee.styledComponentId,H=Ee.target,Re=Ec.useContext(cT),_t=o2(),ye=Ee.shouldForwardProp||_t.shouldForwardProp,Be=W3(ge,Re,it)||Lc,Le=function(rt,qt,Kt){for(var jt,Gt=Zi(Zi({},qt),{className:void 0,theme:Kt}),pr=0;pr<rt.length;pr+=1){var lr=Fc(jt=rt[pr])?jt(Gt):jt;for(var gr in lr)Gt[gr]=gr==="className"?Ul(Gt[gr],lr[gr]):gr==="style"?Zi(Zi({},Gt[gr]),lr[gr]):lr[gr]}return qt.className&&(Gt.className=Ul(Gt.className,qt.className)),Gt}(Fe,ge,Be),Ke=Le.as||H,xe={};for(var Te in Le)Le[Te]===void 0||Te[0]==="$"||Te==="as"||Te==="theme"&&Le.theme===Be||(Te==="forwardedAs"?xe.as=Le.forwardedAs:ye&&!ye(Te,Ke)||(xe[Te]=Le[Te]));var ft=function(rt,qt){var Kt=o2(),jt=rt.generateAndInjectStyles(qt,Kt.styleSheet,Kt.stylis);return jt}(Ge,Le),nt=Ul(ve,je);return ft&&(nt+=" "+ft),Le.className&&(nt+=" "+Le.className),xe[N_(Ke)&&!Yk.has(Ke)?"class":"className"]=nt,xe.ref=Oe,$t.createElement(Ke,xe)}(q,ne,se)}$.displayName=D;var q=Ec.forwardRef($);return q.attrs=N,q.componentStyle=F,q.displayName=D,q.shouldForwardProp=X,q.foldedComponentIds=u?Ul(d.foldedComponentIds,d.styledComponentId):"",q.styledComponentId=A,q.target=u?d.target:e,Object.defineProperty(q,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(ne){this._foldedDefaultProps=u?function(se){for(var Ee=[],ge=1;ge<arguments.length;ge++)Ee[ge-1]=arguments[ge];for(var Oe=0,Fe=Ee;Oe<Fe.length;Oe++)ev(se,Fe[Oe],!0);return se}({},d.defaultProps,ne):ne}}),I1(q,function(){return".".concat(q.styledComponentId)}),g&&nT(q,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),q}function a2(e,t){for(var i=[e[0]],u=0,d=t.length;u<d;u+=1)i.push(t[u],e[u+1]);return i}var l2=function(e){return Object.assign(e,{isCss:!0})};function hT(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(Fc(e)||Yd(e))return l2(ql(a2(Ag,Zm([e],t,!0))));var u=e;return t.length===0&&u.length===1&&typeof u[0]=="string"?ql(u):l2(ql(a2(u,t)))}function rv(e,t,i){if(i===void 0&&(i=Lc),!t)throw cp(1,t);var u=function(d){for(var g=[],y=1;y<arguments.length;y++)g[y-1]=arguments[y];return e(t,i,hT.apply(void 0,Zm([d],g,!1)))};return u.attrs=function(d){return rv(e,t,Zi(Zi({},i),{attrs:Array.prototype.concat(i.attrs,d).filter(Boolean)}))},u.withConfig=function(d){return rv(e,t,Zi(Zi({},i),d))},u}var dT=function(e){return rv(Cz,e)},hp=dT;Yk.forEach(function(e){hp[e]=dT(e)});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Xl=function(){return Xl=Object.assign||function(e){for(var t,i=1,u=arguments.length;i<u;i++)for(var d in t=arguments[i])Object.prototype.hasOwnProperty.call(t,d)&&(e[d]=t[d]);return e},Xl.apply(this,arguments)};function dp(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var u2,c2,h2,d2,p2,Iz=hT(u2||(u2=dp([`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`],[`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`])),"#0658c2","#666","#666","#666","#666","#666"),Pz=hp.label(c2||(c2=dp([`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`],[`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`])),function(e){return e.overRide?"":Iz}),Az=hp.div(h2||(h2=dp([`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`],[`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.9;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  z-index: 999;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`])),"#666","#999"),Mz=hp.div(d2||(d2=dp([`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`],[`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`])),function(e){return e.error?"red":"#666"}),zz=hp.span(p2||(p2=dp([`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`],[`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`])),"#666"),f2=function(e){return e/1024/1024},Dz=function(e){return e===void 0?"":e.map(function(t){return".".concat(t.toLowerCase())}).join(",")};function Rz(e){var t=e.types,i=e.minSize,u=e.maxSize;if(t){var d=t.toString(),g="";return u&&(g+="size >= ".concat(u,", ")),i&&(g+="size <= ".concat(i,", ")),Je.jsx("span",Xl({title:"".concat(g,"types: ").concat(d),className:"file-types"},{children:d}),void 0)}return null}function Lz(){return Je.jsxs("svg",Xl({width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[Je.jsx("path",{d:"M5.33317 6.66667H22.6665V16H25.3332V6.66667C25.3332 5.196 24.1372 4 22.6665 4H5.33317C3.8625 4 2.6665 5.196 2.6665 6.66667V22.6667C2.6665 24.1373 3.8625 25.3333 5.33317 25.3333H15.9998V22.6667H5.33317V6.66667Z",fill:"#0658C2"},void 0),Je.jsx("path",{d:"M10.6665 14.6667L6.6665 20H21.3332L15.9998 12L11.9998 17.3333L10.6665 14.6667Z",fill:"#0658C2"},void 0),Je.jsx("path",{d:"M25.3332 18.6667H22.6665V22.6667H18.6665V25.3333H22.6665V29.3333H25.3332V25.3333H29.3332V22.6667H25.3332V18.6667Z",fill:"#0658C2"},void 0)]}),void 0)}var j_=0,Fz=function(e,t,i,u,d,g){return i?Je.jsx("span",{children:"File type/size error, Hovered on types!"},void 0):Je.jsx(zz,{children:u?Je.jsx("span",{children:"Upload disabled"},void 0):Je.jsx(Je.Fragment,e||t?{children:g?Je.jsx(Je.Fragment,{children:Je.jsx("span",{children:g},void 0)},void 0):Je.jsxs(Je.Fragment,{children:[Je.jsx("span",{children:"Uploaded Successfully!"},void 0)," Upload another?"]},void 0)}:{children:Je.jsxs(Je.Fragment,d?{children:[Je.jsx("span",{children:d.split(" ")[0]},void 0)," ",d.substr(d.indexOf(" ")+1)]}:{children:[Je.jsx("span",{children:"Upload"},void 0)," or drop a file right here"]},void 0)},void 0)},void 0)},Oz=function(e){var t=e.name,i=e.hoverTitle,u=e.types,d=e.handleChange,g=e.classes,y=e.children,c=e.maxSize,T=e.minSize,P=e.fileOrFiles,R=e.onSizeError,D=e.onTypeError,A=e.onSelect,N=e.onDrop,X=e.disabled,U=e.label,te=e.uploadedLabel,F=e.multiple,$=e.required,q=e.onDraggingStateChange,ne=e.dropMessageStyle,se=e.ariaLabel,Ee=e.ariaDescribedby,ge=$t.useRef(null),Oe=$t.useRef(null),Fe=$t.useState(!1),Ge=Fe[0],it=Fe[1],ve=$t.useState(null),je=ve[0],H=ve[1],Re=$t.useState(!1),_t=Re[0],ye=Re[1],Be=function(xe){return u&&!function(Te,ft){var nt=Te.name.split(".").pop();return ft.map(function(rt){return rt.toLowerCase()}).includes(nt.toLowerCase())}(xe,u)?(ye(!0),D&&D("File type is not supported"),!1):c&&f2(xe.size)>c?(ye(!0),R&&R("File size is too big"),!1):!(T&&f2(xe.size)<T)||(ye(!0),R&&R("File size is too small"),!1)},Le=function(xe){var Te=!1;if(xe){if(xe instanceof File)Te=!Be(xe);else for(var ft=0;ft<xe.length;ft++){var nt=xe[ft];Te=!Be(nt)||Te}return!Te&&(d&&d(xe),H(xe),it(!0),ye(!1),!0)}return!1},Ke=function(xe){var Te=xe.labelRef,ft=xe.inputRef,nt=xe.multiple,rt=xe.handleChanges,qt=xe.onDrop,Kt=$t.useState(!1),jt=Kt[0],Gt=Kt[1],pr=$t.useCallback(function(){ft.current.click()},[ft]),lr=$t.useCallback(function(Ue){Ue.preventDefault(),Ue.stopPropagation(),j_++,Ue.dataTransfer.items&&Ue.dataTransfer.items.length!==0&&Gt(!0)},[]),gr=$t.useCallback(function(Ue){Ue.preventDefault(),Ue.stopPropagation(),--j_>0||Gt(!1)},[]),$r=$t.useCallback(function(Ue){Ue.preventDefault(),Ue.stopPropagation()},[]),V=$t.useCallback(function(Ue){Ue.preventDefault(),Ue.stopPropagation(),Gt(!1),j_=0;var ie=Ue.dataTransfer.files;if(ie&&ie.length>0){var de=nt?ie:ie[0],oe=rt(de);qt&&oe&&qt(de)}},[rt]);return $t.useEffect(function(){var Ue=Te.current;return Ue.addEventListener("click",pr),Ue.addEventListener("dragenter",lr),Ue.addEventListener("dragleave",gr),Ue.addEventListener("dragover",$r),Ue.addEventListener("drop",V),function(){Ue.removeEventListener("click",pr),Ue.removeEventListener("dragenter",lr),Ue.removeEventListener("dragleave",gr),Ue.removeEventListener("dragover",$r),Ue.removeEventListener("drop",V)}},[pr,lr,gr,$r,V,Te]),jt}({labelRef:ge,inputRef:Oe,multiple:F,handleChanges:Le,onDrop:N});return $t.useEffect(function(){q==null||q(Ke)},[Ke]),$t.useEffect(function(){P?(it(!0),H(P)):(Oe.current&&(Oe.current.value=""),it(!1),H(null))},[P]),Je.jsxs(Pz,Xl({overRide:y,className:"".concat(g||""," ").concat(X?"is-disabled":""),ref:ge,htmlFor:t,onClick:function(xe){xe.preventDefault(),xe.stopPropagation()},"aria-describedby":Ee,role:"button","aria-label":se},{children:[Je.jsx("input",{onClick:function(xe){xe.stopPropagation(),Oe&&Oe.current&&(Oe.current.value="",Oe.current.click())},onChange:function(xe){var Te=xe.target.files,ft=F?Te:Te[0],nt=Le(ft);A&&nt&&A(ft)},accept:Dz(u),ref:Oe,type:"file",id:t,name:t,disabled:X,multiple:F,required:$},void 0),Ke&&Je.jsx(Az,Xl({style:ne},{children:Je.jsx("span",{children:i||"Drop Here"},void 0)}),void 0),!y&&Je.jsxs(Je.Fragment,{children:[Je.jsx(Lz,{},void 0),Je.jsxs(Mz,Xl({error:_t},{children:[Fz(je,Ge,_t,X,U,te),Je.jsx(Rz,{types:u,minSize:T,maxSize:c},void 0)]}),void 0)]},void 0),y]}),void 0)};function $f(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pT={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(i){e.exports=i()})(function(){return function i(u,d,g){function y(P,R){if(!d[P]){if(!u[P]){var D=typeof $f=="function"&&$f;if(!R&&D)return D(P,!0);if(c)return c(P,!0);var A=new Error("Cannot find module '"+P+"'");throw A.code="MODULE_NOT_FOUND",A}var N=d[P]={exports:{}};u[P][0].call(N.exports,function(X){var U=u[P][1][X];return y(U||X)},N,N.exports,i,u,d,g)}return d[P].exports}for(var c=typeof $f=="function"&&$f,T=0;T<g.length;T++)y(g[T]);return y}({1:[function(i,u,d){var g=i("./utils"),y=i("./support"),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(T){for(var P,R,D,A,N,X,U,te=[],F=0,$=T.length,q=$,ne=g.getTypeOf(T)!=="string";F<T.length;)q=$-F,D=ne?(P=T[F++],R=F<$?T[F++]:0,F<$?T[F++]:0):(P=T.charCodeAt(F++),R=F<$?T.charCodeAt(F++):0,F<$?T.charCodeAt(F++):0),A=P>>2,N=(3&P)<<4|R>>4,X=1<q?(15&R)<<2|D>>6:64,U=2<q?63&D:64,te.push(c.charAt(A)+c.charAt(N)+c.charAt(X)+c.charAt(U));return te.join("")},d.decode=function(T){var P,R,D,A,N,X,U=0,te=0,F="data:";if(T.substr(0,F.length)===F)throw new Error("Invalid base64 input, it looks like a data url.");var $,q=3*(T=T.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(T.charAt(T.length-1)===c.charAt(64)&&q--,T.charAt(T.length-2)===c.charAt(64)&&q--,q%1!=0)throw new Error("Invalid base64 input, bad content length.");for($=y.uint8array?new Uint8Array(0|q):new Array(0|q);U<T.length;)P=c.indexOf(T.charAt(U++))<<2|(A=c.indexOf(T.charAt(U++)))>>4,R=(15&A)<<4|(N=c.indexOf(T.charAt(U++)))>>2,D=(3&N)<<6|(X=c.indexOf(T.charAt(U++))),$[te++]=P,N!==64&&($[te++]=R),X!==64&&($[te++]=D);return $}},{"./support":30,"./utils":32}],2:[function(i,u,d){var g=i("./external"),y=i("./stream/DataWorker"),c=i("./stream/Crc32Probe"),T=i("./stream/DataLengthProbe");function P(R,D,A,N,X){this.compressedSize=R,this.uncompressedSize=D,this.crc32=A,this.compression=N,this.compressedContent=X}P.prototype={getContentWorker:function(){var R=new y(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new T("data_length")),D=this;return R.on("end",function(){if(this.streamInfo.data_length!==D.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),R},getCompressedWorker:function(){return new y(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},P.createWorkerFrom=function(R,D,A){return R.pipe(new c).pipe(new T("uncompressedSize")).pipe(D.compressWorker(A)).pipe(new T("compressedSize")).withStreamInfo("compression",D)},u.exports=P},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(i,u,d){var g=i("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},d.DEFLATE=i("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(i,u,d){var g=i("./utils"),y=function(){for(var c,T=[],P=0;P<256;P++){c=P;for(var R=0;R<8;R++)c=1&c?3988292384^c>>>1:c>>>1;T[P]=c}return T}();u.exports=function(c,T){return c!==void 0&&c.length?g.getTypeOf(c)!=="string"?function(P,R,D,A){var N=y,X=A+D;P^=-1;for(var U=A;U<X;U++)P=P>>>8^N[255&(P^R[U])];return-1^P}(0|T,c,c.length,0):function(P,R,D,A){var N=y,X=A+D;P^=-1;for(var U=A;U<X;U++)P=P>>>8^N[255&(P^R.charCodeAt(U))];return-1^P}(0|T,c,c.length,0):0}},{"./utils":32}],5:[function(i,u,d){d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(i,u,d){var g=null;g=typeof Promise<"u"?Promise:i("lie"),u.exports={Promise:g}},{lie:37}],7:[function(i,u,d){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",y=i("pako"),c=i("./utils"),T=i("./stream/GenericWorker"),P=g?"uint8array":"array";function R(D,A){T.call(this,"FlateWorker/"+D),this._pako=null,this._pakoAction=D,this._pakoOptions=A,this.meta={}}d.magic="\b\0",c.inherits(R,T),R.prototype.processChunk=function(D){this.meta=D.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(P,D.data),!1)},R.prototype.flush=function(){T.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},R.prototype.cleanUp=function(){T.prototype.cleanUp.call(this),this._pako=null},R.prototype._createPako=function(){this._pako=new y[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var D=this;this._pako.onData=function(A){D.push({data:A,meta:D.meta})}},d.compressWorker=function(D){return new R("Deflate",D)},d.uncompressWorker=function(){return new R("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(i,u,d){function g(N,X){var U,te="";for(U=0;U<X;U++)te+=String.fromCharCode(255&N),N>>>=8;return te}function y(N,X,U,te,F,$){var q,ne,se=N.file,Ee=N.compression,ge=$!==P.utf8encode,Oe=c.transformTo("string",$(se.name)),Fe=c.transformTo("string",P.utf8encode(se.name)),Ge=se.comment,it=c.transformTo("string",$(Ge)),ve=c.transformTo("string",P.utf8encode(Ge)),je=Fe.length!==se.name.length,H=ve.length!==Ge.length,Re="",_t="",ye="",Be=se.dir,Le=se.date,Ke={crc32:0,compressedSize:0,uncompressedSize:0};X&&!U||(Ke.crc32=N.crc32,Ke.compressedSize=N.compressedSize,Ke.uncompressedSize=N.uncompressedSize);var xe=0;X&&(xe|=8),ge||!je&&!H||(xe|=2048);var Te=0,ft=0;Be&&(Te|=16),F==="UNIX"?(ft=798,Te|=function(rt,qt){var Kt=rt;return rt||(Kt=qt?16893:33204),(65535&Kt)<<16}(se.unixPermissions,Be)):(ft=20,Te|=function(rt){return 63&(rt||0)}(se.dosPermissions)),q=Le.getUTCHours(),q<<=6,q|=Le.getUTCMinutes(),q<<=5,q|=Le.getUTCSeconds()/2,ne=Le.getUTCFullYear()-1980,ne<<=4,ne|=Le.getUTCMonth()+1,ne<<=5,ne|=Le.getUTCDate(),je&&(_t=g(1,1)+g(R(Oe),4)+Fe,Re+="up"+g(_t.length,2)+_t),H&&(ye=g(1,1)+g(R(it),4)+ve,Re+="uc"+g(ye.length,2)+ye);var nt="";return nt+=`
\0`,nt+=g(xe,2),nt+=Ee.magic,nt+=g(q,2),nt+=g(ne,2),nt+=g(Ke.crc32,4),nt+=g(Ke.compressedSize,4),nt+=g(Ke.uncompressedSize,4),nt+=g(Oe.length,2),nt+=g(Re.length,2),{fileRecord:D.LOCAL_FILE_HEADER+nt+Oe+Re,dirRecord:D.CENTRAL_FILE_HEADER+g(ft,2)+nt+g(it.length,2)+"\0\0\0\0"+g(Te,4)+g(te,4)+Oe+Re+it}}var c=i("../utils"),T=i("../stream/GenericWorker"),P=i("../utf8"),R=i("../crc32"),D=i("../signature");function A(N,X,U,te){T.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=X,this.zipPlatform=U,this.encodeFileName=te,this.streamFiles=N,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}c.inherits(A,T),A.prototype.push=function(N){var X=N.meta.percent||0,U=this.entriesCount,te=this._sources.length;this.accumulate?this.contentBuffer.push(N):(this.bytesWritten+=N.data.length,T.prototype.push.call(this,{data:N.data,meta:{currentFile:this.currentFile,percent:U?(X+100*(U-te-1))/U:100}}))},A.prototype.openedSource=function(N){this.currentSourceOffset=this.bytesWritten,this.currentFile=N.file.name;var X=this.streamFiles&&!N.file.dir;if(X){var U=y(N,X,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:U.fileRecord,meta:{percent:0}})}else this.accumulate=!0},A.prototype.closedSource=function(N){this.accumulate=!1;var X=this.streamFiles&&!N.file.dir,U=y(N,X,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(U.dirRecord),X)this.push({data:function(te){return D.DATA_DESCRIPTOR+g(te.crc32,4)+g(te.compressedSize,4)+g(te.uncompressedSize,4)}(N),meta:{percent:100}});else for(this.push({data:U.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},A.prototype.flush=function(){for(var N=this.bytesWritten,X=0;X<this.dirRecords.length;X++)this.push({data:this.dirRecords[X],meta:{percent:100}});var U=this.bytesWritten-N,te=function(F,$,q,ne,se){var Ee=c.transformTo("string",se(ne));return D.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(F,2)+g(F,2)+g($,4)+g(q,4)+g(Ee.length,2)+Ee}(this.dirRecords.length,U,N,this.zipComment,this.encodeFileName);this.push({data:te,meta:{percent:100}})},A.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},A.prototype.registerPrevious=function(N){this._sources.push(N);var X=this;return N.on("data",function(U){X.processChunk(U)}),N.on("end",function(){X.closedSource(X.previous.streamInfo),X._sources.length?X.prepareNextSource():X.end()}),N.on("error",function(U){X.error(U)}),this},A.prototype.resume=function(){return!!T.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},A.prototype.error=function(N){var X=this._sources;if(!T.prototype.error.call(this,N))return!1;for(var U=0;U<X.length;U++)try{X[U].error(N)}catch{}return!0},A.prototype.lock=function(){T.prototype.lock.call(this);for(var N=this._sources,X=0;X<N.length;X++)N[X].lock()},u.exports=A},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(i,u,d){var g=i("../compressions"),y=i("./ZipFileWorker");d.generateWorker=function(c,T,P){var R=new y(T.streamFiles,P,T.platform,T.encodeFileName),D=0;try{c.forEach(function(A,N){D++;var X=function($,q){var ne=$||q,se=g[ne];if(!se)throw new Error(ne+" is not a valid compression method !");return se}(N.options.compression,T.compression),U=N.options.compressionOptions||T.compressionOptions||{},te=N.dir,F=N.date;N._compressWorker(X,U).withStreamInfo("file",{name:A,dir:te,date:F,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(R)}),R.entriesCount=D}catch(A){R.error(A)}return R}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(i,u,d){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var y=new g;for(var c in this)typeof this[c]!="function"&&(y[c]=this[c]);return y}}(g.prototype=i("./object")).loadAsync=i("./load"),g.support=i("./support"),g.defaults=i("./defaults"),g.version="3.10.1",g.loadAsync=function(y,c){return new g().loadAsync(y,c)},g.external=i("./external"),u.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(i,u,d){var g=i("./utils"),y=i("./external"),c=i("./utf8"),T=i("./zipEntries"),P=i("./stream/Crc32Probe"),R=i("./nodejsUtils");function D(A){return new y.Promise(function(N,X){var U=A.decompressed.getContentWorker().pipe(new P);U.on("error",function(te){X(te)}).on("end",function(){U.streamInfo.crc32!==A.decompressed.crc32?X(new Error("Corrupted zip : CRC32 mismatch")):N()}).resume()})}u.exports=function(A,N){var X=this;return N=g.extend(N||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode}),R.isNode&&R.isStream(A)?y.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",A,!0,N.optimizedBinaryString,N.base64).then(function(U){var te=new T(N);return te.load(U),te}).then(function(U){var te=[y.Promise.resolve(U)],F=U.files;if(N.checkCRC32)for(var $=0;$<F.length;$++)te.push(D(F[$]));return y.Promise.all(te)}).then(function(U){for(var te=U.shift(),F=te.files,$=0;$<F.length;$++){var q=F[$],ne=q.fileNameStr,se=g.resolve(q.fileNameStr);X.file(se,q.decompressed,{binary:!0,optimizedBinaryString:!0,date:q.date,dir:q.dir,comment:q.fileCommentStr.length?q.fileCommentStr:null,unixPermissions:q.unixPermissions,dosPermissions:q.dosPermissions,createFolders:N.createFolders}),q.dir||(X.file(se).unsafeOriginalName=ne)}return te.zipComment.length&&(X.comment=te.zipComment),X})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(i,u,d){var g=i("../utils"),y=i("../stream/GenericWorker");function c(T,P){y.call(this,"Nodejs stream input adapter for "+T),this._upstreamEnded=!1,this._bindStream(P)}g.inherits(c,y),c.prototype._bindStream=function(T){var P=this;(this._stream=T).pause(),T.on("data",function(R){P.push({data:R,meta:{percent:0}})}).on("error",function(R){P.isPaused?this.generatedError=R:P.error(R)}).on("end",function(){P.isPaused?P._upstreamEnded=!0:P.end()})},c.prototype.pause=function(){return!!y.prototype.pause.call(this)&&(this._stream.pause(),!0)},c.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},u.exports=c},{"../stream/GenericWorker":28,"../utils":32}],13:[function(i,u,d){var g=i("readable-stream").Readable;function y(c,T,P){g.call(this,T),this._helper=c;var R=this;c.on("data",function(D,A){R.push(D)||R._helper.pause(),P&&P(A)}).on("error",function(D){R.emit("error",D)}).on("end",function(){R.push(null)})}i("../utils").inherits(y,g),y.prototype._read=function(){this._helper.resume()},u.exports=y},{"../utils":32,"readable-stream":16}],14:[function(i,u,d){u.exports={isNode:typeof Buffer<"u",newBufferFrom:function(g,y){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(g,y);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new Buffer(g,y)},allocBuffer:function(g){if(Buffer.alloc)return Buffer.alloc(g);var y=new Buffer(g);return y.fill(0),y},isBuffer:function(g){return Buffer.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(i,u,d){function g(se,Ee,ge){var Oe,Fe=c.getTypeOf(Ee),Ge=c.extend(ge||{},R);Ge.date=Ge.date||new Date,Ge.compression!==null&&(Ge.compression=Ge.compression.toUpperCase()),typeof Ge.unixPermissions=="string"&&(Ge.unixPermissions=parseInt(Ge.unixPermissions,8)),Ge.unixPermissions&&16384&Ge.unixPermissions&&(Ge.dir=!0),Ge.dosPermissions&&16&Ge.dosPermissions&&(Ge.dir=!0),Ge.dir&&(se=F(se)),Ge.createFolders&&(Oe=te(se))&&$.call(this,Oe,!0);var it=Fe==="string"&&Ge.binary===!1&&Ge.base64===!1;ge&&ge.binary!==void 0||(Ge.binary=!it),(Ee instanceof D&&Ee.uncompressedSize===0||Ge.dir||!Ee||Ee.length===0)&&(Ge.base64=!1,Ge.binary=!0,Ee="",Ge.compression="STORE",Fe="string");var ve=null;ve=Ee instanceof D||Ee instanceof T?Ee:X.isNode&&X.isStream(Ee)?new U(se,Ee):c.prepareContent(se,Ee,Ge.binary,Ge.optimizedBinaryString,Ge.base64);var je=new A(se,ve,Ge);this.files[se]=je}var y=i("./utf8"),c=i("./utils"),T=i("./stream/GenericWorker"),P=i("./stream/StreamHelper"),R=i("./defaults"),D=i("./compressedObject"),A=i("./zipObject"),N=i("./generate"),X=i("./nodejsUtils"),U=i("./nodejs/NodejsStreamInputAdapter"),te=function(se){se.slice(-1)==="/"&&(se=se.substring(0,se.length-1));var Ee=se.lastIndexOf("/");return 0<Ee?se.substring(0,Ee):""},F=function(se){return se.slice(-1)!=="/"&&(se+="/"),se},$=function(se,Ee){return Ee=Ee!==void 0?Ee:R.createFolders,se=F(se),this.files[se]||g.call(this,se,null,{dir:!0,createFolders:Ee}),this.files[se]};function q(se){return Object.prototype.toString.call(se)==="[object RegExp]"}var ne={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(se){var Ee,ge,Oe;for(Ee in this.files)Oe=this.files[Ee],(ge=Ee.slice(this.root.length,Ee.length))&&Ee.slice(0,this.root.length)===this.root&&se(ge,Oe)},filter:function(se){var Ee=[];return this.forEach(function(ge,Oe){se(ge,Oe)&&Ee.push(Oe)}),Ee},file:function(se,Ee,ge){if(arguments.length!==1)return se=this.root+se,g.call(this,se,Ee,ge),this;if(q(se)){var Oe=se;return this.filter(function(Ge,it){return!it.dir&&Oe.test(Ge)})}var Fe=this.files[this.root+se];return Fe&&!Fe.dir?Fe:null},folder:function(se){if(!se)return this;if(q(se))return this.filter(function(Fe,Ge){return Ge.dir&&se.test(Fe)});var Ee=this.root+se,ge=$.call(this,Ee),Oe=this.clone();return Oe.root=ge.name,Oe},remove:function(se){se=this.root+se;var Ee=this.files[se];if(Ee||(se.slice(-1)!=="/"&&(se+="/"),Ee=this.files[se]),Ee&&!Ee.dir)delete this.files[se];else for(var ge=this.filter(function(Fe,Ge){return Ge.name.slice(0,se.length)===se}),Oe=0;Oe<ge.length;Oe++)delete this.files[ge[Oe].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(se){var Ee,ge={};try{if((ge=c.extend(se||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:y.utf8encode})).type=ge.type.toLowerCase(),ge.compression=ge.compression.toUpperCase(),ge.type==="binarystring"&&(ge.type="string"),!ge.type)throw new Error("No output type specified.");c.checkSupport(ge.type),ge.platform!=="darwin"&&ge.platform!=="freebsd"&&ge.platform!=="linux"&&ge.platform!=="sunos"||(ge.platform="UNIX"),ge.platform==="win32"&&(ge.platform="DOS");var Oe=ge.comment||this.comment||"";Ee=N.generateWorker(this,ge,Oe)}catch(Fe){(Ee=new T("error")).error(Fe)}return new P(Ee,ge.type||"string",ge.mimeType)},generateAsync:function(se,Ee){return this.generateInternalStream(se).accumulate(Ee)},generateNodeStream:function(se,Ee){return(se=se||{}).type||(se.type="nodebuffer"),this.generateInternalStream(se).toNodejsStream(Ee)}};u.exports=ne},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(i,u,d){u.exports=i("stream")},{stream:void 0}],17:[function(i,u,d){var g=i("./DataReader");function y(c){g.call(this,c);for(var T=0;T<this.data.length;T++)c[T]=255&c[T]}i("../utils").inherits(y,g),y.prototype.byteAt=function(c){return this.data[this.zero+c]},y.prototype.lastIndexOfSignature=function(c){for(var T=c.charCodeAt(0),P=c.charCodeAt(1),R=c.charCodeAt(2),D=c.charCodeAt(3),A=this.length-4;0<=A;--A)if(this.data[A]===T&&this.data[A+1]===P&&this.data[A+2]===R&&this.data[A+3]===D)return A-this.zero;return-1},y.prototype.readAndCheckSignature=function(c){var T=c.charCodeAt(0),P=c.charCodeAt(1),R=c.charCodeAt(2),D=c.charCodeAt(3),A=this.readData(4);return T===A[0]&&P===A[1]&&R===A[2]&&D===A[3]},y.prototype.readData=function(c){if(this.checkOffset(c),c===0)return[];var T=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,T},u.exports=y},{"../utils":32,"./DataReader":18}],18:[function(i,u,d){var g=i("../utils");function y(c){this.data=c,this.length=c.length,this.index=0,this.zero=0}y.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.length<this.zero+c||c<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+c+"). Corrupted zip ?")},setIndex:function(c){this.checkIndex(c),this.index=c},skip:function(c){this.setIndex(this.index+c)},byteAt:function(){},readInt:function(c){var T,P=0;for(this.checkOffset(c),T=this.index+c-1;T>=this.index;T--)P=(P<<8)+this.byteAt(T);return this.index+=c,P},readString:function(c){return g.transformTo("string",this.readData(c))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var c=this.readInt(4);return new Date(Date.UTC(1980+(c>>25&127),(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(31&c)<<1))}},u.exports=y},{"../utils":32}],19:[function(i,u,d){var g=i("./Uint8ArrayReader");function y(c){g.call(this,c)}i("../utils").inherits(y,g),y.prototype.readData=function(c){this.checkOffset(c);var T=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,T},u.exports=y},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(i,u,d){var g=i("./DataReader");function y(c){g.call(this,c)}i("../utils").inherits(y,g),y.prototype.byteAt=function(c){return this.data.charCodeAt(this.zero+c)},y.prototype.lastIndexOfSignature=function(c){return this.data.lastIndexOf(c)-this.zero},y.prototype.readAndCheckSignature=function(c){return c===this.readData(4)},y.prototype.readData=function(c){this.checkOffset(c);var T=this.data.slice(this.zero+this.index,this.zero+this.index+c);return this.index+=c,T},u.exports=y},{"../utils":32,"./DataReader":18}],21:[function(i,u,d){var g=i("./ArrayReader");function y(c){g.call(this,c)}i("../utils").inherits(y,g),y.prototype.readData=function(c){if(this.checkOffset(c),c===0)return new Uint8Array(0);var T=this.data.subarray(this.zero+this.index,this.zero+this.index+c);return this.index+=c,T},u.exports=y},{"../utils":32,"./ArrayReader":17}],22:[function(i,u,d){var g=i("../utils"),y=i("../support"),c=i("./ArrayReader"),T=i("./StringReader"),P=i("./NodeBufferReader"),R=i("./Uint8ArrayReader");u.exports=function(D){var A=g.getTypeOf(D);return g.checkSupport(A),A!=="string"||y.uint8array?A==="nodebuffer"?new P(D):y.uint8array?new R(g.transformTo("uint8array",D)):new c(g.transformTo("array",D)):new T(D)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(i,u,d){d.LOCAL_FILE_HEADER="PK",d.CENTRAL_FILE_HEADER="PK",d.CENTRAL_DIRECTORY_END="PK",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(i,u,d){var g=i("./GenericWorker"),y=i("../utils");function c(T){g.call(this,"ConvertWorker to "+T),this.destType=T}y.inherits(c,g),c.prototype.processChunk=function(T){this.push({data:y.transformTo(this.destType,T.data),meta:T.meta})},u.exports=c},{"../utils":32,"./GenericWorker":28}],25:[function(i,u,d){var g=i("./GenericWorker"),y=i("../crc32");function c(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}i("../utils").inherits(c,g),c.prototype.processChunk=function(T){this.streamInfo.crc32=y(T.data,this.streamInfo.crc32||0),this.push(T)},u.exports=c},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(i,u,d){var g=i("../utils"),y=i("./GenericWorker");function c(T){y.call(this,"DataLengthProbe for "+T),this.propName=T,this.withStreamInfo(T,0)}g.inherits(c,y),c.prototype.processChunk=function(T){if(T){var P=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=P+T.data.length}y.prototype.processChunk.call(this,T)},u.exports=c},{"../utils":32,"./GenericWorker":28}],27:[function(i,u,d){var g=i("../utils"),y=i("./GenericWorker");function c(T){y.call(this,"DataWorker");var P=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,T.then(function(R){P.dataIsReady=!0,P.data=R,P.max=R&&R.length||0,P.type=g.getTypeOf(R),P.isPaused||P._tickAndRepeat()},function(R){P.error(R)})}g.inherits(c,y),c.prototype.cleanUp=function(){y.prototype.cleanUp.call(this),this.data=null},c.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},c.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},c.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var T=null,P=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":T=this.data.substring(this.index,P);break;case"uint8array":T=this.data.subarray(this.index,P);break;case"array":case"nodebuffer":T=this.data.slice(this.index,P)}return this.index=P,this.push({data:T,meta:{percent:this.max?this.index/this.max*100:0}})},u.exports=c},{"../utils":32,"./GenericWorker":28}],28:[function(i,u,d){function g(y){this.name=y||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(y){this.emit("data",y)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(y){this.emit("error",y)}return!0},error:function(y){return!this.isFinished&&(this.isPaused?this.generatedError=y:(this.isFinished=!0,this.emit("error",y),this.previous&&this.previous.error(y),this.cleanUp()),!0)},on:function(y,c){return this._listeners[y].push(c),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(y,c){if(this._listeners[y])for(var T=0;T<this._listeners[y].length;T++)this._listeners[y][T].call(this,c)},pipe:function(y){return y.registerPrevious(this)},registerPrevious:function(y){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=y.streamInfo,this.mergeStreamInfo(),this.previous=y;var c=this;return y.on("data",function(T){c.processChunk(T)}),y.on("end",function(){c.end()}),y.on("error",function(T){c.error(T)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var y=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),y=!0),this.previous&&this.previous.resume(),!y},flush:function(){},processChunk:function(y){this.push(y)},withStreamInfo:function(y,c){return this.extraStreamInfo[y]=c,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var y in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,y)&&(this.streamInfo[y]=this.extraStreamInfo[y])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var y="Worker "+this.name;return this.previous?this.previous+" -> "+y:y}},u.exports=g},{}],29:[function(i,u,d){var g=i("../utils"),y=i("./ConvertWorker"),c=i("./GenericWorker"),T=i("../base64"),P=i("../support"),R=i("../external"),D=null;if(P.nodestream)try{D=i("../nodejs/NodejsStreamOutputAdapter")}catch{}function A(X,U){return new R.Promise(function(te,F){var $=[],q=X._internalType,ne=X._outputType,se=X._mimeType;X.on("data",function(Ee,ge){$.push(Ee),U&&U(ge)}).on("error",function(Ee){$=[],F(Ee)}).on("end",function(){try{var Ee=function(ge,Oe,Fe){switch(ge){case"blob":return g.newBlob(g.transformTo("arraybuffer",Oe),Fe);case"base64":return T.encode(Oe);default:return g.transformTo(ge,Oe)}}(ne,function(ge,Oe){var Fe,Ge=0,it=null,ve=0;for(Fe=0;Fe<Oe.length;Fe++)ve+=Oe[Fe].length;switch(ge){case"string":return Oe.join("");case"array":return Array.prototype.concat.apply([],Oe);case"uint8array":for(it=new Uint8Array(ve),Fe=0;Fe<Oe.length;Fe++)it.set(Oe[Fe],Ge),Ge+=Oe[Fe].length;return it;case"nodebuffer":return Buffer.concat(Oe);default:throw new Error("concat : unsupported type '"+ge+"'")}}(q,$),se);te(Ee)}catch(ge){F(ge)}$=[]}).resume()})}function N(X,U,te){var F=U;switch(U){case"blob":case"arraybuffer":F="uint8array";break;case"base64":F="string"}try{this._internalType=F,this._outputType=U,this._mimeType=te,g.checkSupport(F),this._worker=X.pipe(new y(F)),X.lock()}catch($){this._worker=new c("error"),this._worker.error($)}}N.prototype={accumulate:function(X){return A(this,X)},on:function(X,U){var te=this;return X==="data"?this._worker.on(X,function(F){U.call(te,F.data,F.meta)}):this._worker.on(X,function(){g.delay(U,arguments,te)}),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(X){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new D(this,{objectMode:this._outputType!=="nodebuffer"},X)}},u.exports=N},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(i,u,d){if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var g=new ArrayBuffer(0);try{d.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);y.append(g),d.blob=y.getBlob("application/zip").size===0}catch{d.blob=!1}}}try{d.nodestream=!!i("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(i,u,d){for(var g=i("./utils"),y=i("./support"),c=i("./nodejsUtils"),T=i("./stream/GenericWorker"),P=new Array(256),R=0;R<256;R++)P[R]=252<=R?6:248<=R?5:240<=R?4:224<=R?3:192<=R?2:1;P[254]=P[254]=1;function D(){T.call(this,"utf-8 decode"),this.leftOver=null}function A(){T.call(this,"utf-8 encode")}d.utf8encode=function(N){return y.nodebuffer?c.newBufferFrom(N,"utf-8"):function(X){var U,te,F,$,q,ne=X.length,se=0;for($=0;$<ne;$++)(64512&(te=X.charCodeAt($)))==55296&&$+1<ne&&(64512&(F=X.charCodeAt($+1)))==56320&&(te=65536+(te-55296<<10)+(F-56320),$++),se+=te<128?1:te<2048?2:te<65536?3:4;for(U=y.uint8array?new Uint8Array(se):new Array(se),$=q=0;q<se;$++)(64512&(te=X.charCodeAt($)))==55296&&$+1<ne&&(64512&(F=X.charCodeAt($+1)))==56320&&(te=65536+(te-55296<<10)+(F-56320),$++),te<128?U[q++]=te:(te<2048?U[q++]=192|te>>>6:(te<65536?U[q++]=224|te>>>12:(U[q++]=240|te>>>18,U[q++]=128|te>>>12&63),U[q++]=128|te>>>6&63),U[q++]=128|63&te);return U}(N)},d.utf8decode=function(N){return y.nodebuffer?g.transformTo("nodebuffer",N).toString("utf-8"):function(X){var U,te,F,$,q=X.length,ne=new Array(2*q);for(U=te=0;U<q;)if((F=X[U++])<128)ne[te++]=F;else if(4<($=P[F]))ne[te++]=65533,U+=$-1;else{for(F&=$===2?31:$===3?15:7;1<$&&U<q;)F=F<<6|63&X[U++],$--;1<$?ne[te++]=65533:F<65536?ne[te++]=F:(F-=65536,ne[te++]=55296|F>>10&1023,ne[te++]=56320|1023&F)}return ne.length!==te&&(ne.subarray?ne=ne.subarray(0,te):ne.length=te),g.applyFromCharCode(ne)}(N=g.transformTo(y.uint8array?"uint8array":"array",N))},g.inherits(D,T),D.prototype.processChunk=function(N){var X=g.transformTo(y.uint8array?"uint8array":"array",N.data);if(this.leftOver&&this.leftOver.length){if(y.uint8array){var U=X;(X=new Uint8Array(U.length+this.leftOver.length)).set(this.leftOver,0),X.set(U,this.leftOver.length)}else X=this.leftOver.concat(X);this.leftOver=null}var te=function($,q){var ne;for((q=q||$.length)>$.length&&(q=$.length),ne=q-1;0<=ne&&(192&$[ne])==128;)ne--;return ne<0||ne===0?q:ne+P[$[ne]]>q?ne:q}(X),F=X;te!==X.length&&(y.uint8array?(F=X.subarray(0,te),this.leftOver=X.subarray(te,X.length)):(F=X.slice(0,te),this.leftOver=X.slice(te,X.length))),this.push({data:d.utf8decode(F),meta:N.meta})},D.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=D,g.inherits(A,T),A.prototype.processChunk=function(N){this.push({data:d.utf8encode(N.data),meta:N.meta})},d.Utf8EncodeWorker=A},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(i,u,d){var g=i("./support"),y=i("./base64"),c=i("./nodejsUtils"),T=i("./external");function P(U){return U}function R(U,te){for(var F=0;F<U.length;++F)te[F]=255&U.charCodeAt(F);return te}i("setimmediate"),d.newBlob=function(U,te){d.checkSupport("blob");try{return new Blob([U],{type:te})}catch{try{var F=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return F.append(U),F.getBlob(te)}catch{throw new Error("Bug : can't construct the Blob.")}}};var D={stringifyByChunk:function(U,te,F){var $=[],q=0,ne=U.length;if(ne<=F)return String.fromCharCode.apply(null,U);for(;q<ne;)te==="array"||te==="nodebuffer"?$.push(String.fromCharCode.apply(null,U.slice(q,Math.min(q+F,ne)))):$.push(String.fromCharCode.apply(null,U.subarray(q,Math.min(q+F,ne)))),q+=F;return $.join("")},stringifyByChar:function(U){for(var te="",F=0;F<U.length;F++)te+=String.fromCharCode(U[F]);return te},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch{return!1}}()}};function A(U){var te=65536,F=d.getTypeOf(U),$=!0;if(F==="uint8array"?$=D.applyCanBeUsed.uint8array:F==="nodebuffer"&&($=D.applyCanBeUsed.nodebuffer),$)for(;1<te;)try{return D.stringifyByChunk(U,F,te)}catch{te=Math.floor(te/2)}return D.stringifyByChar(U)}function N(U,te){for(var F=0;F<U.length;F++)te[F]=U[F];return te}d.applyFromCharCode=A;var X={};X.string={string:P,array:function(U){return R(U,new Array(U.length))},arraybuffer:function(U){return X.string.uint8array(U).buffer},uint8array:function(U){return R(U,new Uint8Array(U.length))},nodebuffer:function(U){return R(U,c.allocBuffer(U.length))}},X.array={string:A,array:P,arraybuffer:function(U){return new Uint8Array(U).buffer},uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return c.newBufferFrom(U)}},X.arraybuffer={string:function(U){return A(new Uint8Array(U))},array:function(U){return N(new Uint8Array(U),new Array(U.byteLength))},arraybuffer:P,uint8array:function(U){return new Uint8Array(U)},nodebuffer:function(U){return c.newBufferFrom(new Uint8Array(U))}},X.uint8array={string:A,array:function(U){return N(U,new Array(U.length))},arraybuffer:function(U){return U.buffer},uint8array:P,nodebuffer:function(U){return c.newBufferFrom(U)}},X.nodebuffer={string:A,array:function(U){return N(U,new Array(U.length))},arraybuffer:function(U){return X.nodebuffer.uint8array(U).buffer},uint8array:function(U){return N(U,new Uint8Array(U.length))},nodebuffer:P},d.transformTo=function(U,te){if(te=te||"",!U)return te;d.checkSupport(U);var F=d.getTypeOf(te);return X[F][U](te)},d.resolve=function(U){for(var te=U.split("/"),F=[],$=0;$<te.length;$++){var q=te[$];q==="."||q===""&&$!==0&&$!==te.length-1||(q===".."?F.pop():F.push(q))}return F.join("/")},d.getTypeOf=function(U){return typeof U=="string"?"string":Object.prototype.toString.call(U)==="[object Array]"?"array":g.nodebuffer&&c.isBuffer(U)?"nodebuffer":g.uint8array&&U instanceof Uint8Array?"uint8array":g.arraybuffer&&U instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(U){if(!g[U.toLowerCase()])throw new Error(U+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(U){var te,F,$="";for(F=0;F<(U||"").length;F++)$+="\\x"+((te=U.charCodeAt(F))<16?"0":"")+te.toString(16).toUpperCase();return $},d.delay=function(U,te,F){setImmediate(function(){U.apply(F||null,te||[])})},d.inherits=function(U,te){function F(){}F.prototype=te.prototype,U.prototype=new F},d.extend=function(){var U,te,F={};for(U=0;U<arguments.length;U++)for(te in arguments[U])Object.prototype.hasOwnProperty.call(arguments[U],te)&&F[te]===void 0&&(F[te]=arguments[U][te]);return F},d.prepareContent=function(U,te,F,$,q){return T.Promise.resolve(te).then(function(ne){return g.blob&&(ne instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ne))!==-1)&&typeof FileReader<"u"?new T.Promise(function(se,Ee){var ge=new FileReader;ge.onload=function(Oe){se(Oe.target.result)},ge.onerror=function(Oe){Ee(Oe.target.error)},ge.readAsArrayBuffer(ne)}):ne}).then(function(ne){var se=d.getTypeOf(ne);return se?(se==="arraybuffer"?ne=d.transformTo("uint8array",ne):se==="string"&&(q?ne=y.decode(ne):F&&$!==!0&&(ne=function(Ee){return R(Ee,g.uint8array?new Uint8Array(Ee.length):new Array(Ee.length))}(ne))),ne):T.Promise.reject(new Error("Can't read the data of '"+U+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(i,u,d){var g=i("./reader/readerFor"),y=i("./utils"),c=i("./signature"),T=i("./zipEntry"),P=i("./support");function R(D){this.files=[],this.loadOptions=D}R.prototype={checkSignature:function(D){if(!this.reader.readAndCheckSignature(D)){this.reader.index-=4;var A=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+y.pretty(A)+", expected "+y.pretty(D)+")")}},isSignature:function(D,A){var N=this.reader.index;this.reader.setIndex(D);var X=this.reader.readString(4)===A;return this.reader.setIndex(N),X},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var D=this.reader.readData(this.zipCommentLength),A=P.uint8array?"uint8array":"array",N=y.transformTo(A,D);this.zipComment=this.loadOptions.decodeFileName(N)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var D,A,N,X=this.zip64EndOfCentralSize-44;0<X;)D=this.reader.readInt(2),A=this.reader.readInt(4),N=this.reader.readData(A),this.zip64ExtensibleData[D]={id:D,length:A,value:N}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var D,A;for(D=0;D<this.files.length;D++)A=this.files[D],this.reader.setIndex(A.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),A.readLocalPart(this.reader),A.handleUTF8(),A.processAttributes()},readCentralDir:function(){var D;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER);)(D=new T({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(D);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var D=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(D<0)throw this.isSignature(0,c.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(D);var A=D;if(this.checkSignature(c.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===y.MAX_VALUE_16BITS||this.diskWithCentralDirStart===y.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===y.MAX_VALUE_16BITS||this.centralDirRecords===y.MAX_VALUE_16BITS||this.centralDirSize===y.MAX_VALUE_32BITS||this.centralDirOffset===y.MAX_VALUE_32BITS){if(this.zip64=!0,(D=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(D),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var N=this.centralDirOffset+this.centralDirSize;this.zip64&&(N+=20,N+=12+this.zip64EndOfCentralSize);var X=A-N;if(0<X)this.isSignature(A,c.CENTRAL_FILE_HEADER)||(this.reader.zero=X);else if(X<0)throw new Error("Corrupted zip: missing "+Math.abs(X)+" bytes.")},prepareReader:function(D){this.reader=g(D)},load:function(D){this.prepareReader(D),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},u.exports=R},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(i,u,d){var g=i("./reader/readerFor"),y=i("./utils"),c=i("./compressedObject"),T=i("./crc32"),P=i("./utf8"),R=i("./compressions"),D=i("./support");function A(N,X){this.options=N,this.loadOptions=X}A.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(N){var X,U;if(N.skip(22),this.fileNameLength=N.readInt(2),U=N.readInt(2),this.fileName=N.readData(this.fileNameLength),N.skip(U),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((X=function(te){for(var F in R)if(Object.prototype.hasOwnProperty.call(R,F)&&R[F].magic===te)return R[F];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+y.pretty(this.compressionMethod)+" unknown (inner file : "+y.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,X,N.readData(this.compressedSize))},readCentralPart:function(N){this.versionMadeBy=N.readInt(2),N.skip(2),this.bitFlag=N.readInt(2),this.compressionMethod=N.readString(2),this.date=N.readDate(),this.crc32=N.readInt(4),this.compressedSize=N.readInt(4),this.uncompressedSize=N.readInt(4);var X=N.readInt(2);if(this.extraFieldsLength=N.readInt(2),this.fileCommentLength=N.readInt(2),this.diskNumberStart=N.readInt(2),this.internalFileAttributes=N.readInt(2),this.externalFileAttributes=N.readInt(4),this.localHeaderOffset=N.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");N.skip(X),this.readExtraFields(N),this.parseZIP64ExtraField(N),this.fileComment=N.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var N=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),N==0&&(this.dosPermissions=63&this.externalFileAttributes),N==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var N=g(this.extraFields[1].value);this.uncompressedSize===y.MAX_VALUE_32BITS&&(this.uncompressedSize=N.readInt(8)),this.compressedSize===y.MAX_VALUE_32BITS&&(this.compressedSize=N.readInt(8)),this.localHeaderOffset===y.MAX_VALUE_32BITS&&(this.localHeaderOffset=N.readInt(8)),this.diskNumberStart===y.MAX_VALUE_32BITS&&(this.diskNumberStart=N.readInt(4))}},readExtraFields:function(N){var X,U,te,F=N.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});N.index+4<F;)X=N.readInt(2),U=N.readInt(2),te=N.readData(U),this.extraFields[X]={id:X,length:U,value:te};N.setIndex(F)},handleUTF8:function(){var N=D.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=P.utf8decode(this.fileName),this.fileCommentStr=P.utf8decode(this.fileComment);else{var X=this.findExtraFieldUnicodePath();if(X!==null)this.fileNameStr=X;else{var U=y.transformTo(N,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(U)}var te=this.findExtraFieldUnicodeComment();if(te!==null)this.fileCommentStr=te;else{var F=y.transformTo(N,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(F)}}},findExtraFieldUnicodePath:function(){var N=this.extraFields[28789];if(N){var X=g(N.value);return X.readInt(1)!==1||T(this.fileName)!==X.readInt(4)?null:P.utf8decode(X.readData(N.length-5))}return null},findExtraFieldUnicodeComment:function(){var N=this.extraFields[25461];if(N){var X=g(N.value);return X.readInt(1)!==1||T(this.fileComment)!==X.readInt(4)?null:P.utf8decode(X.readData(N.length-5))}return null}},u.exports=A},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(i,u,d){function g(X,U,te){this.name=X,this.dir=te.dir,this.date=te.date,this.comment=te.comment,this.unixPermissions=te.unixPermissions,this.dosPermissions=te.dosPermissions,this._data=U,this._dataBinary=te.binary,this.options={compression:te.compression,compressionOptions:te.compressionOptions}}var y=i("./stream/StreamHelper"),c=i("./stream/DataWorker"),T=i("./utf8"),P=i("./compressedObject"),R=i("./stream/GenericWorker");g.prototype={internalStream:function(X){var U=null,te="string";try{if(!X)throw new Error("No output type specified.");var F=(te=X.toLowerCase())==="string"||te==="text";te!=="binarystring"&&te!=="text"||(te="string"),U=this._decompressWorker();var $=!this._dataBinary;$&&!F&&(U=U.pipe(new T.Utf8EncodeWorker)),!$&&F&&(U=U.pipe(new T.Utf8DecodeWorker))}catch(q){(U=new R("error")).error(q)}return new y(U,te,"")},async:function(X,U){return this.internalStream(X).accumulate(U)},nodeStream:function(X,U){return this.internalStream(X||"nodebuffer").toNodejsStream(U)},_compressWorker:function(X,U){if(this._data instanceof P&&this._data.compression.magic===X.magic)return this._data.getCompressedWorker();var te=this._decompressWorker();return this._dataBinary||(te=te.pipe(new T.Utf8EncodeWorker)),P.createWorkerFrom(te,X,U)},_decompressWorker:function(){return this._data instanceof P?this._data.getContentWorker():this._data instanceof R?this._data:new c(this._data)}};for(var D=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],A=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},N=0;N<D.length;N++)g.prototype[D[N]]=A;u.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(i,u,d){(function(g){var y,c,T=g.MutationObserver||g.WebKitMutationObserver;if(T){var P=0,R=new T(X),D=g.document.createTextNode("");R.observe(D,{characterData:!0}),y=function(){D.data=P=++P%2}}else if(g.setImmediate||g.MessageChannel===void 0)y="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var U=g.document.createElement("script");U.onreadystatechange=function(){X(),U.onreadystatechange=null,U.parentNode.removeChild(U),U=null},g.document.documentElement.appendChild(U)}:function(){setTimeout(X,0)};else{var A=new g.MessageChannel;A.port1.onmessage=X,y=function(){A.port2.postMessage(0)}}var N=[];function X(){var U,te;c=!0;for(var F=N.length;F;){for(te=N,N=[],U=-1;++U<F;)te[U]();F=N.length}c=!1}u.exports=function(U){N.push(U)!==1||c||y()}}).call(this,typeof cd<"u"?cd:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(i,u,d){var g=i("immediate");function y(){}var c={},T=["REJECTED"],P=["FULFILLED"],R=["PENDING"];function D(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=R,this.queue=[],this.outcome=void 0,F!==y&&U(this,F)}function A(F,$,q){this.promise=F,typeof $=="function"&&(this.onFulfilled=$,this.callFulfilled=this.otherCallFulfilled),typeof q=="function"&&(this.onRejected=q,this.callRejected=this.otherCallRejected)}function N(F,$,q){g(function(){var ne;try{ne=$(q)}catch(se){return c.reject(F,se)}ne===F?c.reject(F,new TypeError("Cannot resolve promise with itself")):c.resolve(F,ne)})}function X(F){var $=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof $=="function")return function(){$.apply(F,arguments)}}function U(F,$){var q=!1;function ne(ge){q||(q=!0,c.reject(F,ge))}function se(ge){q||(q=!0,c.resolve(F,ge))}var Ee=te(function(){$(se,ne)});Ee.status==="error"&&ne(Ee.value)}function te(F,$){var q={};try{q.value=F($),q.status="success"}catch(ne){q.status="error",q.value=ne}return q}(u.exports=D).prototype.finally=function(F){if(typeof F!="function")return this;var $=this.constructor;return this.then(function(q){return $.resolve(F()).then(function(){return q})},function(q){return $.resolve(F()).then(function(){throw q})})},D.prototype.catch=function(F){return this.then(null,F)},D.prototype.then=function(F,$){if(typeof F!="function"&&this.state===P||typeof $!="function"&&this.state===T)return this;var q=new this.constructor(y);return this.state!==R?N(q,this.state===P?F:$,this.outcome):this.queue.push(new A(q,F,$)),q},A.prototype.callFulfilled=function(F){c.resolve(this.promise,F)},A.prototype.otherCallFulfilled=function(F){N(this.promise,this.onFulfilled,F)},A.prototype.callRejected=function(F){c.reject(this.promise,F)},A.prototype.otherCallRejected=function(F){N(this.promise,this.onRejected,F)},c.resolve=function(F,$){var q=te(X,$);if(q.status==="error")return c.reject(F,q.value);var ne=q.value;if(ne)U(F,ne);else{F.state=P,F.outcome=$;for(var se=-1,Ee=F.queue.length;++se<Ee;)F.queue[se].callFulfilled($)}return F},c.reject=function(F,$){F.state=T,F.outcome=$;for(var q=-1,ne=F.queue.length;++q<ne;)F.queue[q].callRejected($);return F},D.resolve=function(F){return F instanceof this?F:c.resolve(new this(y),F)},D.reject=function(F){var $=new this(y);return c.reject($,F)},D.all=function(F){var $=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=F.length,ne=!1;if(!q)return this.resolve([]);for(var se=new Array(q),Ee=0,ge=-1,Oe=new this(y);++ge<q;)Fe(F[ge],ge);return Oe;function Fe(Ge,it){$.resolve(Ge).then(function(ve){se[it]=ve,++Ee!==q||ne||(ne=!0,c.resolve(Oe,se))},function(ve){ne||(ne=!0,c.reject(Oe,ve))})}},D.race=function(F){var $=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=F.length,ne=!1;if(!q)return this.resolve([]);for(var se=-1,Ee=new this(y);++se<q;)ge=F[se],$.resolve(ge).then(function(Oe){ne||(ne=!0,c.resolve(Ee,Oe))},function(Oe){ne||(ne=!0,c.reject(Ee,Oe))});var ge;return Ee}},{immediate:36}],38:[function(i,u,d){var g={};(0,i("./lib/utils/common").assign)(g,i("./lib/deflate"),i("./lib/inflate"),i("./lib/zlib/constants")),u.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(i,u,d){var g=i("./zlib/deflate"),y=i("./utils/common"),c=i("./utils/strings"),T=i("./zlib/messages"),P=i("./zlib/zstream"),R=Object.prototype.toString,D=0,A=-1,N=0,X=8;function U(F){if(!(this instanceof U))return new U(F);this.options=y.assign({level:A,method:X,chunkSize:16384,windowBits:15,memLevel:8,strategy:N,to:""},F||{});var $=this.options;$.raw&&0<$.windowBits?$.windowBits=-$.windowBits:$.gzip&&0<$.windowBits&&$.windowBits<16&&($.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var q=g.deflateInit2(this.strm,$.level,$.method,$.windowBits,$.memLevel,$.strategy);if(q!==D)throw new Error(T[q]);if($.header&&g.deflateSetHeader(this.strm,$.header),$.dictionary){var ne;if(ne=typeof $.dictionary=="string"?c.string2buf($.dictionary):R.call($.dictionary)==="[object ArrayBuffer]"?new Uint8Array($.dictionary):$.dictionary,(q=g.deflateSetDictionary(this.strm,ne))!==D)throw new Error(T[q]);this._dict_set=!0}}function te(F,$){var q=new U($);if(q.push(F,!0),q.err)throw q.msg||T[q.err];return q.result}U.prototype.push=function(F,$){var q,ne,se=this.strm,Ee=this.options.chunkSize;if(this.ended)return!1;ne=$===~~$?$:$===!0?4:0,typeof F=="string"?se.input=c.string2buf(F):R.call(F)==="[object ArrayBuffer]"?se.input=new Uint8Array(F):se.input=F,se.next_in=0,se.avail_in=se.input.length;do{if(se.avail_out===0&&(se.output=new y.Buf8(Ee),se.next_out=0,se.avail_out=Ee),(q=g.deflate(se,ne))!==1&&q!==D)return this.onEnd(q),!(this.ended=!0);se.avail_out!==0&&(se.avail_in!==0||ne!==4&&ne!==2)||(this.options.to==="string"?this.onData(c.buf2binstring(y.shrinkBuf(se.output,se.next_out))):this.onData(y.shrinkBuf(se.output,se.next_out)))}while((0<se.avail_in||se.avail_out===0)&&q!==1);return ne===4?(q=g.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===D):ne!==2||(this.onEnd(D),!(se.avail_out=0))},U.prototype.onData=function(F){this.chunks.push(F)},U.prototype.onEnd=function(F){F===D&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=F,this.msg=this.strm.msg},d.Deflate=U,d.deflate=te,d.deflateRaw=function(F,$){return($=$||{}).raw=!0,te(F,$)},d.gzip=function(F,$){return($=$||{}).gzip=!0,te(F,$)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(i,u,d){var g=i("./zlib/inflate"),y=i("./utils/common"),c=i("./utils/strings"),T=i("./zlib/constants"),P=i("./zlib/messages"),R=i("./zlib/zstream"),D=i("./zlib/gzheader"),A=Object.prototype.toString;function N(U){if(!(this instanceof N))return new N(U);this.options=y.assign({chunkSize:16384,windowBits:0,to:""},U||{});var te=this.options;te.raw&&0<=te.windowBits&&te.windowBits<16&&(te.windowBits=-te.windowBits,te.windowBits===0&&(te.windowBits=-15)),!(0<=te.windowBits&&te.windowBits<16)||U&&U.windowBits||(te.windowBits+=32),15<te.windowBits&&te.windowBits<48&&!(15&te.windowBits)&&(te.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new R,this.strm.avail_out=0;var F=g.inflateInit2(this.strm,te.windowBits);if(F!==T.Z_OK)throw new Error(P[F]);this.header=new D,g.inflateGetHeader(this.strm,this.header)}function X(U,te){var F=new N(te);if(F.push(U,!0),F.err)throw F.msg||P[F.err];return F.result}N.prototype.push=function(U,te){var F,$,q,ne,se,Ee,ge=this.strm,Oe=this.options.chunkSize,Fe=this.options.dictionary,Ge=!1;if(this.ended)return!1;$=te===~~te?te:te===!0?T.Z_FINISH:T.Z_NO_FLUSH,typeof U=="string"?ge.input=c.binstring2buf(U):A.call(U)==="[object ArrayBuffer]"?ge.input=new Uint8Array(U):ge.input=U,ge.next_in=0,ge.avail_in=ge.input.length;do{if(ge.avail_out===0&&(ge.output=new y.Buf8(Oe),ge.next_out=0,ge.avail_out=Oe),(F=g.inflate(ge,T.Z_NO_FLUSH))===T.Z_NEED_DICT&&Fe&&(Ee=typeof Fe=="string"?c.string2buf(Fe):A.call(Fe)==="[object ArrayBuffer]"?new Uint8Array(Fe):Fe,F=g.inflateSetDictionary(this.strm,Ee)),F===T.Z_BUF_ERROR&&Ge===!0&&(F=T.Z_OK,Ge=!1),F!==T.Z_STREAM_END&&F!==T.Z_OK)return this.onEnd(F),!(this.ended=!0);ge.next_out&&(ge.avail_out!==0&&F!==T.Z_STREAM_END&&(ge.avail_in!==0||$!==T.Z_FINISH&&$!==T.Z_SYNC_FLUSH)||(this.options.to==="string"?(q=c.utf8border(ge.output,ge.next_out),ne=ge.next_out-q,se=c.buf2string(ge.output,q),ge.next_out=ne,ge.avail_out=Oe-ne,ne&&y.arraySet(ge.output,ge.output,q,ne,0),this.onData(se)):this.onData(y.shrinkBuf(ge.output,ge.next_out)))),ge.avail_in===0&&ge.avail_out===0&&(Ge=!0)}while((0<ge.avail_in||ge.avail_out===0)&&F!==T.Z_STREAM_END);return F===T.Z_STREAM_END&&($=T.Z_FINISH),$===T.Z_FINISH?(F=g.inflateEnd(this.strm),this.onEnd(F),this.ended=!0,F===T.Z_OK):$!==T.Z_SYNC_FLUSH||(this.onEnd(T.Z_OK),!(ge.avail_out=0))},N.prototype.onData=function(U){this.chunks.push(U)},N.prototype.onEnd=function(U){U===T.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg},d.Inflate=N,d.inflate=X,d.inflateRaw=function(U,te){return(te=te||{}).raw=!0,X(U,te)},d.ungzip=X},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(i,u,d){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(T){for(var P=Array.prototype.slice.call(arguments,1);P.length;){var R=P.shift();if(R){if(typeof R!="object")throw new TypeError(R+"must be non-object");for(var D in R)R.hasOwnProperty(D)&&(T[D]=R[D])}}return T},d.shrinkBuf=function(T,P){return T.length===P?T:T.subarray?T.subarray(0,P):(T.length=P,T)};var y={arraySet:function(T,P,R,D,A){if(P.subarray&&T.subarray)T.set(P.subarray(R,R+D),A);else for(var N=0;N<D;N++)T[A+N]=P[R+N]},flattenChunks:function(T){var P,R,D,A,N,X;for(P=D=0,R=T.length;P<R;P++)D+=T[P].length;for(X=new Uint8Array(D),P=A=0,R=T.length;P<R;P++)N=T[P],X.set(N,A),A+=N.length;return X}},c={arraySet:function(T,P,R,D,A){for(var N=0;N<D;N++)T[A+N]=P[R+N]},flattenChunks:function(T){return[].concat.apply([],T)}};d.setTyped=function(T){T?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,y)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,c))},d.setTyped(g)},{}],42:[function(i,u,d){var g=i("./common"),y=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch{y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{c=!1}for(var T=new g.Buf8(256),P=0;P<256;P++)T[P]=252<=P?6:248<=P?5:240<=P?4:224<=P?3:192<=P?2:1;function R(D,A){if(A<65537&&(D.subarray&&c||!D.subarray&&y))return String.fromCharCode.apply(null,g.shrinkBuf(D,A));for(var N="",X=0;X<A;X++)N+=String.fromCharCode(D[X]);return N}T[254]=T[254]=1,d.string2buf=function(D){var A,N,X,U,te,F=D.length,$=0;for(U=0;U<F;U++)(64512&(N=D.charCodeAt(U)))==55296&&U+1<F&&(64512&(X=D.charCodeAt(U+1)))==56320&&(N=65536+(N-55296<<10)+(X-56320),U++),$+=N<128?1:N<2048?2:N<65536?3:4;for(A=new g.Buf8($),U=te=0;te<$;U++)(64512&(N=D.charCodeAt(U)))==55296&&U+1<F&&(64512&(X=D.charCodeAt(U+1)))==56320&&(N=65536+(N-55296<<10)+(X-56320),U++),N<128?A[te++]=N:(N<2048?A[te++]=192|N>>>6:(N<65536?A[te++]=224|N>>>12:(A[te++]=240|N>>>18,A[te++]=128|N>>>12&63),A[te++]=128|N>>>6&63),A[te++]=128|63&N);return A},d.buf2binstring=function(D){return R(D,D.length)},d.binstring2buf=function(D){for(var A=new g.Buf8(D.length),N=0,X=A.length;N<X;N++)A[N]=D.charCodeAt(N);return A},d.buf2string=function(D,A){var N,X,U,te,F=A||D.length,$=new Array(2*F);for(N=X=0;N<F;)if((U=D[N++])<128)$[X++]=U;else if(4<(te=T[U]))$[X++]=65533,N+=te-1;else{for(U&=te===2?31:te===3?15:7;1<te&&N<F;)U=U<<6|63&D[N++],te--;1<te?$[X++]=65533:U<65536?$[X++]=U:(U-=65536,$[X++]=55296|U>>10&1023,$[X++]=56320|1023&U)}return R($,X)},d.utf8border=function(D,A){var N;for((A=A||D.length)>D.length&&(A=D.length),N=A-1;0<=N&&(192&D[N])==128;)N--;return N<0||N===0?A:N+T[D[N]]>A?N:A}},{"./common":41}],43:[function(i,u,d){u.exports=function(g,y,c,T){for(var P=65535&g|0,R=g>>>16&65535|0,D=0;c!==0;){for(c-=D=2e3<c?2e3:c;R=R+(P=P+y[T++]|0)|0,--D;);P%=65521,R%=65521}return P|R<<16|0}},{}],44:[function(i,u,d){u.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(i,u,d){var g=function(){for(var y,c=[],T=0;T<256;T++){y=T;for(var P=0;P<8;P++)y=1&y?3988292384^y>>>1:y>>>1;c[T]=y}return c}();u.exports=function(y,c,T,P){var R=g,D=P+T;y^=-1;for(var A=P;A<D;A++)y=y>>>8^R[255&(y^c[A])];return-1^y}},{}],46:[function(i,u,d){var g,y=i("../utils/common"),c=i("./trees"),T=i("./adler32"),P=i("./crc32"),R=i("./messages"),D=0,A=4,N=0,X=-2,U=-1,te=4,F=2,$=8,q=9,ne=286,se=30,Ee=19,ge=2*ne+1,Oe=15,Fe=3,Ge=258,it=Ge+Fe+1,ve=42,je=113,H=1,Re=2,_t=3,ye=4;function Be(V,Ue){return V.msg=R[Ue],Ue}function Le(V){return(V<<1)-(4<V?9:0)}function Ke(V){for(var Ue=V.length;0<=--Ue;)V[Ue]=0}function xe(V){var Ue=V.state,ie=Ue.pending;ie>V.avail_out&&(ie=V.avail_out),ie!==0&&(y.arraySet(V.output,Ue.pending_buf,Ue.pending_out,ie,V.next_out),V.next_out+=ie,Ue.pending_out+=ie,V.total_out+=ie,V.avail_out-=ie,Ue.pending-=ie,Ue.pending===0&&(Ue.pending_out=0))}function Te(V,Ue){c._tr_flush_block(V,0<=V.block_start?V.block_start:-1,V.strstart-V.block_start,Ue),V.block_start=V.strstart,xe(V.strm)}function ft(V,Ue){V.pending_buf[V.pending++]=Ue}function nt(V,Ue){V.pending_buf[V.pending++]=Ue>>>8&255,V.pending_buf[V.pending++]=255&Ue}function rt(V,Ue){var ie,de,oe=V.max_chain_length,ke=V.strstart,Ze=V.prev_length,tt=V.nice_match,Ne=V.strstart>V.w_size-it?V.strstart-(V.w_size-it):0,st=V.window,St=V.w_mask,at=V.prev,Lt=V.strstart+Ge,vr=st[ke+Ze-1],We=st[ke+Ze];V.prev_length>=V.good_match&&(oe>>=2),tt>V.lookahead&&(tt=V.lookahead);do if(st[(ie=Ue)+Ze]===We&&st[ie+Ze-1]===vr&&st[ie]===st[ke]&&st[++ie]===st[ke+1]){ke+=2,ie++;do;while(st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&st[++ke]===st[++ie]&&ke<Lt);if(de=Ge-(Lt-ke),ke=Lt-Ge,Ze<de){if(V.match_start=Ue,tt<=(Ze=de))break;vr=st[ke+Ze-1],We=st[ke+Ze]}}while((Ue=at[Ue&St])>Ne&&--oe!=0);return Ze<=V.lookahead?Ze:V.lookahead}function qt(V){var Ue,ie,de,oe,ke,Ze,tt,Ne,st,St,at=V.w_size;do{if(oe=V.window_size-V.lookahead-V.strstart,V.strstart>=at+(at-it)){for(y.arraySet(V.window,V.window,at,at,0),V.match_start-=at,V.strstart-=at,V.block_start-=at,Ue=ie=V.hash_size;de=V.head[--Ue],V.head[Ue]=at<=de?de-at:0,--ie;);for(Ue=ie=at;de=V.prev[--Ue],V.prev[Ue]=at<=de?de-at:0,--ie;);oe+=at}if(V.strm.avail_in===0)break;if(Ze=V.strm,tt=V.window,Ne=V.strstart+V.lookahead,st=oe,St=void 0,St=Ze.avail_in,st<St&&(St=st),ie=St===0?0:(Ze.avail_in-=St,y.arraySet(tt,Ze.input,Ze.next_in,St,Ne),Ze.state.wrap===1?Ze.adler=T(Ze.adler,tt,St,Ne):Ze.state.wrap===2&&(Ze.adler=P(Ze.adler,tt,St,Ne)),Ze.next_in+=St,Ze.total_in+=St,St),V.lookahead+=ie,V.lookahead+V.insert>=Fe)for(ke=V.strstart-V.insert,V.ins_h=V.window[ke],V.ins_h=(V.ins_h<<V.hash_shift^V.window[ke+1])&V.hash_mask;V.insert&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[ke+Fe-1])&V.hash_mask,V.prev[ke&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=ke,ke++,V.insert--,!(V.lookahead+V.insert<Fe)););}while(V.lookahead<it&&V.strm.avail_in!==0)}function Kt(V,Ue){for(var ie,de;;){if(V.lookahead<it){if(qt(V),V.lookahead<it&&Ue===D)return H;if(V.lookahead===0)break}if(ie=0,V.lookahead>=Fe&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+Fe-1])&V.hash_mask,ie=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),ie!==0&&V.strstart-ie<=V.w_size-it&&(V.match_length=rt(V,ie)),V.match_length>=Fe)if(de=c._tr_tally(V,V.strstart-V.match_start,V.match_length-Fe),V.lookahead-=V.match_length,V.match_length<=V.max_lazy_match&&V.lookahead>=Fe){for(V.match_length--;V.strstart++,V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+Fe-1])&V.hash_mask,ie=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart,--V.match_length!=0;);V.strstart++}else V.strstart+=V.match_length,V.match_length=0,V.ins_h=V.window[V.strstart],V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+1])&V.hash_mask;else de=c._tr_tally(V,0,V.window[V.strstart]),V.lookahead--,V.strstart++;if(de&&(Te(V,!1),V.strm.avail_out===0))return H}return V.insert=V.strstart<Fe-1?V.strstart:Fe-1,Ue===A?(Te(V,!0),V.strm.avail_out===0?_t:ye):V.last_lit&&(Te(V,!1),V.strm.avail_out===0)?H:Re}function jt(V,Ue){for(var ie,de,oe;;){if(V.lookahead<it){if(qt(V),V.lookahead<it&&Ue===D)return H;if(V.lookahead===0)break}if(ie=0,V.lookahead>=Fe&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+Fe-1])&V.hash_mask,ie=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),V.prev_length=V.match_length,V.prev_match=V.match_start,V.match_length=Fe-1,ie!==0&&V.prev_length<V.max_lazy_match&&V.strstart-ie<=V.w_size-it&&(V.match_length=rt(V,ie),V.match_length<=5&&(V.strategy===1||V.match_length===Fe&&4096<V.strstart-V.match_start)&&(V.match_length=Fe-1)),V.prev_length>=Fe&&V.match_length<=V.prev_length){for(oe=V.strstart+V.lookahead-Fe,de=c._tr_tally(V,V.strstart-1-V.prev_match,V.prev_length-Fe),V.lookahead-=V.prev_length-1,V.prev_length-=2;++V.strstart<=oe&&(V.ins_h=(V.ins_h<<V.hash_shift^V.window[V.strstart+Fe-1])&V.hash_mask,ie=V.prev[V.strstart&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=V.strstart),--V.prev_length!=0;);if(V.match_available=0,V.match_length=Fe-1,V.strstart++,de&&(Te(V,!1),V.strm.avail_out===0))return H}else if(V.match_available){if((de=c._tr_tally(V,0,V.window[V.strstart-1]))&&Te(V,!1),V.strstart++,V.lookahead--,V.strm.avail_out===0)return H}else V.match_available=1,V.strstart++,V.lookahead--}return V.match_available&&(de=c._tr_tally(V,0,V.window[V.strstart-1]),V.match_available=0),V.insert=V.strstart<Fe-1?V.strstart:Fe-1,Ue===A?(Te(V,!0),V.strm.avail_out===0?_t:ye):V.last_lit&&(Te(V,!1),V.strm.avail_out===0)?H:Re}function Gt(V,Ue,ie,de,oe){this.good_length=V,this.max_lazy=Ue,this.nice_length=ie,this.max_chain=de,this.func=oe}function pr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new y.Buf16(2*ge),this.dyn_dtree=new y.Buf16(2*(2*se+1)),this.bl_tree=new y.Buf16(2*(2*Ee+1)),Ke(this.dyn_ltree),Ke(this.dyn_dtree),Ke(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new y.Buf16(Oe+1),this.heap=new y.Buf16(2*ne+1),Ke(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new y.Buf16(2*ne+1),Ke(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lr(V){var Ue;return V&&V.state?(V.total_in=V.total_out=0,V.data_type=F,(Ue=V.state).pending=0,Ue.pending_out=0,Ue.wrap<0&&(Ue.wrap=-Ue.wrap),Ue.status=Ue.wrap?ve:je,V.adler=Ue.wrap===2?0:1,Ue.last_flush=D,c._tr_init(Ue),N):Be(V,X)}function gr(V){var Ue=lr(V);return Ue===N&&function(ie){ie.window_size=2*ie.w_size,Ke(ie.head),ie.max_lazy_match=g[ie.level].max_lazy,ie.good_match=g[ie.level].good_length,ie.nice_match=g[ie.level].nice_length,ie.max_chain_length=g[ie.level].max_chain,ie.strstart=0,ie.block_start=0,ie.lookahead=0,ie.insert=0,ie.match_length=ie.prev_length=Fe-1,ie.match_available=0,ie.ins_h=0}(V.state),Ue}function $r(V,Ue,ie,de,oe,ke){if(!V)return X;var Ze=1;if(Ue===U&&(Ue=6),de<0?(Ze=0,de=-de):15<de&&(Ze=2,de-=16),oe<1||q<oe||ie!==$||de<8||15<de||Ue<0||9<Ue||ke<0||te<ke)return Be(V,X);de===8&&(de=9);var tt=new pr;return(V.state=tt).strm=V,tt.wrap=Ze,tt.gzhead=null,tt.w_bits=de,tt.w_size=1<<tt.w_bits,tt.w_mask=tt.w_size-1,tt.hash_bits=oe+7,tt.hash_size=1<<tt.hash_bits,tt.hash_mask=tt.hash_size-1,tt.hash_shift=~~((tt.hash_bits+Fe-1)/Fe),tt.window=new y.Buf8(2*tt.w_size),tt.head=new y.Buf16(tt.hash_size),tt.prev=new y.Buf16(tt.w_size),tt.lit_bufsize=1<<oe+6,tt.pending_buf_size=4*tt.lit_bufsize,tt.pending_buf=new y.Buf8(tt.pending_buf_size),tt.d_buf=1*tt.lit_bufsize,tt.l_buf=3*tt.lit_bufsize,tt.level=Ue,tt.strategy=ke,tt.method=ie,gr(V)}g=[new Gt(0,0,0,0,function(V,Ue){var ie=65535;for(ie>V.pending_buf_size-5&&(ie=V.pending_buf_size-5);;){if(V.lookahead<=1){if(qt(V),V.lookahead===0&&Ue===D)return H;if(V.lookahead===0)break}V.strstart+=V.lookahead,V.lookahead=0;var de=V.block_start+ie;if((V.strstart===0||V.strstart>=de)&&(V.lookahead=V.strstart-de,V.strstart=de,Te(V,!1),V.strm.avail_out===0)||V.strstart-V.block_start>=V.w_size-it&&(Te(V,!1),V.strm.avail_out===0))return H}return V.insert=0,Ue===A?(Te(V,!0),V.strm.avail_out===0?_t:ye):(V.strstart>V.block_start&&(Te(V,!1),V.strm.avail_out),H)}),new Gt(4,4,8,4,Kt),new Gt(4,5,16,8,Kt),new Gt(4,6,32,32,Kt),new Gt(4,4,16,16,jt),new Gt(8,16,32,32,jt),new Gt(8,16,128,128,jt),new Gt(8,32,128,256,jt),new Gt(32,128,258,1024,jt),new Gt(32,258,258,4096,jt)],d.deflateInit=function(V,Ue){return $r(V,Ue,$,15,8,0)},d.deflateInit2=$r,d.deflateReset=gr,d.deflateResetKeep=lr,d.deflateSetHeader=function(V,Ue){return V&&V.state?V.state.wrap!==2?X:(V.state.gzhead=Ue,N):X},d.deflate=function(V,Ue){var ie,de,oe,ke;if(!V||!V.state||5<Ue||Ue<0)return V?Be(V,X):X;if(de=V.state,!V.output||!V.input&&V.avail_in!==0||de.status===666&&Ue!==A)return Be(V,V.avail_out===0?-5:X);if(de.strm=V,ie=de.last_flush,de.last_flush=Ue,de.status===ve)if(de.wrap===2)V.adler=0,ft(de,31),ft(de,139),ft(de,8),de.gzhead?(ft(de,(de.gzhead.text?1:0)+(de.gzhead.hcrc?2:0)+(de.gzhead.extra?4:0)+(de.gzhead.name?8:0)+(de.gzhead.comment?16:0)),ft(de,255&de.gzhead.time),ft(de,de.gzhead.time>>8&255),ft(de,de.gzhead.time>>16&255),ft(de,de.gzhead.time>>24&255),ft(de,de.level===9?2:2<=de.strategy||de.level<2?4:0),ft(de,255&de.gzhead.os),de.gzhead.extra&&de.gzhead.extra.length&&(ft(de,255&de.gzhead.extra.length),ft(de,de.gzhead.extra.length>>8&255)),de.gzhead.hcrc&&(V.adler=P(V.adler,de.pending_buf,de.pending,0)),de.gzindex=0,de.status=69):(ft(de,0),ft(de,0),ft(de,0),ft(de,0),ft(de,0),ft(de,de.level===9?2:2<=de.strategy||de.level<2?4:0),ft(de,3),de.status=je);else{var Ze=$+(de.w_bits-8<<4)<<8;Ze|=(2<=de.strategy||de.level<2?0:de.level<6?1:de.level===6?2:3)<<6,de.strstart!==0&&(Ze|=32),Ze+=31-Ze%31,de.status=je,nt(de,Ze),de.strstart!==0&&(nt(de,V.adler>>>16),nt(de,65535&V.adler)),V.adler=1}if(de.status===69)if(de.gzhead.extra){for(oe=de.pending;de.gzindex<(65535&de.gzhead.extra.length)&&(de.pending!==de.pending_buf_size||(de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),xe(V),oe=de.pending,de.pending!==de.pending_buf_size));)ft(de,255&de.gzhead.extra[de.gzindex]),de.gzindex++;de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),de.gzindex===de.gzhead.extra.length&&(de.gzindex=0,de.status=73)}else de.status=73;if(de.status===73)if(de.gzhead.name){oe=de.pending;do{if(de.pending===de.pending_buf_size&&(de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),xe(V),oe=de.pending,de.pending===de.pending_buf_size)){ke=1;break}ke=de.gzindex<de.gzhead.name.length?255&de.gzhead.name.charCodeAt(de.gzindex++):0,ft(de,ke)}while(ke!==0);de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),ke===0&&(de.gzindex=0,de.status=91)}else de.status=91;if(de.status===91)if(de.gzhead.comment){oe=de.pending;do{if(de.pending===de.pending_buf_size&&(de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),xe(V),oe=de.pending,de.pending===de.pending_buf_size)){ke=1;break}ke=de.gzindex<de.gzhead.comment.length?255&de.gzhead.comment.charCodeAt(de.gzindex++):0,ft(de,ke)}while(ke!==0);de.gzhead.hcrc&&de.pending>oe&&(V.adler=P(V.adler,de.pending_buf,de.pending-oe,oe)),ke===0&&(de.status=103)}else de.status=103;if(de.status===103&&(de.gzhead.hcrc?(de.pending+2>de.pending_buf_size&&xe(V),de.pending+2<=de.pending_buf_size&&(ft(de,255&V.adler),ft(de,V.adler>>8&255),V.adler=0,de.status=je)):de.status=je),de.pending!==0){if(xe(V),V.avail_out===0)return de.last_flush=-1,N}else if(V.avail_in===0&&Le(Ue)<=Le(ie)&&Ue!==A)return Be(V,-5);if(de.status===666&&V.avail_in!==0)return Be(V,-5);if(V.avail_in!==0||de.lookahead!==0||Ue!==D&&de.status!==666){var tt=de.strategy===2?function(Ne,st){for(var St;;){if(Ne.lookahead===0&&(qt(Ne),Ne.lookahead===0)){if(st===D)return H;break}if(Ne.match_length=0,St=c._tr_tally(Ne,0,Ne.window[Ne.strstart]),Ne.lookahead--,Ne.strstart++,St&&(Te(Ne,!1),Ne.strm.avail_out===0))return H}return Ne.insert=0,st===A?(Te(Ne,!0),Ne.strm.avail_out===0?_t:ye):Ne.last_lit&&(Te(Ne,!1),Ne.strm.avail_out===0)?H:Re}(de,Ue):de.strategy===3?function(Ne,st){for(var St,at,Lt,vr,We=Ne.window;;){if(Ne.lookahead<=Ge){if(qt(Ne),Ne.lookahead<=Ge&&st===D)return H;if(Ne.lookahead===0)break}if(Ne.match_length=0,Ne.lookahead>=Fe&&0<Ne.strstart&&(at=We[Lt=Ne.strstart-1])===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]){vr=Ne.strstart+Ge;do;while(at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&at===We[++Lt]&&Lt<vr);Ne.match_length=Ge-(vr-Lt),Ne.match_length>Ne.lookahead&&(Ne.match_length=Ne.lookahead)}if(Ne.match_length>=Fe?(St=c._tr_tally(Ne,1,Ne.match_length-Fe),Ne.lookahead-=Ne.match_length,Ne.strstart+=Ne.match_length,Ne.match_length=0):(St=c._tr_tally(Ne,0,Ne.window[Ne.strstart]),Ne.lookahead--,Ne.strstart++),St&&(Te(Ne,!1),Ne.strm.avail_out===0))return H}return Ne.insert=0,st===A?(Te(Ne,!0),Ne.strm.avail_out===0?_t:ye):Ne.last_lit&&(Te(Ne,!1),Ne.strm.avail_out===0)?H:Re}(de,Ue):g[de.level].func(de,Ue);if(tt!==_t&&tt!==ye||(de.status=666),tt===H||tt===_t)return V.avail_out===0&&(de.last_flush=-1),N;if(tt===Re&&(Ue===1?c._tr_align(de):Ue!==5&&(c._tr_stored_block(de,0,0,!1),Ue===3&&(Ke(de.head),de.lookahead===0&&(de.strstart=0,de.block_start=0,de.insert=0))),xe(V),V.avail_out===0))return de.last_flush=-1,N}return Ue!==A?N:de.wrap<=0?1:(de.wrap===2?(ft(de,255&V.adler),ft(de,V.adler>>8&255),ft(de,V.adler>>16&255),ft(de,V.adler>>24&255),ft(de,255&V.total_in),ft(de,V.total_in>>8&255),ft(de,V.total_in>>16&255),ft(de,V.total_in>>24&255)):(nt(de,V.adler>>>16),nt(de,65535&V.adler)),xe(V),0<de.wrap&&(de.wrap=-de.wrap),de.pending!==0?N:1)},d.deflateEnd=function(V){var Ue;return V&&V.state?(Ue=V.state.status)!==ve&&Ue!==69&&Ue!==73&&Ue!==91&&Ue!==103&&Ue!==je&&Ue!==666?Be(V,X):(V.state=null,Ue===je?Be(V,-3):N):X},d.deflateSetDictionary=function(V,Ue){var ie,de,oe,ke,Ze,tt,Ne,st,St=Ue.length;if(!V||!V.state||(ke=(ie=V.state).wrap)===2||ke===1&&ie.status!==ve||ie.lookahead)return X;for(ke===1&&(V.adler=T(V.adler,Ue,St,0)),ie.wrap=0,St>=ie.w_size&&(ke===0&&(Ke(ie.head),ie.strstart=0,ie.block_start=0,ie.insert=0),st=new y.Buf8(ie.w_size),y.arraySet(st,Ue,St-ie.w_size,ie.w_size,0),Ue=st,St=ie.w_size),Ze=V.avail_in,tt=V.next_in,Ne=V.input,V.avail_in=St,V.next_in=0,V.input=Ue,qt(ie);ie.lookahead>=Fe;){for(de=ie.strstart,oe=ie.lookahead-(Fe-1);ie.ins_h=(ie.ins_h<<ie.hash_shift^ie.window[de+Fe-1])&ie.hash_mask,ie.prev[de&ie.w_mask]=ie.head[ie.ins_h],ie.head[ie.ins_h]=de,de++,--oe;);ie.strstart=de,ie.lookahead=Fe-1,qt(ie)}return ie.strstart+=ie.lookahead,ie.block_start=ie.strstart,ie.insert=ie.lookahead,ie.lookahead=0,ie.match_length=ie.prev_length=Fe-1,ie.match_available=0,V.next_in=tt,V.input=Ne,V.avail_in=Ze,ie.wrap=ke,N},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(i,u,d){u.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(i,u,d){u.exports=function(g,y){var c,T,P,R,D,A,N,X,U,te,F,$,q,ne,se,Ee,ge,Oe,Fe,Ge,it,ve,je,H,Re;c=g.state,T=g.next_in,H=g.input,P=T+(g.avail_in-5),R=g.next_out,Re=g.output,D=R-(y-g.avail_out),A=R+(g.avail_out-257),N=c.dmax,X=c.wsize,U=c.whave,te=c.wnext,F=c.window,$=c.hold,q=c.bits,ne=c.lencode,se=c.distcode,Ee=(1<<c.lenbits)-1,ge=(1<<c.distbits)-1;e:do{q<15&&($+=H[T++]<<q,q+=8,$+=H[T++]<<q,q+=8),Oe=ne[$&Ee];t:for(;;){if($>>>=Fe=Oe>>>24,q-=Fe,(Fe=Oe>>>16&255)===0)Re[R++]=65535&Oe;else{if(!(16&Fe)){if(!(64&Fe)){Oe=ne[(65535&Oe)+($&(1<<Fe)-1)];continue t}if(32&Fe){c.mode=12;break e}g.msg="invalid literal/length code",c.mode=30;break e}Ge=65535&Oe,(Fe&=15)&&(q<Fe&&($+=H[T++]<<q,q+=8),Ge+=$&(1<<Fe)-1,$>>>=Fe,q-=Fe),q<15&&($+=H[T++]<<q,q+=8,$+=H[T++]<<q,q+=8),Oe=se[$&ge];r:for(;;){if($>>>=Fe=Oe>>>24,q-=Fe,!(16&(Fe=Oe>>>16&255))){if(!(64&Fe)){Oe=se[(65535&Oe)+($&(1<<Fe)-1)];continue r}g.msg="invalid distance code",c.mode=30;break e}if(it=65535&Oe,q<(Fe&=15)&&($+=H[T++]<<q,(q+=8)<Fe&&($+=H[T++]<<q,q+=8)),N<(it+=$&(1<<Fe)-1)){g.msg="invalid distance too far back",c.mode=30;break e}if($>>>=Fe,q-=Fe,(Fe=R-D)<it){if(U<(Fe=it-Fe)&&c.sane){g.msg="invalid distance too far back",c.mode=30;break e}if(je=F,(ve=0)===te){if(ve+=X-Fe,Fe<Ge){for(Ge-=Fe;Re[R++]=F[ve++],--Fe;);ve=R-it,je=Re}}else if(te<Fe){if(ve+=X+te-Fe,(Fe-=te)<Ge){for(Ge-=Fe;Re[R++]=F[ve++],--Fe;);if(ve=0,te<Ge){for(Ge-=Fe=te;Re[R++]=F[ve++],--Fe;);ve=R-it,je=Re}}}else if(ve+=te-Fe,Fe<Ge){for(Ge-=Fe;Re[R++]=F[ve++],--Fe;);ve=R-it,je=Re}for(;2<Ge;)Re[R++]=je[ve++],Re[R++]=je[ve++],Re[R++]=je[ve++],Ge-=3;Ge&&(Re[R++]=je[ve++],1<Ge&&(Re[R++]=je[ve++]))}else{for(ve=R-it;Re[R++]=Re[ve++],Re[R++]=Re[ve++],Re[R++]=Re[ve++],2<(Ge-=3););Ge&&(Re[R++]=Re[ve++],1<Ge&&(Re[R++]=Re[ve++]))}break}}break}}while(T<P&&R<A);T-=Ge=q>>3,$&=(1<<(q-=Ge<<3))-1,g.next_in=T,g.next_out=R,g.avail_in=T<P?P-T+5:5-(T-P),g.avail_out=R<A?A-R+257:257-(R-A),c.hold=$,c.bits=q}},{}],49:[function(i,u,d){var g=i("../utils/common"),y=i("./adler32"),c=i("./crc32"),T=i("./inffast"),P=i("./inftrees"),R=1,D=2,A=0,N=-2,X=1,U=852,te=592;function F(ve){return(ve>>>24&255)+(ve>>>8&65280)+((65280&ve)<<8)+((255&ve)<<24)}function $(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function q(ve){var je;return ve&&ve.state?(je=ve.state,ve.total_in=ve.total_out=je.total=0,ve.msg="",je.wrap&&(ve.adler=1&je.wrap),je.mode=X,je.last=0,je.havedict=0,je.dmax=32768,je.head=null,je.hold=0,je.bits=0,je.lencode=je.lendyn=new g.Buf32(U),je.distcode=je.distdyn=new g.Buf32(te),je.sane=1,je.back=-1,A):N}function ne(ve){var je;return ve&&ve.state?((je=ve.state).wsize=0,je.whave=0,je.wnext=0,q(ve)):N}function se(ve,je){var H,Re;return ve&&ve.state?(Re=ve.state,je<0?(H=0,je=-je):(H=1+(je>>4),je<48&&(je&=15)),je&&(je<8||15<je)?N:(Re.window!==null&&Re.wbits!==je&&(Re.window=null),Re.wrap=H,Re.wbits=je,ne(ve))):N}function Ee(ve,je){var H,Re;return ve?(Re=new $,(ve.state=Re).window=null,(H=se(ve,je))!==A&&(ve.state=null),H):N}var ge,Oe,Fe=!0;function Ge(ve){if(Fe){var je;for(ge=new g.Buf32(512),Oe=new g.Buf32(32),je=0;je<144;)ve.lens[je++]=8;for(;je<256;)ve.lens[je++]=9;for(;je<280;)ve.lens[je++]=7;for(;je<288;)ve.lens[je++]=8;for(P(R,ve.lens,0,288,ge,0,ve.work,{bits:9}),je=0;je<32;)ve.lens[je++]=5;P(D,ve.lens,0,32,Oe,0,ve.work,{bits:5}),Fe=!1}ve.lencode=ge,ve.lenbits=9,ve.distcode=Oe,ve.distbits=5}function it(ve,je,H,Re){var _t,ye=ve.state;return ye.window===null&&(ye.wsize=1<<ye.wbits,ye.wnext=0,ye.whave=0,ye.window=new g.Buf8(ye.wsize)),Re>=ye.wsize?(g.arraySet(ye.window,je,H-ye.wsize,ye.wsize,0),ye.wnext=0,ye.whave=ye.wsize):(Re<(_t=ye.wsize-ye.wnext)&&(_t=Re),g.arraySet(ye.window,je,H-Re,_t,ye.wnext),(Re-=_t)?(g.arraySet(ye.window,je,H-Re,Re,0),ye.wnext=Re,ye.whave=ye.wsize):(ye.wnext+=_t,ye.wnext===ye.wsize&&(ye.wnext=0),ye.whave<ye.wsize&&(ye.whave+=_t))),0}d.inflateReset=ne,d.inflateReset2=se,d.inflateResetKeep=q,d.inflateInit=function(ve){return Ee(ve,15)},d.inflateInit2=Ee,d.inflate=function(ve,je){var H,Re,_t,ye,Be,Le,Ke,xe,Te,ft,nt,rt,qt,Kt,jt,Gt,pr,lr,gr,$r,V,Ue,ie,de,oe=0,ke=new g.Buf8(4),Ze=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ve||!ve.state||!ve.output||!ve.input&&ve.avail_in!==0)return N;(H=ve.state).mode===12&&(H.mode=13),Be=ve.next_out,_t=ve.output,Ke=ve.avail_out,ye=ve.next_in,Re=ve.input,Le=ve.avail_in,xe=H.hold,Te=H.bits,ft=Le,nt=Ke,Ue=A;e:for(;;)switch(H.mode){case X:if(H.wrap===0){H.mode=13;break}for(;Te<16;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(2&H.wrap&&xe===35615){ke[H.check=0]=255&xe,ke[1]=xe>>>8&255,H.check=c(H.check,ke,2,0),Te=xe=0,H.mode=2;break}if(H.flags=0,H.head&&(H.head.done=!1),!(1&H.wrap)||(((255&xe)<<8)+(xe>>8))%31){ve.msg="incorrect header check",H.mode=30;break}if((15&xe)!=8){ve.msg="unknown compression method",H.mode=30;break}if(Te-=4,V=8+(15&(xe>>>=4)),H.wbits===0)H.wbits=V;else if(V>H.wbits){ve.msg="invalid window size",H.mode=30;break}H.dmax=1<<V,ve.adler=H.check=1,H.mode=512&xe?10:12,Te=xe=0;break;case 2:for(;Te<16;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(H.flags=xe,(255&H.flags)!=8){ve.msg="unknown compression method",H.mode=30;break}if(57344&H.flags){ve.msg="unknown header flags set",H.mode=30;break}H.head&&(H.head.text=xe>>8&1),512&H.flags&&(ke[0]=255&xe,ke[1]=xe>>>8&255,H.check=c(H.check,ke,2,0)),Te=xe=0,H.mode=3;case 3:for(;Te<32;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.head&&(H.head.time=xe),512&H.flags&&(ke[0]=255&xe,ke[1]=xe>>>8&255,ke[2]=xe>>>16&255,ke[3]=xe>>>24&255,H.check=c(H.check,ke,4,0)),Te=xe=0,H.mode=4;case 4:for(;Te<16;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.head&&(H.head.xflags=255&xe,H.head.os=xe>>8),512&H.flags&&(ke[0]=255&xe,ke[1]=xe>>>8&255,H.check=c(H.check,ke,2,0)),Te=xe=0,H.mode=5;case 5:if(1024&H.flags){for(;Te<16;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.length=xe,H.head&&(H.head.extra_len=xe),512&H.flags&&(ke[0]=255&xe,ke[1]=xe>>>8&255,H.check=c(H.check,ke,2,0)),Te=xe=0}else H.head&&(H.head.extra=null);H.mode=6;case 6:if(1024&H.flags&&(Le<(rt=H.length)&&(rt=Le),rt&&(H.head&&(V=H.head.extra_len-H.length,H.head.extra||(H.head.extra=new Array(H.head.extra_len)),g.arraySet(H.head.extra,Re,ye,rt,V)),512&H.flags&&(H.check=c(H.check,Re,rt,ye)),Le-=rt,ye+=rt,H.length-=rt),H.length))break e;H.length=0,H.mode=7;case 7:if(2048&H.flags){if(Le===0)break e;for(rt=0;V=Re[ye+rt++],H.head&&V&&H.length<65536&&(H.head.name+=String.fromCharCode(V)),V&&rt<Le;);if(512&H.flags&&(H.check=c(H.check,Re,rt,ye)),Le-=rt,ye+=rt,V)break e}else H.head&&(H.head.name=null);H.length=0,H.mode=8;case 8:if(4096&H.flags){if(Le===0)break e;for(rt=0;V=Re[ye+rt++],H.head&&V&&H.length<65536&&(H.head.comment+=String.fromCharCode(V)),V&&rt<Le;);if(512&H.flags&&(H.check=c(H.check,Re,rt,ye)),Le-=rt,ye+=rt,V)break e}else H.head&&(H.head.comment=null);H.mode=9;case 9:if(512&H.flags){for(;Te<16;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(xe!==(65535&H.check)){ve.msg="header crc mismatch",H.mode=30;break}Te=xe=0}H.head&&(H.head.hcrc=H.flags>>9&1,H.head.done=!0),ve.adler=H.check=0,H.mode=12;break;case 10:for(;Te<32;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}ve.adler=H.check=F(xe),Te=xe=0,H.mode=11;case 11:if(H.havedict===0)return ve.next_out=Be,ve.avail_out=Ke,ve.next_in=ye,ve.avail_in=Le,H.hold=xe,H.bits=Te,2;ve.adler=H.check=1,H.mode=12;case 12:if(je===5||je===6)break e;case 13:if(H.last){xe>>>=7&Te,Te-=7&Te,H.mode=27;break}for(;Te<3;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}switch(H.last=1&xe,Te-=1,3&(xe>>>=1)){case 0:H.mode=14;break;case 1:if(Ge(H),H.mode=20,je!==6)break;xe>>>=2,Te-=2;break e;case 2:H.mode=17;break;case 3:ve.msg="invalid block type",H.mode=30}xe>>>=2,Te-=2;break;case 14:for(xe>>>=7&Te,Te-=7&Te;Te<32;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if((65535&xe)!=(xe>>>16^65535)){ve.msg="invalid stored block lengths",H.mode=30;break}if(H.length=65535&xe,Te=xe=0,H.mode=15,je===6)break e;case 15:H.mode=16;case 16:if(rt=H.length){if(Le<rt&&(rt=Le),Ke<rt&&(rt=Ke),rt===0)break e;g.arraySet(_t,Re,ye,rt,Be),Le-=rt,ye+=rt,Ke-=rt,Be+=rt,H.length-=rt;break}H.mode=12;break;case 17:for(;Te<14;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(H.nlen=257+(31&xe),xe>>>=5,Te-=5,H.ndist=1+(31&xe),xe>>>=5,Te-=5,H.ncode=4+(15&xe),xe>>>=4,Te-=4,286<H.nlen||30<H.ndist){ve.msg="too many length or distance symbols",H.mode=30;break}H.have=0,H.mode=18;case 18:for(;H.have<H.ncode;){for(;Te<3;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.lens[Ze[H.have++]]=7&xe,xe>>>=3,Te-=3}for(;H.have<19;)H.lens[Ze[H.have++]]=0;if(H.lencode=H.lendyn,H.lenbits=7,ie={bits:H.lenbits},Ue=P(0,H.lens,0,19,H.lencode,0,H.work,ie),H.lenbits=ie.bits,Ue){ve.msg="invalid code lengths set",H.mode=30;break}H.have=0,H.mode=19;case 19:for(;H.have<H.nlen+H.ndist;){for(;Gt=(oe=H.lencode[xe&(1<<H.lenbits)-1])>>>16&255,pr=65535&oe,!((jt=oe>>>24)<=Te);){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(pr<16)xe>>>=jt,Te-=jt,H.lens[H.have++]=pr;else{if(pr===16){for(de=jt+2;Te<de;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(xe>>>=jt,Te-=jt,H.have===0){ve.msg="invalid bit length repeat",H.mode=30;break}V=H.lens[H.have-1],rt=3+(3&xe),xe>>>=2,Te-=2}else if(pr===17){for(de=jt+3;Te<de;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}Te-=jt,V=0,rt=3+(7&(xe>>>=jt)),xe>>>=3,Te-=3}else{for(de=jt+7;Te<de;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}Te-=jt,V=0,rt=11+(127&(xe>>>=jt)),xe>>>=7,Te-=7}if(H.have+rt>H.nlen+H.ndist){ve.msg="invalid bit length repeat",H.mode=30;break}for(;rt--;)H.lens[H.have++]=V}}if(H.mode===30)break;if(H.lens[256]===0){ve.msg="invalid code -- missing end-of-block",H.mode=30;break}if(H.lenbits=9,ie={bits:H.lenbits},Ue=P(R,H.lens,0,H.nlen,H.lencode,0,H.work,ie),H.lenbits=ie.bits,Ue){ve.msg="invalid literal/lengths set",H.mode=30;break}if(H.distbits=6,H.distcode=H.distdyn,ie={bits:H.distbits},Ue=P(D,H.lens,H.nlen,H.ndist,H.distcode,0,H.work,ie),H.distbits=ie.bits,Ue){ve.msg="invalid distances set",H.mode=30;break}if(H.mode=20,je===6)break e;case 20:H.mode=21;case 21:if(6<=Le&&258<=Ke){ve.next_out=Be,ve.avail_out=Ke,ve.next_in=ye,ve.avail_in=Le,H.hold=xe,H.bits=Te,T(ve,nt),Be=ve.next_out,_t=ve.output,Ke=ve.avail_out,ye=ve.next_in,Re=ve.input,Le=ve.avail_in,xe=H.hold,Te=H.bits,H.mode===12&&(H.back=-1);break}for(H.back=0;Gt=(oe=H.lencode[xe&(1<<H.lenbits)-1])>>>16&255,pr=65535&oe,!((jt=oe>>>24)<=Te);){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(Gt&&!(240&Gt)){for(lr=jt,gr=Gt,$r=pr;Gt=(oe=H.lencode[$r+((xe&(1<<lr+gr)-1)>>lr)])>>>16&255,pr=65535&oe,!(lr+(jt=oe>>>24)<=Te);){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}xe>>>=lr,Te-=lr,H.back+=lr}if(xe>>>=jt,Te-=jt,H.back+=jt,H.length=pr,Gt===0){H.mode=26;break}if(32&Gt){H.back=-1,H.mode=12;break}if(64&Gt){ve.msg="invalid literal/length code",H.mode=30;break}H.extra=15&Gt,H.mode=22;case 22:if(H.extra){for(de=H.extra;Te<de;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.length+=xe&(1<<H.extra)-1,xe>>>=H.extra,Te-=H.extra,H.back+=H.extra}H.was=H.length,H.mode=23;case 23:for(;Gt=(oe=H.distcode[xe&(1<<H.distbits)-1])>>>16&255,pr=65535&oe,!((jt=oe>>>24)<=Te);){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(!(240&Gt)){for(lr=jt,gr=Gt,$r=pr;Gt=(oe=H.distcode[$r+((xe&(1<<lr+gr)-1)>>lr)])>>>16&255,pr=65535&oe,!(lr+(jt=oe>>>24)<=Te);){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}xe>>>=lr,Te-=lr,H.back+=lr}if(xe>>>=jt,Te-=jt,H.back+=jt,64&Gt){ve.msg="invalid distance code",H.mode=30;break}H.offset=pr,H.extra=15&Gt,H.mode=24;case 24:if(H.extra){for(de=H.extra;Te<de;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}H.offset+=xe&(1<<H.extra)-1,xe>>>=H.extra,Te-=H.extra,H.back+=H.extra}if(H.offset>H.dmax){ve.msg="invalid distance too far back",H.mode=30;break}H.mode=25;case 25:if(Ke===0)break e;if(rt=nt-Ke,H.offset>rt){if((rt=H.offset-rt)>H.whave&&H.sane){ve.msg="invalid distance too far back",H.mode=30;break}qt=rt>H.wnext?(rt-=H.wnext,H.wsize-rt):H.wnext-rt,rt>H.length&&(rt=H.length),Kt=H.window}else Kt=_t,qt=Be-H.offset,rt=H.length;for(Ke<rt&&(rt=Ke),Ke-=rt,H.length-=rt;_t[Be++]=Kt[qt++],--rt;);H.length===0&&(H.mode=21);break;case 26:if(Ke===0)break e;_t[Be++]=H.length,Ke--,H.mode=21;break;case 27:if(H.wrap){for(;Te<32;){if(Le===0)break e;Le--,xe|=Re[ye++]<<Te,Te+=8}if(nt-=Ke,ve.total_out+=nt,H.total+=nt,nt&&(ve.adler=H.check=H.flags?c(H.check,_t,nt,Be-nt):y(H.check,_t,nt,Be-nt)),nt=Ke,(H.flags?xe:F(xe))!==H.check){ve.msg="incorrect data check",H.mode=30;break}Te=xe=0}H.mode=28;case 28:if(H.wrap&&H.flags){for(;Te<32;){if(Le===0)break e;Le--,xe+=Re[ye++]<<Te,Te+=8}if(xe!==(4294967295&H.total)){ve.msg="incorrect length check",H.mode=30;break}Te=xe=0}H.mode=29;case 29:Ue=1;break e;case 30:Ue=-3;break e;case 31:return-4;case 32:default:return N}return ve.next_out=Be,ve.avail_out=Ke,ve.next_in=ye,ve.avail_in=Le,H.hold=xe,H.bits=Te,(H.wsize||nt!==ve.avail_out&&H.mode<30&&(H.mode<27||je!==4))&&it(ve,ve.output,ve.next_out,nt-ve.avail_out)?(H.mode=31,-4):(ft-=ve.avail_in,nt-=ve.avail_out,ve.total_in+=ft,ve.total_out+=nt,H.total+=nt,H.wrap&&nt&&(ve.adler=H.check=H.flags?c(H.check,_t,nt,ve.next_out-nt):y(H.check,_t,nt,ve.next_out-nt)),ve.data_type=H.bits+(H.last?64:0)+(H.mode===12?128:0)+(H.mode===20||H.mode===15?256:0),(ft==0&&nt===0||je===4)&&Ue===A&&(Ue=-5),Ue)},d.inflateEnd=function(ve){if(!ve||!ve.state)return N;var je=ve.state;return je.window&&(je.window=null),ve.state=null,A},d.inflateGetHeader=function(ve,je){var H;return ve&&ve.state&&2&(H=ve.state).wrap?((H.head=je).done=!1,A):N},d.inflateSetDictionary=function(ve,je){var H,Re=je.length;return ve&&ve.state?(H=ve.state).wrap!==0&&H.mode!==11?N:H.mode===11&&y(1,je,Re,0)!==H.check?-3:it(ve,je,Re,Re)?(H.mode=31,-4):(H.havedict=1,A):N},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(i,u,d){var g=i("../utils/common"),y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];u.exports=function(R,D,A,N,X,U,te,F){var $,q,ne,se,Ee,ge,Oe,Fe,Ge,it=F.bits,ve=0,je=0,H=0,Re=0,_t=0,ye=0,Be=0,Le=0,Ke=0,xe=0,Te=null,ft=0,nt=new g.Buf16(16),rt=new g.Buf16(16),qt=null,Kt=0;for(ve=0;ve<=15;ve++)nt[ve]=0;for(je=0;je<N;je++)nt[D[A+je]]++;for(_t=it,Re=15;1<=Re&&nt[Re]===0;Re--);if(Re<_t&&(_t=Re),Re===0)return X[U++]=20971520,X[U++]=20971520,F.bits=1,0;for(H=1;H<Re&&nt[H]===0;H++);for(_t<H&&(_t=H),ve=Le=1;ve<=15;ve++)if(Le<<=1,(Le-=nt[ve])<0)return-1;if(0<Le&&(R===0||Re!==1))return-1;for(rt[1]=0,ve=1;ve<15;ve++)rt[ve+1]=rt[ve]+nt[ve];for(je=0;je<N;je++)D[A+je]!==0&&(te[rt[D[A+je]]++]=je);if(ge=R===0?(Te=qt=te,19):R===1?(Te=y,ft-=257,qt=c,Kt-=257,256):(Te=T,qt=P,-1),ve=H,Ee=U,Be=je=xe=0,ne=-1,se=(Ke=1<<(ye=_t))-1,R===1&&852<Ke||R===2&&592<Ke)return 1;for(;;){for(Oe=ve-Be,Ge=te[je]<ge?(Fe=0,te[je]):te[je]>ge?(Fe=qt[Kt+te[je]],Te[ft+te[je]]):(Fe=96,0),$=1<<ve-Be,H=q=1<<ye;X[Ee+(xe>>Be)+(q-=$)]=Oe<<24|Fe<<16|Ge|0,q!==0;);for($=1<<ve-1;xe&$;)$>>=1;if($!==0?(xe&=$-1,xe+=$):xe=0,je++,--nt[ve]==0){if(ve===Re)break;ve=D[A+te[je]]}if(_t<ve&&(xe&se)!==ne){for(Be===0&&(Be=_t),Ee+=H,Le=1<<(ye=ve-Be);ye+Be<Re&&!((Le-=nt[ye+Be])<=0);)ye++,Le<<=1;if(Ke+=1<<ye,R===1&&852<Ke||R===2&&592<Ke)return 1;X[ne=xe&se]=_t<<24|ye<<16|Ee-U|0}}return xe!==0&&(X[Ee+xe]=ve-Be<<24|64<<16|0),F.bits=_t,0}},{"../utils/common":41}],51:[function(i,u,d){u.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(i,u,d){var g=i("../utils/common"),y=0,c=1;function T(oe){for(var ke=oe.length;0<=--ke;)oe[ke]=0}var P=0,R=29,D=256,A=D+1+R,N=30,X=19,U=2*A+1,te=15,F=16,$=7,q=256,ne=16,se=17,Ee=18,ge=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Oe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=new Array(2*(A+2));T(it);var ve=new Array(2*N);T(ve);var je=new Array(512);T(je);var H=new Array(256);T(H);var Re=new Array(R);T(Re);var _t,ye,Be,Le=new Array(N);function Ke(oe,ke,Ze,tt,Ne){this.static_tree=oe,this.extra_bits=ke,this.extra_base=Ze,this.elems=tt,this.max_length=Ne,this.has_stree=oe&&oe.length}function xe(oe,ke){this.dyn_tree=oe,this.max_code=0,this.stat_desc=ke}function Te(oe){return oe<256?je[oe]:je[256+(oe>>>7)]}function ft(oe,ke){oe.pending_buf[oe.pending++]=255&ke,oe.pending_buf[oe.pending++]=ke>>>8&255}function nt(oe,ke,Ze){oe.bi_valid>F-Ze?(oe.bi_buf|=ke<<oe.bi_valid&65535,ft(oe,oe.bi_buf),oe.bi_buf=ke>>F-oe.bi_valid,oe.bi_valid+=Ze-F):(oe.bi_buf|=ke<<oe.bi_valid&65535,oe.bi_valid+=Ze)}function rt(oe,ke,Ze){nt(oe,Ze[2*ke],Ze[2*ke+1])}function qt(oe,ke){for(var Ze=0;Ze|=1&oe,oe>>>=1,Ze<<=1,0<--ke;);return Ze>>>1}function Kt(oe,ke,Ze){var tt,Ne,st=new Array(te+1),St=0;for(tt=1;tt<=te;tt++)st[tt]=St=St+Ze[tt-1]<<1;for(Ne=0;Ne<=ke;Ne++){var at=oe[2*Ne+1];at!==0&&(oe[2*Ne]=qt(st[at]++,at))}}function jt(oe){var ke;for(ke=0;ke<A;ke++)oe.dyn_ltree[2*ke]=0;for(ke=0;ke<N;ke++)oe.dyn_dtree[2*ke]=0;for(ke=0;ke<X;ke++)oe.bl_tree[2*ke]=0;oe.dyn_ltree[2*q]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Gt(oe){8<oe.bi_valid?ft(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function pr(oe,ke,Ze,tt){var Ne=2*ke,st=2*Ze;return oe[Ne]<oe[st]||oe[Ne]===oe[st]&&tt[ke]<=tt[Ze]}function lr(oe,ke,Ze){for(var tt=oe.heap[Ze],Ne=Ze<<1;Ne<=oe.heap_len&&(Ne<oe.heap_len&&pr(ke,oe.heap[Ne+1],oe.heap[Ne],oe.depth)&&Ne++,!pr(ke,tt,oe.heap[Ne],oe.depth));)oe.heap[Ze]=oe.heap[Ne],Ze=Ne,Ne<<=1;oe.heap[Ze]=tt}function gr(oe,ke,Ze){var tt,Ne,st,St,at=0;if(oe.last_lit!==0)for(;tt=oe.pending_buf[oe.d_buf+2*at]<<8|oe.pending_buf[oe.d_buf+2*at+1],Ne=oe.pending_buf[oe.l_buf+at],at++,tt===0?rt(oe,Ne,ke):(rt(oe,(st=H[Ne])+D+1,ke),(St=ge[st])!==0&&nt(oe,Ne-=Re[st],St),rt(oe,st=Te(--tt),Ze),(St=Oe[st])!==0&&nt(oe,tt-=Le[st],St)),at<oe.last_lit;);rt(oe,q,ke)}function $r(oe,ke){var Ze,tt,Ne,st=ke.dyn_tree,St=ke.stat_desc.static_tree,at=ke.stat_desc.has_stree,Lt=ke.stat_desc.elems,vr=-1;for(oe.heap_len=0,oe.heap_max=U,Ze=0;Ze<Lt;Ze++)st[2*Ze]!==0?(oe.heap[++oe.heap_len]=vr=Ze,oe.depth[Ze]=0):st[2*Ze+1]=0;for(;oe.heap_len<2;)st[2*(Ne=oe.heap[++oe.heap_len]=vr<2?++vr:0)]=1,oe.depth[Ne]=0,oe.opt_len--,at&&(oe.static_len-=St[2*Ne+1]);for(ke.max_code=vr,Ze=oe.heap_len>>1;1<=Ze;Ze--)lr(oe,st,Ze);for(Ne=Lt;Ze=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],lr(oe,st,1),tt=oe.heap[1],oe.heap[--oe.heap_max]=Ze,oe.heap[--oe.heap_max]=tt,st[2*Ne]=st[2*Ze]+st[2*tt],oe.depth[Ne]=(oe.depth[Ze]>=oe.depth[tt]?oe.depth[Ze]:oe.depth[tt])+1,st[2*Ze+1]=st[2*tt+1]=Ne,oe.heap[1]=Ne++,lr(oe,st,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(We,Gr){var nn,on,Qn,Qe,Wt,Bt,jr=Gr.dyn_tree,ei=Gr.max_code,Zt=Gr.stat_desc.static_tree,Di=Gr.stat_desc.has_stree,Ki=Gr.stat_desc.extra_bits,Yi=Gr.stat_desc.extra_base,Pn=Gr.stat_desc.max_length,he=0;for(Qe=0;Qe<=te;Qe++)We.bl_count[Qe]=0;for(jr[2*We.heap[We.heap_max]+1]=0,nn=We.heap_max+1;nn<U;nn++)Pn<(Qe=jr[2*jr[2*(on=We.heap[nn])+1]+1]+1)&&(Qe=Pn,he++),jr[2*on+1]=Qe,ei<on||(We.bl_count[Qe]++,Wt=0,Yi<=on&&(Wt=Ki[on-Yi]),Bt=jr[2*on],We.opt_len+=Bt*(Qe+Wt),Di&&(We.static_len+=Bt*(Zt[2*on+1]+Wt)));if(he!==0){do{for(Qe=Pn-1;We.bl_count[Qe]===0;)Qe--;We.bl_count[Qe]--,We.bl_count[Qe+1]+=2,We.bl_count[Pn]--,he-=2}while(0<he);for(Qe=Pn;Qe!==0;Qe--)for(on=We.bl_count[Qe];on!==0;)ei<(Qn=We.heap[--nn])||(jr[2*Qn+1]!==Qe&&(We.opt_len+=(Qe-jr[2*Qn+1])*jr[2*Qn],jr[2*Qn+1]=Qe),on--)}}(oe,ke),Kt(st,vr,oe.bl_count)}function V(oe,ke,Ze){var tt,Ne,st=-1,St=ke[1],at=0,Lt=7,vr=4;for(St===0&&(Lt=138,vr=3),ke[2*(Ze+1)+1]=65535,tt=0;tt<=Ze;tt++)Ne=St,St=ke[2*(tt+1)+1],++at<Lt&&Ne===St||(at<vr?oe.bl_tree[2*Ne]+=at:Ne!==0?(Ne!==st&&oe.bl_tree[2*Ne]++,oe.bl_tree[2*ne]++):at<=10?oe.bl_tree[2*se]++:oe.bl_tree[2*Ee]++,st=Ne,vr=(at=0)===St?(Lt=138,3):Ne===St?(Lt=6,3):(Lt=7,4))}function Ue(oe,ke,Ze){var tt,Ne,st=-1,St=ke[1],at=0,Lt=7,vr=4;for(St===0&&(Lt=138,vr=3),tt=0;tt<=Ze;tt++)if(Ne=St,St=ke[2*(tt+1)+1],!(++at<Lt&&Ne===St)){if(at<vr)for(;rt(oe,Ne,oe.bl_tree),--at!=0;);else Ne!==0?(Ne!==st&&(rt(oe,Ne,oe.bl_tree),at--),rt(oe,ne,oe.bl_tree),nt(oe,at-3,2)):at<=10?(rt(oe,se,oe.bl_tree),nt(oe,at-3,3)):(rt(oe,Ee,oe.bl_tree),nt(oe,at-11,7));st=Ne,vr=(at=0)===St?(Lt=138,3):Ne===St?(Lt=6,3):(Lt=7,4)}}T(Le);var ie=!1;function de(oe,ke,Ze,tt){nt(oe,(P<<1)+(tt?1:0),3),function(Ne,st,St,at){Gt(Ne),ft(Ne,St),ft(Ne,~St),g.arraySet(Ne.pending_buf,Ne.window,st,St,Ne.pending),Ne.pending+=St}(oe,ke,Ze)}d._tr_init=function(oe){ie||(function(){var ke,Ze,tt,Ne,st,St=new Array(te+1);for(Ne=tt=0;Ne<R-1;Ne++)for(Re[Ne]=tt,ke=0;ke<1<<ge[Ne];ke++)H[tt++]=Ne;for(H[tt-1]=Ne,Ne=st=0;Ne<16;Ne++)for(Le[Ne]=st,ke=0;ke<1<<Oe[Ne];ke++)je[st++]=Ne;for(st>>=7;Ne<N;Ne++)for(Le[Ne]=st<<7,ke=0;ke<1<<Oe[Ne]-7;ke++)je[256+st++]=Ne;for(Ze=0;Ze<=te;Ze++)St[Ze]=0;for(ke=0;ke<=143;)it[2*ke+1]=8,ke++,St[8]++;for(;ke<=255;)it[2*ke+1]=9,ke++,St[9]++;for(;ke<=279;)it[2*ke+1]=7,ke++,St[7]++;for(;ke<=287;)it[2*ke+1]=8,ke++,St[8]++;for(Kt(it,A+1,St),ke=0;ke<N;ke++)ve[2*ke+1]=5,ve[2*ke]=qt(ke,5);_t=new Ke(it,ge,D+1,A,te),ye=new Ke(ve,Oe,0,N,te),Be=new Ke(new Array(0),Fe,0,X,$)}(),ie=!0),oe.l_desc=new xe(oe.dyn_ltree,_t),oe.d_desc=new xe(oe.dyn_dtree,ye),oe.bl_desc=new xe(oe.bl_tree,Be),oe.bi_buf=0,oe.bi_valid=0,jt(oe)},d._tr_stored_block=de,d._tr_flush_block=function(oe,ke,Ze,tt){var Ne,st,St=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(at){var Lt,vr=4093624447;for(Lt=0;Lt<=31;Lt++,vr>>>=1)if(1&vr&&at.dyn_ltree[2*Lt]!==0)return y;if(at.dyn_ltree[18]!==0||at.dyn_ltree[20]!==0||at.dyn_ltree[26]!==0)return c;for(Lt=32;Lt<D;Lt++)if(at.dyn_ltree[2*Lt]!==0)return c;return y}(oe)),$r(oe,oe.l_desc),$r(oe,oe.d_desc),St=function(at){var Lt;for(V(at,at.dyn_ltree,at.l_desc.max_code),V(at,at.dyn_dtree,at.d_desc.max_code),$r(at,at.bl_desc),Lt=X-1;3<=Lt&&at.bl_tree[2*Ge[Lt]+1]===0;Lt--);return at.opt_len+=3*(Lt+1)+5+5+4,Lt}(oe),Ne=oe.opt_len+3+7>>>3,(st=oe.static_len+3+7>>>3)<=Ne&&(Ne=st)):Ne=st=Ze+5,Ze+4<=Ne&&ke!==-1?de(oe,ke,Ze,tt):oe.strategy===4||st===Ne?(nt(oe,2+(tt?1:0),3),gr(oe,it,ve)):(nt(oe,4+(tt?1:0),3),function(at,Lt,vr,We){var Gr;for(nt(at,Lt-257,5),nt(at,vr-1,5),nt(at,We-4,4),Gr=0;Gr<We;Gr++)nt(at,at.bl_tree[2*Ge[Gr]+1],3);Ue(at,at.dyn_ltree,Lt-1),Ue(at,at.dyn_dtree,vr-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,St+1),gr(oe,oe.dyn_ltree,oe.dyn_dtree)),jt(oe),tt&&Gt(oe)},d._tr_tally=function(oe,ke,Ze){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=ke>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&ke,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Ze,oe.last_lit++,ke===0?oe.dyn_ltree[2*Ze]++:(oe.matches++,ke--,oe.dyn_ltree[2*(H[Ze]+D+1)]++,oe.dyn_dtree[2*Te(ke)]++),oe.last_lit===oe.lit_bufsize-1},d._tr_align=function(oe){nt(oe,2,3),rt(oe,q,it),function(ke){ke.bi_valid===16?(ft(ke,ke.bi_buf),ke.bi_buf=0,ke.bi_valid=0):8<=ke.bi_valid&&(ke.pending_buf[ke.pending++]=255&ke.bi_buf,ke.bi_buf>>=8,ke.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(i,u,d){u.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(i,u,d){(function(g){(function(y,c){if(!y.setImmediate){var T,P,R,D,A=1,N={},X=!1,U=y.document,te=Object.getPrototypeOf&&Object.getPrototypeOf(y);te=te&&te.setTimeout?te:y,T={}.toString.call(y.process)==="[object process]"?function(ne){process.nextTick(function(){$(ne)})}:function(){if(y.postMessage&&!y.importScripts){var ne=!0,se=y.onmessage;return y.onmessage=function(){ne=!1},y.postMessage("","*"),y.onmessage=se,ne}}()?(D="setImmediate$"+Math.random()+"$",y.addEventListener?y.addEventListener("message",q,!1):y.attachEvent("onmessage",q),function(ne){y.postMessage(D+ne,"*")}):y.MessageChannel?((R=new MessageChannel).port1.onmessage=function(ne){$(ne.data)},function(ne){R.port2.postMessage(ne)}):U&&"onreadystatechange"in U.createElement("script")?(P=U.documentElement,function(ne){var se=U.createElement("script");se.onreadystatechange=function(){$(ne),se.onreadystatechange=null,P.removeChild(se),se=null},P.appendChild(se)}):function(ne){setTimeout($,0,ne)},te.setImmediate=function(ne){typeof ne!="function"&&(ne=new Function(""+ne));for(var se=new Array(arguments.length-1),Ee=0;Ee<se.length;Ee++)se[Ee]=arguments[Ee+1];var ge={callback:ne,args:se};return N[A]=ge,T(A),A++},te.clearImmediate=F}function F(ne){delete N[ne]}function $(ne){if(X)setTimeout($,0,ne);else{var se=N[ne];if(se){X=!0;try{(function(Ee){var ge=Ee.callback,Oe=Ee.args;switch(Oe.length){case 0:ge();break;case 1:ge(Oe[0]);break;case 2:ge(Oe[0],Oe[1]);break;case 3:ge(Oe[0],Oe[1],Oe[2]);break;default:ge.apply(c,Oe)}})(se)}finally{F(ne),X=!1}}}}function q(ne){ne.source===y&&typeof ne.data=="string"&&ne.data.indexOf(D)===0&&$(+ne.data.slice(D.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,typeof cd<"u"?cd:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(pT);var Bz=pT.exports;const Nz=ip(Bz);var nv=function(e,t){return nv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,u){i.__proto__=u}||function(i,u){for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(i[d]=u[d])},nv(e,t)};function No(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");nv(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var Rt=function(){return Rt=Object.assign||function(t){for(var i,u=1,d=arguments.length;u<d;u++){i=arguments[u];for(var g in i)Object.prototype.hasOwnProperty.call(i,g)&&(t[g]=i[g])}return t},Rt.apply(this,arguments)};function Oc(e,t){var i={};for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&t.indexOf(u)<0&&(i[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,u=Object.getOwnPropertySymbols(e);d<u.length;d++)t.indexOf(u[d])<0&&Object.prototype.propertyIsEnumerable.call(e,u[d])&&(i[u[d]]=e[u[d]]);return i}function Ti(e,t,i){if(i||arguments.length===2)for(var u=0,d=t.length,g;u<d;u++)(g||!(u in t))&&(g||(g=Array.prototype.slice.call(t,0,u)),g[u]=t[u]);return e.concat(g||Array.prototype.slice.call(t))}function Ei(e,t){var i=t&&t.cache?t.cache:Gz,u=t&&t.serializer?t.serializer:Hz,d=t&&t.strategy?t.strategy:jz;return d(e,{cache:i,serializer:u})}function $z(e){return e==null||typeof e=="number"||typeof e=="boolean"}function fT(e,t,i,u){var d=$z(u)?u:i(u),g=t.get(d);return typeof g>"u"&&(g=e.call(this,u),t.set(d,g)),g}function mT(e,t,i){var u=Array.prototype.slice.call(arguments,3),d=i(u),g=t.get(d);return typeof g>"u"&&(g=e.apply(this,u),t.set(d,g)),g}function P1(e,t,i,u,d){return i.bind(t,e,u,d)}function jz(e,t){var i=e.length===1?fT:mT;return P1(e,this,i,t.cache.create(),t.serializer)}function Uz(e,t){return P1(e,this,mT,t.cache.create(),t.serializer)}function Vz(e,t){return P1(e,this,fT,t.cache.create(),t.serializer)}var Hz=function(){return JSON.stringify(arguments)};function A1(){this.cache=Object.create(null)}A1.prototype.get=function(e){return this.cache[e]};A1.prototype.set=function(e,t){this.cache[e]=t};var Gz={create:function(){return new A1}},ki={variadic:Uz,monadic:Vz};function gT(e,t,i){if(i===void 0&&(i=Error),!e)throw new i(t)}Ei(function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.NumberFormat).bind.apply(e,Ti([void 0],t,!1)))},{strategy:ki.variadic});Ei(function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.DateTimeFormat).bind.apply(e,Ti([void 0],t,!1)))},{strategy:ki.variadic});Ei(function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.PluralRules).bind.apply(e,Ti([void 0],t,!1)))},{strategy:ki.variadic});Ei(function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.Locale).bind.apply(e,Ti([void 0],t,!1)))},{strategy:ki.variadic});Ei(function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.ListFormat).bind.apply(e,Ti([void 0],t,!1)))},{strategy:ki.variadic});var _r;(function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(_r||(_r={}));var Kr;(function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"})(Kr||(Kr={}));var Bc;(function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"})(Bc||(Bc={}));function m2(e){return e.type===Kr.literal}function Zz(e){return e.type===Kr.argument}function yT(e){return e.type===Kr.number}function _T(e){return e.type===Kr.date}function vT(e){return e.type===Kr.time}function xT(e){return e.type===Kr.select}function wT(e){return e.type===Kr.plural}function Wz(e){return e.type===Kr.pound}function bT(e){return e.type===Kr.tag}function ST(e){return!!(e&&typeof e=="object"&&e.type===Bc.number)}function iv(e){return!!(e&&typeof e=="object"&&e.type===Bc.dateTime)}var ET=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,qz=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function Xz(e){var t={};return e.replace(qz,function(i){var u=i.length;switch(i[0]){case"G":t.era=u===4?"long":u===5?"narrow":"short";break;case"y":t.year=u===2?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][u-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][u-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=u===4?"long":u===5?"narrow":"short";break;case"e":if(u<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][u-4];break;case"c":if(u<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][u-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][u-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][u-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][u-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][u-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][u-1];break;case"s":t.second=["numeric","2-digit"][u-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=u<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""}),t}var Kz=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;function Yz(e){if(e.length===0)throw new Error("Number skeleton cannot be empty");for(var t=e.split(Kz).filter(function(A){return A.length>0}),i=[],u=0,d=t;u<d.length;u++){var g=d[u],y=g.split("/");if(y.length===0)throw new Error("Invalid number skeleton");for(var c=y[0],T=y.slice(1),P=0,R=T;P<R.length;P++){var D=R[P];if(D.length===0)throw new Error("Invalid number skeleton")}i.push({stem:c,options:T})}return i}function Jz(e){return e.replace(/^(.*?)-/,"")}var g2=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,kT=/^(@+)?(\+|#+)?[rs]?$/g,Qz=/(\*)(0+)|(#+)(0+)|(0+)/g,TT=/^(0+)$/;function y2(e){var t={};return e[e.length-1]==="r"?t.roundingPriority="morePrecision":e[e.length-1]==="s"&&(t.roundingPriority="lessPrecision"),e.replace(kT,function(i,u,d){return typeof d!="string"?(t.minimumSignificantDigits=u.length,t.maximumSignificantDigits=u.length):d==="+"?t.minimumSignificantDigits=u.length:u[0]==="#"?t.maximumSignificantDigits=u.length:(t.minimumSignificantDigits=u.length,t.maximumSignificantDigits=u.length+(typeof d=="string"?d.length:0)),""}),t}function CT(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function eD(e){var t;if(e[0]==="E"&&e[1]==="E"?(t={notation:"engineering"},e=e.slice(2)):e[0]==="E"&&(t={notation:"scientific"},e=e.slice(1)),t){var i=e.slice(0,2);if(i==="+!"?(t.signDisplay="always",e=e.slice(2)):i==="+?"&&(t.signDisplay="exceptZero",e=e.slice(2)),!TT.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function _2(e){var t={},i=CT(e);return i||t}function tD(e){for(var t={},i=0,u=e;i<u.length;i++){var d=u[i];switch(d.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=d.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=Jz(d.options[0]);continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=Rt(Rt(Rt({},t),{notation:"scientific"}),d.options.reduce(function(T,P){return Rt(Rt({},T),_2(P))},{}));continue;case"engineering":t=Rt(Rt(Rt({},t),{notation:"engineering"}),d.options.reduce(function(T,P){return Rt(Rt({},T),_2(P))},{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(d.options[0]);continue;case"rounding-mode-floor":t.roundingMode="floor";continue;case"rounding-mode-ceiling":t.roundingMode="ceil";continue;case"rounding-mode-down":t.roundingMode="trunc";continue;case"rounding-mode-up":t.roundingMode="expand";continue;case"rounding-mode-half-even":t.roundingMode="halfEven";continue;case"rounding-mode-half-down":t.roundingMode="halfTrunc";continue;case"rounding-mode-half-up":t.roundingMode="halfExpand";continue;case"integer-width":if(d.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");d.options[0].replace(Qz,function(T,P,R,D,A,N){if(P)t.minimumIntegerDigits=R.length;else{if(D&&A)throw new Error("We currently do not support maximum integer digits");if(N)throw new Error("We currently do not support exact integer digits")}return""});continue}if(TT.test(d.stem)){t.minimumIntegerDigits=d.stem.length;continue}if(g2.test(d.stem)){if(d.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");d.stem.replace(g2,function(T,P,R,D,A,N){return R==="*"?t.minimumFractionDigits=P.length:D&&D[0]==="#"?t.maximumFractionDigits=D.length:A&&N?(t.minimumFractionDigits=A.length,t.maximumFractionDigits=A.length+N.length):(t.minimumFractionDigits=P.length,t.maximumFractionDigits=P.length),""});var g=d.options[0];g==="w"?t=Rt(Rt({},t),{trailingZeroDisplay:"stripIfInteger"}):g&&(t=Rt(Rt({},t),y2(g)));continue}if(kT.test(d.stem)){t=Rt(Rt({},t),y2(d.stem));continue}var y=CT(d.stem);y&&(t=Rt(Rt({},t),y));var c=eD(d.stem);c&&(t=Rt(Rt({},t),c))}return t}var jf={"001":["H","h"],419:["h","H","hB","hb"],AC:["H","h","hb","hB"],AD:["H","hB"],AE:["h","hB","hb","H"],AF:["H","hb","hB","h"],AG:["h","hb","H","hB"],AI:["H","h","hb","hB"],AL:["h","H","hB"],AM:["H","hB"],AO:["H","hB"],AR:["h","H","hB","hb"],AS:["h","H"],AT:["H","hB"],AU:["h","hb","H","hB"],AW:["H","hB"],AX:["H"],AZ:["H","hB","h"],BA:["H","hB","h"],BB:["h","hb","H","hB"],BD:["h","hB","H"],BE:["H","hB"],BF:["H","hB"],BG:["H","hB","h"],BH:["h","hB","hb","H"],BI:["H","h"],BJ:["H","hB"],BL:["H","hB"],BM:["h","hb","H","hB"],BN:["hb","hB","h","H"],BO:["h","H","hB","hb"],BQ:["H"],BR:["H","hB"],BS:["h","hb","H","hB"],BT:["h","H"],BW:["H","h","hb","hB"],BY:["H","h"],BZ:["H","h","hb","hB"],CA:["h","hb","H","hB"],CC:["H","h","hb","hB"],CD:["hB","H"],CF:["H","h","hB"],CG:["H","hB"],CH:["H","hB","h"],CI:["H","hB"],CK:["H","h","hb","hB"],CL:["h","H","hB","hb"],CM:["H","h","hB"],CN:["H","hB","hb","h"],CO:["h","H","hB","hb"],CP:["H"],CR:["h","H","hB","hb"],CU:["h","H","hB","hb"],CV:["H","hB"],CW:["H","hB"],CX:["H","h","hb","hB"],CY:["h","H","hb","hB"],CZ:["H"],DE:["H","hB"],DG:["H","h","hb","hB"],DJ:["h","H"],DK:["H"],DM:["h","hb","H","hB"],DO:["h","H","hB","hb"],DZ:["h","hB","hb","H"],EA:["H","h","hB","hb"],EC:["h","H","hB","hb"],EE:["H","hB"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],ER:["h","H"],ES:["H","hB","h","hb"],ET:["hB","hb","h","H"],FI:["H"],FJ:["h","hb","H","hB"],FK:["H","h","hb","hB"],FM:["h","hb","H","hB"],FO:["H","h"],FR:["H","hB"],GA:["H","hB"],GB:["H","h","hb","hB"],GD:["h","hb","H","hB"],GE:["H","hB","h"],GF:["H","hB"],GG:["H","h","hb","hB"],GH:["h","H"],GI:["H","h","hb","hB"],GL:["H","h"],GM:["h","hb","H","hB"],GN:["H","hB"],GP:["H","hB"],GQ:["H","hB","h","hb"],GR:["h","H","hb","hB"],GT:["h","H","hB","hb"],GU:["h","hb","H","hB"],GW:["H","hB"],GY:["h","hb","H","hB"],HK:["h","hB","hb","H"],HN:["h","H","hB","hb"],HR:["H","hB"],HU:["H","h"],IC:["H","h","hB","hb"],ID:["H"],IE:["H","h","hb","hB"],IL:["H","hB"],IM:["H","h","hb","hB"],IN:["h","H"],IO:["H","h","hb","hB"],IQ:["h","hB","hb","H"],IR:["hB","H"],IS:["H"],IT:["H","hB"],JE:["H","h","hb","hB"],JM:["h","hb","H","hB"],JO:["h","hB","hb","H"],JP:["H","K","h"],KE:["hB","hb","H","h"],KG:["H","h","hB","hb"],KH:["hB","h","H","hb"],KI:["h","hb","H","hB"],KM:["H","h","hB","hb"],KN:["h","hb","H","hB"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],KW:["h","hB","hb","H"],KY:["h","hb","H","hB"],KZ:["H","hB"],LA:["H","hb","hB","h"],LB:["h","hB","hb","H"],LC:["h","hb","H","hB"],LI:["H","hB","h"],LK:["H","h","hB","hb"],LR:["h","hb","H","hB"],LS:["h","H"],LT:["H","h","hb","hB"],LU:["H","h","hB"],LV:["H","hB","hb","h"],LY:["h","hB","hb","H"],MA:["H","h","hB","hb"],MC:["H","hB"],MD:["H","hB"],ME:["H","hB","h"],MF:["H","hB"],MG:["H","h"],MH:["h","hb","H","hB"],MK:["H","h","hb","hB"],ML:["H"],MM:["hB","hb","H","h"],MN:["H","h","hb","hB"],MO:["h","hB","hb","H"],MP:["h","hb","H","hB"],MQ:["H","hB"],MR:["h","hB","hb","H"],MS:["H","h","hb","hB"],MT:["H","h"],MU:["H","h"],MV:["H","h"],MW:["h","hb","H","hB"],MX:["h","H","hB","hb"],MY:["hb","hB","h","H"],MZ:["H","hB"],NA:["h","H","hB","hb"],NC:["H","hB"],NE:["H"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NI:["h","H","hB","hb"],NL:["H","hB"],NO:["H","h"],NP:["H","h","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],NZ:["h","hb","H","hB"],OM:["h","hB","hb","H"],PA:["h","H","hB","hb"],PE:["h","H","hB","hb"],PF:["H","h","hB"],PG:["h","H"],PH:["h","hB","hb","H"],PK:["h","hB","H"],PL:["H","h"],PM:["H","hB"],PN:["H","h","hb","hB"],PR:["h","H","hB","hb"],PS:["h","hB","hb","H"],PT:["H","hB"],PW:["h","H"],PY:["h","H","hB","hb"],QA:["h","hB","hb","H"],RE:["H","hB"],RO:["H","hB"],RS:["H","hB","h"],RU:["H"],RW:["H","h"],SA:["h","hB","hb","H"],SB:["h","hb","H","hB"],SC:["H","h","hB"],SD:["h","hB","hb","H"],SE:["H"],SG:["h","hb","H","hB"],SH:["H","h","hb","hB"],SI:["H","hB"],SJ:["H"],SK:["H"],SL:["h","hb","H","hB"],SM:["H","h","hB"],SN:["H","h","hB"],SO:["h","H"],SR:["H","hB"],SS:["h","hb","H","hB"],ST:["H","hB"],SV:["h","H","hB","hb"],SX:["H","h","hb","hB"],SY:["h","hB","hb","H"],SZ:["h","hb","H","hB"],TA:["H","h","hb","hB"],TC:["h","hb","H","hB"],TD:["h","H","hB"],TF:["H","h","hB"],TG:["H","hB"],TH:["H","h"],TJ:["H","h"],TL:["H","hB","hb","h"],TM:["H","h"],TN:["h","hB","hb","H"],TO:["h","H"],TR:["H","hB"],TT:["h","hb","H","hB"],TW:["hB","hb","h","H"],TZ:["hB","hb","H","h"],UA:["H","hB","h"],UG:["hB","hb","H","h"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],UY:["h","H","hB","hb"],UZ:["H","hB","h"],VA:["H","h","hB"],VC:["h","hb","H","hB"],VE:["h","H","hB","hb"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],VN:["H","h"],VU:["h","H"],WF:["H","hB"],WS:["h","H"],XK:["H","hB","h"],YE:["h","hB","hb","H"],YT:["H","hB"],ZA:["H","h","hb","hB"],ZM:["h","hb","H","hB"],ZW:["H","h"],"af-ZA":["H","h","hB","hb"],"ar-001":["h","hB","hb","H"],"ca-ES":["H","h","hB"],"en-001":["h","hb","H","hB"],"en-HK":["h","hb","H","hB"],"en-IL":["H","h","hb","hB"],"en-MY":["h","hb","H","hB"],"es-BR":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"gu-IN":["hB","hb","h","H"],"hi-IN":["hB","h","H"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],"ta-IN":["hB","h","hb","H"],"te-IN":["hB","h","H"],"zu-ZA":["H","hB","hb","h"]};function rD(e,t){for(var i="",u=0;u<e.length;u++){var d=e.charAt(u);if(d==="j"){for(var g=0;u+1<e.length&&e.charAt(u+1)===d;)g++,u++;var y=1+(g&1),c=g<2?1:3+(g>>1),T="a",P=nD(t);for((P=="H"||P=="k")&&(c=0);c-- >0;)i+=T;for(;y-- >0;)i=P+i}else d==="J"?i+="H":i+=d}return i}function nD(e){var t=e.hourCycle;if(t===void 0&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var i=e.language,u;i!=="root"&&(u=e.maximize().region);var d=jf[u||""]||jf[i||""]||jf["".concat(i,"-001")]||jf["001"];return d[0]}var U_,iD=new RegExp("^".concat(ET.source,"*")),oD=new RegExp("".concat(ET.source,"*$"));function wr(e,t){return{start:e,end:t}}var sD=!!String.prototype.startsWith&&"_a".startsWith("a",1),aD=!!String.fromCodePoint,lD=!!Object.fromEntries,uD=!!String.prototype.codePointAt,cD=!!String.prototype.trimStart,hD=!!String.prototype.trimEnd,dD=!!Number.isSafeInteger,pD=dD?Number.isSafeInteger:function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},ov=!0;try{var fD=PT("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");ov=((U_=fD.exec("a"))===null||U_===void 0?void 0:U_[0])==="a"}catch{ov=!1}var v2=sD?function(t,i,u){return t.startsWith(i,u)}:function(t,i,u){return t.slice(u,u+i.length)===i},sv=aD?String.fromCodePoint:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var u="",d=t.length,g=0,y;d>g;){if(y=t[g++],y>1114111)throw RangeError(y+" is not a valid code point");u+=y<65536?String.fromCharCode(y):String.fromCharCode(((y-=65536)>>10)+55296,y%1024+56320)}return u},x2=lD?Object.fromEntries:function(t){for(var i={},u=0,d=t;u<d.length;u++){var g=d[u],y=g[0],c=g[1];i[y]=c}return i},IT=uD?function(t,i){return t.codePointAt(i)}:function(t,i){var u=t.length;if(!(i<0||i>=u)){var d=t.charCodeAt(i),g;return d<55296||d>56319||i+1===u||(g=t.charCodeAt(i+1))<56320||g>57343?d:(d-55296<<10)+(g-56320)+65536}},mD=cD?function(t){return t.trimStart()}:function(t){return t.replace(iD,"")},gD=hD?function(t){return t.trimEnd()}:function(t){return t.replace(oD,"")};function PT(e,t){return new RegExp(e,t)}var av;if(ov){var w2=PT("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");av=function(t,i){var u;w2.lastIndex=i;var d=w2.exec(t);return(u=d[1])!==null&&u!==void 0?u:""}}else av=function(t,i){for(var u=[];;){var d=IT(t,i);if(d===void 0||AT(d)||xD(d))break;u.push(d),i+=d>=65536?2:1}return sv.apply(void 0,u)};var yD=function(){function e(t,i){i===void 0&&(i={}),this.message=t,this.position={offset:0,line:1,column:1},this.ignoreTag=!!i.ignoreTag,this.locale=i.locale,this.requiresOtherClause=!!i.requiresOtherClause,this.shouldParseSkeletons=!!i.shouldParseSkeletons}return e.prototype.parse=function(){if(this.offset()!==0)throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(t,i,u){for(var d=[];!this.isEOF();){var g=this.char();if(g===123){var y=this.parseArgument(t,u);if(y.err)return y;d.push(y.val)}else{if(g===125&&t>0)break;if(g===35&&(i==="plural"||i==="selectordinal")){var c=this.clonePosition();this.bump(),d.push({type:Kr.pound,location:wr(c,this.clonePosition())})}else if(g===60&&!this.ignoreTag&&this.peek()===47){if(u)break;return this.error(_r.UNMATCHED_CLOSING_TAG,wr(this.clonePosition(),this.clonePosition()))}else if(g===60&&!this.ignoreTag&&lv(this.peek()||0)){var y=this.parseTag(t,i);if(y.err)return y;d.push(y.val)}else{var y=this.parseLiteral(t,i);if(y.err)return y;d.push(y.val)}}}return{val:d,err:null}},e.prototype.parseTag=function(t,i){var u=this.clonePosition();this.bump();var d=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:Kr.literal,value:"<".concat(d,"/>"),location:wr(u,this.clonePosition())},err:null};if(this.bumpIf(">")){var g=this.parseMessage(t+1,i,!0);if(g.err)return g;var y=g.val,c=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!lv(this.char()))return this.error(_r.INVALID_TAG,wr(c,this.clonePosition()));var T=this.clonePosition(),P=this.parseTagName();return d!==P?this.error(_r.UNMATCHED_CLOSING_TAG,wr(T,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:Kr.tag,value:d,children:y,location:wr(u,this.clonePosition())},err:null}:this.error(_r.INVALID_TAG,wr(c,this.clonePosition())))}else return this.error(_r.UNCLOSED_TAG,wr(u,this.clonePosition()))}else return this.error(_r.INVALID_TAG,wr(u,this.clonePosition()))},e.prototype.parseTagName=function(){var t=this.offset();for(this.bump();!this.isEOF()&&vD(this.char());)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(t,i){for(var u=this.clonePosition(),d="";;){var g=this.tryParseQuote(i);if(g){d+=g;continue}var y=this.tryParseUnquoted(t,i);if(y){d+=y;continue}var c=this.tryParseLeftAngleBracket();if(c){d+=c;continue}break}var T=wr(u,this.clonePosition());return{val:{type:Kr.literal,value:d,location:T},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return!this.isEOF()&&this.char()===60&&(this.ignoreTag||!_D(this.peek()||0))?(this.bump(),"<"):null},e.prototype.tryParseQuote=function(t){if(this.isEOF()||this.char()!==39)return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if(t==="plural"||t==="selectordinal")break;return null;default:return null}this.bump();var i=[this.char()];for(this.bump();!this.isEOF();){var u=this.char();if(u===39)if(this.peek()===39)i.push(39),this.bump();else{this.bump();break}else i.push(u);this.bump()}return sv.apply(void 0,i)},e.prototype.tryParseUnquoted=function(t,i){if(this.isEOF())return null;var u=this.char();return u===60||u===123||u===35&&(i==="plural"||i==="selectordinal")||u===125&&t>0?null:(this.bump(),sv(u))},e.prototype.parseArgument=function(t,i){var u=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(_r.EXPECT_ARGUMENT_CLOSING_BRACE,wr(u,this.clonePosition()));if(this.char()===125)return this.bump(),this.error(_r.EMPTY_ARGUMENT,wr(u,this.clonePosition()));var d=this.parseIdentifierIfPossible().value;if(!d)return this.error(_r.MALFORMED_ARGUMENT,wr(u,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(_r.EXPECT_ARGUMENT_CLOSING_BRACE,wr(u,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Kr.argument,value:d,location:wr(u,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(_r.EXPECT_ARGUMENT_CLOSING_BRACE,wr(u,this.clonePosition())):this.parseArgumentOptions(t,i,d,u);default:return this.error(_r.MALFORMED_ARGUMENT,wr(u,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var t=this.clonePosition(),i=this.offset(),u=av(this.message,i),d=i+u.length;this.bumpTo(d);var g=this.clonePosition(),y=wr(t,g);return{value:u,location:y}},e.prototype.parseArgumentOptions=function(t,i,u,d){var g,y=this.clonePosition(),c=this.parseIdentifierIfPossible().value,T=this.clonePosition();switch(c){case"":return this.error(_r.EXPECT_ARGUMENT_TYPE,wr(y,T));case"number":case"date":case"time":{this.bumpSpace();var P=null;if(this.bumpIf(",")){this.bumpSpace();var R=this.clonePosition(),D=this.parseSimpleArgStyleIfPossible();if(D.err)return D;var A=gD(D.val);if(A.length===0)return this.error(_r.EXPECT_ARGUMENT_STYLE,wr(this.clonePosition(),this.clonePosition()));var N=wr(R,this.clonePosition());P={style:A,styleLocation:N}}var X=this.tryParseArgumentClose(d);if(X.err)return X;var U=wr(d,this.clonePosition());if(P&&v2(P==null?void 0:P.style,"::",0)){var te=mD(P.style.slice(2));if(c==="number"){var D=this.parseNumberSkeletonFromString(te,P.styleLocation);return D.err?D:{val:{type:Kr.number,value:u,location:U,style:D.val},err:null}}else{if(te.length===0)return this.error(_r.EXPECT_DATE_TIME_SKELETON,U);var F=te;this.locale&&(F=rD(te,this.locale));var A={type:Bc.dateTime,pattern:F,location:P.styleLocation,parsedOptions:this.shouldParseSkeletons?Xz(F):{}},$=c==="date"?Kr.date:Kr.time;return{val:{type:$,value:u,location:U,style:A},err:null}}}return{val:{type:c==="number"?Kr.number:c==="date"?Kr.date:Kr.time,value:u,location:U,style:(g=P==null?void 0:P.style)!==null&&g!==void 0?g:null},err:null}}case"plural":case"selectordinal":case"select":{var q=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(_r.EXPECT_SELECT_ARGUMENT_OPTIONS,wr(q,Rt({},q)));this.bumpSpace();var ne=this.parseIdentifierIfPossible(),se=0;if(c!=="select"&&ne.value==="offset"){if(!this.bumpIf(":"))return this.error(_r.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,wr(this.clonePosition(),this.clonePosition()));this.bumpSpace();var D=this.tryParseDecimalInteger(_r.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,_r.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(D.err)return D;this.bumpSpace(),ne=this.parseIdentifierIfPossible(),se=D.val}var Ee=this.tryParsePluralOrSelectOptions(t,c,i,ne);if(Ee.err)return Ee;var X=this.tryParseArgumentClose(d);if(X.err)return X;var ge=wr(d,this.clonePosition());return c==="select"?{val:{type:Kr.select,value:u,options:x2(Ee.val),location:ge},err:null}:{val:{type:Kr.plural,value:u,options:x2(Ee.val),offset:se,pluralType:c==="plural"?"cardinal":"ordinal",location:ge},err:null}}default:return this.error(_r.INVALID_ARGUMENT_TYPE,wr(y,T))}},e.prototype.tryParseArgumentClose=function(t){return this.isEOF()||this.char()!==125?this.error(_r.EXPECT_ARGUMENT_CLOSING_BRACE,wr(t,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var t=0,i=this.clonePosition();!this.isEOF();){var u=this.char();switch(u){case 39:{this.bump();var d=this.clonePosition();if(!this.bumpUntil("'"))return this.error(_r.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,wr(d,this.clonePosition()));this.bump();break}case 123:{t+=1,this.bump();break}case 125:{if(t>0)t-=1;else return{val:this.message.slice(i.offset,this.offset()),err:null};break}default:this.bump();break}}return{val:this.message.slice(i.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(t,i){var u=[];try{u=Yz(t)}catch{return this.error(_r.INVALID_NUMBER_SKELETON,i)}return{val:{type:Bc.number,tokens:u,location:i,parsedOptions:this.shouldParseSkeletons?tD(u):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(t,i,u,d){for(var g,y=!1,c=[],T=new Set,P=d.value,R=d.location;;){if(P.length===0){var D=this.clonePosition();if(i!=="select"&&this.bumpIf("=")){var A=this.tryParseDecimalInteger(_r.EXPECT_PLURAL_ARGUMENT_SELECTOR,_r.INVALID_PLURAL_ARGUMENT_SELECTOR);if(A.err)return A;R=wr(D,this.clonePosition()),P=this.message.slice(D.offset,this.offset())}else break}if(T.has(P))return this.error(i==="select"?_r.DUPLICATE_SELECT_ARGUMENT_SELECTOR:_r.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,R);P==="other"&&(y=!0),this.bumpSpace();var N=this.clonePosition();if(!this.bumpIf("{"))return this.error(i==="select"?_r.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:_r.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,wr(this.clonePosition(),this.clonePosition()));var X=this.parseMessage(t+1,i,u);if(X.err)return X;var U=this.tryParseArgumentClose(N);if(U.err)return U;c.push([P,{value:X.val,location:wr(N,this.clonePosition())}]),T.add(P),this.bumpSpace(),g=this.parseIdentifierIfPossible(),P=g.value,R=g.location}return c.length===0?this.error(i==="select"?_r.EXPECT_SELECT_ARGUMENT_SELECTOR:_r.EXPECT_PLURAL_ARGUMENT_SELECTOR,wr(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!y?this.error(_r.MISSING_OTHER_CLAUSE,wr(this.clonePosition(),this.clonePosition())):{val:c,err:null}},e.prototype.tryParseDecimalInteger=function(t,i){var u=1,d=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(u=-1);for(var g=!1,y=0;!this.isEOF();){var c=this.char();if(c>=48&&c<=57)g=!0,y=y*10+(c-48),this.bump();else break}var T=wr(d,this.clonePosition());return g?(y*=u,pD(y)?{val:y,err:null}:this.error(i,T)):this.error(t,T)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var t=this.position.offset;if(t>=this.message.length)throw Error("out of bound");var i=IT(this.message,t);if(i===void 0)throw Error("Offset ".concat(t," is at invalid UTF-16 code unit boundary"));return i},e.prototype.error=function(t,i){return{val:null,err:{kind:t,message:this.message,location:i}}},e.prototype.bump=function(){if(!this.isEOF()){var t=this.char();t===10?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=t<65536?1:2)}},e.prototype.bumpIf=function(t){if(v2(this.message,t,this.offset())){for(var i=0;i<t.length;i++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(t){var i=this.offset(),u=this.message.indexOf(t,i);return u>=0?(this.bumpTo(u),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(t){if(this.offset()>t)throw Error("targetOffset ".concat(t," must be greater than or equal to the current offset ").concat(this.offset()));for(t=Math.min(t,this.message.length);;){var i=this.offset();if(i===t)break;if(i>t)throw Error("targetOffset ".concat(t," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&AT(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var t=this.char(),i=this.offset(),u=this.message.charCodeAt(i+(t>=65536?2:1));return u??null},e}();function lv(e){return e>=97&&e<=122||e>=65&&e<=90}function _D(e){return lv(e)||e===47}function vD(e){return e===45||e===46||e>=48&&e<=57||e===95||e>=97&&e<=122||e>=65&&e<=90||e==183||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}function AT(e){return e>=9&&e<=13||e===32||e===133||e>=8206&&e<=8207||e===8232||e===8233}function xD(e){return e>=33&&e<=35||e===36||e>=37&&e<=39||e===40||e===41||e===42||e===43||e===44||e===45||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||e===91||e===92||e===93||e===94||e===96||e===123||e===124||e===125||e===126||e===161||e>=162&&e<=165||e===166||e===167||e===169||e===171||e===172||e===174||e===176||e===177||e===182||e===187||e===191||e===215||e===247||e>=8208&&e<=8213||e>=8214&&e<=8215||e===8216||e===8217||e===8218||e>=8219&&e<=8220||e===8221||e===8222||e===8223||e>=8224&&e<=8231||e>=8240&&e<=8248||e===8249||e===8250||e>=8251&&e<=8254||e>=8257&&e<=8259||e===8260||e===8261||e===8262||e>=8263&&e<=8273||e===8274||e===8275||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||e===8608||e>=8609&&e<=8610||e===8611||e>=8612&&e<=8613||e===8614||e>=8615&&e<=8621||e===8622||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||e===8658||e===8659||e===8660||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||e===8968||e===8969||e===8970||e===8971||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||e===9001||e===9002||e>=9003&&e<=9083||e===9084||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||e===9655||e>=9656&&e<=9664||e===9665||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||e===9839||e>=9840&&e<=10087||e===10088||e===10089||e===10090||e===10091||e===10092||e===10093||e===10094||e===10095||e===10096||e===10097||e===10098||e===10099||e===10100||e===10101||e>=10132&&e<=10175||e>=10176&&e<=10180||e===10181||e===10182||e>=10183&&e<=10213||e===10214||e===10215||e===10216||e===10217||e===10218||e===10219||e===10220||e===10221||e===10222||e===10223||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||e===10627||e===10628||e===10629||e===10630||e===10631||e===10632||e===10633||e===10634||e===10635||e===10636||e===10637||e===10638||e===10639||e===10640||e===10641||e===10642||e===10643||e===10644||e===10645||e===10646||e===10647||e===10648||e>=10649&&e<=10711||e===10712||e===10713||e===10714||e===10715||e>=10716&&e<=10747||e===10748||e===10749||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||e===11158||e>=11159&&e<=11263||e>=11776&&e<=11777||e===11778||e===11779||e===11780||e===11781||e>=11782&&e<=11784||e===11785||e===11786||e===11787||e===11788||e===11789||e>=11790&&e<=11798||e===11799||e>=11800&&e<=11801||e===11802||e===11803||e===11804||e===11805||e>=11806&&e<=11807||e===11808||e===11809||e===11810||e===11811||e===11812||e===11813||e===11814||e===11815||e===11816||e===11817||e>=11818&&e<=11822||e===11823||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||e===11840||e===11841||e===11842||e>=11843&&e<=11855||e>=11856&&e<=11857||e===11858||e>=11859&&e<=11903||e>=12289&&e<=12291||e===12296||e===12297||e===12298||e===12299||e===12300||e===12301||e===12302||e===12303||e===12304||e===12305||e>=12306&&e<=12307||e===12308||e===12309||e===12310||e===12311||e===12312||e===12313||e===12314||e===12315||e===12316||e===12317||e>=12318&&e<=12319||e===12320||e===12336||e===64830||e===64831||e>=65093&&e<=65094}function uv(e){e.forEach(function(t){if(delete t.location,xT(t)||wT(t))for(var i in t.options)delete t.options[i].location,uv(t.options[i].value);else yT(t)&&ST(t.style)||(_T(t)||vT(t))&&iv(t.style)?delete t.style.location:bT(t)&&uv(t.children)})}function wD(e,t){t===void 0&&(t={}),t=Rt({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var i=new yD(e,t).parse();if(i.err){var u=SyntaxError(_r[i.err.kind]);throw u.location=i.err.location,u.originalMessage=i.err.message,u}return t!=null&&t.captureLocation||uv(i.val),i.val}var ws;(function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"})(ws||(ws={}));var ol=function(e){No(t,e);function t(i,u,d){var g=e.call(this,i)||this;return g.code=u,g.originalMessage=d,g}return t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),b2=function(e){No(t,e);function t(i,u,d,g){return e.call(this,'Invalid values for "'.concat(i,'": "').concat(u,'". Options are "').concat(Object.keys(d).join('", "'),'"'),ws.INVALID_VALUE,g)||this}return t}(ol),bD=function(e){No(t,e);function t(i,u,d){return e.call(this,'Value for "'.concat(i,'" must be of type ').concat(u),ws.INVALID_VALUE,d)||this}return t}(ol),SD=function(e){No(t,e);function t(i,u){return e.call(this,'The intl string context variable "'.concat(i,'" was not provided to the string "').concat(u,'"'),ws.MISSING_VALUE,u)||this}return t}(ol),bi;(function(e){e[e.literal=0]="literal",e[e.object=1]="object"})(bi||(bi={}));function ED(e){return e.length<2?e:e.reduce(function(t,i){var u=t[t.length-1];return!u||u.type!==bi.literal||i.type!==bi.literal?t.push(i):u.value+=i.value,t},[])}function MT(e){return typeof e=="function"}function hm(e,t,i,u,d,g,y){if(e.length===1&&m2(e[0]))return[{type:bi.literal,value:e[0].value}];for(var c=[],T=0,P=e;T<P.length;T++){var R=P[T];if(m2(R)){c.push({type:bi.literal,value:R.value});continue}if(Wz(R)){typeof g=="number"&&c.push({type:bi.literal,value:i.getNumberFormat(t).format(g)});continue}var D=R.value;if(!(d&&D in d))throw new SD(D,y);var A=d[D];if(Zz(R)){(!A||typeof A=="string"||typeof A=="number")&&(A=typeof A=="string"||typeof A=="number"?String(A):""),c.push({type:typeof A=="string"?bi.literal:bi.object,value:A});continue}if(_T(R)){var N=typeof R.style=="string"?u.date[R.style]:iv(R.style)?R.style.parsedOptions:void 0;c.push({type:bi.literal,value:i.getDateTimeFormat(t,N).format(A)});continue}if(vT(R)){var N=typeof R.style=="string"?u.time[R.style]:iv(R.style)?R.style.parsedOptions:u.time.medium;c.push({type:bi.literal,value:i.getDateTimeFormat(t,N).format(A)});continue}if(yT(R)){var N=typeof R.style=="string"?u.number[R.style]:ST(R.style)?R.style.parsedOptions:void 0;N&&N.scale&&(A=A*(N.scale||1)),c.push({type:bi.literal,value:i.getNumberFormat(t,N).format(A)});continue}if(bT(R)){var X=R.children,U=R.value,te=d[U];if(!MT(te))throw new bD(U,"function",y);var F=hm(X,t,i,u,d,g),$=te(F.map(function(se){return se.value}));Array.isArray($)||($=[$]),c.push.apply(c,$.map(function(se){return{type:typeof se=="string"?bi.literal:bi.object,value:se}}))}if(xT(R)){var q=R.options[A]||R.options.other;if(!q)throw new b2(R.value,A,Object.keys(R.options),y);c.push.apply(c,hm(q.value,t,i,u,d));continue}if(wT(R)){var q=R.options["=".concat(A)];if(!q){if(!Intl.PluralRules)throw new ol(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ws.MISSING_INTL_API,y);var ne=i.getPluralRules(t,{type:R.pluralType}).select(A-(R.offset||0));q=R.options[ne]||R.options.other}if(!q)throw new b2(R.value,A,Object.keys(R.options),y);c.push.apply(c,hm(q.value,t,i,u,d,A-(R.offset||0)));continue}}return ED(c)}function kD(e,t){return t?Rt(Rt(Rt({},e||{}),t||{}),Object.keys(e).reduce(function(i,u){return i[u]=Rt(Rt({},e[u]),t[u]||{}),i},{})):e}function TD(e,t){return t?Object.keys(e).reduce(function(i,u){return i[u]=kD(e[u],t[u]),i},Rt({},e)):e}function V_(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,i){e[t]=i}}}}}function CD(e){return e===void 0&&(e={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:Ei(function(){for(var t,i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return new((t=Intl.NumberFormat).bind.apply(t,Ti([void 0],i,!1)))},{cache:V_(e.number),strategy:ki.variadic}),getDateTimeFormat:Ei(function(){for(var t,i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return new((t=Intl.DateTimeFormat).bind.apply(t,Ti([void 0],i,!1)))},{cache:V_(e.dateTime),strategy:ki.variadic}),getPluralRules:Ei(function(){for(var t,i=[],u=0;u<arguments.length;u++)i[u]=arguments[u];return new((t=Intl.PluralRules).bind.apply(t,Ti([void 0],i,!1)))},{cache:V_(e.pluralRules),strategy:ki.variadic})}}var zT=function(){function e(t,i,u,d){i===void 0&&(i=e.defaultLocale);var g=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(T){var P=g.formatToParts(T);if(P.length===1)return P[0].value;var R=P.reduce(function(D,A){return!D.length||A.type!==bi.literal||typeof D[D.length-1]!="string"?D.push(A.value):D[D.length-1]+=A.value,D},[]);return R.length<=1?R[0]||"":R},this.formatToParts=function(T){return hm(g.ast,g.locales,g.formatters,g.formats,T,void 0,g.message)},this.resolvedOptions=function(){var T;return{locale:((T=g.resolvedLocale)===null||T===void 0?void 0:T.toString())||Intl.NumberFormat.supportedLocalesOf(g.locales)[0]}},this.getAst=function(){return g.ast},this.locales=i,this.resolvedLocale=e.resolveLocale(i),typeof t=="string"){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var y=d||{};y.formatters;var c=Oc(y,["formatters"]);this.ast=e.__parse(t,Rt(Rt({},c),{locale:this.resolvedLocale}))}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=TD(e.formats,u),this.formatters=d&&d.formatters||CD(this.formatterCache)}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=new Intl.NumberFormat().resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(t){if(!(typeof Intl.Locale>"u")){var i=Intl.NumberFormat.supportedLocalesOf(t);return i.length>0?new Intl.Locale(i[0]):new Intl.Locale(typeof t=="string"?t:t[0])}},e.__parse=wD,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}(),ru;(function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"})(ru||(ru={}));var pp=function(e){No(t,e);function t(i,u,d){var g=this,y=d?d instanceof Error?d:new Error(String(d)):void 0;return g=e.call(this,"[@formatjs/intl Error ".concat(i,"] ").concat(u,`
`).concat(y?`
`.concat(y.message,`
`).concat(y.stack):""))||this,g.code=i,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(g,t),g}return t}(Error),ID=function(e){No(t,e);function t(i,u){return e.call(this,ru.UNSUPPORTED_FORMATTER,i,u)||this}return t}(pp),PD=function(e){No(t,e);function t(i,u){return e.call(this,ru.INVALID_CONFIG,i,u)||this}return t}(pp),S2=function(e){No(t,e);function t(i,u){return e.call(this,ru.MISSING_DATA,i,u)||this}return t}(pp),$o=function(e){No(t,e);function t(i,u,d){var g=e.call(this,ru.FORMAT_ERROR,"".concat(i,`
Locale: `).concat(u,`
`),d)||this;return g.locale=u,g}return t}(pp),H_=function(e){No(t,e);function t(i,u,d,g){var y=e.call(this,"".concat(i,`
MessageID: `).concat(d==null?void 0:d.id,`
Default Message: `).concat(d==null?void 0:d.defaultMessage,`
Description: `).concat(d==null?void 0:d.description,`
`),u,g)||this;return y.descriptor=d,y.locale=u,y}return t}($o),AD=function(e){No(t,e);function t(i,u){var d=e.call(this,ru.MISSING_TRANSLATION,'Missing message: "'.concat(i.id,'" for locale "').concat(u,'", using ').concat(i.defaultMessage?"default message (".concat(typeof i.defaultMessage=="string"?i.defaultMessage:i.defaultMessage.map(function(g){var y;return(y=g.value)!==null&&y!==void 0?y:JSON.stringify(g)}).join(),")"):"id"," as fallback."))||this;return d.descriptor=i,d}return t}(pp);function su(e,t,i){return i===void 0&&(i={}),t.reduce(function(u,d){return d in e?u[d]=e[d]:d in i&&(u[d]=i[d]),u},{})}var MD=function(e){},zD=function(e){},DT={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:MD,onWarn:zD};function RT(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function zl(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,i){e[t]=i}}}}}function DD(e){e===void 0&&(e=RT());var t=Intl.RelativeTimeFormat,i=Intl.ListFormat,u=Intl.DisplayNames,d=Ei(function(){for(var c,T=[],P=0;P<arguments.length;P++)T[P]=arguments[P];return new((c=Intl.DateTimeFormat).bind.apply(c,Ti([void 0],T,!1)))},{cache:zl(e.dateTime),strategy:ki.variadic}),g=Ei(function(){for(var c,T=[],P=0;P<arguments.length;P++)T[P]=arguments[P];return new((c=Intl.NumberFormat).bind.apply(c,Ti([void 0],T,!1)))},{cache:zl(e.number),strategy:ki.variadic}),y=Ei(function(){for(var c,T=[],P=0;P<arguments.length;P++)T[P]=arguments[P];return new((c=Intl.PluralRules).bind.apply(c,Ti([void 0],T,!1)))},{cache:zl(e.pluralRules),strategy:ki.variadic});return{getDateTimeFormat:d,getNumberFormat:g,getMessageFormat:Ei(function(c,T,P,R){return new zT(c,T,P,Rt({formatters:{getNumberFormat:g,getDateTimeFormat:d,getPluralRules:y}},R||{}))},{cache:zl(e.message),strategy:ki.variadic}),getRelativeTimeFormat:Ei(function(){for(var c=[],T=0;T<arguments.length;T++)c[T]=arguments[T];return new(t.bind.apply(t,Ti([void 0],c,!1)))},{cache:zl(e.relativeTime),strategy:ki.variadic}),getPluralRules:y,getListFormat:Ei(function(){for(var c=[],T=0;T<arguments.length;T++)c[T]=arguments[T];return new(i.bind.apply(i,Ti([void 0],c,!1)))},{cache:zl(e.list),strategy:ki.variadic}),getDisplayNames:Ei(function(){for(var c=[],T=0;T<arguments.length;T++)c[T]=arguments[T];return new(u.bind.apply(u,Ti([void 0],c,!1)))},{cache:zl(e.displayNames),strategy:ki.variadic})}}function M1(e,t,i,u){var d=e&&e[t],g;if(d&&(g=d[i]),g)return g;u(new ID("No ".concat(t," format named: ").concat(i)))}function Uf(e,t){return Object.keys(e).reduce(function(i,u){return i[u]=Rt({timeZone:t},e[u]),i},{})}function E2(e,t){var i=Object.keys(Rt(Rt({},e),t));return i.reduce(function(u,d){return u[d]=Rt(Rt({},e[d]||{}),t[d]||{}),u},{})}function k2(e,t){if(!t)return e;var i=zT.formats;return Rt(Rt(Rt({},i),e),{date:E2(Uf(i.date,t),Uf(e.date||{},t)),time:E2(Uf(i.time,t),Uf(e.time||{},t))})}var cv=function(e,t,i,u,d){var g=e.locale,y=e.formats,c=e.messages,T=e.defaultLocale,P=e.defaultFormats,R=e.fallbackOnEmptyString,D=e.onError,A=e.timeZone,N=e.defaultRichTextElements;i===void 0&&(i={id:""});var X=i.id,U=i.defaultMessage;gT(!!X,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var te=String(X),F=c&&Object.prototype.hasOwnProperty.call(c,te)&&c[te];if(Array.isArray(F)&&F.length===1&&F[0].type===Kr.literal)return F[0].value;if(!u&&F&&typeof F=="string"&&!N)return F.replace(/'\{(.*?)\}'/gi,"{$1}");if(u=Rt(Rt({},N),u||{}),y=k2(y,A),P=k2(P,A),!F){if(R===!1&&F==="")return F;if((!U||g&&g.toLowerCase()!==T.toLowerCase())&&D(new AD(i,g)),U)try{var $=t.getMessageFormat(U,T,P,d);return $.format(u)}catch(q){return D(new H_('Error formatting default message for: "'.concat(te,'", rendering default message verbatim'),g,i,q)),typeof U=="string"?U:te}return te}try{var $=t.getMessageFormat(F,g,y,Rt({formatters:t},d||{}));return $.format(u)}catch(q){D(new H_('Error formatting message: "'.concat(te,'", using ').concat(U?"default message":"id"," as fallback."),g,i,q))}if(U)try{var $=t.getMessageFormat(U,T,P,d);return $.format(u)}catch(q){D(new H_('Error formatting the default message for: "'.concat(te,'", rendering message verbatim'),g,i,q))}return typeof F=="string"?F:typeof U=="string"?U:te},LT=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function Mg(e,t,i,u){var d=e.locale,g=e.formats,y=e.onError,c=e.timeZone;u===void 0&&(u={});var T=u.format,P=Rt(Rt({},c&&{timeZone:c}),T&&M1(g,t,T,y)),R=su(u,LT,P);return t==="time"&&!R.hour&&!R.minute&&!R.second&&!R.timeStyle&&!R.dateStyle&&(R=Rt(Rt({},R),{hour:"numeric",minute:"numeric"})),i(d,R)}function RD(e,t){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];var d=i[0],g=i[1],y=g===void 0?{}:g,c=typeof d=="string"?new Date(d||0):d;try{return Mg(e,"date",t,y).format(c)}catch(T){e.onError(new $o("Error formatting date.",e.locale,T))}return String(c)}function LD(e,t){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];var d=i[0],g=i[1],y=g===void 0?{}:g,c=typeof d=="string"?new Date(d||0):d;try{return Mg(e,"time",t,y).format(c)}catch(T){e.onError(new $o("Error formatting time.",e.locale,T))}return String(c)}function FD(e,t){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];var d=i[0],g=i[1],y=i[2],c=y===void 0?{}:y,T=e.timeZone,P=e.locale,R=e.onError,D=su(c,LT,T?{timeZone:T}:{});try{return t(P,D).formatRange(d,g)}catch(A){R(new $o("Error formatting date time range.",e.locale,A))}return String(d)}function OD(e,t){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];var d=i[0],g=i[1],y=g===void 0?{}:g,c=typeof d=="string"?new Date(d||0):d;try{return Mg(e,"date",t,y).formatToParts(c)}catch(T){e.onError(new $o("Error formatting date.",e.locale,T))}return[]}function BD(e,t){for(var i=[],u=2;u<arguments.length;u++)i[u-2]=arguments[u];var d=i[0],g=i[1],y=g===void 0?{}:g,c=typeof d=="string"?new Date(d||0):d;try{return Mg(e,"time",t,y).formatToParts(c)}catch(T){e.onError(new $o("Error formatting time.",e.locale,T))}return[]}var ND=["style","type","fallback","languageDisplay"];function $D(e,t,i,u){var d=e.locale,g=e.onError,y=Intl.DisplayNames;y||g(new ol(`Intl.DisplayNames is not available in this environment.
Try polyfilling it using "@formatjs/intl-displaynames"
`,ws.MISSING_INTL_API));var c=su(u,ND);try{return t(d,c).of(i)}catch(T){g(new $o("Error formatting display name.",d,T))}}var jD=["type","style"],T2=Date.now();function UD(e){return"".concat(T2,"_").concat(e,"_").concat(T2)}function VD(e,t,i,u){u===void 0&&(u={});var d=FT(e,t,i,u).reduce(function(g,y){var c=y.value;return typeof c!="string"?g.push(c):typeof g[g.length-1]=="string"?g[g.length-1]+=c:g.push(c),g},[]);return d.length===1?d[0]:d.length===0?"":d}function FT(e,t,i,u){var d=e.locale,g=e.onError;u===void 0&&(u={});var y=Intl.ListFormat;y||g(new ol(`Intl.ListFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-listformat"
`,ws.MISSING_INTL_API));var c=su(u,jD);try{var T={},P=i.map(function(R,D){if(typeof R=="object"){var A=UD(D);return T[A]=R,A}return String(R)});return t(d,c).formatToParts(P).map(function(R){return R.type==="literal"?R:Rt(Rt({},R),{value:T[R.value]||R.value})})}catch(R){g(new $o("Error formatting list.",d,R))}return i}var HD=["type"];function GD(e,t,i,u){var d=e.locale,g=e.onError;u===void 0&&(u={}),Intl.PluralRules||g(new ol(`Intl.PluralRules is not available in this environment.
Try polyfilling it using "@formatjs/intl-pluralrules"
`,ws.MISSING_INTL_API));var y=su(u,HD);try{return t(d,y).select(i)}catch(c){g(new $o("Error formatting plural.",d,c))}return"other"}var ZD=["numeric","style"];function WD(e,t,i){var u=e.locale,d=e.formats,g=e.onError;i===void 0&&(i={});var y=i.format,c=!!y&&M1(d,"relative",y,g)||{},T=su(i,ZD,c);return t(u,T)}function qD(e,t,i,u,d){d===void 0&&(d={}),u||(u="second");var g=Intl.RelativeTimeFormat;g||e.onError(new ol(`Intl.RelativeTimeFormat is not available in this environment.
Try polyfilling it using "@formatjs/intl-relativetimeformat"
`,ws.MISSING_INTL_API));try{return WD(e,t,d).format(i,u)}catch(y){e.onError(new $o("Error formatting relative time.",e.locale,y))}return String(i)}var XD=["style","currency","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem","trailingZeroDisplay","roundingPriority","roundingIncrement","roundingMode"];function OT(e,t,i){var u=e.locale,d=e.formats,g=e.onError;i===void 0&&(i={});var y=i.format,c=y&&M1(d,"number",y,g)||{},T=su(i,XD,c);return t(u,T)}function KD(e,t,i,u){u===void 0&&(u={});try{return OT(e,t,u).format(i)}catch(d){e.onError(new $o("Error formatting number.",e.locale,d))}return String(i)}function YD(e,t,i,u){u===void 0&&(u={});try{return OT(e,t,u).formatToParts(i)}catch(d){e.onError(new $o("Error formatting number.",e.locale,d))}return[]}function JD(e){var t=e?e[Object.keys(e)[0]]:void 0;return typeof t=="string"}function QD(e){e.onWarn&&e.defaultRichTextElements&&JD(e.messages||{})&&e.onWarn(`[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. 
Please consider using "@formatjs/cli" to pre-compile your messages for performance.
For more details see https://formatjs.io/docs/getting-started/message-distribution`)}function e5(e,t){var i=DD(t),u=Rt(Rt({},DT),e),d=u.locale,g=u.defaultLocale,y=u.onError;return d?!Intl.NumberFormat.supportedLocalesOf(d).length&&y?y(new S2('Missing locale data for locale: "'.concat(d,'" in Intl.NumberFormat. Using default locale: "').concat(g,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(d).length&&y&&y(new S2('Missing locale data for locale: "'.concat(d,'" in Intl.DateTimeFormat. Using default locale: "').concat(g,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(y&&y(new PD('"locale" was not configured, using "'.concat(g,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),u.locale=u.defaultLocale||"en"),QD(u),Rt(Rt({},u),{formatters:i,formatNumber:KD.bind(null,u,i.getNumberFormat),formatNumberToParts:YD.bind(null,u,i.getNumberFormat),formatRelativeTime:qD.bind(null,u,i.getRelativeTimeFormat),formatDate:RD.bind(null,u,i.getDateTimeFormat),formatDateToParts:OD.bind(null,u,i.getDateTimeFormat),formatTime:LD.bind(null,u,i.getDateTimeFormat),formatDateTimeRange:FD.bind(null,u,i.getDateTimeFormat),formatTimeToParts:BD.bind(null,u,i.getDateTimeFormat),formatPlural:GD.bind(null,u,i.getPluralRules),formatMessage:cv.bind(null,u,i),$t:cv.bind(null,u,i),formatList:VD.bind(null,u,i.getListFormat),formatListToParts:FT.bind(null,u,i.getListFormat),formatDisplayName:$D.bind(null,u,i.getDisplayNames)})}function BT(e){gT(e,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var NT=Rt(Rt({},DT),{textComponent:$t.Fragment});function t5(e){return function(t){return e($t.Children.toArray(t))}}function hv(e,t){if(e===t)return!0;if(!e||!t)return!1;var i=Object.keys(e),u=Object.keys(t),d=i.length;if(u.length!==d)return!1;for(var g=0;g<d;g++){var y=i[g];if(e[y]!==t[y]||!Object.prototype.hasOwnProperty.call(t,y))return!1}return!0}var $T={exports:{}},Dr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jn=typeof Symbol=="function"&&Symbol.for,z1=jn?Symbol.for("react.element"):60103,D1=jn?Symbol.for("react.portal"):60106,zg=jn?Symbol.for("react.fragment"):60107,Dg=jn?Symbol.for("react.strict_mode"):60108,Rg=jn?Symbol.for("react.profiler"):60114,Lg=jn?Symbol.for("react.provider"):60109,Fg=jn?Symbol.for("react.context"):60110,R1=jn?Symbol.for("react.async_mode"):60111,Og=jn?Symbol.for("react.concurrent_mode"):60111,Bg=jn?Symbol.for("react.forward_ref"):60112,Ng=jn?Symbol.for("react.suspense"):60113,r5=jn?Symbol.for("react.suspense_list"):60120,$g=jn?Symbol.for("react.memo"):60115,jg=jn?Symbol.for("react.lazy"):60116,n5=jn?Symbol.for("react.block"):60121,i5=jn?Symbol.for("react.fundamental"):60117,o5=jn?Symbol.for("react.responder"):60118,s5=jn?Symbol.for("react.scope"):60119;function Eo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case z1:switch(e=e.type,e){case R1:case Og:case zg:case Rg:case Dg:case Ng:return e;default:switch(e=e&&e.$$typeof,e){case Fg:case Bg:case jg:case $g:case Lg:return e;default:return t}}case D1:return t}}}function jT(e){return Eo(e)===Og}Dr.AsyncMode=R1;Dr.ConcurrentMode=Og;Dr.ContextConsumer=Fg;Dr.ContextProvider=Lg;Dr.Element=z1;Dr.ForwardRef=Bg;Dr.Fragment=zg;Dr.Lazy=jg;Dr.Memo=$g;Dr.Portal=D1;Dr.Profiler=Rg;Dr.StrictMode=Dg;Dr.Suspense=Ng;Dr.isAsyncMode=function(e){return jT(e)||Eo(e)===R1};Dr.isConcurrentMode=jT;Dr.isContextConsumer=function(e){return Eo(e)===Fg};Dr.isContextProvider=function(e){return Eo(e)===Lg};Dr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===z1};Dr.isForwardRef=function(e){return Eo(e)===Bg};Dr.isFragment=function(e){return Eo(e)===zg};Dr.isLazy=function(e){return Eo(e)===jg};Dr.isMemo=function(e){return Eo(e)===$g};Dr.isPortal=function(e){return Eo(e)===D1};Dr.isProfiler=function(e){return Eo(e)===Rg};Dr.isStrictMode=function(e){return Eo(e)===Dg};Dr.isSuspense=function(e){return Eo(e)===Ng};Dr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===zg||e===Og||e===Rg||e===Dg||e===Ng||e===r5||typeof e=="object"&&e!==null&&(e.$$typeof===jg||e.$$typeof===$g||e.$$typeof===Lg||e.$$typeof===Fg||e.$$typeof===Bg||e.$$typeof===i5||e.$$typeof===o5||e.$$typeof===s5||e.$$typeof===n5)};Dr.typeOf=Eo;$T.exports=Dr;var a5=$T.exports,UT=a5,l5={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},u5={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},VT={};VT[UT.ForwardRef]=l5;VT[UT.Memo]=u5;var L1=typeof window<"u"&&!window.__REACT_INTL_BYPASS_GLOBAL_CONTEXT__?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=$t.createContext(null)):$t.createContext(null);L1.Consumer;var c5=L1.Provider,h5=c5,d5=L1;function Ug(){var e=$t.useContext(d5);return BT(e),e}var dv;(function(e){e.formatDate="FormattedDate",e.formatTime="FormattedTime",e.formatNumber="FormattedNumber",e.formatList="FormattedList",e.formatDisplayName="FormattedDisplayName"})(dv||(dv={}));var pv;(function(e){e.formatDate="FormattedDateParts",e.formatTime="FormattedTimeParts",e.formatNumber="FormattedNumberParts",e.formatList="FormattedListParts"})(pv||(pv={}));function HT(e){var t=function(i){var u=Ug(),d=i.value,g=i.children,y=Oc(i,["value","children"]),c=typeof d=="string"?new Date(d||0):d,T=e==="formatDate"?u.formatDateToParts(c,y):u.formatTimeToParts(c,y);return g(T)};return t.displayName=pv[e],t}function fp(e){var t=function(i){var u=Ug(),d=i.value,g=i.children,y=Oc(i,["value","children"]),c=u[e](d,y);if(typeof g=="function")return g(c);var T=u.textComponent||$t.Fragment;return $t.createElement(T,null,c)};return t.displayName=dv[e],t}function GT(e){return e&&Object.keys(e).reduce(function(t,i){var u=e[i];return t[i]=MT(u)?t5(u):u,t},{})}var C2=function(e,t,i,u){for(var d=[],g=4;g<arguments.length;g++)d[g-4]=arguments[g];var y=GT(u),c=cv.apply(void 0,Ti([e,t,i,y],d,!1));return Array.isArray(c)?$t.Children.toArray(c):c},I2=function(e,t){var i=e.defaultRichTextElements,u=Oc(e,["defaultRichTextElements"]),d=GT(i),g=e5(Rt(Rt(Rt({},NT),u),{defaultRichTextElements:d}),t),y={locale:g.locale,timeZone:g.timeZone,fallbackOnEmptyString:g.fallbackOnEmptyString,formats:g.formats,defaultLocale:g.defaultLocale,defaultFormats:g.defaultFormats,messages:g.messages,onError:g.onError,defaultRichTextElements:d};return Rt(Rt({},g),{formatMessage:C2.bind(null,y,g.formatters),$t:C2.bind(null,y,g.formatters)})};function G_(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}var p5=function(e){No(t,e);function t(){var i=e!==null&&e.apply(this,arguments)||this;return i.cache=RT(),i.state={cache:i.cache,intl:I2(G_(i.props),i.cache),prevConfig:G_(i.props)},i}return t.getDerivedStateFromProps=function(i,u){var d=u.prevConfig,g=u.cache,y=G_(i);return hv(d,y)?null:{intl:I2(y,g),prevConfig:y}},t.prototype.render=function(){return BT(this.state.intl),$t.createElement(h5,{value:this.state.intl},this.props.children)},t.displayName="IntlProvider",t.defaultProps=NT,t}($t.PureComponent);function f5(e,t){var i=e.values,u=Oc(e,["values"]),d=t.values,g=Oc(t,["values"]);return hv(d,i)&&hv(u,g)}function ZT(e){var t=Ug(),i=t.formatMessage,u=t.textComponent,d=u===void 0?$t.Fragment:u,g=e.id,y=e.description,c=e.defaultMessage,T=e.values,P=e.children,R=e.tagName,D=R===void 0?d:R,A=e.ignoreTag,N={id:g,description:y,defaultMessage:c},X=i(N,T,{ignoreTag:A});return typeof P=="function"?P(Array.isArray(X)?X:[X]):D?$t.createElement(D,null,$t.Children.toArray(X)):$t.createElement($t.Fragment,null,X)}ZT.displayName="FormattedMessage";var ln=$t.memo(ZT,f5);ln.displayName="MemoizedFormattedMessage";fp("formatDate");fp("formatTime");fp("formatNumber");fp("formatList");fp("formatDisplayName");HT("formatDate");HT("formatTime");const m5=["txt","zip"];function g5({onFileLoad:e,onDataFileLoad:t,onError:i}){const[u,d]=$t.useState(null),g=Ug(),y=c=>{c.name.toLowerCase().endsWith(".txt")?d(c):new Nz().loadAsync(c).then(function(T){Object.keys(T.files).forEach(P=>{P.toLowerCase().endsWith(".txt")?T.files[P].async("string").then(function(R){e(R)}):P.toLowerCase().endsWith(".jpg")&&T.files[P].async("arraybuffer").then(function(R){const D=new Uint8Array(R),A=new Blob([D.buffer]);t(P,A)})})})};return $t.useEffect(()=>{if(u){var c=new FileReader;c.readAsText(u,"UTF-8"),c.onload=function(T){e(T.target.result)},c.onerror=function(T){i()}}},[u,i,e]),Je.jsx(Oz,{classes:"fileUploadDropArea",handleChange:y,name:"file",types:m5,label:g.formatMessage({id:"app.uploadLabel",defaultMessage:"Upload or drag a file right here"})})}var WT={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,t){(function(i,u){e.exports=u()})(cd,function(){var i={},u={};function d(y,c,T){if(u[y]=T,y==="index"){var P="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",R={};return u.shared(R),u.index(i,R),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([P],{type:"text/javascript"}))),i}}d("shared",["exports"],function(y){function c(o,n,s,h){return new(s||(s=Promise))(function(m,x){function w(I){try{E(h.next(I))}catch(M){x(M)}}function b(I){try{E(h.throw(I))}catch(M){x(M)}}function E(I){var M;I.done?m(I.value):(M=I.value,M instanceof s?M:new s(function(L){L(M)})).then(w,b)}E((h=h.apply(o,n||[])).next())})}function T(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}typeof SuppressedError=="function"&&SuppressedError;var P=R;function R(o,n){this.x=o,this.y=n}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,n){return this.clone()._rotateAround(o,n)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var n=o.x-this.x,s=o.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,n){return Math.atan2(this.x*n-this.y*o,this.x*o+this.y*n)},_matMult:function(o){var n=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=n,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var n=Math.cos(o),s=Math.sin(o),h=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=h,this},_rotateAround:function(o,n){var s=Math.cos(o),h=Math.sin(o),m=n.y+h*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-h*(this.y-n.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(o){return o instanceof R?o:Array.isArray(o)?new R(o[0],o[1]):o};var D=T(P),A=N;function N(o,n,s,h){this.cx=3*o,this.bx=3*(s-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=n,this.p2x=s,this.p2y=h}N.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,n){if(n===void 0&&(n=1e-6),o<0)return 0;if(o>1)return 1;for(var s=o,h=0;h<8;h++){var m=this.sampleCurveX(s)-o;if(Math.abs(m)<n)return s;var x=this.sampleCurveDerivativeX(s);if(Math.abs(x)<1e-6)break;s-=m/x}var w=0,b=1;for(s=o,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-o)<n));h++)o>m?w=s:b=s,s=.5*(b-w)+w;return s},solve:function(o,n){return this.sampleCurveY(this.solveCurveX(o,n))}};var X=T(A);let U,te;function F(){return U==null&&(U=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),U}function $(){if(te==null&&(te=!1,F())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let h=0;h<5*5;h++){const m=4*h;n.fillStyle=`rgb(${m},${m+1},${m+2})`,n.fillRect(h%5,Math.floor(h/5),1,1)}const s=n.getImageData(0,0,5,5).data;for(let h=0;h<5*5*4;h++)if(h%4!=3&&s[h]!==h){te=!0;break}}}return te||!1}function q(o,n,s,h){const m=new X(o,n,s,h);return x=>m.solve(x)}const ne=q(.25,.1,.25,1);function se(o,n,s){return Math.min(s,Math.max(n,o))}function Ee(o,n,s){const h=s-n,m=((o-n)%h+h)%h+n;return m===n?s:m}function ge(o,...n){for(const s of n)for(const h in s)o[h]=s[h];return o}let Oe=1;function Fe(o,n,s){const h={};for(const m in o)h[m]=n.call(this,o[m],m,o);return h}function Ge(o,n,s){const h={};for(const m in o)n.call(this,o[m],m,o)&&(h[m]=o[m]);return h}function it(o){return Array.isArray(o)?o.map(it):typeof o=="object"&&o?Fe(o,it):o}const ve={};function je(o){ve[o]||(typeof console<"u"&&console.warn(o),ve[o]=!0)}function H(o,n,s){return(s.y-o.y)*(n.x-o.x)>(n.y-o.y)*(s.x-o.x)}function Re(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let _t=null;function ye(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Le(o,n,s,h,m){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(o,{timestamp:0});try{const w=x==null?void 0:x.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const b=w.startsWith("BGR"),E=new Uint8ClampedArray(h*m*4);if(yield x.copyTo(E,function(I,M,L,j,W){const Y=4*Math.max(-M,0),J=(Math.max(0,L)-L)*j*4+Y,le=4*j,pe=Math.max(0,M),ze=Math.max(0,L);return{rect:{x:pe,y:ze,width:Math.min(I.width,M+j)-pe,height:Math.min(I.height,L+W)-ze},layout:[{offset:J,stride:le}]}}(o,n,s,h,m)),b)for(let I=0;I<E.length;I+=4){const M=E[I];E[I]=E[I+2],E[I+2]=M}return E}finally{x.close()}})}let Ke,xe;const Te="AbortError";function ft(){return new Error(Te)}const nt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function rt(o){return nt.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const qt="global-dispatcher";class Kt extends Error{constructor(n,s,h,m){super(`AJAXError: ${s} (${n}): ${h}`),this.status=n,this.statusText=s,this.url=h,this.body=m}}const jt=()=>Re(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Gt=function(o,n){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const h=rt(o.url);if(h)return h(o,n);if(Re(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:qt},n)}if(!(/^file:/.test(s=o.url)||/^file:/.test(jt())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,m){return c(this,void 0,void 0,function*(){const x=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:jt(),signal:m.signal});h.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");const w=yield fetch(x);if(!w.ok){const I=yield w.blob();throw new Kt(w.status,w.statusText,h.url,I)}let b;b=h.type==="arrayBuffer"||h.type==="image"?w.arrayBuffer():h.type==="json"?w.json():w.text();const E=yield b;if(m.signal.aborted)throw ft();return{data:E,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}})}(o,n);if(Re(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:qt},n)}var s;return function(h,m){return new Promise((x,w)=>{var b;const E=new XMLHttpRequest;E.open(h.method||"GET",h.url,!0),h.type!=="arrayBuffer"&&h.type!=="image"||(E.responseType="arraybuffer");for(const I in h.headers)E.setRequestHeader(I,h.headers[I]);h.type==="json"&&(E.responseType="text",!((b=h.headers)===null||b===void 0)&&b.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=h.credentials==="include",E.onerror=()=>{w(new Error(E.statusText))},E.onload=()=>{if(!m.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let I=E.response;if(h.type==="json")try{I=JSON.parse(E.response)}catch(M){return void w(M)}x({data:I,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const I=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});w(new Kt(E.status,E.statusText,h.url,I))}},m.signal.addEventListener("abort",()=>{E.abort(),w(ft())}),E.send(h.body)})}(o,n)};function pr(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const n=new URL(o),s=window.location;return n.protocol===s.protocol&&n.host===s.host}function lr(o,n,s){s[o]&&s[o].indexOf(n)!==-1||(s[o]=s[o]||[],s[o].push(n))}function gr(o,n,s){if(s&&s[o]){const h=s[o].indexOf(n);h!==-1&&s[o].splice(h,1)}}class $r{constructor(n,s={}){ge(this,s),this.type=n}}class V extends $r{constructor(n,s={}){super("error",ge({error:n},s))}}class Ue{on(n,s){return this._listeners=this._listeners||{},lr(n,s,this._listeners),this}off(n,s){return gr(n,s,this._listeners),gr(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},lr(n,s,this._oneTimeListeners),this):new Promise(h=>this.once(n,h))}fire(n,s){typeof n=="string"&&(n=new $r(n,s||{}));const h=n.type;if(this.listens(h)){n.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const b of m)b.call(this,n);const x=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const b of x)gr(h,b,this._oneTimeListeners),b.call(this,n);const w=this._eventedParent;w&&(ge(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(n))}else n instanceof V&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var ie={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const de=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oe(o,n){const s={};for(const h in o)h!=="ref"&&(s[h]=o[h]);return de.forEach(h=>{h in n&&(s[h]=n[h])}),s}function ke(o,n){if(Array.isArray(o)){if(!Array.isArray(n)||o.length!==n.length)return!1;for(let s=0;s<o.length;s++)if(!ke(o[s],n[s]))return!1;return!0}if(typeof o=="object"&&o!==null&&n!==null){if(typeof n!="object"||Object.keys(o).length!==Object.keys(n).length)return!1;for(const s in o)if(!ke(o[s],n[s]))return!1;return!0}return o===n}function Ze(o,n){o.push(n)}function tt(o,n,s){Ze(s,{command:"addSource",args:[o,n[o]]})}function Ne(o,n,s){Ze(n,{command:"removeSource",args:[o]}),s[o]=!0}function st(o,n,s,h){Ne(o,s,h),tt(o,n,s)}function St(o,n,s){let h;for(h in o[s])if(Object.prototype.hasOwnProperty.call(o[s],h)&&h!=="data"&&!ke(o[s][h],n[s][h]))return!1;for(h in n[s])if(Object.prototype.hasOwnProperty.call(n[s],h)&&h!=="data"&&!ke(o[s][h],n[s][h]))return!1;return!0}function at(o,n,s,h,m,x){o=o||{},n=n||{};for(const w in o)Object.prototype.hasOwnProperty.call(o,w)&&(ke(o[w],n[w])||s.push({command:x,args:[h,w,n[w],m]}));for(const w in n)Object.prototype.hasOwnProperty.call(n,w)&&!Object.prototype.hasOwnProperty.call(o,w)&&(ke(o[w],n[w])||s.push({command:x,args:[h,w,n[w],m]}))}function Lt(o){return o.id}function vr(o,n){return o[n.id]=n,o}class We{constructor(n,s,h,m){this.message=(n?`${n}: `:"")+h,m&&(this.identifier=m),s!=null&&s.__line__&&(this.line=s.__line__)}}function Gr(o,...n){for(const s of n)for(const h in s)o[h]=s[h];return o}class nn extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class on{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[h,m]of s)this.bindings[h]=m}concat(n){return new on(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Qn={kind:"null"},Qe={kind:"number"},Wt={kind:"string"},Bt={kind:"boolean"},jr={kind:"color"},ei={kind:"object"},Zt={kind:"value"},Di={kind:"collator"},Ki={kind:"formatted"},Yi={kind:"padding"},Pn={kind:"resolvedImage"},he={kind:"variableAnchorOffsetCollection"};function Z(o,n){return{kind:"array",itemType:o,N:n}}function G(o){if(o.kind==="array"){const n=G(o.itemType);return typeof o.N=="number"?`array<${n}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${n}>`}return o.kind}const ee=[Qn,Qe,Wt,Bt,jr,Ki,ei,Z(Zt),Yi,Pn,he];function ue(o,n){if(n.kind==="error")return null;if(o.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ue(o.itemType,n.itemType))&&(typeof o.N!="number"||o.N===n.N))return null}else{if(o.kind===n.kind)return null;if(o.kind==="value"){for(const s of ee)if(!ue(s,n))return null}}return`Expected ${G(o)} but found ${G(n)} instead.`}function Se(o,n){return n.some(s=>s.kind===o.kind)}function Ie(o,n){return n.some(s=>s==="null"?o===null:s==="array"?Array.isArray(o):s==="object"?o&&!Array.isArray(o)&&typeof o=="object":s===typeof o)}function Me(o,n){return o.kind==="array"&&n.kind==="array"?o.itemType.kind===n.itemType.kind&&typeof o.N=="number":o.kind===n.kind}const _e=.96422,He=.82521,Ye=4/29,$e=6/29,ut=3*$e*$e,Mt=$e*$e*$e,Dt=Math.PI/180,cr=180/Math.PI;function Xt(o){return(o%=360)<0&&(o+=360),o}function hr([o,n,s,h]){let m,x;const w=dn((.2225045*(o=rr(o))+.7168786*(n=rr(n))+.0606169*(s=rr(s)))/1);o===n&&n===s?m=x=w:(m=dn((.4360747*o+.3850649*n+.1430804*s)/_e),x=dn((.0139322*o+.0971045*n+.7141733*s)/He));const b=116*w-16;return[b<0?0:b,500*(m-w),200*(w-x),h]}function rr(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function dn(o){return o>Mt?Math.pow(o,1/3):o/ut+Ye}function Zr([o,n,s,h]){let m=(o+16)/116,x=isNaN(n)?m:m+n/500,w=isNaN(s)?m:m-s/200;return m=1*Sr(m),x=_e*Sr(x),w=He*Sr(w),[Jt(3.1338561*x-1.6168667*m-.4906146*w),Jt(-.9787684*x+1.9161415*m+.033454*w),Jt(.0719453*x-.2289914*m+1.4052427*w),h]}function Jt(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Sr(o){return o>$e?o*o*o:ut*(o-Ye)}function Nr(o){return parseInt(o.padEnd(2,o),16)/255}function _n(o,n){return En(n?o/100:o,0,1)}function En(o,n,s){return Math.min(Math.max(n,o),s)}function Un(o){return!o.some(Number.isNaN)}const Qs={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Er{constructor(n,s,h,m=1,x=!0){this.r=n,this.g=s,this.b=h,this.a=m,x||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[n,s,h,m]))}static parse(n){if(n instanceof Er)return n;if(typeof n!="string")return;const s=function(h){if((h=h.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Qs[h];if(m){const[w,b,E]=m;return[w/255,b/255,E/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const w=h.length<6?1:2;let b=1;return[Nr(h.slice(b,b+=w)),Nr(h.slice(b,b+=w)),Nr(h.slice(b,b+=w)),Nr(h.slice(b,b+w)||"ff")]}if(h.startsWith("rgb")){const w=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[b,E,I,M,L,j,W,Y,J,le,pe,ze]=w,be=[M||" ",W||" ",le].join("");if(be==="  "||be==="  /"||be===",,"||be===",,,"){const Ae=[I,j,J].join(""),Ve=Ae==="%%%"?100:Ae===""?255:0;if(Ve){const et=[En(+E/Ve,0,1),En(+L/Ve,0,1),En(+Y/Ve,0,1),pe?_n(+pe,ze):1];if(Un(et))return et}}return}}const x=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,b,E,I,M,L,j,W,Y]=x,J=[E||" ",M||" ",j].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const le=[+b,En(+I,0,100),En(+L,0,100),W?_n(+W,Y):1];if(Un(le))return function([pe,ze,be,Ae]){function Ve(et){const vt=(et+pe/30)%12,Ft=ze*Math.min(be,1-be);return be-Ft*Math.max(-1,Math.min(vt-3,9-vt,1))}return pe=Xt(pe),ze/=100,be/=100,[Ve(0),Ve(8),Ve(4),Ae]}(le)}}}(n);return s?new Er(...s,!1):void 0}get rgb(){const{r:n,g:s,b:h,a:m}=this,x=m||1/0;return this.overwriteGetter("rgb",[n/x,s/x,h/x,m])}get hcl(){return this.overwriteGetter("hcl",function(n){const[s,h,m,x]=hr(n),w=Math.sqrt(h*h+m*m);return[Math.round(1e4*w)?Xt(Math.atan2(m,h)*cr):NaN,w,s,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",hr(this.rgb))}overwriteGetter(n,s){return Object.defineProperty(this,n,{value:s}),s}toString(){const[n,s,h,m]=this.rgb;return`rgba(${[n,s,h].map(x=>Math.round(255*x)).join(",")},${m})`}}Er.black=new Er(0,0,0,1),Er.white=new Er(1,1,1,1),Er.transparent=new Er(0,0,0,0),Er.red=new Er(1,0,0,1);class qc{constructor(n,s,h){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xc{constructor(n,s,h,m,x){this.text=n,this.image=s,this.scale=h,this.fontStack=m,this.textColor=x}}class fi{constructor(n){this.sections=n}static fromString(n){return new fi([new Xc(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof fi?n:fi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class mi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof mi)return n;if(typeof n=="number")return new mi([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const s of n)if(typeof s!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new mi(n)}}toString(){return JSON.stringify(this.values)}}const Kg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ri{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Ri)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let s=0;s<n.length;s+=2){const h=n[s],m=n[s+1];if(typeof h!="string"||!Kg.has(h)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Ri(n)}}toString(){return JSON.stringify(this.values)}}class gi{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new gi({name:n,available:!1}):null}}function ea(o,n,s,h){return typeof o=="number"&&o>=0&&o<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[o,n,s,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[o,n,s,h]:[o,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function bs(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Er||o instanceof qc||o instanceof fi||o instanceof mi||o instanceof Ri||o instanceof gi)return!0;if(Array.isArray(o)){for(const n of o)if(!bs(n))return!1;return!0}if(typeof o=="object"){for(const n in o)if(!bs(o[n]))return!1;return!0}return!1}function pn(o){if(o===null)return Qn;if(typeof o=="string")return Wt;if(typeof o=="boolean")return Bt;if(typeof o=="number")return Qe;if(o instanceof Er)return jr;if(o instanceof qc)return Di;if(o instanceof fi)return Ki;if(o instanceof mi)return Yi;if(o instanceof Ri)return he;if(o instanceof gi)return Pn;if(Array.isArray(o)){const n=o.length;let s;for(const h of o){const m=pn(h);if(s){if(s===m)continue;s=Zt;break}s=m}return Z(s||Zt,n)}return ei}function sl(o){const n=typeof o;return o===null?"":n==="string"||n==="number"||n==="boolean"?String(o):o instanceof Er||o instanceof fi||o instanceof mi||o instanceof Ri||o instanceof gi?o.toString():JSON.stringify(o)}class Ji{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!bs(n[1]))return s.error("invalid value");const h=n[1];let m=pn(h);const x=s.expectedType;return m.kind!=="array"||m.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(m=x),new Ji(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class sn{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const au={string:Wt,number:Qe,boolean:Bt,object:ei};class Qi{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let h,m=1;const x=n[0];if(x==="array"){let b,E;if(n.length>2){const I=n[1];if(typeof I!="string"||!(I in au)||I==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);b=au[I],m++}else b=Zt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);E=n[2],m++}h=Z(b,E)}else{if(!au[x])throw new Error(`Types doesn't contain name = ${x}`);h=au[x]}const w=[];for(;m<n.length;m++){const b=s.parse(n[m],m,Zt);if(!b)return null;w.push(b)}return new Qi(h,w)}evaluate(n){for(let s=0;s<this.args.length;s++){const h=this.args[s].evaluate(n);if(!ue(this.type,pn(h)))return h;if(s===this.args.length-1)throw new sn(`Expected value to be of type ${G(this.type)}, but found ${G(pn(h))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Kc={"to-boolean":Bt,"to-color":jr,"to-number":Qe,"to-string":Wt};class eo{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const h=n[0];if(!Kc[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&n.length!==2)return s.error("Expected one argument.");const m=Kc[h],x=[];for(let w=1;w<n.length;w++){const b=s.parse(n[w],w,Zt);if(!b)return null;x.push(b)}return new eo(m,x)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let s,h;for(const m of this.args){if(s=m.evaluate(n),h=null,s instanceof Er)return s;if(typeof s=="string"){const x=n.parseColor(s);if(x)return x}else if(Array.isArray(s)&&(h=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:ea(s[0],s[1],s[2],s[3]),!h))return new Er(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new sn(h||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const h of this.args){s=h.evaluate(n);const m=mi.parse(s);if(m)return m}throw new sn(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const h of this.args){s=h.evaluate(n);const m=Ri.parse(s);if(m)return m}throw new sn(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const h of this.args){if(s=h.evaluate(n),s===null)return 0;const m=Number(s);if(!isNaN(m))return m}throw new sn(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return fi.fromString(sl(this.args[0].evaluate(n)));case"resolvedImage":return gi.fromString(sl(this.args[0].evaluate(n)));default:return sl(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Yg=["Unknown","Point","LineString","Polygon"];class lu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Er.parse(n)),s}}class Ss{constructor(n,s,h=[],m,x=new on,w=[]){this.registry=n,this.path=h,this.key=h.map(b=>`[${b}]`).join(""),this.scope=x,this.errors=w,this.expectedType=m,this._isConstant=s}parse(n,s,h,m,x={}){return s?this.concat(s,h,m)._parse(n,x):this._parse(n,x)}_parse(n,s){function h(m,x,w){return w==="assert"?new Qi(x,[m]):w==="coerce"?new eo(x,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=n[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[m];if(x){let w=x.parse(n,this);if(!w)return null;if(this.expectedType){const b=this.expectedType,E=w.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||E.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string")if(b.kind!=="padding"||E.kind!=="value"&&E.kind!=="number"&&E.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||E.kind!=="value"&&E.kind!=="array"){if(this.checkSubtype(b,E))return null}else w=h(w,b,s.typeAnnotation||"coerce");else w=h(w,b,s.typeAnnotation||"coerce");else w=h(w,b,s.typeAnnotation||"coerce");else w=h(w,b,s.typeAnnotation||"assert")}if(!(w instanceof Ji)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const b=new lu;try{w=new Ji(w.type,w.evaluate(b))}catch(E){return this.error(E.message),null}}return w}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,h){const m=typeof n=="number"?this.path.concat(n):this.path,x=h?this.scope.concat(h):this.scope;return new Ss(this.registry,this._isConstant,m,s||null,x,this.errors)}error(n,...s){const h=`${this.key}${s.map(m=>`[${m}]`).join("")}`;this.errors.push(new nn(h,n))}checkSubtype(n,s){const h=ue(n,s);return h&&this.error(h),h}}class is{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const h=[];for(let x=1;x<n.length-1;x+=2){const w=n[x];if(typeof w!="string")return s.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return s.error("Variable names must contain only alphanumeric characters or '_'.",x);const b=s.parse(n[x+1],x+1);if(!b)return null;h.push([w,b])}const m=s.parse(n[n.length-1],n.length-1,s.expectedType,h);return m?new is(h,m):null}outputDefined(){return this.result.outputDefined()}}class yr{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const h=n[1];return s.scope.has(h)?new yr(h,s.scope.get(h)):s.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Yc{constructor(n,s,h){this.type=n,this.index=s,this.input=h}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Qe),m=s.parse(n[2],2,Z(s.expectedType||Zt));return h&&m?new Yc(m.type.itemType,h,m):null}evaluate(n){const s=this.index.evaluate(n),h=this.input.evaluate(n);if(s<0)throw new sn(`Array index out of bounds: ${s} < 0.`);if(s>=h.length)throw new sn(`Array index out of bounds: ${s} > ${h.length-1}.`);if(s!==Math.floor(s))throw new sn(`Array index must be an integer, but found ${s} instead.`);return h[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Jc{constructor(n,s){this.type=Bt,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Zt),m=s.parse(n[2],2,Zt);return h&&m?Se(h.type,[Bt,Wt,Qe,Qn,Zt])?new Jc(h,m):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(h.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!h)return!1;if(!Ie(s,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${G(pn(s))} instead.`);if(!Ie(h,["string","array"]))throw new sn(`Expected second argument to be of type array or string, but found ${G(pn(h))} instead.`);return h.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class ta{constructor(n,s,h){this.type=Qe,this.needle=n,this.haystack=s,this.fromIndex=h}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Zt),m=s.parse(n[2],2,Zt);if(!h||!m)return null;if(!Se(h.type,[Bt,Wt,Qe,Qn,Zt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(h.type)} instead`);if(n.length===4){const x=s.parse(n[3],3,Qe);return x?new ta(h,m,x):null}return new ta(h,m)}evaluate(n){const s=this.needle.evaluate(n),h=this.haystack.evaluate(n);if(!Ie(s,["boolean","string","number","null"]))throw new sn(`Expected first argument to be of type boolean, string, number or null, but found ${G(pn(s))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(n)),Ie(h,["string"])){const x=h.indexOf(s,m);return x===-1?-1:[...h.slice(0,x)].length}if(Ie(h,["array"]))return h.indexOf(s,m);throw new sn(`Expected second argument to be of type array or string, but found ${G(pn(h))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Qc{constructor(n,s,h,m,x,w){this.inputType=n,this.type=s,this.input=h,this.cases=m,this.outputs=x,this.otherwise=w}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let h,m;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);const x={},w=[];for(let I=2;I<n.length-1;I+=2){let M=n[I];const L=n[I+1];Array.isArray(M)||(M=[M]);const j=s.concat(I);if(M.length===0)return j.error("Expected at least one branch label.");for(const Y of M){if(typeof Y!="number"&&typeof Y!="string")return j.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return j.error("Numeric branch labels must be integer values.");if(h){if(j.checkSubtype(h,pn(Y)))return null}else h=pn(Y);if(x[String(Y)]!==void 0)return j.error("Branch labels must be unique.");x[String(Y)]=w.length}const W=s.parse(L,I,m);if(!W)return null;m=m||W.type,w.push(W)}const b=s.parse(n[1],1,Zt);if(!b)return null;const E=s.parse(n[n.length-1],n.length-1,m);return E?b.type.kind!=="value"&&s.concat(1).checkSubtype(h,b.type)?null:new Qc(h,m,b,x,w,E):null}evaluate(n){const s=this.input.evaluate(n);return(pn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class uu{constructor(n,s,h){this.type=n,this.branches=s,this.otherwise=h}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const m=[];for(let w=1;w<n.length-1;w+=2){const b=s.parse(n[w],w,Bt);if(!b)return null;const E=s.parse(n[w+1],w+1,h);if(!E)return null;m.push([b,E]),h=h||E.type}const x=s.parse(n[n.length-1],n.length-1,h);if(!x)return null;if(!h)throw new Error("Can't infer output type");return new uu(h,m,x)}evaluate(n){for(const[s,h]of this.branches)if(s.evaluate(n))return h.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,h]of this.branches)n(s),n(h);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class al{constructor(n,s,h,m){this.type=n,this.input=s,this.beginIndex=h,this.endIndex=m}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const h=s.parse(n[1],1,Zt),m=s.parse(n[2],2,Qe);if(!h||!m)return null;if(!Se(h.type,[Z(Zt),Wt,Zt]))return s.error(`Expected first argument to be of type array or string, but found ${G(h.type)} instead`);if(n.length===4){const x=s.parse(n[3],3,Qe);return x?new al(h.type,h,m,x):null}return new al(h.type,h,m)}evaluate(n){const s=this.input.evaluate(n),h=this.beginIndex.evaluate(n);let m;if(this.endIndex&&(m=this.endIndex.evaluate(n)),Ie(s,["string"]))return[...s].slice(h,m).join("");if(Ie(s,["array"]))return s.slice(h,m);throw new sn(`Expected first argument to be of type array or string, but found ${G(pn(s))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function cu(o,n){const s=o.length-1;let h,m,x=0,w=s,b=0;for(;x<=w;)if(b=Math.floor((x+w)/2),h=o[b],m=o[b+1],h<=n){if(b===s||n<m)return b;x=b+1}else{if(!(h>n))throw new sn("Input is not a number.");w=b-1}return 0}class ra{constructor(n,s,h){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[m,x]of h)this.labels.push(m),this.outputs.push(x)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const h=s.parse(n[1],1,Qe);if(!h)return null;const m=[];let x=null;s.expectedType&&s.expectedType.kind!=="value"&&(x=s.expectedType);for(let w=1;w<n.length;w+=2){const b=w===1?-1/0:n[w],E=n[w+1],I=w,M=w+1;if(typeof b!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(m.length&&m[m.length-1][0]>=b)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=s.parse(E,M,x);if(!L)return null;x=x||L.type,m.push([b,L])}return new ra(x,h,m)}evaluate(n){const s=this.labels,h=this.outputs;if(s.length===1)return h[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return h[0].evaluate(n);const x=s.length;return m>=s[x-1]?h[x-1].evaluate(n):h[cu(s,m)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function _p(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Jg=vp;function vp(o,n,s,h){this.cx=3*o,this.bx=3*(s-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(h-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=n,this.p2x=s,this.p2y=h}vp.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,n){if(n===void 0&&(n=1e-6),o<0)return 0;if(o>1)return 1;for(var s=o,h=0;h<8;h++){var m=this.sampleCurveX(s)-o;if(Math.abs(m)<n)return s;var x=this.sampleCurveDerivativeX(s);if(Math.abs(x)<1e-6)break;s-=m/x}var w=0,b=1;for(s=o,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-o)<n));h++)o>m?w=s:b=s,s=.5*(b-w)+w;return s},solve:function(o,n){return this.sampleCurveY(this.solveCurveX(o,n))}};var Qg=_p(Jg);function Es(o,n,s){return o+s*(n-o)}function ll(o,n,s){return o.map((h,m)=>Es(h,n[m],s))}const ti={number:Es,color:function(o,n,s,h="rgb"){switch(h){case"rgb":{const[m,x,w,b]=ll(o.rgb,n.rgb,s);return new Er(m,x,w,b,!1)}case"hcl":{const[m,x,w,b]=o.hcl,[E,I,M,L]=n.hcl;let j,W;if(isNaN(m)||isNaN(E))isNaN(m)?isNaN(E)?j=NaN:(j=E,w!==1&&w!==0||(W=I)):(j=m,M!==1&&M!==0||(W=x));else{let ze=E-m;E>m&&ze>180?ze-=360:E<m&&m-E>180&&(ze+=360),j=m+s*ze}const[Y,J,le,pe]=function([ze,be,Ae,Ve]){return ze=isNaN(ze)?0:ze*Dt,Zr([Ae,Math.cos(ze)*be,Math.sin(ze)*be,Ve])}([j,W??Es(x,I,s),Es(w,M,s),Es(b,L,s)]);return new Er(Y,J,le,pe,!1)}case"lab":{const[m,x,w,b]=Zr(ll(o.lab,n.lab,s));return new Er(m,x,w,b,!1)}}},array:ll,padding:function(o,n,s){return new mi(ll(o.values,n.values,s))},variableAnchorOffsetCollection:function(o,n,s){const h=o.values,m=n.values;if(h.length!==m.length)throw new sn(`Cannot interpolate values of different length. from: ${o.toString()}, to: ${n.toString()}`);const x=[];for(let w=0;w<h.length;w+=2){if(h[w]!==m[w])throw new sn(`Cannot interpolate values containing mismatched anchors. from[${w}]: ${h[w]}, to[${w}]: ${m[w]}`);x.push(h[w]);const[b,E]=h[w+1],[I,M]=m[w+1];x.push([Es(b,I,s),Es(E,M,s)])}return new Ri(x)}};class ri{constructor(n,s,h,m,x){this.type=n,this.operator=s,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[w,b]of x)this.labels.push(w),this.outputs.push(b)}static interpolationFactor(n,s,h,m){let x=0;if(n.name==="exponential")x=hu(s,n.base,h,m);else if(n.name==="linear")x=hu(s,1,h,m);else if(n.name==="cubic-bezier"){const w=n.controlPoints;x=new Qg(w[0],w[1],w[2],w[3]).solve(hu(s,1,h,m))}return x}static parse(n,s){let[h,m,x,...w]=n;if(!Array.isArray(m)||m.length===0)return s.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const I=m[1];if(typeof I!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:I}}else{if(m[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const I=m.slice(1);if(I.length!==4||I.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:I}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(x=s.parse(x,2,Qe),!x)return null;const b=[];let E=null;h==="interpolate-hcl"||h==="interpolate-lab"?E=jr:s.expectedType&&s.expectedType.kind!=="value"&&(E=s.expectedType);for(let I=0;I<w.length;I+=2){const M=w[I],L=w[I+1],j=I+3,W=I+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(b.length&&b[b.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Y=s.parse(L,W,E);if(!Y)return null;E=E||Y.type,b.push([M,Y])}return Me(E,Qe)||Me(E,jr)||Me(E,Yi)||Me(E,he)||Me(E,Z(Qe))?new ri(E,h,m,x,b):s.error(`Type ${G(E)} is not interpolatable.`)}evaluate(n){const s=this.labels,h=this.outputs;if(s.length===1)return h[0].evaluate(n);const m=this.input.evaluate(n);if(m<=s[0])return h[0].evaluate(n);const x=s.length;if(m>=s[x-1])return h[x-1].evaluate(n);const w=cu(s,m),b=ri.interpolationFactor(this.interpolation,m,s[w],s[w+1]),E=h[w].evaluate(n),I=h[w+1].evaluate(n);switch(this.operator){case"interpolate":return ti[this.type.kind](E,I,b);case"interpolate-hcl":return ti.color(E,I,b,"hcl");case"interpolate-lab":return ti.color(E,I,b,"lab")}}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function hu(o,n,s,h){const m=h-s,x=o-s;return m===0?0:n===1?x/m:(Math.pow(n,x)-1)/(Math.pow(n,m)-1)}class du{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let h=null;const m=s.expectedType;m&&m.kind!=="value"&&(h=m);const x=[];for(const b of n.slice(1)){const E=s.parse(b,1+x.length,h,void 0,{typeAnnotation:"omit"});if(!E)return null;h=h||E.type,x.push(E)}if(!h)throw new Error("No output type");const w=m&&x.some(b=>ue(m,b.type));return new du(w?Zt:h,x)}evaluate(n){let s,h=null,m=0;for(const x of this.args)if(m++,h=x.evaluate(n),h&&h instanceof gi&&!h.available&&(s||(s=h.name),h=null,m===this.args.length&&(h=s)),h!==null)break;return h}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function pu(o,n){return o==="=="||o==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function xp(o,n,s,h){return h.compare(n,s)===0}function na(o,n,s){const h=o!=="=="&&o!=="!=";return class qT{constructor(x,w,b){this.type=Bt,this.lhs=x,this.rhs=w,this.collator=b,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const b=x[0];let E=w.parse(x[1],1,Zt);if(!E)return null;if(!pu(b,E.type))return w.concat(1).error(`"${b}" comparisons are not supported for type '${G(E.type)}'.`);let I=w.parse(x[2],2,Zt);if(!I)return null;if(!pu(b,I.type))return w.concat(2).error(`"${b}" comparisons are not supported for type '${G(I.type)}'.`);if(E.type.kind!==I.type.kind&&E.type.kind!=="value"&&I.type.kind!=="value")return w.error(`Cannot compare types '${G(E.type)}' and '${G(I.type)}'.`);h&&(E.type.kind==="value"&&I.type.kind!=="value"?E=new Qi(I.type,[E]):E.type.kind!=="value"&&I.type.kind==="value"&&(I=new Qi(E.type,[I])));let M=null;if(x.length===4){if(E.type.kind!=="string"&&I.type.kind!=="string"&&E.type.kind!=="value"&&I.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(M=w.parse(x[3],3,Di),!M)return null}return new qT(E,I,M)}evaluate(x){const w=this.lhs.evaluate(x),b=this.rhs.evaluate(x);if(h&&this.hasUntypedArgument){const E=pn(w),I=pn(b);if(E.kind!==I.kind||E.kind!=="string"&&E.kind!=="number")throw new sn(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${E.kind}, ${I.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const E=pn(w),I=pn(b);if(E.kind!=="string"||I.kind!=="string")return n(x,w,b)}return this.collator?s(x,w,b,this.collator.evaluate(x)):n(x,w,b)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const ey=na("==",function(o,n,s){return n===s},xp),wp=na("!=",function(o,n,s){return n!==s},function(o,n,s,h){return!xp(0,n,s,h)}),bp=na("<",function(o,n,s){return n<s},function(o,n,s,h){return h.compare(n,s)<0}),ty=na(">",function(o,n,s){return n>s},function(o,n,s,h){return h.compare(n,s)>0}),ry=na("<=",function(o,n,s){return n<=s},function(o,n,s,h){return h.compare(n,s)<=0}),Sp=na(">=",function(o,n,s){return n>=s},function(o,n,s,h){return h.compare(n,s)>=0});class ul{constructor(n,s,h){this.type=Di,this.locale=h,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const h=n[1];if(typeof h!="object"||Array.isArray(h))return s.error("Collator options argument must be an object.");const m=s.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Bt);if(!m)return null;const x=s.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Bt);if(!x)return null;let w=null;return h.locale&&(w=s.parse(h.locale,1,Wt),!w)?null:new ul(m,x,w)}evaluate(n){return new qc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class eh{constructor(n,s,h,m,x){this.type=Wt,this.number=n,this.locale=s,this.currency=h,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const h=s.parse(n[1],1,Qe);if(!h)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return s.error("NumberFormat options argument must be an object.");let x=null;if(m.locale&&(x=s.parse(m.locale,1,Wt),!x))return null;let w=null;if(m.currency&&(w=s.parse(m.currency,1,Wt),!w))return null;let b=null;if(m["min-fraction-digits"]&&(b=s.parse(m["min-fraction-digits"],1,Qe),!b))return null;let E=null;return m["max-fraction-digits"]&&(E=s.parse(m["max-fraction-digits"],1,Qe),!E)?null:new eh(h,x,w,b,E)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class fu{constructor(n){this.type=Ki,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const h=n[1];if(!Array.isArray(h)&&typeof h=="object")return s.error("First argument must be an image or text section.");const m=[];let x=!1;for(let w=1;w<=n.length-1;++w){const b=n[w];if(x&&typeof b=="object"&&!Array.isArray(b)){x=!1;let E=null;if(b["font-scale"]&&(E=s.parse(b["font-scale"],1,Qe),!E))return null;let I=null;if(b["text-font"]&&(I=s.parse(b["text-font"],1,Z(Wt)),!I))return null;let M=null;if(b["text-color"]&&(M=s.parse(b["text-color"],1,jr),!M))return null;const L=m[m.length-1];L.scale=E,L.font=I,L.textColor=M}else{const E=s.parse(n[w],1,Zt);if(!E)return null;const I=E.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,m.push({content:E,scale:null,font:null,textColor:null})}}return new fu(m)}evaluate(n){return new fi(this.sections.map(s=>{const h=s.content.evaluate(n);return pn(h)===Pn?new Xc("",h,null,null,null):new Xc(sl(h),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}}class th{constructor(n){this.type=Pn,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const h=s.parse(n[1],1,Wt);return h?new th(h):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),h=gi.fromString(s);return h&&n.availableImages&&(h.available=n.availableImages.indexOf(s)>-1),h}eachChild(n){n(this.input)}outputDefined(){return!1}}class rh{constructor(n){this.type=Qe,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const h=s.parse(n[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${G(h.type)} instead.`):new rh(h):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new sn(`Expected value to be of type string or array, but found ${G(pn(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const ko=8192;function ny(o,n){const s=(180+o[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(s*m*ko),Math.round(h*m*ko)]}function nh(o,n){const s=Math.pow(2,n.z);return[(m=(o[0]/ko+n.x)/s,360*m-180),(h=(o[1]/ko+n.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,m}function ks(o,n){o[0]=Math.min(o[0],n[0]),o[1]=Math.min(o[1],n[1]),o[2]=Math.max(o[2],n[0]),o[3]=Math.max(o[3],n[1])}function os(o,n){return!(o[0]<=n[0]||o[2]>=n[2]||o[1]<=n[1]||o[3]>=n[3])}function xr(o,n,s){const h=o[0]-n[0],m=o[1]-n[1],x=o[0]-s[0],w=o[1]-s[1];return h*w-x*m==0&&h*x<=0&&m*w<=0}function mu(o,n,s,h){return(m=[h[0]-s[0],h[1]-s[1]])[0]*(x=[n[0]-o[0],n[1]-o[1]])[1]-m[1]*x[0]!=0&&!(!kp(o,n,s,h)||!kp(s,h,o,n));var m,x}function iy(o,n,s){for(const h of s)for(let m=0;m<h.length-1;++m)if(mu(o,n,h[m],h[m+1]))return!0;return!1}function ia(o,n,s=!1){let h=!1;for(const b of n)for(let E=0;E<b.length-1;E++){if(xr(o,b[E],b[E+1]))return s;(x=b[E])[1]>(m=o)[1]!=(w=b[E+1])[1]>m[1]&&m[0]<(w[0]-x[0])*(m[1]-x[1])/(w[1]-x[1])+x[0]&&(h=!h)}var m,x,w;return h}function oy(o,n){for(const s of n)if(ia(o,s))return!0;return!1}function Ep(o,n){for(const s of o)if(!ia(s,n))return!1;for(let s=0;s<o.length-1;++s)if(iy(o[s],o[s+1],n))return!1;return!0}function sy(o,n){for(const s of n)if(Ep(o,s))return!0;return!1}function kp(o,n,s,h){const m=h[0]-s[0],x=h[1]-s[1],w=(o[0]-s[0])*x-m*(o[1]-s[1]),b=(n[0]-s[0])*x-m*(n[1]-s[1]);return w>0&&b<0||w<0&&b>0}function ih(o,n,s){const h=[];for(let m=0;m<o.length;m++){const x=[];for(let w=0;w<o[m].length;w++){const b=ny(o[m][w],s);ks(n,b),x.push(b)}h.push(x)}return h}function Tp(o,n,s){const h=[];for(let m=0;m<o.length;m++){const x=ih(o[m],n,s);h.push(x)}return h}function Cp(o,n,s,h){if(o[0]<s[0]||o[0]>s[2]){const m=.5*h;let x=o[0]-s[0]>m?-h:s[0]-o[0]>m?h:0;x===0&&(x=o[0]-s[2]>m?-h:s[2]-o[0]>m?h:0),o[0]+=x}ks(n,o)}function Ip(o,n,s,h){const m=Math.pow(2,h.z)*ko,x=[h.x*ko,h.y*ko],w=[];for(const b of o)for(const E of b){const I=[E.x+x[0],E.y+x[1]];Cp(I,n,s,m),w.push(I)}return w}function Pp(o,n,s,h){const m=Math.pow(2,h.z)*ko,x=[h.x*ko,h.y*ko],w=[];for(const E of o){const I=[];for(const M of E){const L=[M.x+x[0],M.y+x[1]];ks(n,L),I.push(L)}w.push(I)}if(n[2]-n[0]<=m/2){(b=n)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of w)for(const I of E)Cp(I,n,s,m)}var b;return w}class Ts{constructor(n,s){this.type=Bt,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(bs(n[1])){const h=n[1];if(h.type==="FeatureCollection"){const m=[];for(const x of h.features){const{type:w,coordinates:b}=x.geometry;w==="Polygon"&&m.push(b),w==="MultiPolygon"&&m.push(...b)}if(m.length)return new Ts(h,{type:"MultiPolygon",coordinates:m})}else if(h.type==="Feature"){const m=h.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ts(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Ts(h,h)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,h){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(h.type==="Polygon"){const b=ih(h.coordinates,x,w),E=Ip(s.geometry(),m,x,w);if(!os(m,x))return!1;for(const I of E)if(!ia(I,b))return!1}if(h.type==="MultiPolygon"){const b=Tp(h.coordinates,x,w),E=Ip(s.geometry(),m,x,w);if(!os(m,x))return!1;for(const I of E)if(!oy(I,b))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,h){const m=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(h.type==="Polygon"){const b=ih(h.coordinates,x,w),E=Pp(s.geometry(),m,x,w);if(!os(m,x))return!1;for(const I of E)if(!Ep(I,b))return!1}if(h.type==="MultiPolygon"){const b=Tp(h.coordinates,x,w),E=Pp(s.geometry(),m,x,w);if(!os(m,x))return!1;for(const I of E)if(!sy(I,b))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ap=class{constructor(o=[],n=(s,h)=>s<h?-1:s>h?1:0){if(this.data=o,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:n,compare:s}=this,h=n[o];for(;o>0;){const m=o-1>>1,x=n[m];if(s(h,x)>=0)break;n[o]=x,o=m}n[o]=h}_down(o){const{data:n,compare:s}=this,h=this.length>>1,m=n[o];for(;o<h;){let x=1+(o<<1);const w=x+1;if(w<this.length&&s(n[w],n[x])<0&&(x=w),s(n[x],m)>=0)break;n[o]=n[x],o=x}n[o]=m}};function ay(o,n,s,h,m){Mp(o,n,s,h||o.length-1,m||ly)}function Mp(o,n,s,h,m){for(;h>s;){if(h-s>600){var x=h-s+1,w=n-s+1,b=Math.log(x),E=.5*Math.exp(2*b/3),I=.5*Math.sqrt(b*E*(x-E)/x)*(w-x/2<0?-1:1);Mp(o,n,Math.max(s,Math.floor(n-w*E/x+I)),Math.min(h,Math.floor(n+(x-w)*E/x+I)),m)}var M=o[n],L=s,j=h;for(cl(o,s,n),m(o[h],M)>0&&cl(o,s,h);L<j;){for(cl(o,L,j),L++,j--;m(o[L],M)<0;)L++;for(;m(o[j],M)>0;)j--}m(o[s],M)===0?cl(o,s,j):cl(o,++j,h),j<=n&&(s=j+1),n<=j&&(h=j-1)}}function cl(o,n,s){var h=o[n];o[n]=o[s],o[s]=h}function ly(o,n){return o<n?-1:o>n?1:0}function gu(o,n){if(o.length<=1)return[o];const s=[];let h,m;for(const x of o){const w=cy(x);w!==0&&(x.area=Math.abs(w),m===void 0&&(m=w<0),m===w<0?(h&&s.push(h),h=[x]):h.push(x))}if(h&&s.push(h),n>1)for(let x=0;x<s.length;x++)s[x].length<=n||(ay(s[x],n,1,s[x].length-1,uy),s[x]=s[x].slice(0,n));return s}function uy(o,n){return n.area-o.area}function cy(o){let n=0;for(let s,h,m=0,x=o.length,w=x-1;m<x;w=m++)s=o[m],h=o[w],n+=(h.x-s.x)*(s.y+h.y);return n}const zp=1/298.257223563,Dp=zp*(2-zp),Rp=Math.PI/180;class oh{constructor(n){const s=6378.137*Rp*1e3,h=Math.cos(n*Rp),m=1/(1-Dp*(1-h*h)),x=Math.sqrt(m);this.kx=s*x*h,this.ky=s*x*m*(1-Dp)}distance(n,s){const h=this.wrap(n[0]-s[0])*this.kx,m=(n[1]-s[1])*this.ky;return Math.sqrt(h*h+m*m)}pointOnLine(n,s){let h,m,x,w,b=1/0;for(let E=0;E<n.length-1;E++){let I=n[E][0],M=n[E][1],L=this.wrap(n[E+1][0]-I)*this.kx,j=(n[E+1][1]-M)*this.ky,W=0;L===0&&j===0||(W=(this.wrap(s[0]-I)*this.kx*L+(s[1]-M)*this.ky*j)/(L*L+j*j),W>1?(I=n[E+1][0],M=n[E+1][1]):W>0&&(I+=L/this.kx*W,M+=j/this.ky*W)),L=this.wrap(s[0]-I)*this.kx,j=(s[1]-M)*this.ky;const Y=L*L+j*j;Y<b&&(b=Y,h=I,m=M,x=E,w=W)}return{point:[h,m],index:x,t:Math.max(0,Math.min(1,w))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Lp(o,n){return n[0]-o[0]}function yu(o){return o[1]-o[0]+1}function jo(o,n){return o[1]>=o[0]&&o[1]<n}function sh(o,n){if(o[0]>o[1])return[null,null];const s=yu(o);if(n){if(s===2)return[o,null];const m=Math.floor(s/2);return[[o[0],o[0]+m],[o[0]+m,o[1]]]}if(s===1)return[o,null];const h=Math.floor(s/2)-1;return[[o[0],o[0]+h],[o[0]+h+1,o[1]]]}function ah(o,n){if(!jo(n,o.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let h=n[0];h<=n[1];++h)ks(s,o[h]);return s}function lh(o){const n=[1/0,1/0,-1/0,-1/0];for(const s of o)for(const h of s)ks(n,h);return n}function _u(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function uh(o,n,s){if(!_u(o)||!_u(n))return NaN;let h=0,m=0;return o[2]<n[0]&&(h=n[0]-o[2]),o[0]>n[2]&&(h=o[0]-n[2]),o[1]>n[3]&&(m=o[1]-n[3]),o[3]<n[1]&&(m=n[1]-o[3]),s.distance([0,0],[h,m])}function Cs(o,n,s){const h=s.pointOnLine(n,o);return s.distance(o,h.point)}function ch(o,n,s,h,m){const x=Math.min(Cs(o,[s,h],m),Cs(n,[s,h],m)),w=Math.min(Cs(s,[o,n],m),Cs(h,[o,n],m));return Math.min(x,w)}function hy(o,n,s,h,m){if(!jo(n,o.length)||!jo(h,s.length))return 1/0;let x=1/0;for(let w=n[0];w<n[1];++w){const b=o[w],E=o[w+1];for(let I=h[0];I<h[1];++I){const M=s[I],L=s[I+1];if(mu(b,E,M,L))return 0;x=Math.min(x,ch(b,E,M,L,m))}}return x}function Qr(o,n,s,h,m){if(!jo(n,o.length)||!jo(h,s.length))return NaN;let x=1/0;for(let w=n[0];w<=n[1];++w)for(let b=h[0];b<=h[1];++b)if(x=Math.min(x,m.distance(o[w],s[b])),x===0)return x;return x}function dy(o,n,s){if(ia(o,n,!0))return 0;let h=1/0;for(const m of n){const x=m[0],w=m[m.length-1];if(x!==w&&(h=Math.min(h,Cs(o,[w,x],s)),h===0))return h;const b=s.pointOnLine(m,o);if(h=Math.min(h,s.distance(o,b.point)),h===0)return h}return h}function er(o,n,s,h){if(!jo(n,o.length))return NaN;for(let x=n[0];x<=n[1];++x)if(ia(o[x],s,!0))return 0;let m=1/0;for(let x=n[0];x<n[1];++x){const w=o[x],b=o[x+1];for(const E of s)for(let I=0,M=E.length,L=M-1;I<M;L=I++){const j=E[L],W=E[I];if(mu(w,b,j,W))return 0;m=Math.min(m,ch(w,b,j,W,h))}}return m}function vu(o,n){for(const s of o)for(const h of s)if(ia(h,n,!0))return!0;return!1}function Ar(o,n,s,h=1/0){const m=lh(o),x=lh(n);if(h!==1/0&&uh(m,x,s)>=h)return h;if(os(m,x)){if(vu(o,n))return 0}else if(vu(n,o))return 0;let w=1/0;for(const b of o)for(let E=0,I=b.length,M=I-1;E<I;M=E++){const L=b[M],j=b[E];for(const W of n)for(let Y=0,J=W.length,le=J-1;Y<J;le=Y++){const pe=W[le],ze=W[Y];if(mu(L,j,pe,ze))return 0;w=Math.min(w,ch(L,j,pe,ze,s))}}return w}function kr(o,n,s,h,m,x){if(!x)return;const w=uh(ah(h,x),m,s);w<n&&o.push([w,x,[0,0]])}function Is(o,n,s,h,m,x,w){if(!x||!w)return;const b=uh(ah(h,x),ah(m,w),s);b<n&&o.push([b,x,w])}function hl(o,n,s,h,m=1/0){let x=Math.min(h.distance(o[0],s[0][0]),m);if(x===0)return x;const w=new Ap([[0,[0,o.length-1],[0,0]]],Lp),b=lh(s);for(;w.length>0;){const E=w.pop();if(E[0]>=x)continue;const I=E[1],M=n?50:100;if(yu(I)<=M){if(!jo(I,o.length))return NaN;if(n){const L=er(o,I,s,h);if(isNaN(L)||L===0)return L;x=Math.min(x,L)}else for(let L=I[0];L<=I[1];++L){const j=dy(o[L],s,h);if(x=Math.min(x,j),x===0)return 0}}else{const L=sh(I,n);kr(w,x,h,o,b,L[0]),kr(w,x,h,o,b,L[1])}}return x}function dl(o,n,s,h,m,x=1/0){let w=Math.min(x,m.distance(o[0],s[0]));if(w===0)return w;const b=new Ap([[0,[0,o.length-1],[0,s.length-1]]],Lp);for(;b.length>0;){const E=b.pop();if(E[0]>=w)continue;const I=E[1],M=E[2],L=n?50:100,j=h?50:100;if(yu(I)<=L&&yu(M)<=j){if(!jo(I,o.length)&&jo(M,s.length))return NaN;let W;if(n&&h)W=hy(o,I,s,M,m),w=Math.min(w,W);else if(n&&!h){const Y=o.slice(I[0],I[1]+1);for(let J=M[0];J<=M[1];++J)if(W=Cs(s[J],Y,m),w=Math.min(w,W),w===0)return w}else if(!n&&h){const Y=s.slice(M[0],M[1]+1);for(let J=I[0];J<=I[1];++J)if(W=Cs(o[J],Y,m),w=Math.min(w,W),w===0)return w}else W=Qr(o,I,s,M,m),w=Math.min(w,W)}else{const W=sh(I,n),Y=sh(M,h);Is(b,w,m,o,s,W[0],Y[0]),Is(b,w,m,o,s,W[0],Y[1]),Is(b,w,m,o,s,W[1],Y[0]),Is(b,w,m,o,s,W[1],Y[1])}}return w}function hh(o){return o.type==="MultiPolygon"?o.coordinates.map(n=>({type:"Polygon",coordinates:n})):o.type==="MultiLineString"?o.coordinates.map(n=>({type:"LineString",coordinates:n})):o.type==="MultiPoint"?o.coordinates.map(n=>({type:"Point",coordinates:n})):[o]}class Ps{constructor(n,s){this.type=Qe,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(bs(n[1])){const h=n[1];if(h.type==="FeatureCollection")return new Ps(h,h.features.map(m=>hh(m.geometry)).flat());if(h.type==="Feature")return new Ps(h,hh(h.geometry));if("type"in h&&"coordinates"in h)return new Ps(h,hh(h))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,h){const m=s.geometry(),x=m.flat().map(E=>nh([E.x,E.y],s.canonical));if(m.length===0)return NaN;const w=new oh(x[0][1]);let b=1/0;for(const E of h){switch(E.type){case"Point":b=Math.min(b,dl(x,!1,[E.coordinates],!1,w,b));break;case"LineString":b=Math.min(b,dl(x,!1,E.coordinates,!0,w,b));break;case"Polygon":b=Math.min(b,hl(x,!1,E.coordinates,w,b))}if(b===0)return b}return b}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,h){const m=s.geometry(),x=m.flat().map(E=>nh([E.x,E.y],s.canonical));if(m.length===0)return NaN;const w=new oh(x[0][1]);let b=1/0;for(const E of h){switch(E.type){case"Point":b=Math.min(b,dl(x,!0,[E.coordinates],!1,w,b));break;case"LineString":b=Math.min(b,dl(x,!0,E.coordinates,!0,w,b));break;case"Polygon":b=Math.min(b,hl(x,!0,E.coordinates,w,b))}if(b===0)return b}return b}(n,this.geometries);if(n.geometryType()==="Polygon")return function(s,h){const m=s.geometry();if(m.length===0||m[0].length===0)return NaN;const x=gu(m,0).map(E=>E.map(I=>I.map(M=>nh([M.x,M.y],s.canonical)))),w=new oh(x[0][0][0][1]);let b=1/0;for(const E of h)for(const I of x){switch(E.type){case"Point":b=Math.min(b,hl([E.coordinates],!1,I,w,b));break;case"LineString":b=Math.min(b,hl(E.coordinates,!0,I,w,b));break;case"Polygon":b=Math.min(b,Ar(I,E.coordinates,w,b))}if(b===0)return b}return b}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const oa={"==":ey,"!=":wp,">":ty,"<":bp,">=":Sp,"<=":ry,array:Qi,at:Yc,boolean:Qi,case:uu,coalesce:du,collator:ul,format:fu,image:th,in:Jc,"index-of":ta,interpolate:ri,"interpolate-hcl":ri,"interpolate-lab":ri,length:rh,let:is,literal:Ji,match:Qc,number:Qi,"number-format":eh,object:Qi,slice:al,step:ra,string:Qi,"to-boolean":eo,"to-color":eo,"to-number":eo,"to-string":eo,var:yr,within:Ts,distance:Ps};class Li{constructor(n,s,h,m){this.name=n,this.type=s,this._evaluate=h,this.args=m}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,s){const h=n[0],m=Li.definitions[h];if(!m)return s.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(m)?m[0]:m.type,w=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=w.filter(([I])=>!Array.isArray(I)||I.length===n.length-1);let E=null;for(const[I,M]of b){E=new Ss(s.registry,pl,s.path,null,s.scope);const L=[];let j=!1;for(let W=1;W<n.length;W++){const Y=n[W],J=Array.isArray(I)?I[W-1]:I.type,le=E.parse(Y,1+L.length,J);if(!le){j=!0;break}L.push(le)}if(!j)if(Array.isArray(I)&&I.length!==L.length)E.error(`Expected ${I.length} arguments, but found ${L.length} instead.`);else{for(let W=0;W<L.length;W++){const Y=Array.isArray(I)?I[W]:I.type,J=L[W];E.concat(W+1).checkSubtype(Y,J.type)}if(E.errors.length===0)return new Li(h,x,M,L)}}if(b.length===1)s.errors.push(...E.errors);else{const I=(b.length?b:w).map(([L])=>{return j=L,Array.isArray(j)?`(${j.map(G).join(", ")})`:`(${G(j.type)}...)`;var j}).join(" | "),M=[];for(let L=1;L<n.length;L++){const j=s.parse(n[L],1+M.length);if(!j)return null;M.push(G(j.type))}s.error(`Expected arguments of type ${I}, but found (${M.join(", ")}) instead.`)}return null}static register(n,s){Li.definitions=s;for(const h in s)n[h]=Li}}function dh(o,[n,s,h,m]){n=n.evaluate(o),s=s.evaluate(o),h=h.evaluate(o);const x=m?m.evaluate(o):1,w=ea(n,s,h,x);if(w)throw new sn(w);return new Er(n/255,s/255,h/255,x,!1)}function ph(o,n){return o in n}function fh(o,n){const s=n[o];return s===void 0?null:s}function As(o){return{type:o}}function pl(o){if(o instanceof yr)return pl(o.boundExpression);if(o instanceof Li&&o.name==="error"||o instanceof ul||o instanceof Ts||o instanceof Ps)return!1;const n=o instanceof eo||o instanceof Qi;let s=!0;return o.eachChild(h=>{s=n?s&&pl(h):s&&h instanceof Ji}),!!s&&fl(o)&&ml(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function fl(o){if(o instanceof Li&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Ts||o instanceof Ps)return!1;let n=!0;return o.eachChild(s=>{n&&!fl(s)&&(n=!1)}),n}function sa(o){if(o instanceof Li&&o.name==="feature-state")return!1;let n=!0;return o.eachChild(s=>{n&&!sa(s)&&(n=!1)}),n}function ml(o,n){if(o instanceof Li&&n.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(h=>{s&&!ml(h,n)&&(s=!1)}),s}function xu(o){return{result:"success",value:o}}function aa(o){return{result:"error",value:o}}function la(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Fp(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function mh(o){return!!o.expression&&o.expression.interpolated}function fr(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function wu(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function py(o){return o}function Op(o,n){const s=n.type==="color",h=o.stops&&typeof o.stops[0][0]=="object",m=h||!(h||o.property!==void 0),x=o.type||(mh(n)?"exponential":"interval");if(s||n.type==="padding"){const M=s?Er.parse:mi.parse;(o=Gr({},o)).stops&&(o.stops=o.stops.map(L=>[L[0],M(L[1])])),o.default=M(o.default?o.default:n.default)}if(o.colorSpace&&(w=o.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var w;let b,E,I;if(x==="exponential")b=Np;else if(x==="interval")b=bu;else if(x==="categorical"){b=Bp,E=Object.create(null);for(const M of o.stops)E[M[0]]=M[1];I=typeof o.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);b=$p}if(h){const M={},L=[];for(let Y=0;Y<o.stops.length;Y++){const J=o.stops[Y],le=J[0].zoom;M[le]===void 0&&(M[le]={zoom:le,type:o.type,property:o.property,default:o.default,stops:[]},L.push(le)),M[le].stops.push([J[0].value,J[1]])}const j=[];for(const Y of L)j.push([M[Y].zoom,Op(M[Y],n)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:ri.interpolationFactor.bind(void 0,W),zoomStops:j.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>Np({stops:j,base:o.base},n,Y).evaluate(Y,J)}}if(m){const M=x==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:ri.interpolationFactor.bind(void 0,M),zoomStops:o.stops.map(L=>L[0]),evaluate:({zoom:L})=>b(o,n,L,E,I)}}return{kind:"source",evaluate(M,L){const j=L&&L.properties?L.properties[o.property]:void 0;return j===void 0?ua(o.default,n.default):b(o,n,j,E,I)}}}function ua(o,n,s){return o!==void 0?o:n!==void 0?n:s!==void 0?s:void 0}function Bp(o,n,s,h,m){return ua(typeof s===m?h[s]:void 0,o.default,n.default)}function bu(o,n,s){if(fr(s)!=="number")return ua(o.default,n.default);const h=o.stops.length;if(h===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[h-1][0])return o.stops[h-1][1];const m=cu(o.stops.map(x=>x[0]),s);return o.stops[m][1]}function Np(o,n,s){const h=o.base!==void 0?o.base:1;if(fr(s)!=="number")return ua(o.default,n.default);const m=o.stops.length;if(m===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[m-1][0])return o.stops[m-1][1];const x=cu(o.stops.map(M=>M[0]),s),w=function(M,L,j,W){const Y=W-j,J=M-j;return Y===0?0:L===1?J/Y:(Math.pow(L,J)-1)/(Math.pow(L,Y)-1)}(s,h,o.stops[x][0],o.stops[x+1][0]),b=o.stops[x][1],E=o.stops[x+1][1],I=ti[n.type]||py;return typeof b.evaluate=="function"?{evaluate(...M){const L=b.evaluate.apply(void 0,M),j=E.evaluate.apply(void 0,M);if(L!==void 0&&j!==void 0)return I(L,j,w,o.colorSpace)}}:I(b,E,w,o.colorSpace)}function $p(o,n,s){switch(n.type){case"color":s=Er.parse(s);break;case"formatted":s=fi.fromString(s.toString());break;case"resolvedImage":s=gi.fromString(s.toString());break;case"padding":s=mi.parse(s);break;default:fr(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0)}return ua(s,o.default,n.default)}Li.register(oa,{error:[{kind:"error"},[Wt],(o,[n])=>{throw new sn(n.evaluate(o))}],typeof:[Wt,[Zt],(o,[n])=>G(pn(n.evaluate(o)))],"to-rgba":[Z(Qe,4),[jr],(o,[n])=>{const[s,h,m,x]=n.evaluate(o).rgb;return[255*s,255*h,255*m,x]}],rgb:[jr,[Qe,Qe,Qe],dh],rgba:[jr,[Qe,Qe,Qe,Qe],dh],has:{type:Bt,overloads:[[[Wt],(o,[n])=>ph(n.evaluate(o),o.properties())],[[Wt,ei],(o,[n,s])=>ph(n.evaluate(o),s.evaluate(o))]]},get:{type:Zt,overloads:[[[Wt],(o,[n])=>fh(n.evaluate(o),o.properties())],[[Wt,ei],(o,[n,s])=>fh(n.evaluate(o),s.evaluate(o))]]},"feature-state":[Zt,[Wt],(o,[n])=>fh(n.evaluate(o),o.featureState||{})],properties:[ei,[],o=>o.properties()],"geometry-type":[Wt,[],o=>o.geometryType()],id:[Zt,[],o=>o.id()],zoom:[Qe,[],o=>o.globals.zoom],"heatmap-density":[Qe,[],o=>o.globals.heatmapDensity||0],"line-progress":[Qe,[],o=>o.globals.lineProgress||0],accumulated:[Zt,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Qe,As(Qe),(o,n)=>{let s=0;for(const h of n)s+=h.evaluate(o);return s}],"*":[Qe,As(Qe),(o,n)=>{let s=1;for(const h of n)s*=h.evaluate(o);return s}],"-":{type:Qe,overloads:[[[Qe,Qe],(o,[n,s])=>n.evaluate(o)-s.evaluate(o)],[[Qe],(o,[n])=>-n.evaluate(o)]]},"/":[Qe,[Qe,Qe],(o,[n,s])=>n.evaluate(o)/s.evaluate(o)],"%":[Qe,[Qe,Qe],(o,[n,s])=>n.evaluate(o)%s.evaluate(o)],ln2:[Qe,[],()=>Math.LN2],pi:[Qe,[],()=>Math.PI],e:[Qe,[],()=>Math.E],"^":[Qe,[Qe,Qe],(o,[n,s])=>Math.pow(n.evaluate(o),s.evaluate(o))],sqrt:[Qe,[Qe],(o,[n])=>Math.sqrt(n.evaluate(o))],log10:[Qe,[Qe],(o,[n])=>Math.log(n.evaluate(o))/Math.LN10],ln:[Qe,[Qe],(o,[n])=>Math.log(n.evaluate(o))],log2:[Qe,[Qe],(o,[n])=>Math.log(n.evaluate(o))/Math.LN2],sin:[Qe,[Qe],(o,[n])=>Math.sin(n.evaluate(o))],cos:[Qe,[Qe],(o,[n])=>Math.cos(n.evaluate(o))],tan:[Qe,[Qe],(o,[n])=>Math.tan(n.evaluate(o))],asin:[Qe,[Qe],(o,[n])=>Math.asin(n.evaluate(o))],acos:[Qe,[Qe],(o,[n])=>Math.acos(n.evaluate(o))],atan:[Qe,[Qe],(o,[n])=>Math.atan(n.evaluate(o))],min:[Qe,As(Qe),(o,n)=>Math.min(...n.map(s=>s.evaluate(o)))],max:[Qe,As(Qe),(o,n)=>Math.max(...n.map(s=>s.evaluate(o)))],abs:[Qe,[Qe],(o,[n])=>Math.abs(n.evaluate(o))],round:[Qe,[Qe],(o,[n])=>{const s=n.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[Qe,[Qe],(o,[n])=>Math.floor(n.evaluate(o))],ceil:[Qe,[Qe],(o,[n])=>Math.ceil(n.evaluate(o))],"filter-==":[Bt,[Wt,Zt],(o,[n,s])=>o.properties()[n.value]===s.value],"filter-id-==":[Bt,[Zt],(o,[n])=>o.id()===n.value],"filter-type-==":[Bt,[Wt],(o,[n])=>o.geometryType()===n.value],"filter-<":[Bt,[Wt,Zt],(o,[n,s])=>{const h=o.properties()[n.value],m=s.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Bt,[Zt],(o,[n])=>{const s=o.id(),h=n.value;return typeof s==typeof h&&s<h}],"filter->":[Bt,[Wt,Zt],(o,[n,s])=>{const h=o.properties()[n.value],m=s.value;return typeof h==typeof m&&h>m}],"filter-id->":[Bt,[Zt],(o,[n])=>{const s=o.id(),h=n.value;return typeof s==typeof h&&s>h}],"filter-<=":[Bt,[Wt,Zt],(o,[n,s])=>{const h=o.properties()[n.value],m=s.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Bt,[Zt],(o,[n])=>{const s=o.id(),h=n.value;return typeof s==typeof h&&s<=h}],"filter->=":[Bt,[Wt,Zt],(o,[n,s])=>{const h=o.properties()[n.value],m=s.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Bt,[Zt],(o,[n])=>{const s=o.id(),h=n.value;return typeof s==typeof h&&s>=h}],"filter-has":[Bt,[Zt],(o,[n])=>n.value in o.properties()],"filter-has-id":[Bt,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[Bt,[Z(Wt)],(o,[n])=>n.value.indexOf(o.geometryType())>=0],"filter-id-in":[Bt,[Z(Zt)],(o,[n])=>n.value.indexOf(o.id())>=0],"filter-in-small":[Bt,[Wt,Z(Zt)],(o,[n,s])=>s.value.indexOf(o.properties()[n.value])>=0],"filter-in-large":[Bt,[Wt,Z(Zt)],(o,[n,s])=>function(h,m,x,w){for(;x<=w;){const b=x+w>>1;if(m[b]===h)return!0;m[b]>h?w=b-1:x=b+1}return!1}(o.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Bt,overloads:[[[Bt,Bt],(o,[n,s])=>n.evaluate(o)&&s.evaluate(o)],[As(Bt),(o,n)=>{for(const s of n)if(!s.evaluate(o))return!1;return!0}]]},any:{type:Bt,overloads:[[[Bt,Bt],(o,[n,s])=>n.evaluate(o)||s.evaluate(o)],[As(Bt),(o,n)=>{for(const s of n)if(s.evaluate(o))return!0;return!1}]]},"!":[Bt,[Bt],(o,[n])=>!n.evaluate(o)],"is-supported-script":[Bt,[Wt],(o,[n])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(n.evaluate(o))}],upcase:[Wt,[Wt],(o,[n])=>n.evaluate(o).toUpperCase()],downcase:[Wt,[Wt],(o,[n])=>n.evaluate(o).toLowerCase()],concat:[Wt,As(Zt),(o,n)=>n.map(s=>sl(s.evaluate(o))).join("")],"resolved-locale":[Wt,[Di],(o,[n])=>n.evaluate(o).resolvedLocale()]});class Su{constructor(n,s){var h;this.expression=n,this._warningHistory={},this._evaluator=new lu,this._defaultValue=s?(h=s).type==="color"&&wu(h.default)?new Er(0,0,0,0):h.type==="color"?Er.parse(h.default)||null:h.type==="padding"?mi.parse(h.default)||null:h.type==="variableAnchorOffsetCollection"?Ri.parse(h.default)||null:h.default===void 0?null:h.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,h,m,x,w){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=h,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(n,s,h,m,x,w){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new sn(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Eu(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in oa}function ca(o,n){const s=new Ss(oa,pl,[],n?function(m){const x={color:jr,string:Wt,number:Qe,enum:Wt,boolean:Bt,formatted:Ki,padding:Yi,resolvedImage:Pn,variableAnchorOffsetCollection:he};return m.type==="array"?Z(x[m.value]||Zt,m.length):x[m.type]}(n):void 0),h=s.parse(o,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?xu(new Su(h,n)):aa(s.errors)}class ha{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!sa(s.expression)}evaluateWithoutErrorHandling(n,s,h,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,h,m,x,w)}evaluate(n,s,h,m,x,w){return this._styleExpression.evaluate(n,s,h,m,x,w)}}class da{constructor(n,s,h,m){this.kind=n,this.zoomStops=h,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!sa(s.expression),this.interpolationType=m}evaluateWithoutErrorHandling(n,s,h,m,x,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,h,m,x,w)}evaluate(n,s,h,m,x,w){return this._styleExpression.evaluate(n,s,h,m,x,w)}interpolationFactor(n,s,h){return this.interpolationType?ri.interpolationFactor(this.interpolationType,n,s,h):0}}function gh(o,n){const s=ca(o,n);if(s.result==="error")return s;const h=s.value.expression,m=fl(h);if(!m&&!la(n))return aa([new nn("","data expressions not supported")]);const x=ml(h,["zoom"]);if(!x&&!Fp(n))return aa([new nn("","zoom expressions not supported")]);const w=gl(h);return w||x?w instanceof nn?aa([w]):w instanceof ri&&!mh(n)?aa([new nn("",'"interpolate" expressions cannot be used with this property')]):xu(w?new da(m?"camera":"composite",s.value,w.labels,w instanceof ri?w.interpolation:void 0):new ha(m?"constant":"source",s.value)):aa([new nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class pa{constructor(n,s){this._parameters=n,this._specification=s,Gr(this,Op(this._parameters,this._specification))}static deserialize(n){return new pa(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function gl(o){let n=null;if(o instanceof is)n=gl(o.result);else if(o instanceof du){for(const s of o.args)if(n=gl(s),n)break}else(o instanceof ra||o instanceof ri)&&o.input instanceof Li&&o.input.name==="zoom"&&(n=o);return n instanceof nn||o.eachChild(s=>{const h=gl(s);h instanceof nn?n=h:!n&&h?n=new nn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&h&&n!==h&&(n=new nn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function ku(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const n of o.slice(1))if(!ku(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Tu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yh(o){if(o==null)return{filter:()=>!0,needGeometry:!1};ku(o)||(o=Cu(o));const n=ca(o,Tu);if(n.result==="error")throw new Error(n.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,h,m)=>n.value.evaluate(s,h,{},m),needGeometry:jp(o)}}function fy(o,n){return o<n?-1:o>n?1:0}function jp(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let n=1;n<o.length;n++)if(jp(o[n]))return!0;return!1}function Cu(o){if(!o)return!0;const n=o[0];return o.length<=1?n!=="any":n==="=="?_h(o[1],o[2],"=="):n==="!="?An(_h(o[1],o[2],"==")):n==="<"||n===">"||n==="<="||n===">="?_h(o[1],o[2],n):n==="any"?(s=o.slice(1),["any"].concat(s.map(Cu))):n==="all"?["all"].concat(o.slice(1).map(Cu)):n==="none"?["all"].concat(o.slice(1).map(Cu).map(An)):n==="in"?yl(o[1],o.slice(2)):n==="!in"?An(yl(o[1],o.slice(2))):n==="has"?_l(o[1]):n!=="!has"||An(_l(o[1]));var s}function _h(o,n,s){switch(o){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,o,n]}}function yl(o,n){if(n.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",o,["literal",n.sort(fy)]]:["filter-in-small",o,["literal",n]]}}function _l(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function An(o){return["!",o]}function Ms(o){const n=typeof o;if(n==="number"||n==="boolean"||n==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let m="[";for(const x of o)m+=`${Ms(x)},`;return`${m}]`}const s=Object.keys(o).sort();let h="{";for(let m=0;m<s.length;m++)h+=`${JSON.stringify(s[m])}:${Ms(o[s[m]])},`;return`${h}}`}function Up(o){let n="";for(const s of de)n+=`/${Ms(o[s])}`;return n}function Vp(o){const n=o.value;return n?[new We(o.key,n,"constants have been deprecated as of v8")]:[]}function en(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function to(o){if(Array.isArray(o))return o.map(to);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const n={};for(const s in o)n[s]=to(o[s]);return n}return en(o)}function yi(o){const n=o.key,s=o.value,h=o.valueSpec||{},m=o.objectElementValidators||{},x=o.style,w=o.styleSpec,b=o.validateSpec;let E=[];const I=fr(s);if(I!=="object")return[new We(n,s,`object expected, ${I} found`)];for(const M in s){const L=M.split(".")[0],j=h[L]||h["*"];let W;if(m[L])W=m[L];else if(h[L])W=b;else if(m["*"])W=m["*"];else{if(!h["*"]){E.push(new We(n,s[M],`unknown property "${M}"`));continue}W=b}E=E.concat(W({key:(n&&`${n}.`)+M,value:s[M],valueSpec:j,style:x,styleSpec:w,object:s,objectKey:M,validateSpec:b},s))}for(const M in h)m[M]||h[M].required&&h[M].default===void 0&&s[M]===void 0&&E.push(new We(n,s,`missing required property "${M}"`));return E}function vl(o){const n=o.value,s=o.valueSpec,h=o.style,m=o.styleSpec,x=o.key,w=o.arrayElementValidator||o.validateSpec;if(fr(n)!=="array")return[new We(x,n,`array expected, ${fr(n)} found`)];if(s.length&&n.length!==s.length)return[new We(x,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new We(x,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let b={type:s.value,values:s.values};m.$version<7&&(b.function=s.function),fr(s.value)==="object"&&(b=s.value);let E=[];for(let I=0;I<n.length;I++)E=E.concat(w({array:n,arrayIndex:I,value:n[I],valueSpec:b,validateSpec:o.validateSpec,style:h,styleSpec:m,key:`${x}[${I}]`}));return E}function vh(o){const n=o.key,s=o.value,h=o.valueSpec;let m=fr(s);return m==="number"&&s!=s&&(m="NaN"),m!=="number"?[new We(n,s,`number expected, ${m} found`)]:"minimum"in h&&s<h.minimum?[new We(n,s,`${s} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&s>h.maximum?[new We(n,s,`${s} is greater than the maximum value ${h.maximum}`)]:[]}function Iu(o){const n=o.valueSpec,s=en(o.value.type);let h,m,x,w={};const b=s!=="categorical"&&o.value.property===void 0,E=!b,I=fr(o.value.stops)==="array"&&fr(o.value.stops[0])==="array"&&fr(o.value.stops[0][0])==="object",M=yi({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(W){if(s==="identity")return[new We(W.key,W.value,'identity function may not have a "stops" property')];let Y=[];const J=W.value;return Y=Y.concat(vl({key:W.key,value:J,valueSpec:W.valueSpec,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:L})),fr(J)==="array"&&J.length===0&&Y.push(new We(W.key,J,"array must have at least one stop")),Y},default:function(W){return W.validateSpec({key:W.key,value:W.value,valueSpec:n,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec})}}});return s==="identity"&&b&&M.push(new We(o.key,o.value,'missing required property "property"')),s==="identity"||o.value.stops||M.push(new We(o.key,o.value,'missing required property "stops"')),s==="exponential"&&o.valueSpec.expression&&!mh(o.valueSpec)&&M.push(new We(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(E&&!la(o.valueSpec)?M.push(new We(o.key,o.value,"property functions not supported")):b&&!Fp(o.valueSpec)&&M.push(new We(o.key,o.value,"zoom functions not supported"))),s!=="categorical"&&!I||o.value.property!==void 0||M.push(new We(o.key,o.value,'"property" property is required')),M;function L(W){let Y=[];const J=W.value,le=W.key;if(fr(J)!=="array")return[new We(le,J,`array expected, ${fr(J)} found`)];if(J.length!==2)return[new We(le,J,`array length 2 expected, length ${J.length} found`)];if(I){if(fr(J[0])!=="object")return[new We(le,J,`object expected, ${fr(J[0])} found`)];if(J[0].zoom===void 0)return[new We(le,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new We(le,J,"object stop key must have value")];if(x&&x>en(J[0].zoom))return[new We(le,J[0].zoom,"stop zoom values must appear in ascending order")];en(J[0].zoom)!==x&&(x=en(J[0].zoom),m=void 0,w={}),Y=Y.concat(yi({key:`${le}[0]`,value:J[0],valueSpec:{zoom:{}},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:vh,value:j}}))}else Y=Y.concat(j({key:`${le}[0]`,value:J[0],valueSpec:{},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec},J));return Eu(to(J[1]))?Y.concat([new We(`${le}[1]`,J[1],"expressions are not allowed in function stops.")]):Y.concat(W.validateSpec({key:`${le}[1]`,value:J[1],valueSpec:n,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec}))}function j(W,Y){const J=fr(W.value),le=en(W.value),pe=W.value!==null?W.value:Y;if(h){if(J!==h)return[new We(W.key,pe,`${J} stop domain type must match previous stop domain type ${h}`)]}else h=J;if(J!=="number"&&J!=="string"&&J!=="boolean")return[new We(W.key,pe,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&s!=="categorical"){let ze=`number expected, ${J} found`;return la(n)&&s===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new We(W.key,pe,ze)]}return s!=="categorical"||J!=="number"||isFinite(le)&&Math.floor(le)===le?s!=="categorical"&&J==="number"&&m!==void 0&&le<m?[new We(W.key,pe,"stop domain values must appear in ascending order")]:(m=le,s==="categorical"&&le in w?[new We(W.key,pe,"stop domain values must be unique")]:(w[le]=!0,[])):[new We(W.key,pe,`integer expected, found ${le}`)]}}function fa(o){const n=(o.expressionContext==="property"?gh:ca)(to(o.value),o.valueSpec);if(n.result==="error")return n.value.map(h=>new We(`${o.key}${h.key}`,o.value,h.message));const s=n.value.expression||n.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!s.outputDefined())return[new We(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!sa(s))return[new We(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!sa(s))return[new We(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!ml(s,["zoom","feature-state"]))return[new We(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!fl(s))return[new We(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uo(o){const n=o.key,s=o.value,h=o.valueSpec,m=[];return Array.isArray(h.values)?h.values.indexOf(en(s))===-1&&m.push(new We(n,s,`expected one of [${h.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(h.values).indexOf(en(s))===-1&&m.push(new We(n,s,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(s)} found`)),m}function xh(o){return ku(to(o.value))?fa(Gr({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Pu(o)}function Pu(o){const n=o.value,s=o.key;if(fr(n)!=="array")return[new We(s,n,`array expected, ${fr(n)} found`)];const h=o.styleSpec;let m,x=[];if(n.length<1)return[new We(s,n,"filter array must have at least 1 element")];switch(x=x.concat(Uo({key:`${s}[0]`,value:n[0],valueSpec:h.filter_operator,style:o.style,styleSpec:o.styleSpec})),en(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&en(n[1])==="$type"&&x.push(new We(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&x.push(new We(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(m=fr(n[1]),m!=="string"&&x.push(new We(`${s}[1]`,n[1],`string expected, ${m} found`)));for(let w=2;w<n.length;w++)m=fr(n[w]),en(n[1])==="$type"?x=x.concat(Uo({key:`${s}[${w}]`,value:n[w],valueSpec:h.geometry_type,style:o.style,styleSpec:o.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&x.push(new We(`${s}[${w}]`,n[w],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)x=x.concat(Pu({key:`${s}[${w}]`,value:n[w],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":m=fr(n[1]),n.length!==2?x.push(new We(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):m!=="string"&&x.push(new We(`${s}[1]`,n[1],`string expected, ${m} found`))}return x}function wh(o,n){const s=o.key,h=o.validateSpec,m=o.style,x=o.styleSpec,w=o.value,b=o.objectKey,E=x[`${n}_${o.layerType}`];if(!E)return[];const I=b.match(/^(.*)-transition$/);if(n==="paint"&&I&&E[I[1]]&&E[I[1]].transition)return h({key:s,value:w,valueSpec:x.transition,style:m,styleSpec:x});const M=o.valueSpec||E[b];if(!M)return[new We(s,w,`unknown property "${b}"`)];let L;if(fr(w)==="string"&&la(M)&&!M.tokens&&(L=/^{([^}]+)}$/.exec(w)))return[new We(s,w,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const j=[];return o.layerType==="symbol"&&(b==="text-field"&&m&&!m.glyphs&&j.push(new We(s,w,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&wu(to(w))&&en(w.type)==="identity"&&j.push(new We(s,w,'"text-font" does not support identity functions'))),j.concat(h({key:o.key,value:w,valueSpec:M,style:m,styleSpec:x,expressionContext:"property",propertyType:n,propertyKey:b}))}function Au(o){return wh(o,"paint")}function bh(o){return wh(o,"layout")}function Sh(o){let n=[];const s=o.value,h=o.key,m=o.style,x=o.styleSpec;s.type||s.ref||n.push(new We(h,s,'either "type" or "ref" is required'));let w=en(s.type);const b=en(s.ref);if(s.id){const E=en(s.id);for(let I=0;I<o.arrayIndex;I++){const M=m.layers[I];en(M.id)===E&&n.push(new We(h,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let E;["type","source","source-layer","filter","layout"].forEach(I=>{I in s&&n.push(new We(h,s[I],`"${I}" is prohibited for ref layers`))}),m.layers.forEach(I=>{en(I.id)===b&&(E=I)}),E?E.ref?n.push(new We(h,s.ref,"ref cannot reference another ref layer")):w=en(E.type):n.push(new We(h,s.ref,`ref layer "${b}" not found`))}else if(w!=="background")if(s.source){const E=m.sources&&m.sources[s.source],I=E&&en(E.type);E?I==="vector"&&w==="raster"?n.push(new We(h,s.source,`layer "${s.id}" requires a raster source`)):I!=="raster-dem"&&w==="hillshade"?n.push(new We(h,s.source,`layer "${s.id}" requires a raster-dem source`)):I==="raster"&&w!=="raster"?n.push(new We(h,s.source,`layer "${s.id}" requires a vector source`)):I!=="vector"||s["source-layer"]?I==="raster-dem"&&w!=="hillshade"?n.push(new We(h,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!s.paint||!s.paint["line-gradient"]||I==="geojson"&&E.lineMetrics||n.push(new We(h,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new We(h,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new We(h,s.source,`source "${s.source}" not found`))}else n.push(new We(h,s,'missing required property "source"'));return n=n.concat(yi({key:h,value:s,valueSpec:x.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${h}.type`,value:s.type,valueSpec:x.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:s,objectKey:"type"}),filter:xh,layout:E=>yi({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":I=>bh(Gr({layerType:w},I))}}),paint:E=>yi({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":I=>Au(Gr({layerType:w},I))}})}})),n}function zs(o){const n=o.value,s=o.key,h=fr(n);return h!=="string"?[new We(s,n,`string expected, ${h} found`)]:[]}const Mu={promoteId:function({key:o,value:n}){if(fr(n)==="string")return zs({key:o,value:n});{const s=[];for(const h in n)s.push(...zs({key:`${o}.${h}`,value:n[h]}));return s}}};function xl(o){const n=o.value,s=o.key,h=o.styleSpec,m=o.style,x=o.validateSpec;if(!n.type)return[new We(s,n,'"type" is required')];const w=en(n.type);let b;switch(w){case"vector":case"raster":return b=yi({key:s,value:n,valueSpec:h[`source_${w.replace("-","_")}`],style:o.style,styleSpec:h,objectElementValidators:Mu,validateSpec:x}),b;case"raster-dem":return b=function(E){var I;const M=(I=E.sourceName)!==null&&I!==void 0?I:"",L=E.value,j=E.styleSpec,W=j.source_raster_dem,Y=E.style;let J=[];const le=fr(L);if(L===void 0)return J;if(le!=="object")return J.push(new We("source_raster_dem",L,`object expected, ${le} found`)),J;const pe=en(L.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],be=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const Ae in L)!pe&&ze.includes(Ae)?J.push(new We(Ae,L[Ae],`In "${M}": "${Ae}" is only valid when "encoding" is set to "custom". ${be} encoding found`)):W[Ae]?J=J.concat(E.validateSpec({key:Ae,value:L[Ae],valueSpec:W[Ae],validateSpec:E.validateSpec,style:Y,styleSpec:j})):J.push(new We(Ae,L[Ae],`unknown property "${Ae}"`));return J}({sourceName:s,value:n,style:o.style,styleSpec:h,validateSpec:x}),b;case"geojson":if(b=yi({key:s,value:n,valueSpec:h.source_geojson,style:m,styleSpec:h,validateSpec:x,objectElementValidators:Mu}),n.cluster)for(const E in n.clusterProperties){const[I,M]=n.clusterProperties[E],L=typeof I=="string"?[I,["accumulated"],["get",E]]:I;b.push(...fa({key:`${s}.${E}.map`,value:M,validateSpec:x,expressionContext:"cluster-map"})),b.push(...fa({key:`${s}.${E}.reduce`,value:L,validateSpec:x,expressionContext:"cluster-reduce"}))}return b;case"video":return yi({key:s,value:n,valueSpec:h.source_video,style:m,validateSpec:x,styleSpec:h});case"image":return yi({key:s,value:n,valueSpec:h.source_image,style:m,validateSpec:x,styleSpec:h});case"canvas":return[new We(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Uo({key:`${s}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:x,styleSpec:h})}}function Eh(o){const n=o.value,s=o.styleSpec,h=s.light,m=o.style;let x=[];const w=fr(n);if(n===void 0)return x;if(w!=="object")return x=x.concat([new We("light",n,`object expected, ${w} found`)]),x;for(const b in n){const E=b.match(/^(.*)-transition$/);x=x.concat(E&&h[E[1]]&&h[E[1]].transition?o.validateSpec({key:b,value:n[b],valueSpec:s.transition,validateSpec:o.validateSpec,style:m,styleSpec:s}):h[b]?o.validateSpec({key:b,value:n[b],valueSpec:h[b],validateSpec:o.validateSpec,style:m,styleSpec:s}):[new We(b,n[b],`unknown property "${b}"`)])}return x}function kh(o){const n=o.value,s=o.styleSpec,h=s.sky,m=o.style,x=fr(n);if(n===void 0)return[];if(x!=="object")return[new We("sky",n,`object expected, ${x} found`)];let w=[];for(const b in n)w=w.concat(h[b]?o.validateSpec({key:b,value:n[b],valueSpec:h[b],style:m,styleSpec:s}):[new We(b,n[b],`unknown property "${b}"`)]);return w}function Th(o){const n=o.value,s=o.styleSpec,h=s.terrain,m=o.style;let x=[];const w=fr(n);if(n===void 0)return x;if(w!=="object")return x=x.concat([new We("terrain",n,`object expected, ${w} found`)]),x;for(const b in n)x=x.concat(h[b]?o.validateSpec({key:b,value:n[b],valueSpec:h[b],validateSpec:o.validateSpec,style:m,styleSpec:s}):[new We(b,n[b],`unknown property "${b}"`)]);return x}function Ch(o){let n=[];const s=o.value,h=o.key;if(Array.isArray(s)){const m=[],x=[];for(const w in s)s[w].id&&m.includes(s[w].id)&&n.push(new We(h,s,`all the sprites' ids must be unique, but ${s[w].id} is duplicated`)),m.push(s[w].id),s[w].url&&x.includes(s[w].url)&&n.push(new We(h,s,`all the sprites' URLs must be unique, but ${s[w].url} is duplicated`)),x.push(s[w].url),n=n.concat(yi({key:`${h}[${w}]`,value:s[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return n}return zs({key:h,value:s})}const zu={"*":()=>[],array:vl,boolean:function(o){const n=o.value,s=o.key,h=fr(n);return h!=="boolean"?[new We(s,n,`boolean expected, ${h} found`)]:[]},number:vh,color:function(o){const n=o.key,s=o.value,h=fr(s);return h!=="string"?[new We(n,s,`color expected, ${h} found`)]:Er.parse(String(s))?[]:[new We(n,s,`color expected, "${s}" found`)]},constants:Vp,enum:Uo,filter:xh,function:Iu,layer:Sh,object:yi,source:xl,light:Eh,sky:kh,terrain:Th,projection:function(o){const n=o.value,s=o.styleSpec,h=s.projection,m=o.style,x=fr(n);if(n===void 0)return[];if(x!=="object")return[new We("projection",n,`object expected, ${x} found`)];let w=[];for(const b in n)w=w.concat(h[b]?o.validateSpec({key:b,value:n[b],valueSpec:h[b],style:m,styleSpec:s}):[new We(b,n[b],`unknown property "${b}"`)]);return w},string:zs,formatted:function(o){return zs(o).length===0?[]:fa(o)},resolvedImage:function(o){return zs(o).length===0?[]:fa(o)},padding:function(o){const n=o.key,s=o.value;if(fr(s)==="array"){if(s.length<1||s.length>4)return[new We(n,s,`padding requires 1 to 4 values; ${s.length} values found`)];const h={type:"number"};let m=[];for(let x=0;x<s.length;x++)m=m.concat(o.validateSpec({key:`${n}[${x}]`,value:s[x],validateSpec:o.validateSpec,valueSpec:h}));return m}return vh({key:n,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(o){const n=o.key,s=o.value,h=fr(s),m=o.styleSpec;if(h!=="array"||s.length<1||s.length%2!=0)return[new We(n,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<s.length;w+=2)x=x.concat(Uo({key:`${n}[${w}]`,value:s[w],valueSpec:m.layout_symbol["text-anchor"]})),x=x.concat(vl({key:`${n}[${w+1}]`,value:s[w+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:m}));return x},sprite:Ch};function ma(o){const n=o.value,s=o.valueSpec,h=o.styleSpec;return o.validateSpec=ma,s.expression&&wu(en(n))?Iu(o):s.expression&&Eu(to(n))?fa(o):s.type&&zu[s.type]?zu[s.type](o):yi(Gr({},o,{valueSpec:s.type?h[s.type]:s}))}function Hp(o){const n=o.value,s=o.key,h=zs(o);return h.length||(n.indexOf("{fontstack}")===-1&&h.push(new We(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&h.push(new We(s,n,'"glyphs" url must include a "{range}" token'))),h}function Fi(o,n=ie){let s=[];return s=s.concat(ma({key:"",value:o,valueSpec:n.$root,styleSpec:n,style:o,validateSpec:ma,objectElementValidators:{glyphs:Hp,"*":()=>[]}})),o.constants&&(s=s.concat(Vp({key:"constants",value:o.constants,style:o,styleSpec:n,validateSpec:ma}))),Ih(s)}function To(o){return function(n){return o({...n,validateSpec:ma})}}function Ih(o){return[].concat(o).sort((n,s)=>n.line-s.line)}function ro(o){return function(...n){return Ih(o.apply(this,n))}}Fi.source=ro(To(xl)),Fi.sprite=ro(To(Ch)),Fi.glyphs=ro(To(Hp)),Fi.light=ro(To(Eh)),Fi.sky=ro(To(kh)),Fi.terrain=ro(To(Th)),Fi.layer=ro(To(Sh)),Fi.filter=ro(To(xh)),Fi.paintProperty=ro(To(Au)),Fi.layoutProperty=ro(To(bh));const Ds=Fi,my=Ds.light,gy=Ds.sky,Gp=Ds.paintProperty,Zp=Ds.layoutProperty;function Ph(o,n){let s=!1;if(n&&n.length)for(const h of n)o.fire(new V(new Error(h.message))),s=!0;return s}class ga{constructor(n,s,h){const m=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const w=new Int32Array(this.arrayBuffer);n=w[0],this.d=(s=w[1])+2*(h=w[2]);for(let E=0;E<this.d*this.d;E++){const I=w[3+E],M=w[3+E+1];m.push(I===M?null:w.subarray(I,M))}const b=w[3+m.length+1];this.keys=w.subarray(w[3+m.length],b),this.bboxes=w.subarray(b),this.insert=this._insertReadonly}else{this.d=s+2*h;for(let w=0;w<this.d*this.d;w++)m.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=n,this.padding=h,this.scale=s/n,this.uid=0;const x=h/s*n;this.min=-x,this.max=n+x}insert(n,s,h,m,x){this._forEachCell(s,h,m,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,s,h,m,x,w){this.cells[x].push(w)}query(n,s,h,m,x){const w=this.min,b=this.max;if(n<=w&&s<=w&&b<=h&&b<=m&&!x)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(n,s,h,m,this._queryCell,E,{},x),E}}_queryCell(n,s,h,m,x,w,b,E){const I=this.cells[x];if(I!==null){const M=this.keys,L=this.bboxes;for(let j=0;j<I.length;j++){const W=I[j];if(b[W]===void 0){const Y=4*W;(E?E(L[Y+0],L[Y+1],L[Y+2],L[Y+3]):n<=L[Y+2]&&s<=L[Y+3]&&h>=L[Y+0]&&m>=L[Y+1])?(b[W]=!0,w.push(M[W])):b[W]=!1}}}}_forEachCell(n,s,h,m,x,w,b,E){const I=this._convertToCellCoord(n),M=this._convertToCellCoord(s),L=this._convertToCellCoord(h),j=this._convertToCellCoord(m);for(let W=I;W<=L;W++)for(let Y=M;Y<=j;Y++){const J=this.d*Y+W;if((!E||E(this._convertFromCellCoord(W),this._convertFromCellCoord(Y),this._convertFromCellCoord(W+1),this._convertFromCellCoord(Y+1)))&&x.call(this,n,s,h,m,J,w,b,E))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,s=3+this.cells.length+1+1;let h=0;for(let w=0;w<this.cells.length;w++)h+=this.cells[w].length;const m=new Int32Array(s+h+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let x=s;for(let w=0;w<n.length;w++){const b=n[w];m[3+w]=x,m.set(b,x),x+=b.length}return m[3+n.length]=x,m.set(this.keys,x),x+=this.keys.length,m[3+n.length+1]=x,m.set(this.bboxes,x),x+=this.bboxes.length,m.buffer}static serialize(n,s){const h=n.toArrayBuffer();return s&&s.push(h),{buffer:h}}static deserialize(n){return new ga(n.buffer)}}const Oi={};function bt(o,n,s={}){if(Oi[o])throw new Error(`${o} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:o,writeable:!1}),Oi[o]={klass:n,omit:s.omit||[],shallow:s.shallow||[]}}bt("Object",Object),bt("TransferableGridIndex",ga),bt("Color",Er),bt("Error",Error),bt("AJAXError",Kt),bt("ResolvedImage",gi),bt("StylePropertyFunction",pa),bt("StyleExpression",Su,{omit:["_evaluator"]}),bt("ZoomDependentExpression",da),bt("ZoomConstantExpression",ha),bt("CompoundExpression",Li,{omit:["_evaluate"]});for(const o in oa)oa[o]._classRegistryKey||bt(`Expression_${o}`,oa[o]);function Du(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Ah(o){return o.$name||o.constructor._classRegistryKey}function Wp(o){return!function(n){if(n===null||typeof n!="object")return!1;const s=Ah(n);return!(!s||s==="Object")}(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Du(o)||ye(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function ya(o,n){if(Wp(o))return(Du(o)||ye(o))&&n&&n.push(o),ArrayBuffer.isView(o)&&n&&n.push(o.buffer),o instanceof ImageData&&n&&n.push(o.data.buffer),o;if(Array.isArray(o)){const x=[];for(const w of o)x.push(ya(w,n));return x}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const s=Ah(o);if(!s)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!Oi[s])throw new Error(`${s} is not registered.`);const{klass:h}=Oi[s],m=h.serialize?h.serialize(o,n):{};if(h.serialize){if(n&&m===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in o){if(!o.hasOwnProperty(x)||Oi[s].omit.indexOf(x)>=0)continue;const w=o[x];m[x]=Oi[s].shallow.indexOf(x)>=0?w:ya(w,n)}o instanceof Error&&(m.message=o.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(m.$name=s),m}function _a(o){if(Wp(o))return o;if(Array.isArray(o))return o.map(_a);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const n=Ah(o)||"Object";if(!Oi[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:s}=Oi[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(o);const h=Object.create(s.prototype);for(const m of Object.keys(o)){if(m==="$name")continue;const x=o[m];h[m]=Oi[n].shallow.indexOf(m)>=0?x:_a(x)}return h}class Mh{constructor(){this.first=!0}update(n,s){const h=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=s),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=h,!0))}}const ir={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function zh(o){for(const n of o)if(Rh(n.charCodeAt(0)))return!0;return!1}function yy(o){for(const n of o)if(!va(n.charCodeAt(0)))return!1;return!0}function Dh(o){const n=o.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(n.join("|"),"u")}const _y=Dh(["Arab","Dupl","Mong","Ougr","Syrc"]);function va(o){return!_y.test(String.fromCodePoint(o))}const qp=Dh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Rh(o){return!(o!==746&&o!==747&&(o<4352||!(ir["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||ir["CJK Compatibility"](o)||ir["CJK Strokes"](o)||!(!ir["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||ir["Enclosed CJK Letters and Months"](o)||ir["Ideographic Description Characters"](o)||ir.Kanbun(o)||ir.Katakana(o)&&o!==12540||!(!ir["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!ir["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||ir["Vertical Forms"](o)||ir["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||qp.test(String.fromCodePoint(o)))))}function Xp(o){return!(Rh(o)||function(n){return!!(ir["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||ir["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||ir["Letterlike Symbols"](n)||ir["Number Forms"](n)||ir["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||ir["Control Pictures"](n)&&n!==9251||ir["Optical Character Recognition"](n)||ir["Enclosed Alphanumerics"](n)||ir["Geometric Shapes"](n)||ir["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||ir["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||ir["CJK Symbols and Punctuation"](n)||ir.Katakana(n)||ir["Private Use Area"](n)||ir["CJK Compatibility Forms"](n)||ir["Small Form Variants"](n)||ir["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(o))}const vy=Dh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Lh(o){return vy.test(String.fromCodePoint(o))}function xy(o,n){return!(!n&&Lh(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||ir.Khmer(o))}function wy(o){for(const n of o)if(Lh(n.charCodeAt(0)))return!0;return!1}const _i=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Rr{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Mh,this.transition={})}isSupportedScript(n){return function(s,h){for(const m of s)if(!xy(m.charCodeAt(0),h))return!1;return!0}(n,_i.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,s=n-Math.floor(n),h=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*s}}}class xa{constructor(n,s){this.property=n,this.value=s,this.expression=function(h,m){if(wu(h))return new pa(h,m);if(Eu(h)){const x=gh(h,m);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=h;return m.type==="color"&&typeof h=="string"?x=Er.parse(h):m.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(h)&&(x=Ri.parse(h)):x=mi.parse(h),{kind:"constant",evaluate:()=>x}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,h){return this.property.possiblyEvaluate(this,n,s,h)}}class Ru{constructor(n){this.property=n,this.value=new xa(n,void 0)}transitioned(n,s){return new Kp(this.property,this.value,s,ge({},n.transition,this.transition),n.now)}untransitioned(){return new Kp(this.property,this.value,null,{},0)}}class Lu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return it(this._values[n].value.value)}setValue(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Ru(this._values[n].property)),this._values[n].value=new xa(this._values[n].property,s===null?void 0:it(s))}getTransition(n){return it(this._values[n].transition)}setTransition(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Ru(this._values[n].property)),this._values[n].transition=it(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(n[s]=h);const m=this.getTransition(s);m!==void 0&&(n[`${s}-transition`]=m)}return n}transitioned(n,s){const h=new wl(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(n,s._values[m]);return h}untransitioned(){const n=new wl(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Kp{constructor(n,s,h,m,x){this.property=n,this.value=s,this.begin=x+m.delay||0,this.end=this.begin+m.duration||0,n.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(n,s,h){const m=n.now||0,x=this.value.possiblyEvaluate(n,s,h),w=this.prior;if(w){if(m>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(m<this.begin)return w.possiblyEvaluate(n,s,h);{const b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(n,s,h),x,function(E){if(E<=0)return 0;if(E>=1)return 1;const I=E*E,M=I*E;return 4*(E<.5?M:3*(E-I)+M-.75)}(b))}}return x}}class wl{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,h){const m=new Sl(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(n,s,h);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class bl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return it(this._values[n].value)}setValue(n,s){this._values[n]=new xa(this._values[n].property,s===null?void 0:it(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const h=this.getValue(s);h!==void 0&&(n[s]=h)}return n}possiblyEvaluate(n,s,h){const m=new Sl(this._properties);for(const x of Object.keys(this._values))m._values[x]=this._values[x].possiblyEvaluate(n,s,h);return m}}class Co{constructor(n,s,h){this.property=n,this.value=s,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,h,m){return this.property.evaluate(this.value,this.parameters,n,s,h,m)}}class Sl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Tt{constructor(n){this.specification=n}possiblyEvaluate(n,s){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(s)}interpolate(n,s,h){const m=ti[this.specification.type];return m?m(n,s,h):n}}class Nt{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,h,m){return new Co(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},h,m)}:n.expression,s)}interpolate(n,s,h){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new Co(this,{kind:"constant",value:void 0},n.parameters);const m=ti[this.specification.type];if(m){const x=m(n.value.value,s.value.value,h);return new Co(this,{kind:"constant",value:x},n.parameters)}return n}evaluate(n,s,h,m,x,w){return n.kind==="constant"?n.value:n.evaluate(s,h,m,x,w)}}class Fu extends Nt{possiblyEvaluate(n,s,h,m){if(n.value===void 0)return new Co(this,{kind:"constant",value:void 0},s);if(n.expression.kind==="constant"){const x=n.expression.evaluate(s,null,{},h,m),w=n.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,b=this._calculate(w,w,w,s);return new Co(this,{kind:"constant",value:b},s)}if(n.expression.kind==="camera"){const x=this._calculate(n.expression.evaluate({zoom:s.zoom-1}),n.expression.evaluate({zoom:s.zoom}),n.expression.evaluate({zoom:s.zoom+1}),s);return new Co(this,{kind:"constant",value:x},s)}return new Co(this,n.expression,s)}evaluate(n,s,h,m,x,w){if(n.kind==="source"){const b=n.evaluate(s,h,m,x,w);return this._calculate(b,b,b,s)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(s.zoom)-1},h,m),n.evaluate({zoom:Math.floor(s.zoom)},h,m),n.evaluate({zoom:Math.floor(s.zoom)+1},h,m),s):n.value}_calculate(n,s,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:h,to:s}}interpolate(n){return n}}class Ou{constructor(n){this.specification=n}possiblyEvaluate(n,s,h,m){if(n.value!==void 0){if(n.expression.kind==="constant"){const x=n.expression.evaluate(s,null,{},h,m);return this._calculate(x,x,x,s)}return this._calculate(n.expression.evaluate(new Rr(Math.floor(s.zoom-1),s)),n.expression.evaluate(new Rr(Math.floor(s.zoom),s)),n.expression.evaluate(new Rr(Math.floor(s.zoom+1),s)),s)}}_calculate(n,s,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:h,to:s}}interpolate(n){return n}}class Fh{constructor(n){this.specification=n}possiblyEvaluate(n,s,h,m){return!!n.expression.evaluate(s,null,{},h,m)}interpolate(){return!1}}class v{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in n){const h=n[s];h.specification.overridable&&this.overridableProperties.push(s);const m=this.defaultPropertyValues[s]=new xa(h,void 0),x=this.defaultTransitionablePropertyValues[s]=new Ru(h);this.defaultTransitioningPropertyValues[s]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=m.possiblyEvaluate({})}}}bt("DataDrivenProperty",Nt),bt("DataConstantProperty",Tt),bt("CrossFadedDataDrivenProperty",Fu),bt("CrossFadedProperty",Ou),bt("ColorRampProperty",Fh);const r="-transition";class a extends Ue{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new bl(s.layout)),s.paint)){this._transitionablePaint=new Lu(s.paint);for(const h in n.paint)this.setPaintProperty(h,n.paint[h],{validate:!1});for(const h in n.layout)this.setLayoutProperty(h,n.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Sl(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,h={}){s!=null&&this._validate(Zp,`layers.${this.id}.layout.${n}`,n,s,h)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return n.endsWith(r)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,h={}){if(s!=null&&this._validate(Gp,`layers.${this.id}.paint.${n}`,n,s,h))return!1;if(n.endsWith(r))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const m=this._transitionablePaint._values[n],x=m.property.specification["property-type"]==="cross-faded-data-driven",w=m.value.isDataDriven(),b=m.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const E=this._transitionablePaint._values[n].value;return E.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(n,b,E)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,s,h){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Ge(n,(s,h)=>!(s===void 0||h==="layout"&&!Object.keys(s).length||h==="paint"&&!Object.keys(s).length))}_validate(n,s,h,m,x={}){return(!x||x.validate!==!1)&&Ph(this,n.call(Ds,{key:s,layerType:this.type,objectKey:h,value:m,styleSpec:ie,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof Co&&la(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const p={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class f{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class _{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function S(o,n=1){let s=0,h=0;return{members:o.map(m=>{const x=p[m.type].BYTES_PER_ELEMENT,w=s=k(s,Math.max(n,x)),b=m.components||1;return h=Math.max(h,x),s+=x*b,{name:m.name,type:m.type,components:b,offset:w}}),size:k(s,Math.max(h,n)),alignment:n}}function k(o,n){return Math.ceil(o/n)*n}class C extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const m=2*n;return this.int16[m+0]=s,this.int16[m+1]=h,n}}C.prototype.bytesPerElement=4,bt("StructArrayLayout2i4",C);class z extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,h)}emplace(n,s,h,m){const x=3*n;return this.int16[x+0]=s,this.int16[x+1]=h,this.int16[x+2]=m,n}}z.prototype.bytesPerElement=6,bt("StructArrayLayout3i6",z);class O extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,h,m)}emplace(n,s,h,m,x){const w=4*n;return this.int16[w+0]=s,this.int16[w+1]=h,this.int16[w+2]=m,this.int16[w+3]=x,n}}O.prototype.bytesPerElement=8,bt("StructArrayLayout4i8",O);class B extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w){const b=this.length;return this.resize(b+1),this.emplace(b,n,s,h,m,x,w)}emplace(n,s,h,m,x,w,b){const E=6*n;return this.int16[E+0]=s,this.int16[E+1]=h,this.int16[E+2]=m,this.int16[E+3]=x,this.int16[E+4]=w,this.int16[E+5]=b,n}}B.prototype.bytesPerElement=12,bt("StructArrayLayout2i4i12",B);class K extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w){const b=this.length;return this.resize(b+1),this.emplace(b,n,s,h,m,x,w)}emplace(n,s,h,m,x,w,b){const E=4*n,I=8*n;return this.int16[E+0]=s,this.int16[E+1]=h,this.uint8[I+4]=m,this.uint8[I+5]=x,this.uint8[I+6]=w,this.uint8[I+7]=b,n}}K.prototype.bytesPerElement=8,bt("StructArrayLayout2i4ub8",K);class Q extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const m=2*n;return this.float32[m+0]=s,this.float32[m+1]=h,n}}Q.prototype.bytesPerElement=8,bt("StructArrayLayout2f8",Q);class re extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w,b,E,I,M){const L=this.length;return this.resize(L+1),this.emplace(L,n,s,h,m,x,w,b,E,I,M)}emplace(n,s,h,m,x,w,b,E,I,M,L){const j=10*n;return this.uint16[j+0]=s,this.uint16[j+1]=h,this.uint16[j+2]=m,this.uint16[j+3]=x,this.uint16[j+4]=w,this.uint16[j+5]=b,this.uint16[j+6]=E,this.uint16[j+7]=I,this.uint16[j+8]=M,this.uint16[j+9]=L,n}}re.prototype.bytesPerElement=20,bt("StructArrayLayout10ui20",re);class ce extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w,b,E,I,M,L,j){const W=this.length;return this.resize(W+1),this.emplace(W,n,s,h,m,x,w,b,E,I,M,L,j)}emplace(n,s,h,m,x,w,b,E,I,M,L,j,W){const Y=12*n;return this.int16[Y+0]=s,this.int16[Y+1]=h,this.int16[Y+2]=m,this.int16[Y+3]=x,this.uint16[Y+4]=w,this.uint16[Y+5]=b,this.uint16[Y+6]=E,this.uint16[Y+7]=I,this.int16[Y+8]=M,this.int16[Y+9]=L,this.int16[Y+10]=j,this.int16[Y+11]=W,n}}ce.prototype.bytesPerElement=24,bt("StructArrayLayout4i4ui4i24",ce);class fe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,h)}emplace(n,s,h,m){const x=3*n;return this.float32[x+0]=s,this.float32[x+1]=h,this.float32[x+2]=m,n}}fe.prototype.bytesPerElement=12,bt("StructArrayLayout3f12",fe);class me extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}me.prototype.bytesPerElement=4,bt("StructArrayLayout1ul4",me);class we extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w,b,E,I){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,h,m,x,w,b,E,I)}emplace(n,s,h,m,x,w,b,E,I,M){const L=10*n,j=5*n;return this.int16[L+0]=s,this.int16[L+1]=h,this.int16[L+2]=m,this.int16[L+3]=x,this.int16[L+4]=w,this.int16[L+5]=b,this.uint32[j+3]=E,this.uint16[L+8]=I,this.uint16[L+9]=M,n}}we.prototype.bytesPerElement=20,bt("StructArrayLayout6i1ul2ui20",we);class ae extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w){const b=this.length;return this.resize(b+1),this.emplace(b,n,s,h,m,x,w)}emplace(n,s,h,m,x,w,b){const E=6*n;return this.int16[E+0]=s,this.int16[E+1]=h,this.int16[E+2]=m,this.int16[E+3]=x,this.int16[E+4]=w,this.int16[E+5]=b,n}}ae.prototype.bytesPerElement=12,bt("StructArrayLayout2i2i2i12",ae);class Ce extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,h,m,x)}emplace(n,s,h,m,x,w){const b=4*n,E=8*n;return this.float32[b+0]=s,this.float32[b+1]=h,this.float32[b+2]=m,this.int16[E+6]=x,this.int16[E+7]=w,n}}Ce.prototype.bytesPerElement=16,bt("StructArrayLayout2f1f2i16",Ce);class Pe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w){const b=this.length;return this.resize(b+1),this.emplace(b,n,s,h,m,x,w)}emplace(n,s,h,m,x,w,b){const E=16*n,I=4*n,M=8*n;return this.uint8[E+0]=s,this.uint8[E+1]=h,this.float32[I+1]=m,this.float32[I+2]=x,this.int16[M+6]=w,this.int16[M+7]=b,n}}Pe.prototype.bytesPerElement=16,bt("StructArrayLayout2ub2f2i16",Pe);class De extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,h)}emplace(n,s,h,m){const x=3*n;return this.uint16[x+0]=s,this.uint16[x+1]=h,this.uint16[x+2]=m,n}}De.prototype.bytesPerElement=6,bt("StructArrayLayout3ui6",De);class Xe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe){const ze=this.length;return this.resize(ze+1),this.emplace(ze,n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe)}emplace(n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe,ze){const be=24*n,Ae=12*n,Ve=48*n;return this.int16[be+0]=s,this.int16[be+1]=h,this.uint16[be+2]=m,this.uint16[be+3]=x,this.uint32[Ae+2]=w,this.uint32[Ae+3]=b,this.uint32[Ae+4]=E,this.uint16[be+10]=I,this.uint16[be+11]=M,this.uint16[be+12]=L,this.float32[Ae+7]=j,this.float32[Ae+8]=W,this.uint8[Ve+36]=Y,this.uint8[Ve+37]=J,this.uint8[Ve+38]=le,this.uint32[Ae+10]=pe,this.int16[be+22]=ze,n}}Xe.prototype.bytesPerElement=48,bt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Xe);class ot extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe,ze,be,Ae,Ve,et,vt,Ft,gt,pt,Pt,Et){const wt=this.length;return this.resize(wt+1),this.emplace(wt,n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe,ze,be,Ae,Ve,et,vt,Ft,gt,pt,Pt,Et)}emplace(n,s,h,m,x,w,b,E,I,M,L,j,W,Y,J,le,pe,ze,be,Ae,Ve,et,vt,Ft,gt,pt,Pt,Et,wt){const qe=32*n,At=16*n;return this.int16[qe+0]=s,this.int16[qe+1]=h,this.int16[qe+2]=m,this.int16[qe+3]=x,this.int16[qe+4]=w,this.int16[qe+5]=b,this.int16[qe+6]=E,this.int16[qe+7]=I,this.uint16[qe+8]=M,this.uint16[qe+9]=L,this.uint16[qe+10]=j,this.uint16[qe+11]=W,this.uint16[qe+12]=Y,this.uint16[qe+13]=J,this.uint16[qe+14]=le,this.uint16[qe+15]=pe,this.uint16[qe+16]=ze,this.uint16[qe+17]=be,this.uint16[qe+18]=Ae,this.uint16[qe+19]=Ve,this.uint16[qe+20]=et,this.uint16[qe+21]=vt,this.uint16[qe+22]=Ft,this.uint32[At+12]=gt,this.float32[At+13]=pt,this.float32[At+14]=Pt,this.uint16[qe+30]=Et,this.uint16[qe+31]=wt,n}}ot.prototype.bytesPerElement=64,bt("StructArrayLayout8i15ui1ul2f2ui64",ot);class mt extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}mt.prototype.bytesPerElement=4,bt("StructArrayLayout1f4",mt);class xt extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,h)}emplace(n,s,h,m){const x=3*n;return this.uint16[6*n+0]=s,this.float32[x+1]=h,this.float32[x+2]=m,n}}xt.prototype.bytesPerElement=12,bt("StructArrayLayout1ui2f12",xt);class ht extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,n,s,h)}emplace(n,s,h,m){const x=4*n;return this.uint32[2*n+0]=s,this.uint16[x+2]=h,this.uint16[x+3]=m,n}}ht.prototype.bytesPerElement=8,bt("StructArrayLayout1ul2ui8",ht);class ct extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const h=this.length;return this.resize(h+1),this.emplace(h,n,s)}emplace(n,s,h){const m=2*n;return this.uint16[m+0]=s,this.uint16[m+1]=h,n}}ct.prototype.bytesPerElement=4,bt("StructArrayLayout2ui4",ct);class Ct extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}Ct.prototype.bytesPerElement=2,bt("StructArrayLayout1ui2",Ct);class Ht extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,h,m){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,h,m)}emplace(n,s,h,m,x){const w=4*n;return this.float32[w+0]=s,this.float32[w+1]=h,this.float32[w+2]=m,this.float32[w+3]=x,n}}Ht.prototype.bytesPerElement=16,bt("StructArrayLayout4f16",Ht);class dt extends f{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new D(this.anchorPointX,this.anchorPointY)}}dt.prototype.size=20;class yt extends we{get(n){return new dt(this,n)}}bt("CollisionBoxArray",yt);class Ut extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ut.prototype.size=48;class Lr extends Xe{get(n){return new Ut(this,n)}}bt("PlacedSymbolArray",Lr);class Yt extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Yt.prototype.size=64;class nr extends ot{get(n){return new Yt(this,n)}}bt("SymbolInstanceArray",nr);class Fr extends mt{getoffsetX(n){return this.float32[1*n+0]}}bt("GlyphOffsetArray",Fr);class Mn extends z{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}bt("SymbolLineVertexArray",Mn);class no extends f{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}no.prototype.size=12;class Or extends xt{get(n){return new no(this,n)}}bt("TextAnchorOffsetArray",Or);class ni extends f{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ni.prototype.size=8;class Vn extends ht{get(n){return new ni(this,n)}}bt("FeatureIndexArray",Vn);class zn extends C{}class Hn extends C{}class Io extends C{}class wa extends B{}class Bu extends K{}class ba extends Q{}class Bi extends re{}class Nu extends ce{}class Oh extends fe{}class Ni extends me{}class $i extends ae{}class ss extends Pe{}class io extends De{}class kn extends ct{}const Dn=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:vi}=Dn;class or{constructor(n=[]){this.segments=n}prepareSegment(n,s,h,m){let x=this.segments[this.segments.length-1];return n>or.MAX_VERTEX_ARRAY_LENGTH&&je(`Max vertices per segment is ${or.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!x||x.vertexLength+n>or.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==m)&&(x={vertexOffset:s.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},m!==void 0&&(x.sortKey=m),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,h,m){return new or([{vertexOffset:n,primitiveOffset:s,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function Rs(o,n){return 256*(o=se(Math.floor(o),0,255))+se(Math.floor(n),0,255)}or.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bt("SegmentVector",or);const Sa=S([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ea={exports:{}},Yp={exports:{}};Yp.exports=function(o,n){var s,h,m,x,w,b,E,I;for(h=o.length-(s=3&o.length),m=n,w=3432918353,b=461845907,I=0;I<h;)E=255&o.charCodeAt(I)|(255&o.charCodeAt(++I))<<8|(255&o.charCodeAt(++I))<<16|(255&o.charCodeAt(++I))<<24,++I,m=27492+(65535&(x=5*(65535&(m=(m^=E=(65535&(E=(E=(65535&E)*w+(((E>>>16)*w&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(E=0,s){case 3:E^=(255&o.charCodeAt(I+2))<<16;case 2:E^=(255&o.charCodeAt(I+1))<<8;case 1:m^=E=(65535&(E=(E=(65535&(E^=255&o.charCodeAt(I)))*w+(((E>>>16)*w&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return m^=o.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var by=Yp.exports,Jp={exports:{}};Jp.exports=function(o,n){for(var s,h=o.length,m=n^h,x=0;h>=4;)s=1540483477*(65535&(s=255&o.charCodeAt(x)|(255&o.charCodeAt(++x))<<8|(255&o.charCodeAt(++x))<<16|(255&o.charCodeAt(++x))<<24))+((1540483477*(s>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),h-=4,++x;switch(h){case 3:m^=(255&o.charCodeAt(x+2))<<16;case 2:m^=(255&o.charCodeAt(x+1))<<8;case 1:m=1540483477*(65535&(m^=255&o.charCodeAt(x)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var as=by,Qp=Jp.exports;Ea.exports=as,Ea.exports.murmur3=as,Ea.exports.murmur2=Qp;var $u=T(Ea.exports);class El{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,h,m){this.ids.push(ju(n)),this.positions.push(s,h,m)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=ju(n);let h=0,m=this.ids.length-1;for(;h<m;){const w=h+m>>1;this.ids[w]>=s?m=w:h=w+1}const x=[];for(;this.ids[h]===s;)x.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return x}static serialize(n,s){const h=new Float64Array(n.ids),m=new Uint32Array(n.positions);return Uu(h,m,0,h.length-1),s&&s.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(n){const s=new El;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function ju(o){const n=+o;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:$u(String(o))}function Uu(o,n,s,h){for(;s<h;){const m=o[s+h>>1];let x=s-1,w=h+1;for(;;){do x++;while(o[x]<m);do w--;while(o[w]>m);if(x>=w)break;ka(o,x,w),ka(n,3*x,3*w),ka(n,3*x+1,3*w+1),ka(n,3*x+2,3*w+2)}w-s<h-w?(Uu(o,n,s,w),s=w+1):(Uu(o,n,w+1,h),h=w)}}function ka(o,n,s){const h=o[n];o[n]=o[s],o[s]=h}bt("FeaturePositionMap",El);class kl{constructor(n,s){this.gl=n.gl,this.location=s}}class ef extends kl{constructor(n,s){super(n,s),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class rx extends kl{constructor(n,s){super(n,s),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class nx extends kl{constructor(n,s){super(n,s),this.current=Er.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const lI=new Float32Array(16);function Sy(o){return[Rs(255*o.r,255*o.g),Rs(255*o.b,255*o.a)]}class Bh{constructor(n,s,h){this.value=n,this.uniformNames=s.map(m=>`u_${m}`),this.type=h}setUniform(n,s,h){n.set(h.constantOr(this.value))}getBinding(n,s,h){return this.type==="color"?new nx(n,s):new ef(n,s)}}class Vu{constructor(n,s){this.uniformNames=s.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=n.tlbr}setUniform(n,s,h,m){const x=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&n.set(x)}getBinding(n,s,h){return h.substr(0,9)==="u_pattern"?new rx(n,s):new ef(n,s)}}class Ls{constructor(n,s,h,m){this.expression=n,this.type=h,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,s,h,m,x){const w=this.paintVertexArray.length,b=this.expression.evaluate(new Rr(0),s,{},m,[],x);this.paintVertexArray.resize(n),this._setPaintValue(w,n,b)}updatePaintArray(n,s,h,m){const x=this.expression.evaluate({zoom:0},h,m);this._setPaintValue(n,s,x)}_setPaintValue(n,s,h){if(this.type==="color"){const m=Sy(h);for(let x=n;x<s;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=n;m<s;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vo{constructor(n,s,h,m,x,w){this.expression=n,this.uniformNames=s.map(b=>`u_${b}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=s.map(b=>({name:`a_${b}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(n,s,h,m,x){const w=this.expression.evaluate(new Rr(this.zoom),s,{},m,[],x),b=this.expression.evaluate(new Rr(this.zoom+1),s,{},m,[],x),E=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(E,n,w,b)}updatePaintArray(n,s,h,m){const x=this.expression.evaluate({zoom:this.zoom},h,m),w=this.expression.evaluate({zoom:this.zoom+1},h,m);this._setPaintValue(n,s,x,w)}_setPaintValue(n,s,h,m){if(this.type==="color"){const x=Sy(h),w=Sy(m);for(let b=n;b<s;b++)this.paintVertexArray.emplace(b,x[0],x[1],w[0],w[1])}else{for(let x=n;x<s;x++)this.paintVertexArray.emplace(x,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s){const h=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,m=se(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);n.set(m)}getBinding(n,s,h){return new ef(n,s)}}class Ta{constructor(n,s,h,m,x,w){this.expression=n,this.type=s,this.useIntegerZoom=h,this.zoom=m,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(n,s,h){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(m,n,s.patterns&&s.patterns[this.layerId],h)}updatePaintArray(n,s,h,m,x){this._setPaintValues(n,s,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(n,s,h,m){if(!m||!h)return;const{min:x,mid:w,max:b}=h,E=m[x],I=m[w],M=m[b];if(E&&I&&M)for(let L=n;L<s;L++)this.zoomInPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],I.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,I.tl[0],I.tl[1],I.br[0],I.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],I.pixelRatio,M.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,Sa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,Sa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ix{constructor(n,s,h){this.binders={},this._buffers=[];const m=[];for(const x in n.paint._values){if(!h(x))continue;const w=n.paint.get(x);if(!(w instanceof Co&&la(w.property.specification)))continue;const b=uI(x,n.type),E=w.value,I=w.property.specification.type,M=w.property.useIntegerZoom,L=w.property.specification["property-type"],j=L==="cross-faded"||L==="cross-faded-data-driven";if(E.kind==="constant")this.binders[x]=j?new Vu(E.value,b):new Bh(E.value,b,I),m.push(`/u_${x}`);else if(E.kind==="source"||j){const W=ox(x,I,"source");this.binders[x]=j?new Ta(E,I,M,s,W,n.id):new Ls(E,b,I,W),m.push(`/a_${x}`)}else{const W=ox(x,I,"composite");this.binders[x]=new Vo(E,b,I,M,s,W),m.push(`/z_${x}`)}}this.cacheKey=m.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Ls||s instanceof Vo?s.maxValue:0}populatePaintArrays(n,s,h,m,x){for(const w in this.binders){const b=this.binders[w];(b instanceof Ls||b instanceof Vo||b instanceof Ta)&&b.populatePaintArray(n,s,h,m,x)}}setConstantPatternPositions(n,s){for(const h in this.binders){const m=this.binders[h];m instanceof Vu&&m.setConstantPatternPositions(n,s)}}updatePaintArrays(n,s,h,m,x){let w=!1;for(const b in n){const E=s.getPositions(b);for(const I of E){const M=h.feature(I.index);for(const L in this.binders){const j=this.binders[L];if((j instanceof Ls||j instanceof Vo||j instanceof Ta)&&j.expression.isStateDependent===!0){const W=m.paint.get(L);j.expression=W.value,j.updatePaintArray(I.start,I.end,M,n[b],x),w=!0}}}}return w}defines(){const n=[];for(const s in this.binders){const h=this.binders[s];(h instanceof Bh||h instanceof Vu)&&n.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof Ls||h instanceof Vo)for(let m=0;m<h.paintVertexAttributes.length;m++)n.push(h.paintVertexAttributes[m].name);else if(h instanceof Ta)for(let m=0;m<Sa.members.length;m++)n.push(Sa.members[m].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof Bh||h instanceof Vu||h instanceof Vo)for(const m of h.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,s){const h=[];for(const m in this.binders){const x=this.binders[m];if(x instanceof Bh||x instanceof Vu||x instanceof Vo){for(const w of x.uniformNames)if(s[w]){const b=x.getBinding(n,s[w],w);h.push({name:w,property:m,binding:b})}}}return h}setUniforms(n,s,h,m){for(const{name:x,property:w,binding:b}of s)this.binders[w].setUniform(b,m,h.get(w),x)}updatePaintBuffers(n){this._buffers=[];for(const s in this.binders){const h=this.binders[s];if(n&&h instanceof Ta){const m=n.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(h instanceof Ls||h instanceof Vo)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(n){for(const s in this.binders){const h=this.binders[s];(h instanceof Ls||h instanceof Vo||h instanceof Ta)&&h.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Ls||s instanceof Vo||s instanceof Ta)&&s.destroy()}}}class Tl{constructor(n,s,h=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new ix(m,s,h);this.needsUpload=!1,this._featureMap=new El,this._bufferOffset=0}populatePaintArrays(n,s,h,m,x,w){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(n,s,m,x,w);s.id!==void 0&&this._featureMap.add(s.id,h,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,h,m){for(const x of h)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(n,this._featureMap,s,x,m)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function uI(o,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${n}-`,"").replace(/-/g,"_")]}function ox(o,n,s){const h={color:{source:Q,composite:Ht},number:{source:mt,composite:Q}},m=function(x){return{"line-pattern":{source:Bi,composite:Bi},"fill-pattern":{source:Bi,composite:Bi},"fill-extrusion-pattern":{source:Bi,composite:Bi}}[x]}(o);return m&&m[s]||h[n][s]}bt("ConstantBinder",Bh),bt("CrossFadedConstantBinder",Vu),bt("SourceExpressionBinder",Ls),bt("CrossFadedCompositeBinder",Ta),bt("CompositeExpressionBinder",Vo),bt("ProgramConfiguration",ix,{omit:["_buffers"]}),bt("ProgramConfigurationSet",Tl);const fn=8192,Ey=Math.pow(2,14)-1,sx=-Ey-1;function Cl(o){const n=fn/o.extent,s=o.loadGeometry();for(let h=0;h<s.length;h++){const m=s[h];for(let x=0;x<m.length;x++){const w=m[x],b=Math.round(w.x*n),E=Math.round(w.y*n);w.x=se(b,sx,Ey),w.y=se(E,sx,Ey),(b<w.x||b>w.x+1||E<w.y||E>w.y+1)&&je("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Il(o,n){return{type:o.type,id:o.id,properties:o.properties,geometry:n?Cl(o):[]}}function tf(o,n,s,h,m){o.emplaceBack(2*n+(h+1)/2,2*s+(m+1)/2)}class ky{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Hn,this.indexArray=new io,this.segments=new or,this.programConfigurations=new Tl(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,h){const m=this.layers[0],x=[];let w=null,b=!1;m.type==="circle"&&(w=m.layout.get("circle-sort-key"),b=!w.isConstant());for(const{feature:E,id:I,index:M,sourceLayerIndex:L}of n){const j=this.layers[0]._featureFilter.needGeometry,W=Il(E,j);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom),W,h))continue;const Y=b?w.evaluate(W,{},h):void 0,J={id:I,properties:E.properties,type:E.type,sourceLayerIndex:L,index:M,geometry:j?W.geometry:Cl(E),patterns:{},sortKey:Y};x.push(J)}b&&x.sort((E,I)=>E.sortKey-I.sortKey);for(const E of x){const{geometry:I,index:M,sourceLayerIndex:L}=E,j=n[M].feature;this.addFeature(E,I,M,h),s.featureIndex.insert(j,I,M,L,this.index)}}update(n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,vi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,h,m){for(const x of s)for(const w of x){const b=w.x,E=w.y;if(b<0||b>=fn||E<0||E>=fn)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=I.vertexLength;tf(this.layoutVertexArray,b,E,-1,-1),tf(this.layoutVertexArray,b,E,1,-1),tf(this.layoutVertexArray,b,E,1,1),tf(this.layoutVertexArray,b,E,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,{},m)}}function ax(o,n){for(let s=0;s<o.length;s++)if(Hu(n,o[s]))return!0;for(let s=0;s<n.length;s++)if(Hu(o,n[s]))return!0;return!!Ty(o,n)}function cI(o,n,s){return!!Hu(o,n)||!!Cy(n,o,s)}function lx(o,n){if(o.length===1)return cx(n,o[0]);for(let s=0;s<n.length;s++){const h=n[s];for(let m=0;m<h.length;m++)if(Hu(o,h[m]))return!0}for(let s=0;s<o.length;s++)if(cx(n,o[s]))return!0;for(let s=0;s<n.length;s++)if(Ty(o,n[s]))return!0;return!1}function hI(o,n,s){if(o.length>1){if(Ty(o,n))return!0;for(let h=0;h<n.length;h++)if(Cy(n[h],o,s))return!0}for(let h=0;h<o.length;h++)if(Cy(o[h],n,s))return!0;return!1}function Ty(o,n){if(o.length===0||n.length===0)return!1;for(let s=0;s<o.length-1;s++){const h=o[s],m=o[s+1];for(let x=0;x<n.length-1;x++)if(dI(h,m,n[x],n[x+1]))return!0}return!1}function dI(o,n,s,h){return H(o,s,h)!==H(n,s,h)&&H(o,n,s)!==H(o,n,h)}function Cy(o,n,s){const h=s*s;if(n.length===1)return o.distSqr(n[0])<h;for(let m=1;m<n.length;m++)if(ux(o,n[m-1],n[m])<h)return!0;return!1}function ux(o,n,s){const h=n.distSqr(s);if(h===0)return o.distSqr(n);const m=((o.x-n.x)*(s.x-n.x)+(o.y-n.y)*(s.y-n.y))/h;return o.distSqr(m<0?n:m>1?s:s.sub(n)._mult(m)._add(n))}function cx(o,n){let s,h,m,x=!1;for(let w=0;w<o.length;w++){s=o[w];for(let b=0,E=s.length-1;b<s.length;E=b++)h=s[b],m=s[E],h.y>n.y!=m.y>n.y&&n.x<(m.x-h.x)*(n.y-h.y)/(m.y-h.y)+h.x&&(x=!x)}return x}function Hu(o,n){let s=!1;for(let h=0,m=o.length-1;h<o.length;m=h++){const x=o[h],w=o[m];x.y>n.y!=w.y>n.y&&n.x<(w.x-x.x)*(n.y-x.y)/(w.y-x.y)+x.x&&(s=!s)}return s}function pI(o,n,s){const h=s[0],m=s[2];if(o.x<h.x&&n.x<h.x||o.x>m.x&&n.x>m.x||o.y<h.y&&n.y<h.y||o.y>m.y&&n.y>m.y)return!1;const x=H(o,n,s[0]);return x!==H(o,n,s[1])||x!==H(o,n,s[2])||x!==H(o,n,s[3])}function Nh(o,n,s){const h=n.paint.get(o).value;return h.kind==="constant"?h.value:s.programConfigurations.get(n.id).getMaxValue(o)}function rf(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function nf(o,n,s,h,m){if(!n[0]&&!n[1])return o;const x=D.convert(n)._mult(m);s==="viewport"&&x._rotate(-h);const w=[];for(let b=0;b<o.length;b++)w.push(o[b].sub(x));return w}let hx,dx;bt("CircleBucket",ky,{omit:["layers"]});var fI={get paint(){return dx=dx||new v({"circle-radius":new Nt(ie.paint_circle["circle-radius"]),"circle-color":new Nt(ie.paint_circle["circle-color"]),"circle-blur":new Nt(ie.paint_circle["circle-blur"]),"circle-opacity":new Nt(ie.paint_circle["circle-opacity"]),"circle-translate":new Tt(ie.paint_circle["circle-translate"]),"circle-translate-anchor":new Tt(ie.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Tt(ie.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Tt(ie.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(ie.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(ie.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(ie.paint_circle["circle-stroke-opacity"])})},get layout(){return hx=hx||new v({"circle-sort-key":new Nt(ie.layout_circle["circle-sort-key"])})}},ii=1e-6,Gu=typeof Float32Array<"u"?Float32Array:Array;function Iy(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function px(o,n,s){var h=n[0],m=n[1],x=n[2],w=n[3],b=n[4],E=n[5],I=n[6],M=n[7],L=n[8],j=n[9],W=n[10],Y=n[11],J=n[12],le=n[13],pe=n[14],ze=n[15],be=s[0],Ae=s[1],Ve=s[2],et=s[3];return o[0]=be*h+Ae*b+Ve*L+et*J,o[1]=be*m+Ae*E+Ve*j+et*le,o[2]=be*x+Ae*I+Ve*W+et*pe,o[3]=be*w+Ae*M+Ve*Y+et*ze,o[4]=(be=s[4])*h+(Ae=s[5])*b+(Ve=s[6])*L+(et=s[7])*J,o[5]=be*m+Ae*E+Ve*j+et*le,o[6]=be*x+Ae*I+Ve*W+et*pe,o[7]=be*w+Ae*M+Ve*Y+et*ze,o[8]=(be=s[8])*h+(Ae=s[9])*b+(Ve=s[10])*L+(et=s[11])*J,o[9]=be*m+Ae*E+Ve*j+et*le,o[10]=be*x+Ae*I+Ve*W+et*pe,o[11]=be*w+Ae*M+Ve*Y+et*ze,o[12]=(be=s[12])*h+(Ae=s[13])*b+(Ve=s[14])*L+(et=s[15])*J,o[13]=be*m+Ae*E+Ve*j+et*le,o[14]=be*x+Ae*I+Ve*W+et*pe,o[15]=be*w+Ae*M+Ve*Y+et*ze,o}Math.hypot||(Math.hypot=function(){for(var o=0,n=arguments.length;n--;)o+=arguments[n]*arguments[n];return Math.sqrt(o)});var $h,mI=px;function of(o,n,s){var h=n[0],m=n[1],x=n[2],w=n[3];return o[0]=s[0]*h+s[4]*m+s[8]*x+s[12]*w,o[1]=s[1]*h+s[5]*m+s[9]*x+s[13]*w,o[2]=s[2]*h+s[6]*m+s[10]*x+s[14]*w,o[3]=s[3]*h+s[7]*m+s[11]*x+s[15]*w,o}$h=new Gu(4),Gu!=Float32Array&&($h[0]=0,$h[1]=0,$h[2]=0,$h[3]=0);class gI extends a{constructor(n){super(n,fI)}createBucket(n){return new ky(n)}queryRadius(n){const s=n;return Nh("circle-radius",this,s)+Nh("circle-stroke-width",this,s)+rf(this.paint.get("circle-translate"))}queryIntersectsFeature(n,s,h,m,x,w,b,E){const I=nf(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),w.angle,b),M=this.paint.get("circle-radius").evaluate(s,h)+this.paint.get("circle-stroke-width").evaluate(s,h),L=this.paint.get("circle-pitch-alignment")==="map",j=L?I:function(Y,J){return Y.map(le=>fx(le,J))}(I,E),W=L?M*b:M;for(const Y of m)for(const J of Y){const le=L?J:fx(J,E);let pe=W;const ze=of([],[J.x,J.y,0,1],E);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pe*=ze[3]/w.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pe*=w.cameraToCenterDistance/ze[3]),cI(j,le,pe))return!0}return!1}}function fx(o,n){const s=of([],[o.x,o.y,0,1],n);return new D(s[0]/s[3],s[1]/s[3])}class mx extends ky{}let gx;bt("HeatmapBucket",mx,{omit:["layers"]});var yI={get paint(){return gx=gx||new v({"heatmap-radius":new Nt(ie.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(ie.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Tt(ie.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fh(ie.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Tt(ie.paint_heatmap["heatmap-opacity"])})}};function Py(o,{width:n,height:s},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*s*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${n*s*h}`)}else m=new Uint8Array(n*s*h);return o.width=n,o.height=s,o.data=m,o}function yx(o,{width:n,height:s},h){if(n===o.width&&s===o.height)return;const m=Py({},{width:n,height:s},h);Ay(o,m,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,n),height:Math.min(o.height,s)},h),o.width=n,o.height=s,o.data=m.data}function Ay(o,n,s,h,m,x){if(m.width===0||m.height===0)return n;if(m.width>o.width||m.height>o.height||s.x>o.width-m.width||s.y>o.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||h.x>n.width-m.width||h.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const w=o.data,b=n.data;if(w===b)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<m.height;E++){const I=((s.y+E)*o.width+s.x)*x,M=((h.y+E)*n.width+h.x)*x;for(let L=0;L<m.width*x;L++)b[M+L]=w[I+L]}return n}class jh{constructor(n,s){Py(this,n,1,s)}resize(n){yx(this,n,1)}clone(){return new jh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,h,m,x){Ay(n,s,h,m,x,1)}}class oo{constructor(n,s){Py(this,n,4,s)}resize(n){yx(this,n,4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,h,m,x){Ay(n,s,h,m,x,4)}}function _x(o){const n={},s=o.resolution||256,h=o.clips?o.clips.length:1,m=o.image||new oo({width:s,height:h});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const x=(w,b,E)=>{n[o.evaluationKey]=E;const I=o.expression.evaluate(n);m.data[w+b+0]=Math.floor(255*I.r/I.a),m.data[w+b+1]=Math.floor(255*I.g/I.a),m.data[w+b+2]=Math.floor(255*I.b/I.a),m.data[w+b+3]=Math.floor(255*I.a)};if(o.clips)for(let w=0,b=0;w<h;++w,b+=4*s)for(let E=0,I=0;E<s;E++,I+=4){const M=E/(s-1),{start:L,end:j}=o.clips[w];x(b,I,L*(1-M)+j*M)}else for(let w=0,b=0;w<s;w++,b+=4)x(0,b,w/(s-1));return m}bt("AlphaImage",jh),bt("RGBAImage",oo);const My="big-fb";class _I extends a{createBucket(n){return new mx(n)}constructor(n){super(n,yI),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_x({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(My)&&this.heatmapFbos.delete(My)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vx;var vI={get paint(){return vx=vx||new v({"hillshade-illumination-direction":new Tt(ie.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Tt(ie.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Tt(ie.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Tt(ie.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Tt(ie.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Tt(ie.paint_hillshade["hillshade-accent-color"])})}};class xI extends a{constructor(n){super(n,vI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const wI=S([{name:"a_pos",components:2,type:"Int16"}],4),{members:bI}=wI;function xx(o,n,s=2){const h=n&&n.length,m=h?n[0]*s:o.length;let x=wx(o,0,m,s,!0);const w=[];if(!x||x.next===x.prev)return w;let b,E,I;if(h&&(x=function(M,L,j,W){const Y=[];for(let J=0,le=L.length;J<le;J++){const pe=wx(M,L[J]*W,J<le-1?L[J+1]*W:M.length,W,!1);pe===pe.next&&(pe.steiner=!0),Y.push(AI(pe))}Y.sort(CI);for(let J=0;J<Y.length;J++)j=II(Y[J],j);return j}(o,n,x,s)),o.length>80*s){b=1/0,E=1/0;let M=-1/0,L=-1/0;for(let j=s;j<m;j+=s){const W=o[j],Y=o[j+1];W<b&&(b=W),Y<E&&(E=Y),W>M&&(M=W),Y>L&&(L=Y)}I=Math.max(M-b,L-E),I=I!==0?32767/I:0}return Uh(x,w,s,b,E,I,0),w}function wx(o,n,s,h,m){let x;if(m===function(w,b,E,I){let M=0;for(let L=b,j=E-I;L<E;L+=I)M+=(w[j]-w[L])*(w[L+1]+w[j+1]),j=L;return M}(o,n,s,h)>0)for(let w=n;w<s;w+=h)x=Ex(w/h|0,o[w],o[w+1],x);else for(let w=s-h;w>=n;w-=h)x=Ex(w/h|0,o[w],o[w+1],x);return x&&sf(x,x.next)&&(Hh(x),x=x.next),x}function Pl(o,n){if(!o)return o;n||(n=o);let s,h=o;do if(s=!1,h.steiner||!sf(h,h.next)&&an(h.prev,h,h.next)!==0)h=h.next;else{if(Hh(h),h=n=h.prev,h===h.next)break;s=!0}while(s||h!==n);return n}function Uh(o,n,s,h,m,x,w){if(!o)return;!w&&x&&function(E,I,M,L){let j=E;do j.z===0&&(j.z=zy(j.x,j.y,I,M,L)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==E);j.prevZ.nextZ=null,j.prevZ=null,function(W){let Y,J=1;do{let le,pe=W;W=null;let ze=null;for(Y=0;pe;){Y++;let be=pe,Ae=0;for(let et=0;et<J&&(Ae++,be=be.nextZ,be);et++);let Ve=J;for(;Ae>0||Ve>0&&be;)Ae!==0&&(Ve===0||!be||pe.z<=be.z)?(le=pe,pe=pe.nextZ,Ae--):(le=be,be=be.nextZ,Ve--),ze?ze.nextZ=le:W=le,le.prevZ=ze,ze=le;pe=be}ze.nextZ=null,J*=2}while(Y>1)}(j)}(o,h,m,x);let b=o;for(;o.prev!==o.next;){const E=o.prev,I=o.next;if(x?EI(o,h,m,x):SI(o))n.push(E.i,o.i,I.i),Hh(o),o=I.next,b=I.next;else if((o=I)===b){w?w===1?Uh(o=kI(Pl(o),n),n,s,h,m,x,2):w===2&&TI(o,n,s,h,m,x):Uh(Pl(o),n,s,h,m,x,1);break}}}function SI(o){const n=o.prev,s=o,h=o.next;if(an(n,s,h)>=0)return!1;const m=n.x,x=s.x,w=h.x,b=n.y,E=s.y,I=h.y,M=m<x?m<w?m:w:x<w?x:w,L=b<E?b<I?b:I:E<I?E:I,j=m>x?m>w?m:w:x>w?x:w,W=b>E?b>I?b:I:E>I?E:I;let Y=h.next;for(;Y!==n;){if(Y.x>=M&&Y.x<=j&&Y.y>=L&&Y.y<=W&&Zu(m,b,x,E,w,I,Y.x,Y.y)&&an(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function EI(o,n,s,h){const m=o.prev,x=o,w=o.next;if(an(m,x,w)>=0)return!1;const b=m.x,E=x.x,I=w.x,M=m.y,L=x.y,j=w.y,W=b<E?b<I?b:I:E<I?E:I,Y=M<L?M<j?M:j:L<j?L:j,J=b>E?b>I?b:I:E>I?E:I,le=M>L?M>j?M:j:L>j?L:j,pe=zy(W,Y,n,s,h),ze=zy(J,le,n,s,h);let be=o.prevZ,Ae=o.nextZ;for(;be&&be.z>=pe&&Ae&&Ae.z<=ze;){if(be.x>=W&&be.x<=J&&be.y>=Y&&be.y<=le&&be!==m&&be!==w&&Zu(b,M,E,L,I,j,be.x,be.y)&&an(be.prev,be,be.next)>=0||(be=be.prevZ,Ae.x>=W&&Ae.x<=J&&Ae.y>=Y&&Ae.y<=le&&Ae!==m&&Ae!==w&&Zu(b,M,E,L,I,j,Ae.x,Ae.y)&&an(Ae.prev,Ae,Ae.next)>=0))return!1;Ae=Ae.nextZ}for(;be&&be.z>=pe;){if(be.x>=W&&be.x<=J&&be.y>=Y&&be.y<=le&&be!==m&&be!==w&&Zu(b,M,E,L,I,j,be.x,be.y)&&an(be.prev,be,be.next)>=0)return!1;be=be.prevZ}for(;Ae&&Ae.z<=ze;){if(Ae.x>=W&&Ae.x<=J&&Ae.y>=Y&&Ae.y<=le&&Ae!==m&&Ae!==w&&Zu(b,M,E,L,I,j,Ae.x,Ae.y)&&an(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.nextZ}return!0}function kI(o,n){let s=o;do{const h=s.prev,m=s.next.next;!sf(h,m)&&bx(h,s,s.next,m)&&Vh(h,m)&&Vh(m,h)&&(n.push(h.i,s.i,m.i),Hh(s),Hh(s.next),s=o=m),s=s.next}while(s!==o);return Pl(s)}function TI(o,n,s,h,m,x){let w=o;do{let b=w.next.next;for(;b!==w.prev;){if(w.i!==b.i&&MI(w,b)){let E=Sx(w,b);return w=Pl(w,w.next),E=Pl(E,E.next),Uh(w,n,s,h,m,x,0),void Uh(E,n,s,h,m,x,0)}b=b.next}w=w.next}while(w!==o)}function CI(o,n){return o.x-n.x}function II(o,n){const s=function(m,x){let w=x;const b=m.x,E=m.y;let I,M=-1/0;do{if(E<=w.y&&E>=w.next.y&&w.next.y!==w.y){const J=w.x+(E-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(J<=b&&J>M&&(M=J,I=w.x<w.next.x?w:w.next,J===b))return I}w=w.next}while(w!==x);if(!I)return null;const L=I,j=I.x,W=I.y;let Y=1/0;w=I;do{if(b>=w.x&&w.x>=j&&b!==w.x&&Zu(E<W?b:M,E,j,W,E<W?M:b,E,w.x,w.y)){const J=Math.abs(E-w.y)/(b-w.x);Vh(w,m)&&(J<Y||J===Y&&(w.x>I.x||w.x===I.x&&PI(I,w)))&&(I=w,Y=J)}w=w.next}while(w!==L);return I}(o,n);if(!s)return n;const h=Sx(s,o);return Pl(h,h.next),Pl(s,s.next)}function PI(o,n){return an(o.prev,o,n.prev)<0&&an(n.next,o,o.next)<0}function zy(o,n,s,h,m){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*m|0)|o<<8))|o<<4))|o<<2))|o<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-h)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function AI(o){let n=o,s=o;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==o);return s}function Zu(o,n,s,h,m,x,w,b){return(m-w)*(n-b)>=(o-w)*(x-b)&&(o-w)*(h-b)>=(s-w)*(n-b)&&(s-w)*(x-b)>=(m-w)*(h-b)}function MI(o,n){return o.next.i!==n.i&&o.prev.i!==n.i&&!function(s,h){let m=s;do{if(m.i!==s.i&&m.next.i!==s.i&&m.i!==h.i&&m.next.i!==h.i&&bx(m,m.next,s,h))return!0;m=m.next}while(m!==s);return!1}(o,n)&&(Vh(o,n)&&Vh(n,o)&&function(s,h){let m=s,x=!1;const w=(s.x+h.x)/2,b=(s.y+h.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&w<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(x=!x),m=m.next;while(m!==s);return x}(o,n)&&(an(o.prev,o,n.prev)||an(o,n.prev,n))||sf(o,n)&&an(o.prev,o,o.next)>0&&an(n.prev,n,n.next)>0)}function an(o,n,s){return(n.y-o.y)*(s.x-n.x)-(n.x-o.x)*(s.y-n.y)}function sf(o,n){return o.x===n.x&&o.y===n.y}function bx(o,n,s,h){const m=lf(an(o,n,s)),x=lf(an(o,n,h)),w=lf(an(s,h,o)),b=lf(an(s,h,n));return m!==x&&w!==b||!(m!==0||!af(o,s,n))||!(x!==0||!af(o,h,n))||!(w!==0||!af(s,o,h))||!(b!==0||!af(s,n,h))}function af(o,n,s){return n.x<=Math.max(o.x,s.x)&&n.x>=Math.min(o.x,s.x)&&n.y<=Math.max(o.y,s.y)&&n.y>=Math.min(o.y,s.y)}function lf(o){return o>0?1:o<0?-1:0}function Vh(o,n){return an(o.prev,o,o.next)<0?an(o,n,o.next)>=0&&an(o,o.prev,n)>=0:an(o,n,o.prev)<0||an(o,o.next,n)<0}function Sx(o,n){const s=Dy(o.i,o.x,o.y),h=Dy(n.i,n.x,n.y),m=o.next,x=n.prev;return o.next=n,n.prev=o,s.next=m,m.prev=s,h.next=s,s.prev=h,x.next=h,h.prev=x,h}function Ex(o,n,s,h){const m=Dy(o,n,s);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function Hh(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Dy(o,n,s){return{i:o,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ry(o,n,s){const h=s.patternDependencies;let m=!1;for(const x of n){const w=x.paint.get(`${o}-pattern`);w.isConstant()||(m=!0);const b=w.constantOr(null);b&&(m=!0,h[b.to]=!0,h[b.from]=!0)}return m}function Ly(o,n,s,h,m){const x=m.patternDependencies;for(const w of n){const b=w.paint.get(`${o}-pattern`).value;if(b.kind!=="constant"){let E=b.evaluate({zoom:h-1},s,{},m.availableImages),I=b.evaluate({zoom:h},s,{},m.availableImages),M=b.evaluate({zoom:h+1},s,{},m.availableImages);E=E&&E.name?E.name:E,I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,x[E]=!0,x[I]=!0,x[M]=!0,s.patterns[w.id]={min:E,mid:I,max:M}}}return s}class Fy{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Io,this.indexArray=new io,this.indexArray2=new kn,this.programConfigurations=new Tl(n.layers,n.zoom),this.segments=new or,this.segments2=new or,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,h){this.hasPattern=Ry("fill",this.layers,s);const m=this.layers[0].layout.get("fill-sort-key"),x=!m.isConstant(),w=[];for(const{feature:b,id:E,index:I,sourceLayerIndex:M}of n){const L=this.layers[0]._featureFilter.needGeometry,j=Il(b,L);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom),j,h))continue;const W=x?m.evaluate(j,{},h,s.availableImages):void 0,Y={id:E,properties:b.properties,type:b.type,sourceLayerIndex:M,index:I,geometry:L?j.geometry:Cl(b),patterns:{},sortKey:W};w.push(Y)}x&&w.sort((b,E)=>b.sortKey-E.sortKey);for(const b of w){const{geometry:E,index:I,sourceLayerIndex:M}=b;if(this.hasPattern){const L=Ly("fill",this.layers,b,this.zoom,s);this.patternFeatures.push(L)}else this.addFeature(b,E,I,h,{});s.featureIndex.insert(n[I].feature,E,I,M,this.index)}}update(n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,h)}addFeatures(n,s,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,s,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,bI),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,h,m,x){for(const w of gu(s,500)){let b=0;for(const W of w)b+=W.length;const E=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),I=E.vertexLength,M=[],L=[];for(const W of w){if(W.length===0)continue;W!==w[0]&&L.push(M.length/2);const Y=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),J=Y.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(J+W.length-1,J),M.push(W[0].x),M.push(W[0].y);for(let le=1;le<W.length;le++)this.layoutVertexArray.emplaceBack(W[le].x,W[le].y),this.indexArray2.emplaceBack(J+le-1,J+le),M.push(W[le].x),M.push(W[le].y);Y.vertexLength+=W.length,Y.primitiveLength+=W.length}const j=xx(M,L);for(let W=0;W<j.length;W+=3)this.indexArray.emplaceBack(I+j[W],I+j[W+1],I+j[W+2]);E.vertexLength+=b,E.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,x,m)}}let kx,Tx;bt("FillBucket",Fy,{omit:["layers","patternFeatures"]});var zI={get paint(){return Tx=Tx||new v({"fill-antialias":new Tt(ie.paint_fill["fill-antialias"]),"fill-opacity":new Nt(ie.paint_fill["fill-opacity"]),"fill-color":new Nt(ie.paint_fill["fill-color"]),"fill-outline-color":new Nt(ie.paint_fill["fill-outline-color"]),"fill-translate":new Tt(ie.paint_fill["fill-translate"]),"fill-translate-anchor":new Tt(ie.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fu(ie.paint_fill["fill-pattern"])})},get layout(){return kx=kx||new v({"fill-sort-key":new Nt(ie.layout_fill["fill-sort-key"])})}};class DI extends a{constructor(n){super(n,zI)}recalculate(n,s){super.recalculate(n,s);const h=this.paint._values["fill-outline-color"];h.value.kind==="constant"&&h.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Fy(n)}queryRadius(){return rf(this.paint.get("fill-translate"))}queryIntersectsFeature(n,s,h,m,x,w,b){return lx(nf(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),w.angle,b),m)}isTileClipped(){return!0}}const RI=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),LI=S([{name:"a_centroid",components:2,type:"Int16"}],4),{members:FI}=RI;var Ca={},OI=P,Cx=Wu;function Wu(o,n,s,h,m){this.properties={},this.extent=s,this.type=0,this._pbf=o,this._geometry=-1,this._keys=h,this._values=m,o.readFields(BI,this,n)}function BI(o,n,s){o==1?n.id=s.readVarint():o==2?function(h,m){for(var x=h.readVarint()+h.pos;h.pos<x;){var w=m._keys[h.readVarint()],b=m._values[h.readVarint()];m.properties[w]=b}}(s,n):o==3?n.type=s.readVarint():o==4&&(n._geometry=s.pos)}function NI(o){for(var n,s,h=0,m=0,x=o.length,w=x-1;m<x;w=m++)h+=((s=o[w]).x-(n=o[m]).x)*(n.y+s.y);return h}Wu.types=["Unknown","Point","LineString","Polygon"],Wu.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var n,s=o.readVarint()+o.pos,h=1,m=0,x=0,w=0,b=[];o.pos<s;){if(m<=0){var E=o.readVarint();h=7&E,m=E>>3}if(m--,h===1||h===2)x+=o.readSVarint(),w+=o.readSVarint(),h===1&&(n&&b.push(n),n=[]),n.push(new OI(x,w));else{if(h!==7)throw new Error("unknown command "+h);n&&n.push(n[0].clone())}}return n&&b.push(n),b},Wu.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var n=o.readVarint()+o.pos,s=1,h=0,m=0,x=0,w=1/0,b=-1/0,E=1/0,I=-1/0;o.pos<n;){if(h<=0){var M=o.readVarint();s=7&M,h=M>>3}if(h--,s===1||s===2)(m+=o.readSVarint())<w&&(w=m),m>b&&(b=m),(x+=o.readSVarint())<E&&(E=x),x>I&&(I=x);else if(s!==7)throw new Error("unknown command "+s)}return[w,E,b,I]},Wu.prototype.toGeoJSON=function(o,n,s){var h,m,x=this.extent*Math.pow(2,s),w=this.extent*o,b=this.extent*n,E=this.loadGeometry(),I=Wu.types[this.type];function M(W){for(var Y=0;Y<W.length;Y++){var J=W[Y];W[Y]=[360*(J.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+b)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(h=0;h<E.length;h++)L[h]=E[h][0];M(E=L);break;case 2:for(h=0;h<E.length;h++)M(E[h]);break;case 3:for(E=function(W){var Y=W.length;if(Y<=1)return[W];for(var J,le,pe=[],ze=0;ze<Y;ze++){var be=NI(W[ze]);be!==0&&(le===void 0&&(le=be<0),le===be<0?(J&&pe.push(J),J=[W[ze]]):J.push(W[ze]))}return J&&pe.push(J),pe}(E),h=0;h<E.length;h++)for(m=0;m<E[h].length;m++)M(E[h][m])}E.length===1?E=E[0]:I="Multi"+I;var j={type:"Feature",geometry:{type:I,coordinates:E},properties:this.properties};return"id"in this&&(j.id=this.id),j};var $I=Cx,Ix=Px;function Px(o,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(jI,this,n),this.length=this._features.length}function jI(o,n,s){o===15?n.version=s.readVarint():o===1?n.name=s.readString():o===5?n.extent=s.readVarint():o===2?n._features.push(s.pos):o===3?n._keys.push(s.readString()):o===4&&n._values.push(function(h){for(var m=null,x=h.readVarint()+h.pos;h.pos<x;){var w=h.readVarint()>>3;m=w===1?h.readString():w===2?h.readFloat():w===3?h.readDouble():w===4?h.readVarint64():w===5?h.readVarint():w===6?h.readSVarint():w===7?h.readBoolean():null}return m}(s))}Px.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var n=this._pbf.readVarint()+this._pbf.pos;return new $I(this._pbf,n,this.extent,this._keys,this._values)};var UI=Ix;function VI(o,n,s){if(o===3){var h=new UI(s,s.readVarint()+s.pos);h.length&&(n[h.name]=h)}}Ca.VectorTile=function(o,n){this.layers=o.readFields(VI,{},n)},Ca.VectorTileFeature=Cx,Ca.VectorTileLayer=Ix;const HI=Ca.VectorTileFeature.types,Oy=Math.pow(2,13);function Gh(o,n,s,h,m,x,w,b){o.emplaceBack(n,s,2*Math.floor(h*Oy)+w,m*Oy*2,x*Oy*2,Math.round(b))}class By{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new wa,this.centroidVertexArray=new zn,this.indexArray=new io,this.programConfigurations=new Tl(n.layers,n.zoom),this.segments=new or,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,h){this.features=[],this.hasPattern=Ry("fill-extrusion",this.layers,s);for(const{feature:m,id:x,index:w,sourceLayerIndex:b}of n){const E=this.layers[0]._featureFilter.needGeometry,I=Il(m,E);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom),I,h))continue;const M={id:x,sourceLayerIndex:b,index:w,geometry:E?I.geometry:Cl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Ly("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,w,h,{}),s.featureIndex.insert(m,M.geometry,w,b,this.index,!0)}}addFeatures(n,s,h){for(const m of this.features){const{geometry:x}=m;this.addFeature(m,x,m.index,s,h)}}update(n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,FI),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,LI.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,s,h,m,x){for(const w of gu(s,500)){const b={x:0,y:0,vertexCount:0};let E=0;for(const Y of w)E+=Y.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Y of w){if(Y.length===0||ZI(Y))continue;let J=0;for(let le=0;le<Y.length;le++){const pe=Y[le];if(le>=1){const ze=Y[le-1];if(!GI(pe,ze)){I.vertexLength+4>or.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const be=pe.sub(ze)._perp()._unit(),Ae=ze.dist(pe);J+Ae>32768&&(J=0),Gh(this.layoutVertexArray,pe.x,pe.y,be.x,be.y,0,0,J),Gh(this.layoutVertexArray,pe.x,pe.y,be.x,be.y,0,1,J),b.x+=2*pe.x,b.y+=2*pe.y,b.vertexCount+=2,J+=Ae,Gh(this.layoutVertexArray,ze.x,ze.y,be.x,be.y,0,0,J),Gh(this.layoutVertexArray,ze.x,ze.y,be.x,be.y,0,1,J),b.x+=2*ze.x,b.y+=2*ze.y,b.vertexCount+=2;const Ve=I.vertexLength;this.indexArray.emplaceBack(Ve,Ve+2,Ve+1),this.indexArray.emplaceBack(Ve+1,Ve+2,Ve+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+E>or.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray)),HI[n.type]!=="Polygon")continue;const M=[],L=[],j=I.vertexLength;for(const Y of w)if(Y.length!==0){Y!==w[0]&&L.push(M.length/2);for(let J=0;J<Y.length;J++){const le=Y[J];Gh(this.layoutVertexArray,le.x,le.y,0,0,1,1,0),b.x+=le.x,b.y+=le.y,b.vertexCount+=1,M.push(le.x),M.push(le.y)}}const W=xx(M,L);for(let Y=0;Y<W.length;Y+=3)this.indexArray.emplaceBack(j+W[Y],j+W[Y+2],j+W[Y+1]);I.primitiveLength+=W.length/3,I.vertexLength+=E;for(let Y=0;Y<b.vertexCount;Y++){const J=Math.floor(b.x/b.vertexCount),le=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(J,le)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,x,m)}}function GI(o,n){return o.x===n.x&&(o.x<0||o.x>fn)||o.y===n.y&&(o.y<0||o.y>fn)}function ZI(o){return o.every(n=>n.x<0)||o.every(n=>n.x>fn)||o.every(n=>n.y<0)||o.every(n=>n.y>fn)}let Ax;bt("FillExtrusionBucket",By,{omit:["layers","features"]});var WI={get paint(){return Ax=Ax||new v({"fill-extrusion-opacity":new Tt(ie["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(ie["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Tt(ie["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Tt(ie["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fu(ie["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(ie["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(ie["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Tt(ie["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qI extends a{constructor(n){super(n,WI)}createBucket(n){return new By(n)}queryRadius(){return rf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,s,h,m,x,w,b,E){const I=nf(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),w.angle,b),M=this.paint.get("fill-extrusion-height").evaluate(s,h),L=this.paint.get("fill-extrusion-base").evaluate(s,h),j=function(Y,J,le,pe){const ze=[];for(const be of Y){const Ae=[be.x,be.y,0,1];of(Ae,Ae,J),ze.push(new D(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return ze}(I,E),W=function(Y,J,le,pe){const ze=[],be=[],Ae=pe[8]*J,Ve=pe[9]*J,et=pe[10]*J,vt=pe[11]*J,Ft=pe[8]*le,gt=pe[9]*le,pt=pe[10]*le,Pt=pe[11]*le;for(const Et of Y){const wt=[],qe=[];for(const At of Et){const It=At.x,Vt=At.y,Ir=pe[0]*It+pe[4]*Vt+pe[12],Cr=pe[1]*It+pe[5]*Vt+pe[13],vn=pe[2]*It+pe[6]*Vt+pe[14],Po=pe[3]*It+pe[7]*Vt+pe[15],Ln=vn+et,xn=Po+vt,oi=Ir+Ft,si=Cr+gt,ai=vn+pt,tn=Po+Pt,wn=new D((Ir+Ae)/xn,(Cr+Ve)/xn);wn.z=Ln/xn,wt.push(wn);const Gn=new D(oi/tn,si/tn);Gn.z=ai/tn,qe.push(Gn)}ze.push(wt),be.push(qe)}return[ze,be]}(m,L,M,E);return function(Y,J,le){let pe=1/0;lx(le,J)&&(pe=Mx(le,J[0]));for(let ze=0;ze<J.length;ze++){const be=J[ze],Ae=Y[ze];for(let Ve=0;Ve<be.length-1;Ve++){const et=be[Ve],vt=[et,be[Ve+1],Ae[Ve+1],Ae[Ve],et];ax(le,vt)&&(pe=Math.min(pe,Mx(le,vt)))}}return pe!==1/0&&pe}(W[0],W[1],j)}}function Zh(o,n){return o.x*n.x+o.y*n.y}function Mx(o,n){if(o.length===1){let s=0;const h=n[s++];let m;for(;!m||h.equals(m);)if(m=n[s++],!m)return 1/0;for(;s<n.length;s++){const x=n[s],w=o[0],b=m.sub(h),E=x.sub(h),I=w.sub(h),M=Zh(b,b),L=Zh(b,E),j=Zh(E,E),W=Zh(I,b),Y=Zh(I,E),J=M*j-L*L,le=(j*W-L*Y)/J,pe=(M*Y-L*W)/J,ze=h.z*(1-le-pe)+m.z*le+x.z*pe;if(isFinite(ze))return ze}return 1/0}{let s=1/0;for(const h of n)s=Math.min(s,h.z);return s}}const XI=S([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:KI}=XI,YI=S([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:JI}=YI,QI=Ca.VectorTileFeature.types,eP=Math.cos(Math.PI/180*37.5),zx=Math.pow(2,14)/.5;class Ny{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Bu,this.layoutVertexArray2=new ba,this.indexArray=new io,this.programConfigurations=new Tl(n.layers,n.zoom),this.segments=new or,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,h){this.hasPattern=Ry("line",this.layers,s);const m=this.layers[0].layout.get("line-sort-key"),x=!m.isConstant(),w=[];for(const{feature:b,id:E,index:I,sourceLayerIndex:M}of n){const L=this.layers[0]._featureFilter.needGeometry,j=Il(b,L);if(!this.layers[0]._featureFilter.filter(new Rr(this.zoom),j,h))continue;const W=x?m.evaluate(j,{},h):void 0,Y={id:E,properties:b.properties,type:b.type,sourceLayerIndex:M,index:I,geometry:L?j.geometry:Cl(b),patterns:{},sortKey:W};w.push(Y)}x&&w.sort((b,E)=>b.sortKey-E.sortKey);for(const b of w){const{geometry:E,index:I,sourceLayerIndex:M}=b;if(this.hasPattern){const L=Ly("line",this.layers,b,this.zoom,s);this.patternFeatures.push(L)}else this.addFeature(b,E,I,h,{});s.featureIndex.insert(n[I].feature,E,I,M,this.index)}}update(n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,h)}addFeatures(n,s,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,s,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,JI)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,KI),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,h,m,x){const w=this.layers[0].layout,b=w.get("line-join").evaluate(n,{}),E=w.get("line-cap"),I=w.get("line-miter-limit"),M=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const L of s)this.addLine(L,n,b,E,I,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,h,x,m)}addLine(n,s,h,m,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let pe=0;pe<n.length-1;pe++)this.totalDistance+=n[pe].dist(n[pe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=QI[s.type]==="Polygon";let E=n.length;for(;E>=2&&n[E-1].equals(n[E-2]);)E--;let I=0;for(;I<E-1&&n[I].equals(n[I+1]);)I++;if(E<(b?3:2))return;h==="bevel"&&(x=1.05);const M=this.overscaling<=16?15*fn/(512*this.overscaling):0,L=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let j,W,Y,J,le;this.e1=this.e2=-1,b&&(j=n[E-2],le=n[I].sub(j)._unit()._perp());for(let pe=I;pe<E;pe++){if(Y=pe===E-1?b?n[I+1]:void 0:n[pe+1],Y&&n[pe].equals(Y))continue;le&&(J=le),j&&(W=j),j=n[pe],le=Y?Y.sub(j)._unit()._perp():J,J=J||le;let ze=J.add(le);ze.x===0&&ze.y===0||ze._unit();const be=J.x*le.x+J.y*le.y,Ae=ze.x*le.x+ze.y*le.y,Ve=Ae!==0?1/Ae:1/0,et=2*Math.sqrt(2-2*Ae),vt=Ae<eP&&W&&Y,Ft=J.x*le.y-J.y*le.x>0;if(vt&&pe>I){const Pt=j.dist(W);if(Pt>2*M){const Et=j.sub(j.sub(W)._mult(M/Pt)._round());this.updateDistance(W,Et),this.addCurrentVertex(Et,J,0,0,L),W=Et}}const gt=W&&Y;let pt=gt?h:b?"butt":m;if(gt&&pt==="round"&&(Ve<w?pt="miter":Ve<=2&&(pt="fakeround")),pt==="miter"&&Ve>x&&(pt="bevel"),pt==="bevel"&&(Ve>2&&(pt="flipbevel"),Ve<x&&(pt="miter")),W&&this.updateDistance(W,j),pt==="miter")ze._mult(Ve),this.addCurrentVertex(j,ze,0,0,L);else if(pt==="flipbevel"){if(Ve>100)ze=le.mult(-1);else{const Pt=Ve*J.add(le).mag()/J.sub(le).mag();ze._perp()._mult(Pt*(Ft?-1:1))}this.addCurrentVertex(j,ze,0,0,L),this.addCurrentVertex(j,ze.mult(-1),0,0,L)}else if(pt==="bevel"||pt==="fakeround"){const Pt=-Math.sqrt(Ve*Ve-1),Et=Ft?Pt:0,wt=Ft?0:Pt;if(W&&this.addCurrentVertex(j,J,Et,wt,L),pt==="fakeround"){const qe=Math.round(180*et/Math.PI/20);for(let At=1;At<qe;At++){let It=At/qe;if(It!==.5){const Ir=It-.5;It+=It*Ir*(It-1)*((1.0904+be*(be*(3.55645-1.43519*be)-3.2452))*Ir*Ir+(.848013+be*(.215638*be-1.06021)))}const Vt=le.sub(J)._mult(It)._add(J)._unit()._mult(Ft?-1:1);this.addHalfVertex(j,Vt.x,Vt.y,!1,Ft,0,L)}}Y&&this.addCurrentVertex(j,le,-Et,-wt,L)}else if(pt==="butt")this.addCurrentVertex(j,ze,0,0,L);else if(pt==="square"){const Pt=W?1:-1;this.addCurrentVertex(j,ze,Pt,Pt,L)}else pt==="round"&&(W&&(this.addCurrentVertex(j,J,0,0,L),this.addCurrentVertex(j,J,1,1,L,!0)),Y&&(this.addCurrentVertex(j,le,-1,-1,L,!0),this.addCurrentVertex(j,le,0,0,L)));if(vt&&pe<E-1){const Pt=j.dist(Y);if(Pt>2*M){const Et=j.add(Y.sub(j)._mult(M/Pt)._round());this.updateDistance(j,Et),this.addCurrentVertex(Et,le,0,0,L),j=Et}}}}addCurrentVertex(n,s,h,m,x,w=!1){const b=s.y*m-s.x,E=-s.y-s.x*m;this.addHalfVertex(n,s.x+s.y*h,s.y-s.x*h,w,!1,h,x),this.addHalfVertex(n,b,E,w,!0,-m,x),this.distance>zx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,s,h,m,x,w))}addHalfVertex({x:n,y:s},h,m,x,w,b,E){const I=.5*(this.lineClips?this.scaledDistance*(zx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(x?1:0),(s<<1)+(w?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),E.primitiveLength++),w?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}let Dx,Rx;bt("LineBucket",Ny,{omit:["layers","patternFeatures"]});var Lx={get paint(){return Rx=Rx||new v({"line-opacity":new Nt(ie.paint_line["line-opacity"]),"line-color":new Nt(ie.paint_line["line-color"]),"line-translate":new Tt(ie.paint_line["line-translate"]),"line-translate-anchor":new Tt(ie.paint_line["line-translate-anchor"]),"line-width":new Nt(ie.paint_line["line-width"]),"line-gap-width":new Nt(ie.paint_line["line-gap-width"]),"line-offset":new Nt(ie.paint_line["line-offset"]),"line-blur":new Nt(ie.paint_line["line-blur"]),"line-dasharray":new Ou(ie.paint_line["line-dasharray"]),"line-pattern":new Fu(ie.paint_line["line-pattern"]),"line-gradient":new Fh(ie.paint_line["line-gradient"])})},get layout(){return Dx=Dx||new v({"line-cap":new Tt(ie.layout_line["line-cap"]),"line-join":new Nt(ie.layout_line["line-join"]),"line-miter-limit":new Tt(ie.layout_line["line-miter-limit"]),"line-round-limit":new Tt(ie.layout_line["line-round-limit"]),"line-sort-key":new Nt(ie.layout_line["line-sort-key"])})}};class tP extends Nt{possiblyEvaluate(n,s){return s=new Rr(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,h,m){return s=ge({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,h,m)}}let uf;class rP extends a{constructor(n){super(n,Lx),this.gradientVersion=0,uf||(uf=new tP(Lx.paint.properties["line-width"].specification),uf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(h){return h._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof ra,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,s){super.recalculate(n,s),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Ny(n)}queryRadius(n){const s=n,h=Fx(Nh("line-width",this,s),Nh("line-gap-width",this,s)),m=Nh("line-offset",this,s);return h/2+Math.abs(m)+rf(this.paint.get("line-translate"))}queryIntersectsFeature(n,s,h,m,x,w,b){const E=nf(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),w.angle,b),I=b/2*Fx(this.paint.get("line-width").evaluate(s,h),this.paint.get("line-gap-width").evaluate(s,h)),M=this.paint.get("line-offset").evaluate(s,h);return M&&(m=function(L,j){const W=[];for(let Y=0;Y<L.length;Y++){const J=L[Y],le=[];for(let pe=0;pe<J.length;pe++){const ze=J[pe-1],be=J[pe],Ae=J[pe+1],Ve=pe===0?new D(0,0):be.sub(ze)._unit()._perp(),et=pe===J.length-1?new D(0,0):Ae.sub(be)._unit()._perp(),vt=Ve._add(et)._unit(),Ft=vt.x*et.x+vt.y*et.y;Ft!==0&&vt._mult(1/Ft),le.push(vt._mult(j)._add(be))}W.push(le)}return W}(m,M*b)),function(L,j,W){for(let Y=0;Y<j.length;Y++){const J=j[Y];if(L.length>=3){for(let le=0;le<J.length;le++)if(Hu(L,J[le]))return!0}if(hI(L,J,W))return!0}return!1}(E,m,I)}isTileClipped(){return!0}}function Fx(o,n){return n>0?n+2*o:o}const nP=S([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),iP=S([{name:"a_projected_pos",components:3,type:"Float32"}],4);S([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oP=S([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);S([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ox=S([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),sP=S([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function aP(o,n,s){return o.sections.forEach(h=>{h.text=function(m,x,w){const b=x.layout.get("text-transform").evaluate(w,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),_i.applyArabicShaping&&(m=_i.applyArabicShaping(m)),m}(h.text,n,s)}),o}S([{name:"triangle",components:3,type:"Uint16"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),S([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),S([{type:"Float32",name:"offsetX"}]),S([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),S([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Wh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var gn=24,Bx=Tr,Nx=function(o,n,s,h,m){var x,w,b=8*m-h-1,E=(1<<b)-1,I=E>>1,M=-7,L=m-1,j=-1,W=o[n+L];for(L+=j,x=W&(1<<-M)-1,W>>=-M,M+=b;M>0;x=256*x+o[n+L],L+=j,M-=8);for(w=x&(1<<-M)-1,x>>=-M,M+=h;M>0;w=256*w+o[n+L],L+=j,M-=8);if(x===0)x=1-I;else{if(x===E)return w?NaN:1/0*(W?-1:1);w+=Math.pow(2,h),x-=I}return(W?-1:1)*w*Math.pow(2,x-h)},$x=function(o,n,s,h,m,x){var w,b,E,I=8*x-m-1,M=(1<<I)-1,L=M>>1,j=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=0,Y=1,J=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(b=isNaN(n)?1:0,w=M):(w=Math.floor(Math.log(n)/Math.LN2),n*(E=Math.pow(2,-w))<1&&(w--,E*=2),(n+=w+L>=1?j/E:j*Math.pow(2,1-L))*E>=2&&(w++,E/=2),w+L>=M?(b=0,w=M):w+L>=1?(b=(n*E-1)*Math.pow(2,m),w+=L):(b=n*Math.pow(2,L-1)*Math.pow(2,m),w=0));m>=8;o[s+W]=255&b,W+=Y,b/=256,m-=8);for(w=w<<m|b,I+=m;I>0;o[s+W]=255&w,W+=Y,w/=256,I-=8);o[s+W-Y]|=128*J};function Tr(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Tr.Varint=0,Tr.Fixed64=1,Tr.Bytes=2,Tr.Fixed32=5;var $y=4294967296,jx=1/$y,Ux=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Fs(o){return o.type===Tr.Bytes?o.readVarint()+o.pos:o.pos+1}function qu(o,n,s){return s?4294967296*n+(o>>>0):4294967296*(n>>>0)+(o>>>0)}function Vx(o,n,s){var h=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(h);for(var m=s.pos-1;m>=o;m--)s.buf[m+h]=s.buf[m]}function lP(o,n){for(var s=0;s<o.length;s++)n.writeVarint(o[s])}function uP(o,n){for(var s=0;s<o.length;s++)n.writeSVarint(o[s])}function cP(o,n){for(var s=0;s<o.length;s++)n.writeFloat(o[s])}function hP(o,n){for(var s=0;s<o.length;s++)n.writeDouble(o[s])}function dP(o,n){for(var s=0;s<o.length;s++)n.writeBoolean(o[s])}function pP(o,n){for(var s=0;s<o.length;s++)n.writeFixed32(o[s])}function fP(o,n){for(var s=0;s<o.length;s++)n.writeSFixed32(o[s])}function mP(o,n){for(var s=0;s<o.length;s++)n.writeFixed64(o[s])}function gP(o,n){for(var s=0;s<o.length;s++)n.writeSFixed64(o[s])}function cf(o,n){return(o[n]|o[n+1]<<8|o[n+2]<<16)+16777216*o[n+3]}function Xu(o,n,s){o[s]=n,o[s+1]=n>>>8,o[s+2]=n>>>16,o[s+3]=n>>>24}function Hx(o,n){return(o[n]|o[n+1]<<8|o[n+2]<<16)+(o[n+3]<<24)}Tr.prototype={destroy:function(){this.buf=null},readFields:function(o,n,s){for(s=s||this.length;this.pos<s;){var h=this.readVarint(),m=h>>3,x=this.pos;this.type=7&h,o(m,n,this),this.pos===x&&this.skip(h)}return n},readMessage:function(o,n){return this.readFields(o,n,this.readVarint()+this.pos)},readFixed32:function(){var o=cf(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=Hx(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=cf(this.buf,this.pos)+cf(this.buf,this.pos+4)*$y;return this.pos+=8,o},readSFixed64:function(){var o=cf(this.buf,this.pos)+Hx(this.buf,this.pos+4)*$y;return this.pos+=8,o},readFloat:function(){var o=Nx(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Nx(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var n,s,h=this.buf;return n=127&(s=h[this.pos++]),s<128?n:(n|=(127&(s=h[this.pos++]))<<7,s<128?n:(n|=(127&(s=h[this.pos++]))<<14,s<128?n:(n|=(127&(s=h[this.pos++]))<<21,s<128?n:function(m,x,w){var b,E,I=w.buf;if(b=(112&(E=I[w.pos++]))>>4,E<128||(b|=(127&(E=I[w.pos++]))<<3,E<128)||(b|=(127&(E=I[w.pos++]))<<10,E<128)||(b|=(127&(E=I[w.pos++]))<<17,E<128)||(b|=(127&(E=I[w.pos++]))<<24,E<128)||(b|=(1&(E=I[w.pos++]))<<31,E<128))return qu(m,b,x);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=h[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,n=this.pos;return this.pos=o,o-n>=12&&Ux?function(s,h,m){return Ux.decode(s.subarray(h,m))}(this.buf,n,o):function(s,h,m){for(var x="",w=h;w<m;){var b,E,I,M=s[w],L=null,j=M>239?4:M>223?3:M>191?2:1;if(w+j>m)break;j===1?M<128&&(L=M):j===2?(192&(b=s[w+1]))==128&&(L=(31&M)<<6|63&b)<=127&&(L=null):j===3?(E=s[w+2],(192&(b=s[w+1]))==128&&(192&E)==128&&((L=(15&M)<<12|(63&b)<<6|63&E)<=2047||L>=55296&&L<=57343)&&(L=null)):j===4&&(E=s[w+2],I=s[w+3],(192&(b=s[w+1]))==128&&(192&E)==128&&(192&I)==128&&((L=(15&M)<<18|(63&b)<<12|(63&E)<<6|63&I)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,j=1):L>65535&&(L-=65536,x+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),x+=String.fromCharCode(L),w+=j}return x}(this.buf,n,o)},readBytes:function(){var o=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,o);return this.pos=o,n},readPackedVarint:function(o,n){if(this.type!==Tr.Bytes)return o.push(this.readVarint(n));var s=Fs(this);for(o=o||[];this.pos<s;)o.push(this.readVarint(n));return o},readPackedSVarint:function(o){if(this.type!==Tr.Bytes)return o.push(this.readSVarint());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Tr.Bytes)return o.push(this.readBoolean());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Tr.Bytes)return o.push(this.readFloat());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Tr.Bytes)return o.push(this.readDouble());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Tr.Bytes)return o.push(this.readFixed32());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Tr.Bytes)return o.push(this.readSFixed32());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Tr.Bytes)return o.push(this.readFixed64());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Tr.Bytes)return o.push(this.readSFixed64());var n=Fs(this);for(o=o||[];this.pos<n;)o.push(this.readSFixed64());return o},skip:function(o){var n=7&o;if(n===Tr.Varint)for(;this.buf[this.pos++]>127;);else if(n===Tr.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Tr.Fixed32)this.pos+=4;else{if(n!==Tr.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(o,n){this.writeVarint(o<<3|n)},realloc:function(o){for(var n=this.length||16;n<this.pos+o;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Xu(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Xu(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Xu(this.buf,-1&o,this.pos),Xu(this.buf,Math.floor(o*jx),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Xu(this.buf,-1&o,this.pos),Xu(this.buf,Math.floor(o*jx),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(n,s){var h,m;if(n>=0?(h=n%4294967296|0,m=n/4294967296|0):(m=~(-n/4294967296),4294967295^(h=~(-n%4294967296))?h=h+1|0:(h=0,m=m+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(x,w,b){b.buf[b.pos++]=127&x|128,x>>>=7,b.buf[b.pos++]=127&x|128,x>>>=7,b.buf[b.pos++]=127&x|128,x>>>=7,b.buf[b.pos++]=127&x|128,b.buf[b.pos]=127&(x>>>=7)}(h,0,s),function(x,w){var b=(7&x)<<4;w.buf[w.pos++]|=b|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(m,s)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var n=this.pos;this.pos=function(h,m,x){for(var w,b,E=0;E<m.length;E++){if((w=m.charCodeAt(E))>55295&&w<57344){if(!b){w>56319||E+1===m.length?(h[x++]=239,h[x++]=191,h[x++]=189):b=w;continue}if(w<56320){h[x++]=239,h[x++]=191,h[x++]=189,b=w;continue}w=b-55296<<10|w-56320|65536,b=null}else b&&(h[x++]=239,h[x++]=191,h[x++]=189,b=null);w<128?h[x++]=w:(w<2048?h[x++]=w>>6|192:(w<65536?h[x++]=w>>12|224:(h[x++]=w>>18|240,h[x++]=w>>12&63|128),h[x++]=w>>6&63|128),h[x++]=63&w|128)}return x}(this.buf,o,this.pos);var s=this.pos-n;s>=128&&Vx(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(o){this.realloc(4),$x(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),$x(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var n=o.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=o[s]},writeRawMessage:function(o,n){this.pos++;var s=this.pos;o(n,this);var h=this.pos-s;h>=128&&Vx(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeMessage:function(o,n,s){this.writeTag(o,Tr.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(o,n){n.length&&this.writeMessage(o,lP,n)},writePackedSVarint:function(o,n){n.length&&this.writeMessage(o,uP,n)},writePackedBoolean:function(o,n){n.length&&this.writeMessage(o,dP,n)},writePackedFloat:function(o,n){n.length&&this.writeMessage(o,cP,n)},writePackedDouble:function(o,n){n.length&&this.writeMessage(o,hP,n)},writePackedFixed32:function(o,n){n.length&&this.writeMessage(o,pP,n)},writePackedSFixed32:function(o,n){n.length&&this.writeMessage(o,fP,n)},writePackedFixed64:function(o,n){n.length&&this.writeMessage(o,mP,n)},writePackedSFixed64:function(o,n){n.length&&this.writeMessage(o,gP,n)},writeBytesField:function(o,n){this.writeTag(o,Tr.Bytes),this.writeBytes(n)},writeFixed32Field:function(o,n){this.writeTag(o,Tr.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(o,n){this.writeTag(o,Tr.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(o,n){this.writeTag(o,Tr.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(o,n){this.writeTag(o,Tr.Fixed64),this.writeSFixed64(n)},writeVarintField:function(o,n){this.writeTag(o,Tr.Varint),this.writeVarint(n)},writeSVarintField:function(o,n){this.writeTag(o,Tr.Varint),this.writeSVarint(n)},writeStringField:function(o,n){this.writeTag(o,Tr.Bytes),this.writeString(n)},writeFloatField:function(o,n){this.writeTag(o,Tr.Fixed32),this.writeFloat(n)},writeDoubleField:function(o,n){this.writeTag(o,Tr.Fixed64),this.writeDouble(n)},writeBooleanField:function(o,n){this.writeVarintField(o,!!n)}};var jy=T(Bx);const Uy=3;function yP(o,n,s){o===1&&s.readMessage(_P,n)}function _P(o,n,s){if(o===3){const{id:h,bitmap:m,width:x,height:w,left:b,top:E,advance:I}=s.readMessage(vP,{});n.push({id:h,bitmap:new jh({width:x+2*Uy,height:w+2*Uy},m),metrics:{width:x,height:w,left:b,top:E,advance:I}})}}function vP(o,n,s){o===1?n.id=s.readVarint():o===2?n.bitmap=s.readBytes():o===3?n.width=s.readVarint():o===4?n.height=s.readVarint():o===5?n.left=s.readSVarint():o===6?n.top=s.readSVarint():o===7&&(n.advance=s.readVarint())}const Gx=Uy;function Zx(o){let n=0,s=0;for(const w of o)n+=w.w*w.h,s=Math.max(s,w.w);o.sort((w,b)=>b.h-w.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let m=0,x=0;for(const w of o)for(let b=h.length-1;b>=0;b--){const E=h[b];if(!(w.w>E.w||w.h>E.h)){if(w.x=E.x,w.y=E.y,x=Math.max(x,w.y+w.h),m=Math.max(m,w.x+w.w),w.w===E.w&&w.h===E.h){const I=h.pop();b<h.length&&(h[b]=I)}else w.h===E.h?(E.x+=w.w,E.w-=w.w):w.w===E.w?(E.y+=w.h,E.h-=w.h):(h.push({x:E.x+w.w,y:E.y,w:E.w-w.w,h:w.h}),E.y+=w.h,E.h-=w.h);break}}return{w:m,h:x,fill:n/(m*x)||0}}const xi=1;class Vy{constructor(n,{pixelRatio:s,version:h,stretchX:m,stretchY:x,content:w,textFitWidth:b,textFitHeight:E}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=m,this.stretchY=x,this.content=w,this.version=h,this.textFitWidth=b,this.textFitHeight=E}get tl(){return[this.paddedRect.x+xi,this.paddedRect.y+xi]}get br(){return[this.paddedRect.x+this.paddedRect.w-xi,this.paddedRect.y+this.paddedRect.h-xi]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*xi)/this.pixelRatio,(this.paddedRect.h-2*xi)/this.pixelRatio]}}class Wx{constructor(n,s){const h={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(n,h,x),this.addImages(s,m,x);const{w,h:b}=Zx(x),E=new oo({width:w||1,height:b||1});for(const I in n){const M=n[I],L=h[I].paddedRect;oo.copy(M.data,E,{x:0,y:0},{x:L.x+xi,y:L.y+xi},M.data)}for(const I in s){const M=s[I],L=m[I].paddedRect,j=L.x+xi,W=L.y+xi,Y=M.data.width,J=M.data.height;oo.copy(M.data,E,{x:0,y:0},{x:j,y:W},M.data),oo.copy(M.data,E,{x:0,y:J-1},{x:j,y:W-1},{width:Y,height:1}),oo.copy(M.data,E,{x:0,y:0},{x:j,y:W+J},{width:Y,height:1}),oo.copy(M.data,E,{x:Y-1,y:0},{x:j-1,y:W},{width:1,height:J}),oo.copy(M.data,E,{x:0,y:0},{x:j+Y,y:W},{width:1,height:J})}this.image=E,this.iconPositions=h,this.patternPositions=m}addImages(n,s,h){for(const m in n){const x=n[m],w={x:0,y:0,w:x.data.width+2*xi,h:x.data.height+2*xi};h.push(w),s[m]=new Vy(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(n,s){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in n.updatedImages)this.patchUpdatedImage(this.iconPositions[h],n.getImage(h),s),this.patchUpdatedImage(this.patternPositions[h],n.getImage(h),s)}patchUpdatedImage(n,s,h){if(!n||!s||n.version===s.version)return;n.version=s.version;const[m,x]=n.tl;h.update(s.data,void 0,{x:m,y:x})}}var Ia;bt("ImagePosition",Vy),bt("ImageAtlas",Wx),y.ah=void 0,(Ia=y.ah||(y.ah={}))[Ia.none=0]="none",Ia[Ia.horizontal=1]="horizontal",Ia[Ia.vertical=2]="vertical",Ia[Ia.horizontalOnly=3]="horizontalOnly";const qh=-17;class Xh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const h=new Xh;return h.scale=n||1,h.fontStack=s,h}static forImage(n){const s=new Xh;return s.imageName=n,s}}class Ku{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const h=new Ku;for(let m=0;m<n.sections.length;m++){const x=n.sections[m];x.image?h.addImageSection(x):h.addTextSection(x,s)}return h}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let s="";for(let h=0;h<n.length;h++){const m=n.charCodeAt(h+1)||null,x=n.charCodeAt(h-1)||null;s+=m&&Xp(m)&&!Wh[n[h+1]]||x&&Xp(x)&&!Wh[n[h-1]]||!Wh[n[h]]?n[h]:Wh[n[h]]}return s}(this.text)}trim(){let n=0;for(let h=0;h<this.text.length&&df[this.text.charCodeAt(h)];h++)n++;let s=this.text.length;for(let h=this.text.length-1;h>=0&&h>=n&&df[this.text.charCodeAt(h)];h--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const h=new Ku;return h.text=this.text.substring(n,s),h.sectionIndex=this.sectionIndex.slice(n,s),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Xh.forText(n.scale,n.fontStack||s));const h=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(h)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void je("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Xh.forImage(s)),this.sectionIndex.push(this.sections.length-1)):je("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hf(o,n,s,h,m,x,w,b,E,I,M,L,j,W,Y){const J=Ku.fromFeature(o,m);let le;L===y.ah.vertical&&J.verticalizePunctuation();const{processBidirectionalText:pe,processStyledBidirectionalText:ze}=_i;if(pe&&J.sections.length===1){le=[];const Ve=pe(J.toString(),Hy(J,I,x,n,h,W));for(const et of Ve){const vt=new Ku;vt.text=et,vt.sections=J.sections;for(let Ft=0;Ft<et.length;Ft++)vt.sectionIndex.push(0);le.push(vt)}}else if(ze){le=[];const Ve=ze(J.text,J.sectionIndex,Hy(J,I,x,n,h,W));for(const et of Ve){const vt=new Ku;vt.text=et[0],vt.sectionIndex=et[1],vt.sections=J.sections,le.push(vt)}}else le=function(Ve,et){const vt=[],Ft=Ve.text;let gt=0;for(const pt of et)vt.push(Ve.substring(gt,pt)),gt=pt;return gt<Ft.length&&vt.push(Ve.substring(gt,Ft.length)),vt}(J,Hy(J,I,x,n,h,W));const be=[],Ae={positionedLines:be,text:J.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Ve,et,vt,Ft,gt,pt,Pt,Et,wt,qe,At,It){let Vt=0,Ir=qh,Cr=0,vn=0;const Po=Et==="right"?1:Et==="left"?0:.5;let Ln=0;for(const tn of gt){tn.trim();const wn=tn.getMaxScale(),Gn=(wn-1)*gn,Fn={positionedGlyphs:[],lineOffset:0};Ve.positionedLines[Ln]=Fn;const li=Fn.positionedGlyphs;let On=0;if(!tn.length()){Ir+=pt,++Ln;continue}for(let wi=0;wi<tn.length();wi++){const mr=tn.getSection(wi),Mr=tn.getSectionIndex(wi),Br=tn.getCharCode(wi);let ji=0,Wr=null,ec=null,us=null,cs=gn;const Ao=!(wt===y.ah.horizontal||!At&&!Rh(Br)||At&&(df[Br]||(xn=Br,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(xn)))));if(mr.imageName){const lo=Ft[mr.imageName];if(!lo)continue;us=mr.imageName,Ve.iconsInText=Ve.iconsInText||!0,ec=lo.paddedRect;const Tn=lo.displaySize;mr.scale=mr.scale*gn/It,Wr={width:Tn[0],height:Tn[1],left:xi,top:-Gx,advance:Ao?Tn[1]:Tn[0]},ji=Gn+(gn-Tn[1]*mr.scale),cs=Wr.advance;const Os=Ao?Tn[0]*mr.scale-gn*wn:Tn[1]*mr.scale-gn*wn;Os>0&&Os>On&&(On=Os)}else{const lo=vt[mr.fontStack],Tn=lo&&lo[Br];if(Tn&&Tn.rect)ec=Tn.rect,Wr=Tn.metrics;else{const Os=et[mr.fontStack],td=Os&&Os[Br];if(!td)continue;Wr=td.metrics}ji=(wn-mr.scale)*gn}Ao?(Ve.verticalizable=!0,li.push({glyph:Br,imageName:us,x:Vt,y:Ir+ji,vertical:Ao,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Mr,metrics:Wr,rect:ec}),Vt+=cs*mr.scale+qe):(li.push({glyph:Br,imageName:us,x:Vt,y:Ir+ji,vertical:Ao,scale:mr.scale,fontStack:mr.fontStack,sectionIndex:Mr,metrics:Wr,rect:ec}),Vt+=Wr.advance*mr.scale+qe)}li.length!==0&&(Cr=Math.max(Vt-qe,Cr),SP(li,0,li.length-1,Po,On)),Vt=0;const ao=pt*wn+On;Fn.lineOffset=Math.max(On,Gn),Ir+=ao,vn=Math.max(ao,vn),++Ln}var xn;const oi=Ir-qh,{horizontalAlign:si,verticalAlign:ai}=Gy(Pt);(function(tn,wn,Gn,Fn,li,On,ao,wi,mr){const Mr=(wn-Gn)*li;let Br=0;Br=On!==ao?-wi*Fn-qh:(-Fn*mr+.5)*ao;for(const ji of tn)for(const Wr of ji.positionedGlyphs)Wr.x+=Mr,Wr.y+=Br})(Ve.positionedLines,Po,si,ai,Cr,vn,pt,oi,gt.length),Ve.top+=-ai*oi,Ve.bottom=Ve.top+oi,Ve.left+=-si*Cr,Ve.right=Ve.left+Cr}(Ae,n,s,h,le,w,b,E,L,I,j,Y),!function(Ve){for(const et of Ve)if(et.positionedGlyphs.length!==0)return!1;return!0}(be)&&Ae}const df={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},xP={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},wP={40:!0};function qx(o,n,s,h,m,x){if(n.imageName){const w=h[n.imageName];return w?w.displaySize[0]*n.scale*gn/x+m:0}{const w=s[n.fontStack],b=w&&w[o];return b?b.metrics.advance*n.scale+m:0}}function Xx(o,n,s,h){const m=Math.pow(o-n,2);return h?o<n?m/2:2*m:m+Math.abs(s)*s}function bP(o,n,s){let h=0;return o===10&&(h-=1e4),s&&(h+=150),o!==40&&o!==65288||(h+=50),n!==41&&n!==65289||(h+=50),h}function Kx(o,n,s,h,m,x){let w=null,b=Xx(n,s,m,x);for(const E of h){const I=Xx(n-E.x,s,m,x)+E.badness;I<=b&&(w=E,b=I)}return{index:o,x:n,priorBreak:w,badness:b}}function Yx(o){return o?Yx(o.priorBreak).concat(o.index):[]}function Hy(o,n,s,h,m,x){if(!o)return[];const w=[],b=function(L,j,W,Y,J,le){let pe=0;for(let ze=0;ze<L.length();ze++){const be=L.getSection(ze);pe+=qx(L.getCharCode(ze),be,Y,J,j,le)}return pe/Math.max(1,Math.ceil(pe/W))}(o,n,s,h,m,x),E=o.text.indexOf("​")>=0;let I=0;for(let L=0;L<o.length();L++){const j=o.getSection(L),W=o.getCharCode(L);if(df[W]||(I+=qx(W,j,h,m,n,x)),L<o.length()-1){const Y=!((M=W)<11904)&&(!!ir["CJK Compatibility Forms"](M)||!!ir["CJK Compatibility"](M)||!!ir["CJK Strokes"](M)||!!ir["CJK Symbols and Punctuation"](M)||!!ir["Enclosed CJK Letters and Months"](M)||!!ir["Halfwidth and Fullwidth Forms"](M)||!!ir["Ideographic Description Characters"](M)||!!ir["Vertical Forms"](M)||qp.test(String.fromCodePoint(M)));(xP[W]||Y||j.imageName||L!==o.length()-2&&wP[o.getCharCode(L+1)])&&w.push(Kx(L+1,I,b,w,bP(W,o.getCharCode(L+1),Y&&E),!1))}}var M;return Yx(Kx(o.length(),I,b,w,0,!0))}function Gy(o){let n=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function SP(o,n,s,h,m){if(!h&&!m)return;const x=o[s],w=(o[s].x+x.metrics.advance*x.scale)*h;for(let b=n;b<=s;b++)o[b].x-=w,o[b].y+=m}function EP(o,n,s){const{horizontalAlign:h,verticalAlign:m}=Gy(s),x=n[0]-o.displaySize[0]*h,w=n[1]-o.displaySize[1]*m;return{image:o,top:w,bottom:w+o.displaySize[1],left:x,right:x+o.displaySize[0]}}function Jx(o){var n,s;let h=o.left,m=o.top,x=o.right-h,w=o.bottom-m;const b=(n=o.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",E=(s=o.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",I=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(E==="proportional"){if(b==="stretchOnly"&&x/w<I||b==="proportional"){const M=Math.ceil(w*I);h*=M/x,x=M}}else if(b==="proportional"&&E==="stretchOnly"&&I!==0&&x/w>I){const M=Math.ceil(x/I);m*=M/w,w=M}return{x1:h,y1:m,x2:h+x,y2:m+w}}function Qx(o,n,s,h,m,x){const w=o.image;let b;if(w.content){const le=w.content,pe=w.pixelRatio||1;b=[le[0]/pe,le[1]/pe,w.displaySize[0]-le[2]/pe,w.displaySize[1]-le[3]/pe]}const E=n.left*x,I=n.right*x;let M,L,j,W;s==="width"||s==="both"?(W=m[0]+E-h[3],L=m[0]+I+h[1]):(W=m[0]+(E+I-w.displaySize[0])/2,L=W+w.displaySize[0]);const Y=n.top*x,J=n.bottom*x;return s==="height"||s==="both"?(M=m[1]+Y-h[0],j=m[1]+J+h[2]):(M=m[1]+(Y+J-w.displaySize[1])/2,j=M+w.displaySize[1]),{image:w,top:M,right:L,bottom:j,left:W,collisionPadding:b}}const Kh=255,ls=128,Pa=Kh*ls;function ew(o,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Rr(o+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:m}=s;let x=0;for(;x<h.length&&h[x]<=o;)x++;x=Math.max(0,x-1);let w=x;for(;w<h.length&&h[w]<o+1;)w++;w=Math.min(h.length-1,w);const b=h[x],E=h[w];return s.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:E,minSize:s.evaluate(new Rr(b)),maxSize:s.evaluate(new Rr(E)),interpolationType:m}}}function Zy(o,n,s){let h="never";const m=o.get(n);return m?h=m:o.get(s)&&(h="always"),h}const kP=Ca.VectorTileFeature.types,TP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pf(o,n,s,h,m,x,w,b,E,I,M,L,j){const W=b?Math.min(Pa,Math.round(b[0])):0,Y=b?Math.min(Pa,Math.round(b[1])):0;o.emplaceBack(n,s,Math.round(32*h),Math.round(32*m),x,w,(W<<1)+(E?1:0),Y,16*I,16*M,256*L,256*j)}function Wy(o,n,s){o.emplaceBack(n.x,n.y,s),o.emplaceBack(n.x,n.y,s),o.emplaceBack(n.x,n.y,s),o.emplaceBack(n.x,n.y,s)}function CP(o){for(const n of o.sections)if(wy(n.text))return!0;return!1}class qy{constructor(n){this.layoutVertexArray=new Nu,this.indexArray=new io,this.programConfigurations=n,this.segments=new or,this.dynamicLayoutVertexArray=new Oh,this.opacityVertexArray=new Ni,this.hasVisibleVertices=!1,this.placedSymbolArray=new Lr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,nP.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,iP.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,TP,!0),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}bt("SymbolBuffers",qy);class Xy{constructor(n,s,h){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new h,this.segments=new or,this.collisionVertexArray=new ss}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,oP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}bt("CollisionBuffers",Xy);class Yu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(w=>w.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Iy([]),this.placementViewportMatrix=Iy([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ew(this.zoom,s["text-size"]),this.iconSizeData=ew(this.zoom,s["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),x=h.get("symbol-z-order");this.canOverlap=Zy(h,"text-overlap","text-allow-overlap")!=="never"||Zy(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(w=>y.ah[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=n.sourceID}createArrays(){this.text=new qy(new Tl(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new qy(new Tl(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Fr,this.lineVertexArray=new Mn,this.symbolInstances=new nr,this.textAnchorOffsets=new Or}calculateGlyphDependencies(n,s,h,m,x){for(let w=0;w<n.length;w++)if(s[n.charCodeAt(w)]=!0,(h||m)&&x){const b=Wh[n.charAt(w)];b&&(s[b.charCodeAt(0)]=!0)}}populate(n,s,h){const m=this.layers[0],x=m.layout,w=x.get("text-font"),b=x.get("text-field"),E=x.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof fi&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),M=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,L=x.get("symbol-sort-key");if(this.features=[],!I&&!M)return;const j=s.iconDependencies,W=s.glyphDependencies,Y=s.availableImages,J=new Rr(this.zoom);for(const{feature:le,id:pe,index:ze,sourceLayerIndex:be}of n){const Ae=m._featureFilter.needGeometry,Ve=Il(le,Ae);if(!m._featureFilter.filter(J,Ve,h))continue;let et,vt;if(Ae||(Ve.geometry=Cl(le)),I){const gt=m.getValueAndResolveTokens("text-field",Ve,h,Y),pt=fi.factory(gt),Pt=this.hasRTLText=this.hasRTLText||CP(pt);(!Pt||_i.getRTLTextPluginStatus()==="unavailable"||Pt&&_i.isParsed())&&(et=aP(pt,m,Ve))}if(M){const gt=m.getValueAndResolveTokens("icon-image",Ve,h,Y);vt=gt instanceof gi?gt:gi.fromString(gt)}if(!et&&!vt)continue;const Ft=this.sortFeaturesByKey?L.evaluate(Ve,{},h):void 0;if(this.features.push({id:pe,text:et,icon:vt,index:ze,sourceLayerIndex:be,geometry:Ve.geometry,properties:le.properties,type:kP[le.type],sortKey:Ft}),vt&&(j[vt.name]=!0),et){const gt=w.evaluate(Ve,{},h).join(","),pt=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(y.ah.vertical)>=0;for(const Pt of et.sections)if(Pt.image)j[Pt.image.name]=!0;else{const Et=zh(et.toString()),wt=Pt.fontStack||gt,qe=W[wt]=W[wt]||{};this.calculateGlyphDependencies(Pt.text,qe,pt,this.allowVerticalPlacement,Et)}}}x.get("symbol-placement")==="line"&&(this.features=function(le){const pe={},ze={},be=[];let Ae=0;function Ve(gt){be.push(le[gt]),Ae++}function et(gt,pt,Pt){const Et=ze[gt];return delete ze[gt],ze[pt]=Et,be[Et].geometry[0].pop(),be[Et].geometry[0]=be[Et].geometry[0].concat(Pt[0]),Et}function vt(gt,pt,Pt){const Et=pe[pt];return delete pe[pt],pe[gt]=Et,be[Et].geometry[0].shift(),be[Et].geometry[0]=Pt[0].concat(be[Et].geometry[0]),Et}function Ft(gt,pt,Pt){const Et=Pt?pt[0][pt[0].length-1]:pt[0][0];return`${gt}:${Et.x}:${Et.y}`}for(let gt=0;gt<le.length;gt++){const pt=le[gt],Pt=pt.geometry,Et=pt.text?pt.text.toString():null;if(!Et){Ve(gt);continue}const wt=Ft(Et,Pt),qe=Ft(Et,Pt,!0);if(wt in ze&&qe in pe&&ze[wt]!==pe[qe]){const At=vt(wt,qe,Pt),It=et(wt,qe,be[At].geometry);delete pe[wt],delete ze[qe],ze[Ft(Et,be[It].geometry,!0)]=It,be[At].geometry=null}else wt in ze?et(wt,qe,Pt):qe in pe?vt(wt,qe,Pt):(Ve(gt),pe[wt]=Ae-1,ze[qe]=Ae-1)}return be.filter(gt=>gt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,pe)=>le.sortKey-pe.sortKey)}update(n,s,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,h),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const h=this.lineVertexArray.length;if(n.segment!==void 0){let m=n.dist(s[n.segment+1]),x=n.dist(s[n.segment]);const w={};for(let b=n.segment+1;b<s.length;b++)w[b]={x:s[b].x,y:s[b].y,tileUnitDistanceFromAnchor:m},b<s.length-1&&(m+=s[b+1].dist(s[b]));for(let b=n.segment||0;b>=0;b--)w[b]={x:s[b].x,y:s[b].y,tileUnitDistanceFromAnchor:x},b>0&&(x+=s[b-1].dist(s[b]));for(let b=0;b<s.length;b++){const E=w[b];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(n,s,h,m,x,w,b,E,I,M,L,j){const W=n.indexArray,Y=n.layoutVertexArray,J=n.segments.prepareSegment(4*s.length,Y,W,this.canOverlap?w.sortKey:void 0),le=this.glyphOffsetArray.length,pe=J.vertexLength,ze=this.allowVerticalPlacement&&b===y.ah.vertical?Math.PI/2:0,be=w.text&&w.text.sections;for(let Ae=0;Ae<s.length;Ae++){const{tl:Ve,tr:et,bl:vt,br:Ft,tex:gt,pixelOffsetTL:pt,pixelOffsetBR:Pt,minFontScaleX:Et,minFontScaleY:wt,glyphOffset:qe,isSDF:At,sectionIndex:It}=s[Ae],Vt=J.vertexLength,Ir=qe[1];pf(Y,E.x,E.y,Ve.x,Ir+Ve.y,gt.x,gt.y,h,At,pt.x,pt.y,Et,wt),pf(Y,E.x,E.y,et.x,Ir+et.y,gt.x+gt.w,gt.y,h,At,Pt.x,pt.y,Et,wt),pf(Y,E.x,E.y,vt.x,Ir+vt.y,gt.x,gt.y+gt.h,h,At,pt.x,Pt.y,Et,wt),pf(Y,E.x,E.y,Ft.x,Ir+Ft.y,gt.x+gt.w,gt.y+gt.h,h,At,Pt.x,Pt.y,Et,wt),Wy(n.dynamicLayoutVertexArray,E,ze),W.emplaceBack(Vt,Vt+1,Vt+2),W.emplaceBack(Vt+1,Vt+2,Vt+3),J.vertexLength+=4,J.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(qe[0]),Ae!==s.length-1&&It===s[Ae+1].sectionIndex||n.programConfigurations.populatePaintArrays(Y.length,w,w.index,{},j,be&&be[It])}n.placedSymbolArray.emplaceBack(E.x,E.y,le,this.glyphOffsetArray.length-le,pe,I,M,E.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],b,0,!1,0,L)}_addCollisionDebugVertex(n,s,h,m,x,w){return s.emplaceBack(0,0),n.emplaceBack(h.x,h.y,m,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(n,s,h,m,x,w,b){const E=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),I=E.vertexLength,M=x.layoutVertexArray,L=x.collisionVertexArray,j=b.anchorX,W=b.anchorY;this._addCollisionDebugVertex(M,L,w,j,W,new D(n,s)),this._addCollisionDebugVertex(M,L,w,j,W,new D(h,s)),this._addCollisionDebugVertex(M,L,w,j,W,new D(h,m)),this._addCollisionDebugVertex(M,L,w,j,W,new D(n,m)),E.vertexLength+=4;const Y=x.indexArray;Y.emplaceBack(I,I+1),Y.emplaceBack(I+1,I+2),Y.emplaceBack(I+2,I+3),Y.emplaceBack(I+3,I),E.primitiveLength+=4}addDebugCollisionBoxes(n,s,h,m){for(let x=n;x<s;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,m?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xy($i,Ox.members,kn),this.iconCollisionBox=new Xy($i,Ox.members,kn);for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(n,s,h,m,x,w,b,E,I){const M={};for(let L=s;L<h;L++){const j=n.get(L);M.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},M.textFeatureIndex=j.featureIndex;break}for(let L=m;L<x;L++){const j=n.get(L);M.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},M.verticalTextFeatureIndex=j.featureIndex;break}for(let L=w;L<b;L++){const j=n.get(L);M.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},M.iconFeatureIndex=j.featureIndex;break}for(let L=E;L<I;L++){const j=n.get(L);M.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},M.verticalIconFeatureIndex=j.featureIndex;break}return M}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const h=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const h=n.placedSymbolArray.get(s),m=h.vertexStartIndex+4*h.numGlyphs;for(let x=h.vertexStartIndex;x<m;x+=4)n.indexArray.emplaceBack(x,x+1,x+2),n.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),h=Math.cos(n),m=[],x=[],w=[];for(let b=0;b<this.symbolInstances.length;++b){w.push(b);const E=this.symbolInstances.get(b);m.push(0|Math.round(s*E.anchorX+h*E.anchorY)),x.push(E.featureIndex)}return w.sort((b,E)=>m[b]-m[E]||x[E]-x[b]),w}addToSortKeyRanges(n,s){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===s?h.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const h=this.symbolInstances.get(s);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((m,x,w)=>{m>=0&&w.indexOf(m)===x&&this.addIndicesForPlacedSymbol(this.text,m)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let tw,rw;bt("SymbolBucket",Yu,{omit:["layers","collisionBoxArray","features","compareText"]}),Yu.MAX_GLYPHS=65535,Yu.addDynamicAttributes=Wy;var Ky={get paint(){return rw=rw||new v({"icon-opacity":new Nt(ie.paint_symbol["icon-opacity"]),"icon-color":new Nt(ie.paint_symbol["icon-color"]),"icon-halo-color":new Nt(ie.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(ie.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(ie.paint_symbol["icon-halo-blur"]),"icon-translate":new Tt(ie.paint_symbol["icon-translate"]),"icon-translate-anchor":new Tt(ie.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(ie.paint_symbol["text-opacity"]),"text-color":new Nt(ie.paint_symbol["text-color"],{runtimeType:jr,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Nt(ie.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(ie.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(ie.paint_symbol["text-halo-blur"]),"text-translate":new Tt(ie.paint_symbol["text-translate"]),"text-translate-anchor":new Tt(ie.paint_symbol["text-translate-anchor"])})},get layout(){return tw=tw||new v({"symbol-placement":new Tt(ie.layout_symbol["symbol-placement"]),"symbol-spacing":new Tt(ie.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Tt(ie.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(ie.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Tt(ie.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Tt(ie.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Tt(ie.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Tt(ie.layout_symbol["icon-ignore-placement"]),"icon-optional":new Tt(ie.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Tt(ie.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(ie.layout_symbol["icon-size"]),"icon-text-fit":new Tt(ie.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Tt(ie.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(ie.layout_symbol["icon-image"]),"icon-rotate":new Nt(ie.layout_symbol["icon-rotate"]),"icon-padding":new Nt(ie.layout_symbol["icon-padding"]),"icon-keep-upright":new Tt(ie.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(ie.layout_symbol["icon-offset"]),"icon-anchor":new Nt(ie.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Tt(ie.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Tt(ie.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Tt(ie.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(ie.layout_symbol["text-field"]),"text-font":new Nt(ie.layout_symbol["text-font"]),"text-size":new Nt(ie.layout_symbol["text-size"]),"text-max-width":new Nt(ie.layout_symbol["text-max-width"]),"text-line-height":new Tt(ie.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(ie.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(ie.layout_symbol["text-justify"]),"text-radial-offset":new Nt(ie.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Tt(ie.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Nt(ie.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Nt(ie.layout_symbol["text-anchor"]),"text-max-angle":new Tt(ie.layout_symbol["text-max-angle"]),"text-writing-mode":new Tt(ie.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(ie.layout_symbol["text-rotate"]),"text-padding":new Tt(ie.layout_symbol["text-padding"]),"text-keep-upright":new Tt(ie.layout_symbol["text-keep-upright"]),"text-transform":new Nt(ie.layout_symbol["text-transform"]),"text-offset":new Nt(ie.layout_symbol["text-offset"]),"text-allow-overlap":new Tt(ie.layout_symbol["text-allow-overlap"]),"text-overlap":new Tt(ie.layout_symbol["text-overlap"]),"text-ignore-placement":new Tt(ie.layout_symbol["text-ignore-placement"]),"text-optional":new Tt(ie.layout_symbol["text-optional"])})}};class nw{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Qn,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bt("FormatSectionOverride",nw,{omit:["defaultValue"]});class ff extends a{constructor(n){super(n,Ky)}recalculate(n,s){if(super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const x of h)m.indexOf(x)<0&&m.push(x);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,s,h,m){const x=this.layout.get(n).evaluate(s,{},h,m),w=this._unevaluatedLayout._values[n];return w.isDataDriven()||Eu(w.value)||!x?x:function(b,E){return E.replace(/{([^{}]+)}/g,(I,M)=>b&&M in b?String(b[M]):"")}(s.properties,x)}createBucket(n){return new Yu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of Ky.paint.overridableProperties){if(!ff.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),h=new nw(s),m=new Su(h,s.property.specification);let x=null;x=s.value.kind==="constant"||s.value.kind==="source"?new ha("source",m):new da("composite",m,s.value.zoomStops),this.paint._values[n]=new Co(s.property,x,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,h){return!(!this.layout||s.isDataDriven()||h.isDataDriven())&&ff.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const h=n.get("text-field"),m=Ky.paint.properties[s];let x=!1;const w=b=>{for(const E of b)if(m.overrides&&m.overrides.hasOverride(E))return void(x=!0)};if(h.value.kind==="constant"&&h.value.value instanceof fi)w(h.value.value.sections);else if(h.value.kind==="source"){const b=I=>{x||(I instanceof Ji&&pn(I.value)===Ki?w(I.value.sections):I instanceof fu?w(I.sections):I.eachChild(b))},E=h.value;E._styleExpression&&b(E._styleExpression.expression)}return x}}let iw;var IP={get paint(){return iw=iw||new v({"background-color":new Tt(ie.paint_background["background-color"]),"background-pattern":new Ou(ie.paint_background["background-pattern"]),"background-opacity":new Tt(ie.paint_background["background-opacity"])})}};class PP extends a{constructor(n){super(n,IP)}}let ow;var AP={get paint(){return ow=ow||new v({"raster-opacity":new Tt(ie.paint_raster["raster-opacity"]),"raster-hue-rotate":new Tt(ie.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Tt(ie.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Tt(ie.paint_raster["raster-brightness-max"]),"raster-saturation":new Tt(ie.paint_raster["raster-saturation"]),"raster-contrast":new Tt(ie.paint_raster["raster-contrast"]),"raster-resampling":new Tt(ie.paint_raster["raster-resampling"]),"raster-fade-duration":new Tt(ie.paint_raster["raster-fade-duration"])})}};class MP extends a{constructor(n){super(n,AP)}}class zP extends a{constructor(n){super(n,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class DP{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Yy=63710088e-1;class Aa{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Aa(Ee(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,h=this.lat*s,m=n.lat*s,x=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((n.lng-this.lng)*s);return Yy*Math.acos(Math.min(x,1))}static convert(n){if(n instanceof Aa)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Aa(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Aa(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const sw=2*Math.PI*Yy;function aw(o){return sw*Math.cos(o*Math.PI/180)}function lw(o){return(180+o)/360}function uw(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function cw(o,n){return o/aw(n)}function Jy(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}class Yh{constructor(n,s,h=0){this.x=+n,this.y=+s,this.z=+h}static fromLngLat(n,s=0){const h=Aa.convert(n);return new Yh(lw(h.lng),uw(h.lat),cw(s,h.lat))}toLngLat(){return new Aa(360*this.x-180,Jy(this.y))}toAltitude(){return this.z*aw(Jy(this.y))}meterInMercatorCoordinateUnits(){return 1/sw*(n=Jy(this.y),1/Math.cos(n*Math.PI/180));var n}}function hw(o,n,s){var h=2*Math.PI*6378137/256/Math.pow(2,s);return[o*h-2*Math.PI*6378137/2,n*h-2*Math.PI*6378137/2]}class Qy{constructor(n,s,h){if(!function(m,x,w){return!(m<0||m>25||w<0||w>=Math.pow(2,m)||x<0||x>=Math.pow(2,m))}(n,s,h))throw new Error(`x=${s}, y=${h}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=s,this.y=h,this.key=Jh(0,n,n,s,h)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s,h){const m=(w=this.y,b=this.z,E=hw(256*(x=this.x),256*(w=Math.pow(2,b)-w-1),b),I=hw(256*(x+1),256*(w+1),b),E[0]+","+E[1]+","+I[0]+","+I[1]);var x,w,b,E,I;const M=function(L,j,W){let Y,J="";for(let le=L;le>0;le--)Y=1<<le-1,J+=(j&Y?1:0)+(W&Y?2:0);return J}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,m)}isChildOf(n){const s=this.z-n.z;return s>0&&n.x===this.x>>s&&n.y===this.y>>s}getTilePoint(n){const s=Math.pow(2,this.z);return new D((n.x*s-this.x)*fn,(n.y*s-this.y)*fn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class dw{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Jh(n,s.z,s.z,s.x,s.y)}}class so{constructor(n,s,h,m,x){if(n<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${h}`);this.overscaledZ=n,this.wrap=s,this.canonical=new Qy(h,+m,+x),this.key=Jh(s,n,h,m,x)}clone(){return new so(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-n;return n>this.canonical.z?new so(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new so(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-n;return n>this.canonical.z?Jh(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y):Jh(this.wrap*+s,n,n,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new so(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new so(s,this.wrap,s,h,m),new so(s,this.wrap,s,h+1,m),new so(s,this.wrap,s,h,m+1),new so(s,this.wrap,s,h+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new so(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new so(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new dw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new Yh(n.x-this.wrap,n.y))}}function Jh(o,n,s,h,m){(o*=2)<0&&(o=-1*o-1);const x=1<<s;return(x*x*o+x*m+h).toString(36)+s.toString(36)+n.toString(36)}bt("CanonicalTileID",Qy),bt("OverscaledTileID",so,{omit:["posMatrix"]});class pw{constructor(n,s,h,m=1,x=1,w=1,b=0){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void je(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const E=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=x,this.blueFactor=w,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<E;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(E,I)]=this.data[this._idx(E-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,E)]=this.data[this._idx(I,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<E;I++)for(let M=0;M<E;M++){const L=this.get(I,M);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(n,s){const h=new Uint8Array(this.data.buffer),m=4*this._idx(n,s);return this.unpack(h[m],h[m+1],h[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}unpack(n,s,h){return n*this.redFactor+s*this.greenFactor+h*this.blueFactor-this.baseShift}getPixels(){return new oo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,s,h){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=s*this.dim,x=s*this.dim+this.dim,w=h*this.dim,b=h*this.dim+this.dim;switch(s){case-1:m=x-1;break;case 1:x=m+1}switch(h){case-1:w=b-1;break;case 1:b=w+1}const E=-s*this.dim,I=-h*this.dim;for(let M=w;M<b;M++)for(let L=m;L<x;L++)this.data[this._idx(L,M)]=n.data[this._idx(L+E,M+I)]}}bt("DEMData",pw);class fw{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const h=n[s];this._stringToNumber[h]=s,this._numberToString[s]=h}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class mw{constructor(n,s,h,m,x){this.type="Feature",this._vectorTileFeature=n,n._z=s,n._x=h,n._y=m,this.properties=n.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(n[s]=this[s]);return n}}class gw{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new ga(fn,16,0),this.grid3D=new ga(fn,16,0),this.featureIndexArray=new Vn,this.promoteId=s}insert(n,s,h,m,x,w){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,x);const E=w?this.grid3D:this.grid;for(let I=0;I<s.length;I++){const M=s[I],L=[1/0,1/0,-1/0,-1/0];for(let j=0;j<M.length;j++){const W=M[j];L[0]=Math.min(L[0],W.x),L[1]=Math.min(L[1],W.y),L[2]=Math.max(L[2],W.x),L[3]=Math.max(L[3],W.y)}L[0]<fn&&L[1]<fn&&L[2]>=0&&L[3]>=0&&E.insert(b,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ca.VectorTile(new jy(this.rawTileData)).layers,this.sourceLayerCoder=new fw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,s,h,m){this.loadVTLayers();const x=n.params||{},w=fn/n.tileSize/n.scale,b=yh(x.filter),E=n.queryGeometry,I=n.queryPadding*w,M=_w(E),L=this.grid.query(M.minX-I,M.minY-I,M.maxX+I,M.maxY+I),j=_w(n.cameraQueryGeometry),W=this.grid3D.query(j.minX-I,j.minY-I,j.maxX+I,j.maxY+I,(le,pe,ze,be)=>function(Ae,Ve,et,vt,Ft){for(const pt of Ae)if(Ve<=pt.x&&et<=pt.y&&vt>=pt.x&&Ft>=pt.y)return!0;const gt=[new D(Ve,et),new D(Ve,Ft),new D(vt,Ft),new D(vt,et)];if(Ae.length>2){for(const pt of gt)if(Hu(Ae,pt))return!0}for(let pt=0;pt<Ae.length-1;pt++)if(pI(Ae[pt],Ae[pt+1],gt))return!0;return!1}(n.cameraQueryGeometry,le-I,pe-I,ze+I,be+I));for(const le of W)L.push(le);L.sort(RP);const Y={};let J;for(let le=0;le<L.length;le++){const pe=L[le];if(pe===J)continue;J=pe;const ze=this.featureIndexArray.get(pe);let be=null;this.loadMatchingFeature(Y,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,b,x.layers,x.availableImages,s,h,m,(Ae,Ve,et)=>(be||(be=Cl(Ae)),Ve.queryIntersectsFeature(E,Ae,et,be,this.z,n.transform,w,n.pixelPosMatrix)))}return Y}loadMatchingFeature(n,s,h,m,x,w,b,E,I,M,L){const j=this.bucketLayerIDs[s];if(w&&!function(le,pe){for(let ze=0;ze<le.length;ze++)if(pe.indexOf(le[ze])>=0)return!0;return!1}(w,j))return;const W=this.sourceLayerCoder.decode(h),Y=this.vtLayers[W].feature(m);if(x.needGeometry){const le=Il(Y,!0);if(!x.filter(new Rr(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!x.filter(new Rr(this.tileID.overscaledZ),Y))return;const J=this.getId(Y,W);for(let le=0;le<j.length;le++){const pe=j[le];if(w&&w.indexOf(pe)<0)continue;const ze=E[pe];if(!ze)continue;let be={};J&&M&&(be=M.getState(ze.sourceLayer||"_geojsonTileLayer",J));const Ae=ge({},I[pe]);Ae.paint=yw(Ae.paint,ze.paint,Y,be,b),Ae.layout=yw(Ae.layout,ze.layout,Y,be,b);const Ve=!L||L(Y,ze,be);if(!Ve)continue;const et=new mw(Y,this.z,this.x,this.y,J);et.layer=Ae;let vt=n[pe];vt===void 0&&(vt=n[pe]=[]),vt.push({featureIndex:m,feature:et,intersectionZ:Ve})}}lookupSymbolFeatures(n,s,h,m,x,w,b,E){const I={};this.loadVTLayers();const M=yh(x);for(const L of n)this.loadMatchingFeature(I,h,m,L,M,w,b,E,s);return I}hasLayer(n){for(const s of this.bucketLayerIDs)for(const h of s)if(n===h)return!0;return!1}getId(n,s){let h=n.id;return this.promoteId&&(h=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof h=="boolean"&&(h=Number(h))),h}}function yw(o,n,s,h,m){return Fe(o,(x,w)=>{const b=n instanceof Sl?n.get(w):null;return b&&b.evaluate?b.evaluate(s,h,m):b})}function _w(o){let n=1/0,s=1/0,h=-1/0,m=-1/0;for(const x of o)n=Math.min(n,x.x),s=Math.min(s,x.y),h=Math.max(h,x.x),m=Math.max(m,x.y);return{minX:n,minY:s,maxX:h,maxY:m}}function RP(o,n){return n-o}function vw(o,n,s,h,m){const x=[];for(let w=0;w<o.length;w++){const b=o[w];let E;for(let I=0;I<b.length-1;I++){let M=b[I],L=b[I+1];M.x<n&&L.x<n||(M.x<n?M=new D(n,M.y+(n-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x<n&&(L=new D(n,M.y+(n-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y<s&&L.y<s||(M.y<s?M=new D(M.x+(s-M.y)/(L.y-M.y)*(L.x-M.x),s)._round():L.y<s&&(L=new D(M.x+(s-M.y)/(L.y-M.y)*(L.x-M.x),s)._round()),M.x>=h&&L.x>=h||(M.x>=h?M=new D(h,M.y+(h-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x>=h&&(L=new D(h,M.y+(h-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y>=m&&L.y>=m||(M.y>=m?M=new D(M.x+(m-M.y)/(L.y-M.y)*(L.x-M.x),m)._round():L.y>=m&&(L=new D(M.x+(m-M.y)/(L.y-M.y)*(L.x-M.x),m)._round()),E&&M.equals(E[E.length-1])||(E=[M],x.push(E)),E.push(L)))))}}return x}bt("FeatureIndex",gw,{omit:["rawTileData","sourceLayerCoder"]});class Ma extends D{constructor(n,s,h,m){super(n,s),this.angle=h,m!==void 0&&(this.segment=m)}clone(){return new Ma(this.x,this.y,this.angle,this.segment)}}function xw(o,n,s,h,m){if(n.segment===void 0||s===0)return!0;let x=n,w=n.segment+1,b=0;for(;b>-s/2;){if(w--,w<0)return!1;b-=o[w].dist(x),x=o[w]}b+=o[w].dist(o[w+1]),w++;const E=[];let I=0;for(;b<s/2;){const M=o[w],L=o[w+1];if(!L)return!1;let j=o[w-1].angleTo(M)-M.angleTo(L);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:j}),I+=j;b-E[0].distance>h;)I-=E.shift().angleDelta;if(I>m)return!1;w++,b+=M.dist(L)}return!0}function ww(o){let n=0;for(let s=0;s<o.length-1;s++)n+=o[s].dist(o[s+1]);return n}function bw(o,n,s){return o?.6*n*s:0}function Sw(o,n){return Math.max(o?o.right-o.left:0,n?n.right-n.left:0)}function LP(o,n,s,h,m,x){const w=bw(s,m,x),b=Sw(s,h)*x;let E=0;const I=ww(o)/2;for(let M=0;M<o.length-1;M++){const L=o[M],j=o[M+1],W=L.dist(j);if(E+W>I){const Y=(I-E)/W,J=ti.number(L.x,j.x,Y),le=ti.number(L.y,j.y,Y),pe=new Ma(J,le,j.angleTo(L),M);return pe._round(),!w||xw(o,pe,b,w,n)?pe:void 0}E+=W}}function FP(o,n,s,h,m,x,w,b,E){const I=bw(h,x,w),M=Sw(h,m),L=M*w,j=o[0].x===0||o[0].x===E||o[0].y===0||o[0].y===E;return n-L<n/4&&(n=L+n/4),Ew(o,j?n/2*b%n:(M/2+2*x)*w*b%n,n,I,s,L,j,!1,E)}function Ew(o,n,s,h,m,x,w,b,E){const I=x/2,M=ww(o);let L=0,j=n-s,W=[];for(let Y=0;Y<o.length-1;Y++){const J=o[Y],le=o[Y+1],pe=J.dist(le),ze=le.angleTo(J);for(;j+s<L+pe;){j+=s;const be=(j-L)/pe,Ae=ti.number(J.x,le.x,be),Ve=ti.number(J.y,le.y,be);if(Ae>=0&&Ae<E&&Ve>=0&&Ve<E&&j-I>=0&&j+I<=M){const et=new Ma(Ae,Ve,ze,Y);et._round(),h&&!xw(o,et,x,h,m)||W.push(et)}}L+=pe}return b||W.length||w||(W=Ew(o,L/2,s,h,m,x,w,!0,E)),W}bt("Anchor",Ma);const Ju=xi;function kw(o,n,s,h){const m=[],x=o.image,w=x.pixelRatio,b=x.paddedRect.w-2*Ju,E=x.paddedRect.h-2*Ju;let I={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const M=x.stretchX||[[0,b]],L=x.stretchY||[[0,E]],j=(qe,At)=>qe+At[1]-At[0],W=M.reduce(j,0),Y=L.reduce(j,0),J=b-W,le=E-Y;let pe=0,ze=W,be=0,Ae=Y,Ve=0,et=J,vt=0,Ft=le;if(x.content&&h){const qe=x.content,At=qe[2]-qe[0],It=qe[3]-qe[1];(x.textFitWidth||x.textFitHeight)&&(I=Jx(o)),pe=mf(M,0,qe[0]),be=mf(L,0,qe[1]),ze=mf(M,qe[0],qe[2]),Ae=mf(L,qe[1],qe[3]),Ve=qe[0]-pe,vt=qe[1]-be,et=At-ze,Ft=It-Ae}const gt=I.x1,pt=I.y1,Pt=I.x2-gt,Et=I.y2-pt,wt=(qe,At,It,Vt)=>{const Ir=gf(qe.stretch-pe,ze,Pt,gt),Cr=yf(qe.fixed-Ve,et,qe.stretch,W),vn=gf(At.stretch-be,Ae,Et,pt),Po=yf(At.fixed-vt,Ft,At.stretch,Y),Ln=gf(It.stretch-pe,ze,Pt,gt),xn=yf(It.fixed-Ve,et,It.stretch,W),oi=gf(Vt.stretch-be,Ae,Et,pt),si=yf(Vt.fixed-vt,Ft,Vt.stretch,Y),ai=new D(Ir,vn),tn=new D(Ln,vn),wn=new D(Ln,oi),Gn=new D(Ir,oi),Fn=new D(Cr/w,Po/w),li=new D(xn/w,si/w),On=n*Math.PI/180;if(On){const mr=Math.sin(On),Mr=Math.cos(On),Br=[Mr,-mr,mr,Mr];ai._matMult(Br),tn._matMult(Br),Gn._matMult(Br),wn._matMult(Br)}const ao=qe.stretch+qe.fixed,wi=At.stretch+At.fixed;return{tl:ai,tr:tn,bl:Gn,br:wn,tex:{x:x.paddedRect.x+Ju+ao,y:x.paddedRect.y+Ju+wi,w:It.stretch+It.fixed-ao,h:Vt.stretch+Vt.fixed-wi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fn,pixelOffsetBR:li,minFontScaleX:et/w/Pt,minFontScaleY:Ft/w/Et,isSDF:s}};if(h&&(x.stretchX||x.stretchY)){const qe=Tw(M,J,W),At=Tw(L,le,Y);for(let It=0;It<qe.length-1;It++){const Vt=qe[It],Ir=qe[It+1];for(let Cr=0;Cr<At.length-1;Cr++)m.push(wt(Vt,At[Cr],Ir,At[Cr+1]))}}else m.push(wt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return m}function mf(o,n,s){let h=0;for(const m of o)h+=Math.max(n,Math.min(s,m[1]))-Math.max(n,Math.min(s,m[0]));return h}function Tw(o,n,s){const h=[{fixed:-Ju,stretch:0}];for(const[m,x]of o){const w=h[h.length-1];h.push({fixed:m-w.stretch,stretch:w.stretch}),h.push({fixed:m-w.stretch,stretch:w.stretch+(x-m)})}return h.push({fixed:n+Ju,stretch:s}),h}function gf(o,n,s,h){return o/n*s+h}function yf(o,n,s,h){return o-n*s/h}class _f{constructor(n,s,h,m,x,w,b,E,I,M){var L;if(this.boxStartIndex=n.length,I){let j=w.top,W=w.bottom;const Y=w.collisionPadding;Y&&(j-=Y[1],W+=Y[3]);let J=W-j;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{const j=!((L=w.image)===null||L===void 0)&&L.content&&(w.image.textFitWidth||w.image.textFitHeight)?Jx(w):{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom};j.y1=j.y1*b-E[0],j.y2=j.y2*b+E[2],j.x1=j.x1*b-E[3],j.x2=j.x2*b+E[1];const W=w.collisionPadding;if(W&&(j.x1-=W[0]*b,j.y1-=W[1]*b,j.x2+=W[2]*b,j.y2+=W[3]*b),M){const Y=new D(j.x1,j.y1),J=new D(j.x2,j.y1),le=new D(j.x1,j.y2),pe=new D(j.x2,j.y2),ze=M*Math.PI/180;Y._rotate(ze),J._rotate(ze),le._rotate(ze),pe._rotate(ze),j.x1=Math.min(Y.x,J.x,le.x,pe.x),j.x2=Math.max(Y.x,J.x,le.x,pe.x),j.y1=Math.min(Y.y,J.y,le.y,pe.y),j.y2=Math.max(Y.y,J.y,le.y,pe.y)}n.emplaceBack(s.x,s.y,j.x1,j.y1,j.x2,j.y2,h,m,x)}this.boxEndIndex=n.length}}class OP{constructor(n=[],s=(h,m)=>h<m?-1:h>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:h}=this,m=s[n];for(;n>0;){const x=n-1>>1,w=s[x];if(h(m,w)>=0)break;s[n]=w,n=x}s[n]=m}_down(n){const{data:s,compare:h}=this,m=this.length>>1,x=s[n];for(;n<m;){let w=1+(n<<1);const b=w+1;if(b<this.length&&h(s[b],s[w])<0&&(w=b),h(s[w],x)>=0)break;s[n]=s[w],n=w}s[n]=x}}function BP(o,n=1,s=!1){let h=1/0,m=1/0,x=-1/0,w=-1/0;const b=o[0];for(let W=0;W<b.length;W++){const Y=b[W];(!W||Y.x<h)&&(h=Y.x),(!W||Y.y<m)&&(m=Y.y),(!W||Y.x>x)&&(x=Y.x),(!W||Y.y>w)&&(w=Y.y)}const E=Math.min(x-h,w-m);let I=E/2;const M=new OP([],NP);if(E===0)return new D(h,m);for(let W=h;W<x;W+=E)for(let Y=m;Y<w;Y+=E)M.push(new Qu(W+I,Y+I,I,o));let L=function(W){let Y=0,J=0,le=0;const pe=W[0];for(let ze=0,be=pe.length,Ae=be-1;ze<be;Ae=ze++){const Ve=pe[ze],et=pe[Ae],vt=Ve.x*et.y-et.x*Ve.y;J+=(Ve.x+et.x)*vt,le+=(Ve.y+et.y)*vt,Y+=3*vt}return new Qu(J/Y,le/Y,0,W)}(o),j=M.length;for(;M.length;){const W=M.pop();(W.d>L.d||!L.d)&&(L=W,s&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,j)),W.max-L.d<=n||(I=W.h/2,M.push(new Qu(W.p.x-I,W.p.y-I,I,o)),M.push(new Qu(W.p.x+I,W.p.y-I,I,o)),M.push(new Qu(W.p.x-I,W.p.y+I,I,o)),M.push(new Qu(W.p.x+I,W.p.y+I,I,o)),j+=4)}return s&&(console.log(`num probes: ${j}`),console.log(`best distance: ${L.d}`)),L.p}function NP(o,n){return n.max-o.max}function Qu(o,n,s,h){this.p=new D(o,n),this.h=s,this.d=function(m,x){let w=!1,b=1/0;for(let E=0;E<x.length;E++){const I=x[E];for(let M=0,L=I.length,j=L-1;M<L;j=M++){const W=I[M],Y=I[j];W.y>m.y!=Y.y>m.y&&m.x<(Y.x-W.x)*(m.y-W.y)/(Y.y-W.y)+W.x&&(w=!w),b=Math.min(b,ux(m,W,Y))}}return(w?1:-1)*Math.sqrt(b)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var Rn;y.aq=void 0,(Rn=y.aq||(y.aq={}))[Rn.center=1]="center",Rn[Rn.left=2]="left",Rn[Rn.right=3]="right",Rn[Rn.top=4]="top",Rn[Rn.bottom=5]="bottom",Rn[Rn["top-left"]=6]="top-left",Rn[Rn["top-right"]=7]="top-right",Rn[Rn["bottom-left"]=8]="bottom-left",Rn[Rn["bottom-right"]=9]="bottom-right";const za=7,e_=Number.POSITIVE_INFINITY;function Cw(o,n){return n[1]!==e_?function(s,h,m){let x=0,w=0;switch(h=Math.abs(h),m=Math.abs(m),s){case"top-right":case"top-left":case"top":w=m-za;break;case"bottom-right":case"bottom-left":case"bottom":w=-m+za}switch(s){case"top-right":case"bottom-right":case"right":x=-h;break;case"top-left":case"bottom-left":case"left":x=h}return[x,w]}(o,n[0],n[1]):function(s,h){let m=0,x=0;h<0&&(h=0);const w=h/Math.SQRT2;switch(s){case"top-right":case"top-left":x=w-za;break;case"bottom-right":case"bottom-left":x=-w+za;break;case"bottom":x=-h+za;break;case"top":x=h-za}switch(s){case"top-right":case"bottom-right":m=-w;break;case"top-left":case"bottom-left":m=w;break;case"left":m=h;break;case"right":m=-h}return[m,x]}(o,n[0])}function Iw(o,n,s){var h;const m=o.layout,x=(h=m.get("text-variable-anchor-offset"))===null||h===void 0?void 0:h.evaluate(n,{},s);if(x){const b=x.values,E=[];for(let I=0;I<b.length;I+=2){const M=E[I]=b[I],L=b[I+1].map(j=>j*gn);M.startsWith("top")?L[1]-=za:M.startsWith("bottom")&&(L[1]+=za),E[I+1]=L}return new Ri(E)}const w=m.get("text-variable-anchor");if(w){let b;b=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(n,{},s)*gn,e_]:m.get("text-offset").evaluate(n,{},s).map(I=>I*gn);const E=[];for(const I of w)E.push(I,Cw(I,b));return new Ri(E)}return null}function t_(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $P(o,n,s,h,m,x,w,b,E,I,M){let L=x.textMaxSize.evaluate(n,{});L===void 0&&(L=w);const j=o.layers[0].layout,W=j.get("icon-offset").evaluate(n,{},M),Y=Aw(s.horizontal),J=w/24,le=o.tilePixelRatio*J,pe=o.tilePixelRatio*L/24,ze=o.tilePixelRatio*b,be=o.tilePixelRatio*j.get("symbol-spacing"),Ae=j.get("text-padding")*o.tilePixelRatio,Ve=function(qe,At,It,Vt=1){const Ir=qe.get("icon-padding").evaluate(At,{},It),Cr=Ir&&Ir.values;return[Cr[0]*Vt,Cr[1]*Vt,Cr[2]*Vt,Cr[3]*Vt]}(j,n,M,o.tilePixelRatio),et=j.get("text-max-angle")/180*Math.PI,vt=j.get("text-rotation-alignment")!=="viewport"&&j.get("symbol-placement")!=="point",Ft=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",gt=j.get("symbol-placement"),pt=be/2,Pt=j.get("icon-text-fit");let Et;h&&Pt!=="none"&&(o.allowVerticalPlacement&&s.vertical&&(Et=Qx(h,s.vertical,Pt,j.get("icon-text-fit-padding"),W,J)),Y&&(h=Qx(h,Y,Pt,j.get("icon-text-fit-padding"),W,J)));const wt=(qe,At)=>{At.x<0||At.x>=fn||At.y<0||At.y>=fn||function(It,Vt,Ir,Cr,vn,Po,Ln,xn,oi,si,ai,tn,wn,Gn,Fn,li,On,ao,wi,mr,Mr,Br,ji,Wr,ec){const us=It.addToLineVertexArray(Vt,Ir);let cs,Ao,lo,Tn,Os=0,td=0,Rw=0,Lw=0,u_=-1,c_=-1;const Bs={};let Fw=$u("");if(It.allowVerticalPlacement&&Cr.vertical){const Zn=xn.layout.get("text-rotate").evaluate(Mr,{},Wr)+90;lo=new _f(oi,Vt,si,ai,tn,Cr.vertical,wn,Gn,Fn,Zn),Ln&&(Tn=new _f(oi,Vt,si,ai,tn,Ln,On,ao,Fn,Zn))}if(vn){const Zn=xn.layout.get("icon-rotate").evaluate(Mr,{}),uo=xn.layout.get("icon-text-fit")!=="none",Al=kw(vn,Zn,ji,uo),Go=Ln?kw(Ln,Zn,ji,uo):void 0;Ao=new _f(oi,Vt,si,ai,tn,vn,On,ao,!1,Zn),Os=4*Al.length;const Ml=It.iconSizeData;let hs=null;Ml.kind==="source"?(hs=[ls*xn.layout.get("icon-size").evaluate(Mr,{})],hs[0]>Pa&&je(`${It.layerIds[0]}: Value for "icon-size" is >= ${Kh}. Reduce your "icon-size".`)):Ml.kind==="composite"&&(hs=[ls*Br.compositeIconSizes[0].evaluate(Mr,{},Wr),ls*Br.compositeIconSizes[1].evaluate(Mr,{},Wr)],(hs[0]>Pa||hs[1]>Pa)&&je(`${It.layerIds[0]}: Value for "icon-size" is >= ${Kh}. Reduce your "icon-size".`)),It.addSymbols(It.icon,Al,hs,mr,wi,Mr,y.ah.none,Vt,us.lineStartIndex,us.lineLength,-1,Wr),u_=It.icon.placedSymbolArray.length-1,Go&&(td=4*Go.length,It.addSymbols(It.icon,Go,hs,mr,wi,Mr,y.ah.vertical,Vt,us.lineStartIndex,us.lineLength,-1,Wr),c_=It.icon.placedSymbolArray.length-1)}const Ow=Object.keys(Cr.horizontal);for(const Zn of Ow){const uo=Cr.horizontal[Zn];if(!cs){Fw=$u(uo.text);const Go=xn.layout.get("text-rotate").evaluate(Mr,{},Wr);cs=new _f(oi,Vt,si,ai,tn,uo,wn,Gn,Fn,Go)}const Al=uo.positionedLines.length===1;if(Rw+=Pw(It,Vt,uo,Po,xn,Fn,Mr,li,us,Cr.vertical?y.ah.horizontal:y.ah.horizontalOnly,Al?Ow:[Zn],Bs,u_,Br,Wr),Al)break}Cr.vertical&&(Lw+=Pw(It,Vt,Cr.vertical,Po,xn,Fn,Mr,li,us,y.ah.vertical,["vertical"],Bs,c_,Br,Wr));const VP=cs?cs.boxStartIndex:It.collisionBoxArray.length,HP=cs?cs.boxEndIndex:It.collisionBoxArray.length,GP=lo?lo.boxStartIndex:It.collisionBoxArray.length,ZP=lo?lo.boxEndIndex:It.collisionBoxArray.length,WP=Ao?Ao.boxStartIndex:It.collisionBoxArray.length,qP=Ao?Ao.boxEndIndex:It.collisionBoxArray.length,XP=Tn?Tn.boxStartIndex:It.collisionBoxArray.length,KP=Tn?Tn.boxEndIndex:It.collisionBoxArray.length;let Ho=-1;const xf=(Zn,uo)=>Zn&&Zn.circleDiameter?Math.max(Zn.circleDiameter,uo):uo;Ho=xf(cs,Ho),Ho=xf(lo,Ho),Ho=xf(Ao,Ho),Ho=xf(Tn,Ho);const Bw=Ho>-1?1:0;Bw&&(Ho*=ec/gn),It.glyphOffsetArray.length>=Yu.MAX_GLYPHS&&je("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mr.sortKey!==void 0&&It.addToSortKeyRanges(It.symbolInstances.length,Mr.sortKey);const YP=Iw(xn,Mr,Wr),[JP,QP]=function(Zn,uo){const Al=Zn.length,Go=uo==null?void 0:uo.values;if((Go==null?void 0:Go.length)>0)for(let Ml=0;Ml<Go.length;Ml+=2){const hs=Go[Ml+1];Zn.emplaceBack(y.aq[Go[Ml]],hs[0],hs[1])}return[Al,Zn.length]}(It.textAnchorOffsets,YP);It.symbolInstances.emplaceBack(Vt.x,Vt.y,Bs.right>=0?Bs.right:-1,Bs.center>=0?Bs.center:-1,Bs.left>=0?Bs.left:-1,Bs.vertical||-1,u_,c_,Fw,VP,HP,GP,ZP,WP,qP,XP,KP,si,Rw,Lw,Os,td,Bw,0,wn,Ho,JP,QP)}(o,At,qe,s,h,m,Et,o.layers[0],o.collisionBoxArray,n.index,n.sourceLayerIndex,o.index,le,[Ae,Ae,Ae,Ae],vt,E,ze,Ve,Ft,W,n,x,I,M,w)};if(gt==="line")for(const qe of vw(n.geometry,0,0,fn,fn)){const At=FP(qe,be,et,s.vertical||Y,h,24,pe,o.overscaling,fn);for(const It of At)Y&&jP(o,Y.text,pt,It)||wt(qe,It)}else if(gt==="line-center"){for(const qe of n.geometry)if(qe.length>1){const At=LP(qe,et,s.vertical||Y,h,24,pe);At&&wt(qe,At)}}else if(n.type==="Polygon")for(const qe of gu(n.geometry,0)){const At=BP(qe,16);wt(qe[0],new Ma(At.x,At.y,0))}else if(n.type==="LineString")for(const qe of n.geometry)wt(qe,new Ma(qe[0].x,qe[0].y,0));else if(n.type==="Point")for(const qe of n.geometry)for(const At of qe)wt([At],new Ma(At.x,At.y,0))}function Pw(o,n,s,h,m,x,w,b,E,I,M,L,j,W,Y){const J=function(ze,be,Ae,Ve,et,vt,Ft,gt){const pt=Ve.layout.get("text-rotate").evaluate(vt,{})*Math.PI/180,Pt=[];for(const Et of be.positionedLines)for(const wt of Et.positionedGlyphs){if(!wt.rect)continue;const qe=wt.rect||{};let At=Gx+1,It=!0,Vt=1,Ir=0;const Cr=(et||gt)&&wt.vertical,vn=wt.metrics.advance*wt.scale/2;if(gt&&be.verticalizable&&(Ir=Et.lineOffset/2-(wt.imageName?-(gn-wt.metrics.width*wt.scale)/2:(wt.scale-1)*gn)),wt.imageName){const mr=Ft[wt.imageName];It=mr.sdf,Vt=mr.pixelRatio,At=xi/Vt}const Po=et?[wt.x+vn,wt.y]:[0,0];let Ln=et?[0,0]:[wt.x+vn+Ae[0],wt.y+Ae[1]-Ir],xn=[0,0];Cr&&(xn=Ln,Ln=[0,0]);const oi=wt.metrics.isDoubleResolution?2:1,si=(wt.metrics.left-At)*wt.scale-vn+Ln[0],ai=(-wt.metrics.top-At)*wt.scale+Ln[1],tn=si+qe.w/oi*wt.scale/Vt,wn=ai+qe.h/oi*wt.scale/Vt,Gn=new D(si,ai),Fn=new D(tn,ai),li=new D(si,wn),On=new D(tn,wn);if(Cr){const mr=new D(-vn,vn-qh),Mr=-Math.PI/2,Br=gn/2-vn,ji=new D(5-qh-Br,-(wt.imageName?Br:0)),Wr=new D(...xn);Gn._rotateAround(Mr,mr)._add(ji)._add(Wr),Fn._rotateAround(Mr,mr)._add(ji)._add(Wr),li._rotateAround(Mr,mr)._add(ji)._add(Wr),On._rotateAround(Mr,mr)._add(ji)._add(Wr)}if(pt){const mr=Math.sin(pt),Mr=Math.cos(pt),Br=[Mr,-mr,mr,Mr];Gn._matMult(Br),Fn._matMult(Br),li._matMult(Br),On._matMult(Br)}const ao=new D(0,0),wi=new D(0,0);Pt.push({tl:Gn,tr:Fn,bl:li,br:On,tex:qe,writingMode:be.writingMode,glyphOffset:Po,sectionIndex:wt.sectionIndex,isSDF:It,pixelOffsetTL:ao,pixelOffsetBR:wi,minFontScaleX:0,minFontScaleY:0})}return Pt}(0,s,b,m,x,w,h,o.allowVerticalPlacement),le=o.textSizeData;let pe=null;le.kind==="source"?(pe=[ls*m.layout.get("text-size").evaluate(w,{})],pe[0]>Pa&&je(`${o.layerIds[0]}: Value for "text-size" is >= ${Kh}. Reduce your "text-size".`)):le.kind==="composite"&&(pe=[ls*W.compositeTextSizes[0].evaluate(w,{},Y),ls*W.compositeTextSizes[1].evaluate(w,{},Y)],(pe[0]>Pa||pe[1]>Pa)&&je(`${o.layerIds[0]}: Value for "text-size" is >= ${Kh}. Reduce your "text-size".`)),o.addSymbols(o.text,J,pe,b,x,w,I,n,E.lineStartIndex,E.lineLength,j,Y);for(const ze of M)L[ze]=o.text.placedSymbolArray.length-1;return 4*J.length}function Aw(o){for(const n in o)return o[n];return null}function jP(o,n,s,h){const m=o.compareText;if(n in m){const x=m[n];for(let w=x.length-1;w>=0;w--)if(h.dist(x[w])<s)return!0}else m[n]=[];return m[n].push(h),!1}const Mw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class r_{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,h]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const x=Mw[15&h];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(n,2,1),[b]=new Uint32Array(n,4,1);return new r_(b,w,x,n)}constructor(n,s=64,h=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=h,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const x=Mw.indexOf(this.ArrayType),w=2*n*this.ArrayType.BYTES_PER_ELEMENT,b=n*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+E,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+w+b+E),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+E,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=n,this.coords[this._pos++]=s,h}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return n_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:b}=this,E=[0,x.length-1,0],I=[];for(;E.length;){const M=E.pop()||0,L=E.pop()||0,j=E.pop()||0;if(L-j<=b){for(let le=j;le<=L;le++){const pe=w[2*le],ze=w[2*le+1];pe>=n&&pe<=h&&ze>=s&&ze<=m&&I.push(x[le])}continue}const W=j+L>>1,Y=w[2*W],J=w[2*W+1];Y>=n&&Y<=h&&J>=s&&J<=m&&I.push(x[W]),(M===0?n<=Y:s<=J)&&(E.push(j),E.push(W-1),E.push(1-M)),(M===0?h>=Y:m>=J)&&(E.push(W+1),E.push(L),E.push(1-M))}return I}within(n,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:w}=this,b=[0,m.length-1,0],E=[],I=h*h;for(;b.length;){const M=b.pop()||0,L=b.pop()||0,j=b.pop()||0;if(L-j<=w){for(let le=j;le<=L;le++)Dw(x[2*le],x[2*le+1],n,s)<=I&&E.push(m[le]);continue}const W=j+L>>1,Y=x[2*W],J=x[2*W+1];Dw(Y,J,n,s)<=I&&E.push(m[W]),(M===0?n-h<=Y:s-h<=J)&&(b.push(j),b.push(W-1),b.push(1-M)),(M===0?n+h>=Y:s+h>=J)&&(b.push(W+1),b.push(L),b.push(1-M))}return E}}function n_(o,n,s,h,m,x){if(m-h<=s)return;const w=h+m>>1;zw(o,n,w,h,m,x),n_(o,n,s,h,w-1,1-x),n_(o,n,s,w+1,m,1-x)}function zw(o,n,s,h,m,x){for(;m>h;){if(m-h>600){const I=m-h+1,M=s-h+1,L=Math.log(I),j=.5*Math.exp(2*L/3),W=.5*Math.sqrt(L*j*(I-j)/I)*(M-I/2<0?-1:1);zw(o,n,s,Math.max(h,Math.floor(s-M*j/I+W)),Math.min(m,Math.floor(s+(I-M)*j/I+W)),x)}const w=n[2*s+x];let b=h,E=m;for(Qh(o,n,h,s),n[2*m+x]>w&&Qh(o,n,h,m);b<E;){for(Qh(o,n,b,E),b++,E--;n[2*b+x]<w;)b++;for(;n[2*E+x]>w;)E--}n[2*h+x]===w?Qh(o,n,h,E):(E++,Qh(o,n,E,m)),E<=s&&(h=E+1),s<=E&&(m=E-1)}}function Qh(o,n,s,h){i_(o,s,h),i_(n,2*s,2*h),i_(n,2*s+1,2*h+1)}function i_(o,n,s){const h=o[n];o[n]=o[s],o[s]=h}function Dw(o,n,s,h){const m=o-s,x=n-h;return m*m+x*x}var o_;y.bg=void 0,(o_=y.bg||(y.bg={})).create="create",o_.load="load",o_.fullLoad="fullLoad";let vf=null,ed=[];const s_=1e3/60,a_="loadTime",l_="fullLoadTime",UP={mark(o){performance.mark(o)},frame(o){const n=o;vf!=null&&ed.push(n-vf),vf=n},clearMetrics(){vf=null,ed=[],performance.clearMeasures(a_),performance.clearMeasures(l_);for(const o in y.bg)performance.clearMarks(y.bg[o])},getPerformanceMetrics(){performance.measure(a_,y.bg.create,y.bg.load),performance.measure(l_,y.bg.create,y.bg.fullLoad);const o=performance.getEntriesByName(a_)[0].duration,n=performance.getEntriesByName(l_)[0].duration,s=ed.length,h=1/(ed.reduce((x,w)=>x+w,0)/s/1e3),m=ed.filter(x=>x>s_).reduce((x,w)=>x+(w-s_)/s_,0);return{loadTime:o,fullLoadTime:n,fps:h,percentDroppedFrames:m/(s+m)*100,totalFrames:s}}};y.$=class extends O{},y.A=Gu,y.B=gy,y.C=function(o){if(_t==null){const n=o.navigator?o.navigator.userAgent:null;_t=!!o.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return _t},y.D=Tt,y.E=Ue,y.F=class{constructor(o,n){this.target=o,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new DP(()=>this.process()),this.subscription=function(s,h,m,x){return s.addEventListener(h,m,!1),{unsubscribe:()=>{s.removeEventListener(h,m,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=Re(self)?o:window}registerMessageHandler(o,n){this.messageHandlers[o]=n}sendAsync(o,n){return new Promise((s,h)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:s,reject:h},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const b={id:m,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const x=[],w=Object.assign(Object.assign({},o),{id:m,sourceMapId:this.mapId,origin:location.origin,data:ya(o.data,x)});this.target.postMessage(w,{transfer:x})})}receive(o){const n=o.data,s=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[s];const h=this.abortControllers[s];return delete this.abortControllers[s],void(h&&h.abort())}if(Re(self)||n.mustQueue)return this.tasks[s]=n,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,n)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),n=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(o,n)}processTask(o,n){return c(this,void 0,void 0,function*(){if(n.type==="<response>"){const m=this.resolveRejects[o];return delete this.resolveRejects[o],m?void(n.error?m.reject(_a(n.error)):m.resolve(_a(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=_a(n.data),h=new AbortController;this.abortControllers[o]=h;try{const m=yield this.messageHandlers[n.type](n.sourceMapId,s,h);this.completeTask(o,null,m)}catch(m){this.completeTask(o,m)}})}completeTask(o,n,s){const h=[];delete this.abortControllers[o];const m={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?ya(n):null,data:ya(s,h)};this.target.postMessage(m,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},y.G=qt,y.H=function(){var o=new Gu(16);return Gu!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},y.I=Vy,y.J=function(o,n,s){var h,m,x,w,b,E,I,M,L,j,W,Y,J=s[0],le=s[1],pe=s[2];return n===o?(o[12]=n[0]*J+n[4]*le+n[8]*pe+n[12],o[13]=n[1]*J+n[5]*le+n[9]*pe+n[13],o[14]=n[2]*J+n[6]*le+n[10]*pe+n[14],o[15]=n[3]*J+n[7]*le+n[11]*pe+n[15]):(m=n[1],x=n[2],w=n[3],b=n[4],E=n[5],I=n[6],M=n[7],L=n[8],j=n[9],W=n[10],Y=n[11],o[0]=h=n[0],o[1]=m,o[2]=x,o[3]=w,o[4]=b,o[5]=E,o[6]=I,o[7]=M,o[8]=L,o[9]=j,o[10]=W,o[11]=Y,o[12]=h*J+b*le+L*pe+n[12],o[13]=m*J+E*le+j*pe+n[13],o[14]=x*J+I*le+W*pe+n[14],o[15]=w*J+M*le+Y*pe+n[15]),o},y.K=function(o,n,s){var h=s[0],m=s[1],x=s[2];return o[0]=n[0]*h,o[1]=n[1]*h,o[2]=n[2]*h,o[3]=n[3]*h,o[4]=n[4]*m,o[5]=n[5]*m,o[6]=n[6]*m,o[7]=n[7]*m,o[8]=n[8]*x,o[9]=n[9]*x,o[10]=n[10]*x,o[11]=n[11]*x,o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15],o},y.L=px,y.M=function(o,n){const s={};for(let h=0;h<n.length;h++){const m=n[h];m in o&&(s[m]=o[m])}return s},y.N=Aa,y.O=lw,y.P=D,y.Q=uw,y.R=oo,y.S=so,y.T=Lu,y.U=F,y.V=$,y.W=Le,y.X=fn,y.Y=S,y.Z=Yh,y._=c,y.a=nt,y.a$=function(o,n){var s=o[0],h=o[1],m=o[2],x=o[3],w=o[4],b=o[5],E=o[6],I=o[7],M=o[8],L=o[9],j=o[10],W=o[11],Y=o[12],J=o[13],le=o[14],pe=o[15],ze=n[0],be=n[1],Ae=n[2],Ve=n[3],et=n[4],vt=n[5],Ft=n[6],gt=n[7],pt=n[8],Pt=n[9],Et=n[10],wt=n[11],qe=n[12],At=n[13],It=n[14],Vt=n[15];return Math.abs(s-ze)<=ii*Math.max(1,Math.abs(s),Math.abs(ze))&&Math.abs(h-be)<=ii*Math.max(1,Math.abs(h),Math.abs(be))&&Math.abs(m-Ae)<=ii*Math.max(1,Math.abs(m),Math.abs(Ae))&&Math.abs(x-Ve)<=ii*Math.max(1,Math.abs(x),Math.abs(Ve))&&Math.abs(w-et)<=ii*Math.max(1,Math.abs(w),Math.abs(et))&&Math.abs(b-vt)<=ii*Math.max(1,Math.abs(b),Math.abs(vt))&&Math.abs(E-Ft)<=ii*Math.max(1,Math.abs(E),Math.abs(Ft))&&Math.abs(I-gt)<=ii*Math.max(1,Math.abs(I),Math.abs(gt))&&Math.abs(M-pt)<=ii*Math.max(1,Math.abs(M),Math.abs(pt))&&Math.abs(L-Pt)<=ii*Math.max(1,Math.abs(L),Math.abs(Pt))&&Math.abs(j-Et)<=ii*Math.max(1,Math.abs(j),Math.abs(Et))&&Math.abs(W-wt)<=ii*Math.max(1,Math.abs(W),Math.abs(wt))&&Math.abs(Y-qe)<=ii*Math.max(1,Math.abs(Y),Math.abs(qe))&&Math.abs(J-At)<=ii*Math.max(1,Math.abs(J),Math.abs(At))&&Math.abs(le-It)<=ii*Math.max(1,Math.abs(le),Math.abs(It))&&Math.abs(pe-Vt)<=ii*Math.max(1,Math.abs(pe),Math.abs(Vt))},y.a0=or,y.a1=Qy,y.a2=We,y.a3=o=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(s=>{n.onloadstart=()=>{s(n)};for(const h of o){const m=window.document.createElement("source");pr(h)||(n.crossOrigin="Anonymous"),m.src=h,n.appendChild(m)}})},y.a4=function(){return Oe++},y.a5=yt,y.a6=Yu,y.a7=yh,y.a8=Il,y.a9=mw,y.aA=function(o){if(o.type==="custom")return new zP(o);switch(o.type){case"background":return new PP(o);case"circle":return new gI(o);case"fill":return new DI(o);case"fill-extrusion":return new qI(o);case"heatmap":return new _I(o);case"hillshade":return new xI(o);case"line":return new rP(o);case"raster":return new MP(o);case"symbol":return new ff(o)}},y.aB=it,y.aC=function(o,n){if(!o)return[{command:"setStyle",args:[n]}];let s=[];try{if(!ke(o.version,n.version))return[{command:"setStyle",args:[n]}];ke(o.center,n.center)||s.push({command:"setCenter",args:[n.center]}),ke(o.zoom,n.zoom)||s.push({command:"setZoom",args:[n.zoom]}),ke(o.bearing,n.bearing)||s.push({command:"setBearing",args:[n.bearing]}),ke(o.pitch,n.pitch)||s.push({command:"setPitch",args:[n.pitch]}),ke(o.sprite,n.sprite)||s.push({command:"setSprite",args:[n.sprite]}),ke(o.glyphs,n.glyphs)||s.push({command:"setGlyphs",args:[n.glyphs]}),ke(o.transition,n.transition)||s.push({command:"setTransition",args:[n.transition]}),ke(o.light,n.light)||s.push({command:"setLight",args:[n.light]}),ke(o.terrain,n.terrain)||s.push({command:"setTerrain",args:[n.terrain]}),ke(o.sky,n.sky)||s.push({command:"setSky",args:[n.sky]}),ke(o.projection,n.projection)||s.push({command:"setProjection",args:[n.projection]});const h={},m=[];(function(w,b,E,I){let M;for(M in b=b||{},w=w||{})Object.prototype.hasOwnProperty.call(w,M)&&(Object.prototype.hasOwnProperty.call(b,M)||Ne(M,E,I));for(M in b)Object.prototype.hasOwnProperty.call(b,M)&&(Object.prototype.hasOwnProperty.call(w,M)?ke(w[M],b[M])||(w[M].type==="geojson"&&b[M].type==="geojson"&&St(w,b,M)?Ze(E,{command:"setGeoJSONSourceData",args:[M,b[M].data]}):st(M,b,E,I)):tt(M,b,E))})(o.sources,n.sources,m,h);const x=[];o.layers&&o.layers.forEach(w=>{"source"in w&&h[w.source]?s.push({command:"removeLayer",args:[w.id]}):x.push(w)}),s=s.concat(m),function(w,b,E){b=b||[];const I=(w=w||[]).map(Lt),M=b.map(Lt),L=w.reduce(vr,{}),j=b.reduce(vr,{}),W=I.slice(),Y=Object.create(null);let J,le,pe,ze,be;for(let Ae=0,Ve=0;Ae<I.length;Ae++)J=I[Ae],Object.prototype.hasOwnProperty.call(j,J)?Ve++:(Ze(E,{command:"removeLayer",args:[J]}),W.splice(W.indexOf(J,Ve),1));for(let Ae=0,Ve=0;Ae<M.length;Ae++)J=M[M.length-1-Ae],W[W.length-1-Ae]!==J&&(Object.prototype.hasOwnProperty.call(L,J)?(Ze(E,{command:"removeLayer",args:[J]}),W.splice(W.lastIndexOf(J,W.length-Ve),1)):Ve++,ze=W[W.length-Ae],Ze(E,{command:"addLayer",args:[j[J],ze]}),W.splice(W.length-Ae,0,J),Y[J]=!0);for(let Ae=0;Ae<M.length;Ae++)if(J=M[Ae],le=L[J],pe=j[J],!Y[J]&&!ke(le,pe))if(ke(le.source,pe.source)&&ke(le["source-layer"],pe["source-layer"])&&ke(le.type,pe.type)){for(be in at(le.layout,pe.layout,E,J,null,"setLayoutProperty"),at(le.paint,pe.paint,E,J,null,"setPaintProperty"),ke(le.filter,pe.filter)||Ze(E,{command:"setFilter",args:[J,pe.filter]}),ke(le.minzoom,pe.minzoom)&&ke(le.maxzoom,pe.maxzoom)||Ze(E,{command:"setLayerZoomRange",args:[J,pe.minzoom,pe.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,be)&&be!=="layout"&&be!=="paint"&&be!=="filter"&&be!=="metadata"&&be!=="minzoom"&&be!=="maxzoom"&&(be.indexOf("paint.")===0?at(le[be],pe[be],E,J,be.slice(6),"setPaintProperty"):ke(le[be],pe[be])||Ze(E,{command:"setLayerProperty",args:[J,be,pe[be]]}));for(be in pe)Object.prototype.hasOwnProperty.call(pe,be)&&!Object.prototype.hasOwnProperty.call(le,be)&&be!=="layout"&&be!=="paint"&&be!=="filter"&&be!=="metadata"&&be!=="minzoom"&&be!=="maxzoom"&&(be.indexOf("paint.")===0?at(le[be],pe[be],E,J,be.slice(6),"setPaintProperty"):ke(le[be],pe[be])||Ze(E,{command:"setLayerProperty",args:[J,be,pe[be]]}))}else Ze(E,{command:"removeLayer",args:[J]}),ze=W[W.lastIndexOf(J)+1],Ze(E,{command:"addLayer",args:[pe,ze]})}(x,n.layers,s)}catch(h){console.warn("Unable to compute style diff:",h),s=[{command:"setStyle",args:[n]}]}return s},y.aD=function(o){const n=[],s=o.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),o.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},y.aE=function o(n,s){if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(let h=0;h<n.length;h++)if(!o(n[h],s[h]))return!1;return!0}if(typeof n=="object"&&n!==null&&s!==null){if(typeof s!="object"||Object.keys(n).length!==Object.keys(s).length)return!1;for(const h in n)if(!o(n[h],s[h]))return!1;return!0}return n===s},y.aF=Fe,y.aG=Ge,y.aH=class extends kl{constructor(o,n){super(o,n),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},y.aI=ef,y.aJ=class extends kl{constructor(o,n){super(o,n),this.current=lI}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let n=1;n<16;n++)if(o[n]!==this.current[n]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},y.aK=rx,y.aL=nx,y.aM=Er,y.aN=class extends kl{constructor(o,n){super(o,n),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},y.aO=class extends kl{constructor(o,n){super(o,n),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},y.aP=function(o,n,s,h,m,x,w){var b=1/(n-s),E=1/(h-m),I=1/(x-w);return o[0]=-2*b,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*E,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*I,o[11]=0,o[12]=(n+s)*b,o[13]=(m+h)*E,o[14]=(w+x)*I,o[15]=1,o},y.aQ=mI,y.aR=class extends Ce{},y.aS=sP,y.aT=class extends De{},y.aU=My,y.aV=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},y.aW=_x,y.aX=zn,y.aY=io,y.aZ=class extends Ct{},y.a_=function(o,n){return o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2]&&o[3]===n[3]&&o[4]===n[4]&&o[5]===n[5]&&o[6]===n[6]&&o[7]===n[7]&&o[8]===n[8]&&o[9]===n[9]&&o[10]===n[10]&&o[11]===n[11]&&o[12]===n[12]&&o[13]===n[13]&&o[14]===n[14]&&o[15]===n[15]},y.aa=function(o){const n={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,h,m,x)=>{const w=m||x;return n[h]=!w||w.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n},y.ab=function(o,n){const s=[];for(const h in o)h in n||s.push(h);return s},y.ac=se,y.ad=function(o,n,s){var h=Math.sin(s),m=Math.cos(s),x=n[0],w=n[1],b=n[2],E=n[3],I=n[4],M=n[5],L=n[6],j=n[7];return n!==o&&(o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=n[11],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o[0]=x*m+I*h,o[1]=w*m+M*h,o[2]=b*m+L*h,o[3]=E*m+j*h,o[4]=I*m-x*h,o[5]=M*m-w*h,o[6]=L*m-b*h,o[7]=j*m-E*h,o},y.ae=function(o){var n=new Gu(16);return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=o[6],n[7]=o[7],n[8]=o[8],n[9]=o[9],n[10]=o[10],n[11]=o[11],n[12]=o[12],n[13]=o[13],n[14]=o[14],n[15]=o[15],n},y.af=of,y.ag=function(o,n){let s=0,h=0;if(o.kind==="constant")h=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:w}=o,b=m?se(ri.interpolationFactor(m,n,x,w),0,1):0;o.kind==="camera"?h=ti.number(o.minSize,o.maxSize,b):s=b}return{uSizeT:s,uSize:h}},y.ai=function(o,{uSize:n,uSizeT:s},{lowerSize:h,upperSize:m}){return o.kind==="source"?h/ls:o.kind==="composite"?ti.number(h/ls,m/ls,s):n},y.aj=Wy,y.ak=function(o,n,s,h){const m=n.y-o.y,x=n.x-o.x,w=h.y-s.y,b=h.x-s.x,E=w*x-b*m;if(E===0)return null;const I=(b*(o.y-s.y)-w*(o.x-s.x))/E;return new D(o.x+I*x,o.y+I*m)},y.al=vw,y.am=ax,y.an=Iy,y.ao=function(o){let n=1/0,s=1/0,h=-1/0,m=-1/0;for(const x of o)n=Math.min(n,x.x),s=Math.min(s,x.y),h=Math.max(h,x.x),m=Math.max(m,x.y);return[n,s,h,m]},y.ap=gn,y.ar=Zy,y.as=function(o,n){var s=n[0],h=n[1],m=n[2],x=n[3],w=n[4],b=n[5],E=n[6],I=n[7],M=n[8],L=n[9],j=n[10],W=n[11],Y=n[12],J=n[13],le=n[14],pe=n[15],ze=s*b-h*w,be=s*E-m*w,Ae=s*I-x*w,Ve=h*E-m*b,et=h*I-x*b,vt=m*I-x*E,Ft=M*J-L*Y,gt=M*le-j*Y,pt=M*pe-W*Y,Pt=L*le-j*J,Et=L*pe-W*J,wt=j*pe-W*le,qe=ze*wt-be*Et+Ae*Pt+Ve*pt-et*gt+vt*Ft;return qe?(o[0]=(b*wt-E*Et+I*Pt)*(qe=1/qe),o[1]=(m*Et-h*wt-x*Pt)*qe,o[2]=(J*vt-le*et+pe*Ve)*qe,o[3]=(j*et-L*vt-W*Ve)*qe,o[4]=(E*pt-w*wt-I*gt)*qe,o[5]=(s*wt-m*pt+x*gt)*qe,o[6]=(le*Ae-Y*vt-pe*be)*qe,o[7]=(M*vt-j*Ae+W*be)*qe,o[8]=(w*Et-b*pt+I*Ft)*qe,o[9]=(h*pt-s*Et-x*Ft)*qe,o[10]=(Y*et-J*Ae+pe*ze)*qe,o[11]=(L*Ae-M*et-W*ze)*qe,o[12]=(b*gt-w*Pt-E*Ft)*qe,o[13]=(s*Pt-h*gt+m*Ft)*qe,o[14]=(J*be-Y*Ve-le*ze)*qe,o[15]=(M*Ve-L*be+j*ze)*qe,o):null},y.at=t_,y.au=Gy,y.av=r_,y.aw=function(){const o={},n=ie.$version;for(const s in ie.$root){const h=ie.$root[s];if(h.required){let m=null;m=s==="version"?n:h.type==="array"?[]:{},m!=null&&(o[s]=m)}}return o},y.ax=Mh,y.ay=jt,y.az=function(o){o=o.slice();const n=Object.create(null);for(let s=0;s<o.length;s++)n[o[s].id]=o[s];for(let s=0;s<o.length;s++)"ref"in o[s]&&(o[s]=oe(o[s],n[o[s].ref]));return o},y.b=ye,y.b0=function(o,n){return o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[3],o[4]=n[4],o[5]=n[5],o[6]=n[6],o[7]=n[7],o[8]=n[8],o[9]=n[9],o[10]=n[10],o[11]=n[11],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15],o},y.b1=function(o,n,s){return o[0]=n[0]*s[0],o[1]=n[1]*s[1],o[2]=n[2]*s[2],o[3]=n[3]*s[3],o},y.b2=function(o,n){return o[0]*n[0]+o[1]*n[1]+o[2]*n[2]+o[3]*n[3]},y.b3=Ee,y.b4=dw,y.b5=cw,y.b6=function(o,n,s,h,m){var x,w=1/Math.tan(n/2);return o[0]=w/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=w,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,m!=null&&m!==1/0?(o[10]=(m+h)*(x=1/(h-m)),o[14]=2*m*h*x):(o[10]=-1,o[14]=-2*h),o},y.b7=function(o,n,s){var h=Math.sin(s),m=Math.cos(s),x=n[4],w=n[5],b=n[6],E=n[7],I=n[8],M=n[9],L=n[10],j=n[11];return n!==o&&(o[0]=n[0],o[1]=n[1],o[2]=n[2],o[3]=n[3],o[12]=n[12],o[13]=n[13],o[14]=n[14],o[15]=n[15]),o[4]=x*m+I*h,o[5]=w*m+M*h,o[6]=b*m+L*h,o[7]=E*m+j*h,o[8]=I*m-x*h,o[9]=M*m-w*h,o[10]=L*m-b*h,o[11]=j*m-E*h,o},y.b8=q,y.b9=ne,y.bA=Bx,y.bB=function(o){return o.message===Te},y.bC=ca,y.bD=_i,y.ba=function(o){return o*Math.PI/180},y.bb=function(o,n){const{x:s,y:h}=Yh.fromLngLat(n);return!(o<0||o>25||h<0||h>=1||s<0||s>=1)},y.bc=function(o,n){return o[0]=n[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=n[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=n[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},y.bd=class extends z{},y.be=Yy,y.bf=UP,y.bh=Kt,y.bi=function(o,n){nt.REGISTERED_PROTOCOLS[o]=n},y.bj=function(o){delete nt.REGISTERED_PROTOCOLS[o]},y.bk=function(o,n){const s={};for(let m=0;m<o.length;m++){const x=n&&n[o[m].id]||Up(o[m]);n&&(n[o[m].id]=x);let w=s[x];w||(w=s[x]=[]),w.push(o[m])}const h=[];for(const m in s)h.push(s[m]);return h},y.bl=bt,y.bm=fw,y.bn=gw,y.bo=Wx,y.bp=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=fn/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const n=o.bucket.layers[0],s=n.layout,h=n._unevaluatedLayout._values,m={layoutIconSize:h["icon-size"].possiblyEvaluate(new Rr(o.bucket.zoom+1),o.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Rr(o.bucket.zoom+1),o.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Rr(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:M}=o.bucket.textSizeData;m.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Rr(I),o.canonical),h["text-size"].possiblyEvaluate(new Rr(M),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:M}=o.bucket.iconSizeData;m.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Rr(I),o.canonical),h["icon-size"].possiblyEvaluate(new Rr(M),o.canonical)]}const x=s.get("text-line-height")*gn,w=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",b=s.get("text-keep-upright"),E=s.get("text-size");for(const I of o.bucket.features){const M=s.get("text-font").evaluate(I,{},o.canonical).join(","),L=E.evaluate(I,{},o.canonical),j=m.layoutTextSize.evaluate(I,{},o.canonical),W=m.layoutIconSize.evaluate(I,{},o.canonical),Y={horizontal:{},vertical:void 0},J=I.text;let le,pe=[0,0];if(J){const Ae=J.toString(),Ve=s.get("text-letter-spacing").evaluate(I,{},o.canonical)*gn,et=yy(Ae)?Ve:0,vt=s.get("text-anchor").evaluate(I,{},o.canonical),Ft=Iw(n,I,o.canonical);if(!Ft){const Et=s.get("text-radial-offset").evaluate(I,{},o.canonical);pe=Et?Cw(vt,[Et*gn,e_]):s.get("text-offset").evaluate(I,{},o.canonical).map(wt=>wt*gn)}let gt=w?"center":s.get("text-justify").evaluate(I,{},o.canonical);const pt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(I,{},o.canonical)*gn:1/0,Pt=()=>{o.bucket.allowVerticalPlacement&&zh(Ae)&&(Y.vertical=hf(J,o.glyphMap,o.glyphPositions,o.imagePositions,M,pt,x,vt,"left",et,pe,y.ah.vertical,!0,j,L))};if(!w&&Ft){const Et=new Set;if(gt==="auto")for(let qe=0;qe<Ft.values.length;qe+=2)Et.add(t_(Ft.values[qe]));else Et.add(gt);let wt=!1;for(const qe of Et)if(!Y.horizontal[qe])if(wt)Y.horizontal[qe]=Y.horizontal[0];else{const At=hf(J,o.glyphMap,o.glyphPositions,o.imagePositions,M,pt,x,"center",qe,et,pe,y.ah.horizontal,!1,j,L);At&&(Y.horizontal[qe]=At,wt=At.positionedLines.length===1)}Pt()}else{gt==="auto"&&(gt=t_(vt));const Et=hf(J,o.glyphMap,o.glyphPositions,o.imagePositions,M,pt,x,vt,gt,et,pe,y.ah.horizontal,!1,j,L);Et&&(Y.horizontal[gt]=Et),Pt(),zh(Ae)&&w&&b&&(Y.vertical=hf(J,o.glyphMap,o.glyphPositions,o.imagePositions,M,pt,x,vt,gt,et,pe,y.ah.vertical,!1,j,L))}}let ze=!1;if(I.icon&&I.icon.name){const Ae=o.imageMap[I.icon.name];Ae&&(le=EP(o.imagePositions[I.icon.name],s.get("icon-offset").evaluate(I,{},o.canonical),s.get("icon-anchor").evaluate(I,{},o.canonical)),ze=!!Ae.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=ze:o.bucket.sdfIcons!==ze&&je("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ae.pixelRatio!==o.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const be=Aw(Y.horizontal)||Y.vertical;o.bucket.iconsInText=!!be&&be.iconsInText,(be||le)&&$P(o.bucket,I,Y,le,o.imageMap,m,j,W,pe,ze,o.canonical)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},y.bq=Ny,y.br=Fy,y.bs=By,y.bt=Ca,y.bu=jy,y.bv=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},y.bw=function(o,n,s,h,m){return c(this,void 0,void 0,function*(){if($())try{return yield Le(o,n,s,h,m)}catch{}return function(x,w,b,E,I){const M=x.width,L=x.height;Ke&&xe||(Ke=new OffscreenCanvas(M,L),xe=Ke.getContext("2d",{willReadFrequently:!0})),Ke.width=M,Ke.height=L,xe.drawImage(x,0,0,M,L);const j=xe.getImageData(w,b,E,I);return xe.clearRect(0,0,M,L),j.data}(o,n,s,h,m)})},y.bx=pw,y.by=T,y.bz=P,y.c=ft,y.d=o=>c(void 0,void 0,void 0,function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(n)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),y.e=ge,y.f=o=>new Promise((n,s)=>{const h=new Image;h.onload=()=>{n(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=Be})},h.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(o)],{type:"image/png"});h.src=o.byteLength?URL.createObjectURL(m):Be}),y.g=rt,y.h=(o,n)=>Gt(ge(o,{type:"json"}),n),y.i=Re,y.j=V,y.k=$r,y.l=(o,n)=>Gt(ge(o,{type:"arrayBuffer"}),n),y.m=Gt,y.n=function(o){return new jy(o).readFields(yP,[])},y.o=jh,y.p=Zx,y.q=v,y.r=my,y.s=pr,y.t=Ph,y.u=Ds,y.v=ie,y.w=je,y.x=function([o,n,s]){return n+=90,n*=Math.PI/180,s*=Math.PI/180,{x:o*Math.cos(n)*Math.sin(s),y:o*Math.sin(n)*Math.sin(s),z:o*Math.cos(s)}},y.y=ti,y.z=Rr}),d("worker",["./shared"],function(y){class c{constructor(Z){this.keyCache={},Z&&this.replace(Z)}replace(Z){this._layerConfigs={},this._layers={},this.update(Z,[])}update(Z,G){for(const ue of Z){this._layerConfigs[ue.id]=ue;const Se=this._layers[ue.id]=y.aA(ue);Se._featureFilter=y.a7(Se.filter),this.keyCache[ue.id]&&delete this.keyCache[ue.id]}for(const ue of G)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const ee=y.bk(Object.values(this._layerConfigs),this.keyCache);for(const ue of ee){const Se=ue.map($e=>this._layers[$e.id]),Ie=Se[0];if(Ie.visibility==="none")continue;const Me=Ie.source||"";let _e=this.familiesBySource[Me];_e||(_e=this.familiesBySource[Me]={});const He=Ie.sourceLayer||"_geojsonTileLayer";let Ye=_e[He];Ye||(Ye=_e[He]=[]),Ye.push(Se)}}}class T{constructor(Z){const G={},ee=[];for(const Me in Z){const _e=Z[Me],He=G[Me]={};for(const Ye in _e){const $e=_e[+Ye];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const ut={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};ee.push(ut),He[Ye]={rect:ut,metrics:$e.metrics}}}const{w:ue,h:Se}=y.p(ee),Ie=new y.o({width:ue||1,height:Se||1});for(const Me in Z){const _e=Z[Me];for(const He in _e){const Ye=_e[+He];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const $e=G[Me][He].rect;y.o.copy(Ye.bitmap,Ie,{x:0,y:0},{x:$e.x+1,y:$e.y+1},Ye.bitmap)}}this.image=Ie,this.positions=G}}y.bl("GlyphAtlas",T);class P{constructor(Z){this.tileID=new y.S(Z.tileID.overscaledZ,Z.tileID.wrap,Z.tileID.canonical.z,Z.tileID.canonical.x,Z.tileID.canonical.y),this.uid=Z.uid,this.zoom=Z.zoom,this.pixelRatio=Z.pixelRatio,this.tileSize=Z.tileSize,this.source=Z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Z.showCollisionBoxes,this.collectResourceTiming=!!Z.collectResourceTiming,this.returnDependencies=!!Z.returnDependencies,this.promoteId=Z.promoteId,this.inFlightDependencies=[]}parse(Z,G,ee,ue){return y._(this,void 0,void 0,function*(){this.status="parsing",this.data=Z,this.collisionBoxArray=new y.a5;const Se=new y.bm(Object.keys(Z.layers).sort()),Ie=new y.bn(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Me={},_e={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ee},He=G.familiesBySource[this.source];for(const Jt in He){const Sr=Z.layers[Jt];if(!Sr)continue;Sr.version===1&&y.w(`Vector tile source "${this.source}" layer "${Jt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Nr=Se.encode(Jt),_n=[];for(let En=0;En<Sr.length;En++){const Un=Sr.feature(En),Qs=Ie.getId(Un,Jt);_n.push({feature:Un,id:Qs,index:En,sourceLayerIndex:Nr})}for(const En of He[Jt]){const Un=En[0];Un.source!==this.source&&y.w(`layer.source = ${Un.source} does not equal this.source = ${this.source}`),Un.minzoom&&this.zoom<Math.floor(Un.minzoom)||Un.maxzoom&&this.zoom>=Un.maxzoom||Un.visibility!=="none"&&(R(En,this.zoom,ee),(Me[Un.id]=Un.createBucket({index:Ie.bucketLayerIDs.length,layers:En,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Nr,sourceID:this.source})).populate(_n,_e,this.tileID.canonical),Ie.bucketLayerIDs.push(En.map(Qs=>Qs.id)))}}const Ye=y.aF(_e.glyphDependencies,Jt=>Object.keys(Jt).map(Number));this.inFlightDependencies.forEach(Jt=>Jt==null?void 0:Jt.abort()),this.inFlightDependencies=[];let $e=Promise.resolve({});if(Object.keys(Ye).length){const Jt=new AbortController;this.inFlightDependencies.push(Jt),$e=ue.sendAsync({type:"GG",data:{stacks:Ye,source:this.source,tileID:this.tileID,type:"glyphs"}},Jt)}const ut=Object.keys(_e.iconDependencies);let Mt=Promise.resolve({});if(ut.length){const Jt=new AbortController;this.inFlightDependencies.push(Jt),Mt=ue.sendAsync({type:"GI",data:{icons:ut,source:this.source,tileID:this.tileID,type:"icons"}},Jt)}const Dt=Object.keys(_e.patternDependencies);let cr=Promise.resolve({});if(Dt.length){const Jt=new AbortController;this.inFlightDependencies.push(Jt),cr=ue.sendAsync({type:"GI",data:{icons:Dt,source:this.source,tileID:this.tileID,type:"patterns"}},Jt)}const[Xt,hr,rr]=yield Promise.all([$e,Mt,cr]),dn=new T(Xt),Zr=new y.bo(hr,rr);for(const Jt in Me){const Sr=Me[Jt];Sr instanceof y.a6?(R(Sr.layers,this.zoom,ee),y.bp({bucket:Sr,glyphMap:Xt,glyphPositions:dn.positions,imageMap:hr,imagePositions:Zr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Sr.hasPattern&&(Sr instanceof y.bq||Sr instanceof y.br||Sr instanceof y.bs)&&(R(Sr.layers,this.zoom,ee),Sr.addFeatures(_e,this.tileID.canonical,Zr.patternPositions))}return this.status="done",{buckets:Object.values(Me).filter(Jt=>!Jt.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:dn.image,imageAtlas:Zr,glyphMap:this.returnDependencies?Xt:null,iconMap:this.returnDependencies?hr:null,glyphPositions:this.returnDependencies?dn.positions:null}})}}function R(he,Z,G){const ee=new y.z(Z);for(const ue of he)ue.recalculate(ee,G)}class D{constructor(Z,G,ee){this.actor=Z,this.layerIndex=G,this.availableImages=ee,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Z,G){return y._(this,void 0,void 0,function*(){const ee=yield y.l(Z.request,G);try{return{vectorTile:new y.bt.VectorTile(new y.bu(ee.data)),rawData:ee.data,cacheControl:ee.cacheControl,expires:ee.expires}}catch(ue){const Se=new Uint8Array(ee.data);let Ie=`Unable to parse the tile at ${Z.request.url}, `;throw Ie+=Se[0]===31&&Se[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ue.message}`,new Error(Ie)}})}loadTile(Z){return y._(this,void 0,void 0,function*(){const G=Z.uid,ee=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new y.bv(Z.request),ue=new P(Z);this.loading[G]=ue;const Se=new AbortController;ue.abort=Se;try{const Ie=yield this.loadVectorTile(Z,Se);if(delete this.loading[G],!Ie)return null;const Me=Ie.rawData,_e={};Ie.expires&&(_e.expires=Ie.expires),Ie.cacheControl&&(_e.cacheControl=Ie.cacheControl);const He={};if(ee){const $e=ee.finish();$e&&(He.resourceTiming=JSON.parse(JSON.stringify($e)))}ue.vectorTile=Ie.vectorTile;const Ye=ue.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[G]=ue,this.fetching[G]={rawTileData:Me,cacheControl:_e,resourceTiming:He};try{const $e=yield Ye;return y.e({rawTileData:Me.slice(0)},$e,_e,He)}finally{delete this.fetching[G]}}catch(Ie){throw delete this.loading[G],ue.status="done",this.loaded[G]=ue,Ie}})}reloadTile(Z){return y._(this,void 0,void 0,function*(){const G=Z.uid;if(!this.loaded||!this.loaded[G])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ee=this.loaded[G];if(ee.showCollisionBoxes=Z.showCollisionBoxes,ee.status==="parsing"){const ue=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor);let Se;if(this.fetching[G]){const{rawTileData:Ie,cacheControl:Me,resourceTiming:_e}=this.fetching[G];delete this.fetching[G],Se=y.e({rawTileData:Ie.slice(0)},ue,Me,_e)}else Se=ue;return Se}if(ee.status==="done"&&ee.vectorTile)return ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(Z){return y._(this,void 0,void 0,function*(){const G=this.loading,ee=Z.uid;G&&G[ee]&&G[ee].abort&&(G[ee].abort.abort(),delete G[ee])})}removeTile(Z){return y._(this,void 0,void 0,function*(){this.loaded&&this.loaded[Z.uid]&&delete this.loaded[Z.uid]})}}class A{constructor(){this.loaded={}}loadTile(Z){return y._(this,void 0,void 0,function*(){const{uid:G,encoding:ee,rawImageData:ue,redFactor:Se,greenFactor:Ie,blueFactor:Me,baseShift:_e}=Z,He=ue.width+2,Ye=ue.height+2,$e=y.b(ue)?new y.R({width:He,height:Ye},yield y.bw(ue,-1,-1,He,Ye)):ue,ut=new y.bx(G,$e,ee,Se,Ie,Me,_e);return this.loaded=this.loaded||{},this.loaded[G]=ut,ut})}removeTile(Z){const G=this.loaded,ee=Z.uid;G&&G[ee]&&delete G[ee]}}function N(he,Z){if(he.length!==0){X(he[0],Z);for(var G=1;G<he.length;G++)X(he[G],!Z)}}function X(he,Z){for(var G=0,ee=0,ue=0,Se=he.length,Ie=Se-1;ue<Se;Ie=ue++){var Me=(he[ue][0]-he[Ie][0])*(he[Ie][1]+he[ue][1]),_e=G+Me;ee+=Math.abs(G)>=Math.abs(Me)?G-_e+Me:Me-_e+G,G=_e}G+ee>=0!=!!Z&&he.reverse()}var U=y.by(function he(Z,G){var ee,ue=Z&&Z.type;if(ue==="FeatureCollection")for(ee=0;ee<Z.features.length;ee++)he(Z.features[ee],G);else if(ue==="GeometryCollection")for(ee=0;ee<Z.geometries.length;ee++)he(Z.geometries[ee],G);else if(ue==="Feature")he(Z.geometry,G);else if(ue==="Polygon")N(Z.coordinates,G);else if(ue==="MultiPolygon")for(ee=0;ee<Z.coordinates.length;ee++)N(Z.coordinates[ee],G);return Z});const te=y.bt.VectorTileFeature.prototype.toGeoJSON;var F={exports:{}},$=y.bz,q=y.bt.VectorTileFeature,ne=se;function se(he,Z){this.options=Z||{},this.features=he,this.length=he.length}function Ee(he,Z){this.id=typeof he.id=="number"?he.id:void 0,this.type=he.type,this.rawGeometry=he.type===1?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=Z||4096}se.prototype.feature=function(he){return new Ee(this.features[he],this.options.extent)},Ee.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var Z=0;Z<he.length;Z++){for(var G=he[Z],ee=[],ue=0;ue<G.length;ue++)ee.push(new $(G[ue][0],G[ue][1]));this.geometry.push(ee)}return this.geometry},Ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,Z=1/0,G=-1/0,ee=1/0,ue=-1/0,Se=0;Se<he.length;Se++)for(var Ie=he[Se],Me=0;Me<Ie.length;Me++){var _e=Ie[Me];Z=Math.min(Z,_e.x),G=Math.max(G,_e.x),ee=Math.min(ee,_e.y),ue=Math.max(ue,_e.y)}return[Z,ee,G,ue]},Ee.prototype.toGeoJSON=q.prototype.toGeoJSON;var ge=y.bA,Oe=ne;function Fe(he){var Z=new ge;return function(G,ee){for(var ue in G.layers)ee.writeMessage(3,Ge,G.layers[ue])}(he,Z),Z.finish()}function Ge(he,Z){var G;Z.writeVarintField(15,he.version||1),Z.writeStringField(1,he.name||""),Z.writeVarintField(5,he.extent||4096);var ee={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<he.length;G++)ee.feature=he.feature(G),Z.writeMessage(2,it,ee);var ue=ee.keys;for(G=0;G<ue.length;G++)Z.writeStringField(3,ue[G]);var Se=ee.values;for(G=0;G<Se.length;G++)Z.writeMessage(4,_t,Se[G])}function it(he,Z){var G=he.feature;G.id!==void 0&&Z.writeVarintField(1,G.id),Z.writeMessage(2,ve,he),Z.writeVarintField(3,G.type),Z.writeMessage(4,Re,G)}function ve(he,Z){var G=he.feature,ee=he.keys,ue=he.values,Se=he.keycache,Ie=he.valuecache;for(var Me in G.properties){var _e=G.properties[Me],He=Se[Me];if(_e!==null){He===void 0&&(ee.push(Me),Se[Me]=He=ee.length-1),Z.writeVarint(He);var Ye=typeof _e;Ye!=="string"&&Ye!=="boolean"&&Ye!=="number"&&(_e=JSON.stringify(_e));var $e=Ye+":"+_e,ut=Ie[$e];ut===void 0&&(ue.push(_e),Ie[$e]=ut=ue.length-1),Z.writeVarint(ut)}}}function je(he,Z){return(Z<<3)+(7&he)}function H(he){return he<<1^he>>31}function Re(he,Z){for(var G=he.loadGeometry(),ee=he.type,ue=0,Se=0,Ie=G.length,Me=0;Me<Ie;Me++){var _e=G[Me],He=1;ee===1&&(He=_e.length),Z.writeVarint(je(1,He));for(var Ye=ee===3?_e.length-1:_e.length,$e=0;$e<Ye;$e++){$e===1&&ee!==1&&Z.writeVarint(je(2,Ye-1));var ut=_e[$e].x-ue,Mt=_e[$e].y-Se;Z.writeVarint(H(ut)),Z.writeVarint(H(Mt)),ue+=ut,Se+=Mt}ee===3&&Z.writeVarint(je(7,1))}}function _t(he,Z){var G=typeof he;G==="string"?Z.writeStringField(1,he):G==="boolean"?Z.writeBooleanField(7,he):G==="number"&&(he%1!=0?Z.writeDoubleField(3,he):he<0?Z.writeSVarintField(6,he):Z.writeVarintField(5,he))}F.exports=Fe,F.exports.fromVectorTileJs=Fe,F.exports.fromGeojsonVt=function(he,Z){Z=Z||{};var G={};for(var ee in he)G[ee]=new Oe(he[ee].features,Z),G[ee].name=ee,G[ee].version=Z.version,G[ee].extent=Z.extent;return Fe({layers:G})},F.exports.GeoJSONWrapper=Oe;var ye=y.by(F.exports);const Be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},Le=Math.fround||(Ke=new Float32Array(1),he=>(Ke[0]=+he,Ke[0]));var Ke;const xe=3,Te=5,ft=6;class nt{constructor(Z){this.options=Object.assign(Object.create(Be),Z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Z){const{log:G,minZoom:ee,maxZoom:ue}=this.options;G&&console.time("total time");const Se=`prepare ${Z.length} points`;G&&console.time(Se),this.points=Z;const Ie=[];for(let _e=0;_e<Z.length;_e++){const He=Z[_e];if(!He.geometry)continue;const[Ye,$e]=He.geometry.coordinates,ut=Le(Kt(Ye)),Mt=Le(jt($e));Ie.push(ut,Mt,1/0,_e,-1,1),this.options.reduce&&Ie.push(0)}let Me=this.trees[ue+1]=this._createTree(Ie);G&&console.timeEnd(Se);for(let _e=ue;_e>=ee;_e--){const He=+Date.now();Me=this.trees[_e]=this._createTree(this._cluster(Me,_e)),G&&console.log("z%d: %d clusters in %dms",_e,Me.numItems,+Date.now()-He)}return G&&console.timeEnd("total time"),this}getClusters(Z,G){let ee=((Z[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,Z[1]));let Se=Z[2]===180?180:((Z[2]+180)%360+360)%360-180;const Ie=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)ee=-180,Se=180;else if(ee>Se){const $e=this.getClusters([ee,ue,180,Ie],G),ut=this.getClusters([-180,ue,Se,Ie],G);return $e.concat(ut)}const Me=this.trees[this._limitZoom(G)],_e=Me.range(Kt(ee),jt(Ie),Kt(Se),jt(ue)),He=Me.data,Ye=[];for(const $e of _e){const ut=this.stride*$e;Ye.push(He[ut+Te]>1?rt(He,ut,this.clusterProps):this.points[He[ut+xe]])}return Ye}getChildren(Z){const G=this._getOriginId(Z),ee=this._getOriginZoom(Z),ue="No cluster with the specified id.",Se=this.trees[ee];if(!Se)throw new Error(ue);const Ie=Se.data;if(G*this.stride>=Ie.length)throw new Error(ue);const Me=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),_e=Se.within(Ie[G*this.stride],Ie[G*this.stride+1],Me),He=[];for(const Ye of _e){const $e=Ye*this.stride;Ie[$e+4]===Z&&He.push(Ie[$e+Te]>1?rt(Ie,$e,this.clusterProps):this.points[Ie[$e+xe]])}if(He.length===0)throw new Error(ue);return He}getLeaves(Z,G,ee){const ue=[];return this._appendLeaves(ue,Z,G=G||10,ee=ee||0,0),ue}getTile(Z,G,ee){const ue=this.trees[this._limitZoom(Z)],Se=Math.pow(2,Z),{extent:Ie,radius:Me}=this.options,_e=Me/Ie,He=(ee-_e)/Se,Ye=(ee+1+_e)/Se,$e={features:[]};return this._addTileFeatures(ue.range((G-_e)/Se,He,(G+1+_e)/Se,Ye),ue.data,G,ee,Se,$e),G===0&&this._addTileFeatures(ue.range(1-_e/Se,He,1,Ye),ue.data,Se,ee,Se,$e),G===Se-1&&this._addTileFeatures(ue.range(0,He,_e/Se,Ye),ue.data,-1,ee,Se,$e),$e.features.length?$e:null}getClusterExpansionZoom(Z){let G=this._getOriginZoom(Z)-1;for(;G<=this.options.maxZoom;){const ee=this.getChildren(Z);if(G++,ee.length!==1)break;Z=ee[0].properties.cluster_id}return G}_appendLeaves(Z,G,ee,ue,Se){const Ie=this.getChildren(G);for(const Me of Ie){const _e=Me.properties;if(_e&&_e.cluster?Se+_e.point_count<=ue?Se+=_e.point_count:Se=this._appendLeaves(Z,_e.cluster_id,ee,ue,Se):Se<ue?Se++:Z.push(Me),Z.length===ee)break}return Se}_createTree(Z){const G=new y.av(Z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ee=0;ee<Z.length;ee+=this.stride)G.add(Z[ee],Z[ee+1]);return G.finish(),G.data=Z,G}_addTileFeatures(Z,G,ee,ue,Se,Ie){for(const Me of Z){const _e=Me*this.stride,He=G[_e+Te]>1;let Ye,$e,ut;if(He)Ye=qt(G,_e,this.clusterProps),$e=G[_e],ut=G[_e+1];else{const cr=this.points[G[_e+xe]];Ye=cr.properties;const[Xt,hr]=cr.geometry.coordinates;$e=Kt(Xt),ut=jt(hr)}const Mt={type:1,geometry:[[Math.round(this.options.extent*($e*Se-ee)),Math.round(this.options.extent*(ut*Se-ue))]],tags:Ye};let Dt;Dt=He||this.options.generateId?G[_e+xe]:this.points[G[_e+xe]].id,Dt!==void 0&&(Mt.id=Dt),Ie.features.push(Mt)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(Math.floor(+Z),this.options.maxZoom+1))}_cluster(Z,G){const{radius:ee,extent:ue,reduce:Se,minPoints:Ie}=this.options,Me=ee/(ue*Math.pow(2,G)),_e=Z.data,He=[],Ye=this.stride;for(let $e=0;$e<_e.length;$e+=Ye){if(_e[$e+2]<=G)continue;_e[$e+2]=G;const ut=_e[$e],Mt=_e[$e+1],Dt=Z.within(_e[$e],_e[$e+1],Me),cr=_e[$e+Te];let Xt=cr;for(const hr of Dt){const rr=hr*Ye;_e[rr+2]>G&&(Xt+=_e[rr+Te])}if(Xt>cr&&Xt>=Ie){let hr,rr=ut*cr,dn=Mt*cr,Zr=-1;const Jt=(($e/Ye|0)<<5)+(G+1)+this.points.length;for(const Sr of Dt){const Nr=Sr*Ye;if(_e[Nr+2]<=G)continue;_e[Nr+2]=G;const _n=_e[Nr+Te];rr+=_e[Nr]*_n,dn+=_e[Nr+1]*_n,_e[Nr+4]=Jt,Se&&(hr||(hr=this._map(_e,$e,!0),Zr=this.clusterProps.length,this.clusterProps.push(hr)),Se(hr,this._map(_e,Nr)))}_e[$e+4]=Jt,He.push(rr/Xt,dn/Xt,1/0,Jt,-1,Xt),Se&&He.push(Zr)}else{for(let hr=0;hr<Ye;hr++)He.push(_e[$e+hr]);if(Xt>1)for(const hr of Dt){const rr=hr*Ye;if(!(_e[rr+2]<=G)){_e[rr+2]=G;for(let dn=0;dn<Ye;dn++)He.push(_e[rr+dn])}}}}return He}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,G,ee){if(Z[G+Te]>1){const Ie=this.clusterProps[Z[G+ft]];return ee?Object.assign({},Ie):Ie}const ue=this.points[Z[G+xe]].properties,Se=this.options.map(ue);return ee&&Se===ue?Object.assign({},Se):Se}}function rt(he,Z,G){return{type:"Feature",id:he[Z+xe],properties:qt(he,Z,G),geometry:{type:"Point",coordinates:[(ee=he[Z],360*(ee-.5)),Gt(he[Z+1])]}};var ee}function qt(he,Z,G){const ee=he[Z+Te],ue=ee>=1e4?`${Math.round(ee/1e3)}k`:ee>=1e3?Math.round(ee/100)/10+"k":ee,Se=he[Z+ft],Ie=Se===-1?{}:Object.assign({},G[Se]);return Object.assign(Ie,{cluster:!0,cluster_id:he[Z+xe],point_count:ee,point_count_abbreviated:ue})}function Kt(he){return he/360+.5}function jt(he){const Z=Math.sin(he*Math.PI/180),G=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return G<0?0:G>1?1:G}function Gt(he){const Z=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function pr(he,Z,G,ee){let ue=ee;const Se=Z+(G-Z>>1);let Ie,Me=G-Z;const _e=he[Z],He=he[Z+1],Ye=he[G],$e=he[G+1];for(let ut=Z+3;ut<G;ut+=3){const Mt=lr(he[ut],he[ut+1],_e,He,Ye,$e);if(Mt>ue)Ie=ut,ue=Mt;else if(Mt===ue){const Dt=Math.abs(ut-Se);Dt<Me&&(Ie=ut,Me=Dt)}}ue>ee&&(Ie-Z>3&&pr(he,Z,Ie,ee),he[Ie+2]=ue,G-Ie>3&&pr(he,Ie,G,ee))}function lr(he,Z,G,ee,ue,Se){let Ie=ue-G,Me=Se-ee;if(Ie!==0||Me!==0){const _e=((he-G)*Ie+(Z-ee)*Me)/(Ie*Ie+Me*Me);_e>1?(G=ue,ee=Se):_e>0&&(G+=Ie*_e,ee+=Me*_e)}return Ie=he-G,Me=Z-ee,Ie*Ie+Me*Me}function gr(he,Z,G,ee){const ue={id:he??null,type:Z,geometry:G,tags:ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Z==="Point"||Z==="MultiPoint"||Z==="LineString")$r(ue,G);else if(Z==="Polygon")$r(ue,G[0]);else if(Z==="MultiLineString")for(const Se of G)$r(ue,Se);else if(Z==="MultiPolygon")for(const Se of G)$r(ue,Se[0]);return ue}function $r(he,Z){for(let G=0;G<Z.length;G+=3)he.minX=Math.min(he.minX,Z[G]),he.minY=Math.min(he.minY,Z[G+1]),he.maxX=Math.max(he.maxX,Z[G]),he.maxY=Math.max(he.maxY,Z[G+1])}function V(he,Z,G,ee){if(!Z.geometry)return;const ue=Z.geometry.coordinates;if(ue&&ue.length===0)return;const Se=Z.geometry.type,Ie=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2);let Me=[],_e=Z.id;if(G.promoteId?_e=Z.properties[G.promoteId]:G.generateId&&(_e=ee||0),Se==="Point")Ue(ue,Me);else if(Se==="MultiPoint")for(const He of ue)Ue(He,Me);else if(Se==="LineString")ie(ue,Me,Ie,!1);else if(Se==="MultiLineString"){if(G.lineMetrics){for(const He of ue)Me=[],ie(He,Me,Ie,!1),he.push(gr(_e,"LineString",Me,Z.properties));return}de(ue,Me,Ie,!1)}else if(Se==="Polygon")de(ue,Me,Ie,!0);else{if(Se!=="MultiPolygon"){if(Se==="GeometryCollection"){for(const He of Z.geometry.geometries)V(he,{id:_e,geometry:He,properties:Z.properties},G,ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const He of ue){const Ye=[];de(He,Ye,Ie,!0),Me.push(Ye)}}he.push(gr(_e,Se,Me,Z.properties))}function Ue(he,Z){Z.push(oe(he[0]),ke(he[1]),0)}function ie(he,Z,G,ee){let ue,Se,Ie=0;for(let _e=0;_e<he.length;_e++){const He=oe(he[_e][0]),Ye=ke(he[_e][1]);Z.push(He,Ye,0),_e>0&&(Ie+=ee?(ue*Ye-He*Se)/2:Math.sqrt(Math.pow(He-ue,2)+Math.pow(Ye-Se,2))),ue=He,Se=Ye}const Me=Z.length-3;Z[2]=1,pr(Z,0,Me,G),Z[Me+2]=1,Z.size=Math.abs(Ie),Z.start=0,Z.end=Z.size}function de(he,Z,G,ee){for(let ue=0;ue<he.length;ue++){const Se=[];ie(he[ue],Se,G,ee),Z.push(Se)}}function oe(he){return he/360+.5}function ke(he){const Z=Math.sin(he*Math.PI/180),G=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return G<0?0:G>1?1:G}function Ze(he,Z,G,ee,ue,Se,Ie,Me){if(ee/=Z,Se>=(G/=Z)&&Ie<ee)return he;if(Ie<G||Se>=ee)return null;const _e=[];for(const He of he){const Ye=He.geometry;let $e=He.type;const ut=ue===0?He.minX:He.minY,Mt=ue===0?He.maxX:He.maxY;if(ut>=G&&Mt<ee){_e.push(He);continue}if(Mt<G||ut>=ee)continue;let Dt=[];if($e==="Point"||$e==="MultiPoint")tt(Ye,Dt,G,ee,ue);else if($e==="LineString")Ne(Ye,Dt,G,ee,ue,!1,Me.lineMetrics);else if($e==="MultiLineString")St(Ye,Dt,G,ee,ue,!1);else if($e==="Polygon")St(Ye,Dt,G,ee,ue,!0);else if($e==="MultiPolygon")for(const cr of Ye){const Xt=[];St(cr,Xt,G,ee,ue,!0),Xt.length&&Dt.push(Xt)}if(Dt.length){if(Me.lineMetrics&&$e==="LineString"){for(const cr of Dt)_e.push(gr(He.id,$e,cr,He.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(Dt.length===1?($e="LineString",Dt=Dt[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=Dt.length===3?"Point":"MultiPoint"),_e.push(gr(He.id,$e,Dt,He.tags))}}return _e.length?_e:null}function tt(he,Z,G,ee,ue){for(let Se=0;Se<he.length;Se+=3){const Ie=he[Se+ue];Ie>=G&&Ie<=ee&&at(Z,he[Se],he[Se+1],he[Se+2])}}function Ne(he,Z,G,ee,ue,Se,Ie){let Me=st(he);const _e=ue===0?Lt:vr;let He,Ye,$e=he.start;for(let Xt=0;Xt<he.length-3;Xt+=3){const hr=he[Xt],rr=he[Xt+1],dn=he[Xt+2],Zr=he[Xt+3],Jt=he[Xt+4],Sr=ue===0?hr:rr,Nr=ue===0?Zr:Jt;let _n=!1;Ie&&(He=Math.sqrt(Math.pow(hr-Zr,2)+Math.pow(rr-Jt,2))),Sr<G?Nr>G&&(Ye=_e(Me,hr,rr,Zr,Jt,G),Ie&&(Me.start=$e+He*Ye)):Sr>ee?Nr<ee&&(Ye=_e(Me,hr,rr,Zr,Jt,ee),Ie&&(Me.start=$e+He*Ye)):at(Me,hr,rr,dn),Nr<G&&Sr>=G&&(Ye=_e(Me,hr,rr,Zr,Jt,G),_n=!0),Nr>ee&&Sr<=ee&&(Ye=_e(Me,hr,rr,Zr,Jt,ee),_n=!0),!Se&&_n&&(Ie&&(Me.end=$e+He*Ye),Z.push(Me),Me=st(he)),Ie&&($e+=He)}let ut=he.length-3;const Mt=he[ut],Dt=he[ut+1],cr=ue===0?Mt:Dt;cr>=G&&cr<=ee&&at(Me,Mt,Dt,he[ut+2]),ut=Me.length-3,Se&&ut>=3&&(Me[ut]!==Me[0]||Me[ut+1]!==Me[1])&&at(Me,Me[0],Me[1],Me[2]),Me.length&&Z.push(Me)}function st(he){const Z=[];return Z.size=he.size,Z.start=he.start,Z.end=he.end,Z}function St(he,Z,G,ee,ue,Se){for(const Ie of he)Ne(Ie,Z,G,ee,ue,Se,!1)}function at(he,Z,G,ee){he.push(Z,G,ee)}function Lt(he,Z,G,ee,ue,Se){const Ie=(Se-Z)/(ee-Z);return at(he,Se,G+(ue-G)*Ie,1),Ie}function vr(he,Z,G,ee,ue,Se){const Ie=(Se-G)/(ue-G);return at(he,Z+(ee-Z)*Ie,Se,1),Ie}function We(he,Z){const G=[];for(let ee=0;ee<he.length;ee++){const ue=he[ee],Se=ue.type;let Ie;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")Ie=Gr(ue.geometry,Z);else if(Se==="MultiLineString"||Se==="Polygon"){Ie=[];for(const Me of ue.geometry)Ie.push(Gr(Me,Z))}else if(Se==="MultiPolygon"){Ie=[];for(const Me of ue.geometry){const _e=[];for(const He of Me)_e.push(Gr(He,Z));Ie.push(_e)}}G.push(gr(ue.id,Se,Ie,ue.tags))}return G}function Gr(he,Z){const G=[];G.size=he.size,he.start!==void 0&&(G.start=he.start,G.end=he.end);for(let ee=0;ee<he.length;ee+=3)G.push(he[ee]+Z,he[ee+1],he[ee+2]);return G}function nn(he,Z){if(he.transformed)return he;const G=1<<he.z,ee=he.x,ue=he.y;for(const Se of he.features){const Ie=Se.geometry,Me=Se.type;if(Se.geometry=[],Me===1)for(let _e=0;_e<Ie.length;_e+=2)Se.geometry.push(on(Ie[_e],Ie[_e+1],Z,G,ee,ue));else for(let _e=0;_e<Ie.length;_e++){const He=[];for(let Ye=0;Ye<Ie[_e].length;Ye+=2)He.push(on(Ie[_e][Ye],Ie[_e][Ye+1],Z,G,ee,ue));Se.geometry.push(He)}}return he.transformed=!0,he}function on(he,Z,G,ee,ue,Se){return[Math.round(G*(he*ee-ue)),Math.round(G*(Z*ee-Se))]}function Qn(he,Z,G,ee,ue){const Se=Z===ue.maxZoom?0:ue.tolerance/((1<<Z)*ue.extent),Ie={features:[],numPoints:0,numSimplified:0,numFeatures:he.length,source:null,x:G,y:ee,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Me of he)Qe(Ie,Me,Se,ue);return Ie}function Qe(he,Z,G,ee){const ue=Z.geometry,Se=Z.type,Ie=[];if(he.minX=Math.min(he.minX,Z.minX),he.minY=Math.min(he.minY,Z.minY),he.maxX=Math.max(he.maxX,Z.maxX),he.maxY=Math.max(he.maxY,Z.maxY),Se==="Point"||Se==="MultiPoint")for(let Me=0;Me<ue.length;Me+=3)Ie.push(ue[Me],ue[Me+1]),he.numPoints++,he.numSimplified++;else if(Se==="LineString")Wt(Ie,ue,he,G,!1,!1);else if(Se==="MultiLineString"||Se==="Polygon")for(let Me=0;Me<ue.length;Me++)Wt(Ie,ue[Me],he,G,Se==="Polygon",Me===0);else if(Se==="MultiPolygon")for(let Me=0;Me<ue.length;Me++){const _e=ue[Me];for(let He=0;He<_e.length;He++)Wt(Ie,_e[He],he,G,!0,He===0)}if(Ie.length){let Me=Z.tags||null;if(Se==="LineString"&&ee.lineMetrics){Me={};for(const He in Z.tags)Me[He]=Z.tags[He];Me.mapbox_clip_start=ue.start/ue.size,Me.mapbox_clip_end=ue.end/ue.size}const _e={geometry:Ie,type:Se==="Polygon"||Se==="MultiPolygon"?3:Se==="LineString"||Se==="MultiLineString"?2:1,tags:Me};Z.id!==null&&(_e.id=Z.id),he.features.push(_e)}}function Wt(he,Z,G,ee,ue,Se){const Ie=ee*ee;if(ee>0&&Z.size<(ue?Ie:ee))return void(G.numPoints+=Z.length/3);const Me=[];for(let _e=0;_e<Z.length;_e+=3)(ee===0||Z[_e+2]>Ie)&&(G.numSimplified++,Me.push(Z[_e],Z[_e+1])),G.numPoints++;ue&&function(_e,He){let Ye=0;for(let $e=0,ut=_e.length,Mt=ut-2;$e<ut;Mt=$e,$e+=2)Ye+=(_e[$e]-_e[Mt])*(_e[$e+1]+_e[Mt+1]);if(Ye>0===He)for(let $e=0,ut=_e.length;$e<ut/2;$e+=2){const Mt=_e[$e],Dt=_e[$e+1];_e[$e]=_e[ut-2-$e],_e[$e+1]=_e[ut-1-$e],_e[ut-2-$e]=Mt,_e[ut-1-$e]=Dt}}(Me,Se),he.push(Me)}const Bt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class jr{constructor(Z,G){const ee=(G=this.options=function(Se,Ie){for(const Me in Ie)Se[Me]=Ie[Me];return Se}(Object.create(Bt),G)).debug;if(ee&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");let ue=function(Se,Ie){const Me=[];if(Se.type==="FeatureCollection")for(let _e=0;_e<Se.features.length;_e++)V(Me,Se.features[_e],Ie,_e);else V(Me,Se.type==="Feature"?Se:{geometry:Se},Ie);return Me}(Z,G);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ue=function(Se,Ie){const Me=Ie.buffer/Ie.extent;let _e=Se;const He=Ze(Se,1,-1-Me,Me,0,-1,2,Ie),Ye=Ze(Se,1,1-Me,2+Me,0,-1,2,Ie);return(He||Ye)&&(_e=Ze(Se,1,-Me,1+Me,0,-1,2,Ie)||[],He&&(_e=We(He,1).concat(_e)),Ye&&(_e=_e.concat(We(Ye,-1)))),_e}(ue,G),ue.length&&this.splitTile(ue,0,0,0),ee&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Z,G,ee,ue,Se,Ie,Me){const _e=[Z,G,ee,ue],He=this.options,Ye=He.debug;for(;_e.length;){ue=_e.pop(),ee=_e.pop(),G=_e.pop(),Z=_e.pop();const $e=1<<G,ut=ei(G,ee,ue);let Mt=this.tiles[ut];if(!Mt&&(Ye>1&&console.time("creation"),Mt=this.tiles[ut]=Qn(Z,G,ee,ue,He),this.tileCoords.push({z:G,x:ee,y:ue}),Ye)){Ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,ee,ue,Mt.numFeatures,Mt.numPoints,Mt.numSimplified),console.timeEnd("creation"));const _n=`z${G}`;this.stats[_n]=(this.stats[_n]||0)+1,this.total++}if(Mt.source=Z,Se==null){if(G===He.indexMaxZoom||Mt.numPoints<=He.indexMaxPoints)continue}else{if(G===He.maxZoom||G===Se)continue;if(Se!=null){const _n=Se-G;if(ee!==Ie>>_n||ue!==Me>>_n)continue}}if(Mt.source=null,Z.length===0)continue;Ye>1&&console.time("clipping");const Dt=.5*He.buffer/He.extent,cr=.5-Dt,Xt=.5+Dt,hr=1+Dt;let rr=null,dn=null,Zr=null,Jt=null,Sr=Ze(Z,$e,ee-Dt,ee+Xt,0,Mt.minX,Mt.maxX,He),Nr=Ze(Z,$e,ee+cr,ee+hr,0,Mt.minX,Mt.maxX,He);Z=null,Sr&&(rr=Ze(Sr,$e,ue-Dt,ue+Xt,1,Mt.minY,Mt.maxY,He),dn=Ze(Sr,$e,ue+cr,ue+hr,1,Mt.minY,Mt.maxY,He),Sr=null),Nr&&(Zr=Ze(Nr,$e,ue-Dt,ue+Xt,1,Mt.minY,Mt.maxY,He),Jt=Ze(Nr,$e,ue+cr,ue+hr,1,Mt.minY,Mt.maxY,He),Nr=null),Ye>1&&console.timeEnd("clipping"),_e.push(rr||[],G+1,2*ee,2*ue),_e.push(dn||[],G+1,2*ee,2*ue+1),_e.push(Zr||[],G+1,2*ee+1,2*ue),_e.push(Jt||[],G+1,2*ee+1,2*ue+1)}}getTile(Z,G,ee){Z=+Z,G=+G,ee=+ee;const ue=this.options,{extent:Se,debug:Ie}=ue;if(Z<0||Z>24)return null;const Me=1<<Z,_e=ei(Z,G=G+Me&Me-1,ee);if(this.tiles[_e])return nn(this.tiles[_e],Se);Ie>1&&console.log("drilling down to z%d-%d-%d",Z,G,ee);let He,Ye=Z,$e=G,ut=ee;for(;!He&&Ye>0;)Ye--,$e>>=1,ut>>=1,He=this.tiles[ei(Ye,$e,ut)];return He&&He.source?(Ie>1&&(console.log("found parent tile z%d-%d-%d",Ye,$e,ut),console.time("drilling down")),this.splitTile(He.source,Ye,$e,ut,Z,G,ee),Ie>1&&console.timeEnd("drilling down"),this.tiles[_e]?nn(this.tiles[_e],Se):null):null}}function ei(he,Z,G){return 32*((1<<he)*G+Z)+he}function Zt(he,Z){return Z?he.properties[Z]:he.id}function Di(he,Z){if(he==null)return!0;if(he.type==="Feature")return Zt(he,Z)!=null;if(he.type==="FeatureCollection"){const G=new Set;for(const ee of he.features){const ue=Zt(ee,Z);if(ue==null||G.has(ue))return!1;G.add(ue)}return!0}return!1}function Ki(he,Z){const G=new Map;if(he!=null)if(he.type==="Feature")G.set(Zt(he,Z),he);else for(const ee of he.features)G.set(Zt(ee,Z),ee);return G}class Yi extends D{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Z,G){return y._(this,void 0,void 0,function*(){const ee=Z.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ue=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!ue)return null;const Se=new class{constructor(Me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=y.X,this.length=Me.length,this._features=Me}feature(Me){return new class{constructor(_e){this._feature=_e,this.extent=y.X,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))}loadGeometry(){if(this._feature.type===1){const _e=[];for(const He of this._feature.geometry)_e.push([new y.P(He[0],He[1])]);return _e}{const _e=[];for(const He of this._feature.geometry){const Ye=[];for(const $e of He)Ye.push(new y.P($e[0],$e[1]));_e.push(Ye)}return _e}}toGeoJSON(_e,He,Ye){return te.call(this,_e,He,Ye)}}(this._features[Me])}}(ue.features);let Ie=ye(Se);return Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),{vectorTile:Se,rawData:Ie.buffer}})}loadData(Z){return y._(this,void 0,void 0,function*(){var G;(G=this._pendingRequest)===null||G===void 0||G.abort();const ee=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new y.bv(Z.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Z,this._pendingRequest),this._geoJSONIndex=Z.cluster?new nt(function({superclusterOptions:Ie,clusterProperties:Me}){if(!Me||!Ie)return Ie;const _e={},He={},Ye={accumulated:null,zoom:0},$e={properties:null},ut=Object.keys(Me);for(const Mt of ut){const[Dt,cr]=Me[Mt],Xt=y.bC(cr),hr=y.bC(typeof Dt=="string"?[Dt,["accumulated"],["get",Mt]]:Dt);_e[Mt]=Xt.value,He[Mt]=hr.value}return Ie.map=Mt=>{$e.properties=Mt;const Dt={};for(const cr of ut)Dt[cr]=_e[cr].evaluate(Ye,$e);return Dt},Ie.reduce=(Mt,Dt)=>{$e.properties=Dt;for(const cr of ut)Ye.accumulated=Mt[cr],Mt[cr]=He[cr].evaluate(Ye,$e)},Ie}(Z)).load((yield this._pendingData).features):(ue=yield this._pendingData,new jr(ue,Z.geojsonVtOptions)),this.loaded={};const Se={};if(ee){const Ie=ee.finish();Ie&&(Se.resourceTiming={},Se.resourceTiming[Z.source]=JSON.parse(JSON.stringify(Ie)))}return Se}catch(Se){if(delete this._pendingRequest,y.bB(Se))return{abandoned:!0};throw Se}var ue})}getData(){return y._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(Z){const G=this.loaded;return G&&G[Z.uid]?super.reloadTile(Z):this.loadTile(Z)}loadAndProcessGeoJSON(Z,G){return y._(this,void 0,void 0,function*(){let ee=yield this.loadGeoJSON(Z,G);if(delete this._pendingRequest,typeof ee!="object")throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(U(ee,!0),Z.filter){const ue=y.bC(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ue.result==="error")throw new Error(ue.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));ee={type:"FeatureCollection",features:ee.features.filter(Ie=>ue.value.evaluate({zoom:0},Ie))}}return ee})}loadGeoJSON(Z,G){return y._(this,void 0,void 0,function*(){const{promoteId:ee}=Z;if(Z.request){const ue=yield y.h(Z.request,G);return this._dataUpdateable=Di(ue.data,ee)?Ki(ue.data,ee):void 0,ue.data}if(typeof Z.data=="string")try{const ue=JSON.parse(Z.data);return this._dataUpdateable=Di(ue,ee)?Ki(ue,ee):void 0,ue}catch{throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`)}if(!Z.dataDiff)throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Z.source}`);return function(ue,Se,Ie){var Me,_e,He,Ye;if(Se.removeAll&&ue.clear(),Se.remove)for(const $e of Se.remove)ue.delete($e);if(Se.add)for(const $e of Se.add){const ut=Zt($e,Ie);ut!=null&&ue.set(ut,$e)}if(Se.update)for(const $e of Se.update){let ut=ue.get($e.id);if(ut==null)continue;const Mt=!$e.removeAllProperties&&(((Me=$e.removeProperties)===null||Me===void 0?void 0:Me.length)>0||((_e=$e.addOrUpdateProperties)===null||_e===void 0?void 0:_e.length)>0);if(($e.newGeometry||$e.removeAllProperties||Mt)&&(ut=Object.assign({},ut),ue.set($e.id,ut),Mt&&(ut.properties=Object.assign({},ut.properties))),$e.newGeometry&&(ut.geometry=$e.newGeometry),$e.removeAllProperties)ut.properties={};else if(((He=$e.removeProperties)===null||He===void 0?void 0:He.length)>0)for(const Dt of $e.removeProperties)Object.prototype.hasOwnProperty.call(ut.properties,Dt)&&delete ut.properties[Dt];if(((Ye=$e.addOrUpdateProperties)===null||Ye===void 0?void 0:Ye.length)>0)for(const{key:Dt,value:cr}of $e.addOrUpdateProperties)ut.properties[Dt]=cr}}(this._dataUpdateable,Z.dataDiff,ee),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(Z){return y._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(Z){return this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId)}getClusterChildren(Z){return this._geoJSONIndex.getChildren(Z.clusterId)}getClusterLeaves(Z){return this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset)}}class Pn{constructor(Z){this.self=Z,this.actor=new y.F(Z),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(G,ee)=>{if(this.externalWorkerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.externalWorkerSourceTypes[G]=ee},this.self.addProtocol=y.bi,this.self.removeProtocol=y.bj,this.self.registerRTLTextPlugin=G=>{if(y.bD.isParsed())throw new Error("RTL text plugin already registered.");y.bD.setMethods(G)},this.actor.registerMessageHandler("LDT",(G,ee)=>this._getDEMWorkerSource(G,ee.source).loadTile(ee)),this.actor.registerMessageHandler("RDT",(G,ee)=>y._(this,void 0,void 0,function*(){this._getDEMWorkerSource(G,ee.source).removeTile(ee)})),this.actor.registerMessageHandler("GCEZ",(G,ee)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(G,ee.type,ee.source).getClusterExpansionZoom(ee)})),this.actor.registerMessageHandler("GCC",(G,ee)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(G,ee.type,ee.source).getClusterChildren(ee)})),this.actor.registerMessageHandler("GCL",(G,ee)=>y._(this,void 0,void 0,function*(){return this._getWorkerSource(G,ee.type,ee.source).getClusterLeaves(ee)})),this.actor.registerMessageHandler("LD",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).loadData(ee)),this.actor.registerMessageHandler("GD",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).getData()),this.actor.registerMessageHandler("LT",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).loadTile(ee)),this.actor.registerMessageHandler("RT",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).reloadTile(ee)),this.actor.registerMessageHandler("AT",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).abortTile(ee)),this.actor.registerMessageHandler("RMT",(G,ee)=>this._getWorkerSource(G,ee.type,ee.source).removeTile(ee)),this.actor.registerMessageHandler("RS",(G,ee)=>y._(this,void 0,void 0,function*(){if(!this.workerSources[G]||!this.workerSources[G][ee.type]||!this.workerSources[G][ee.type][ee.source])return;const ue=this.workerSources[G][ee.type][ee.source];delete this.workerSources[G][ee.type][ee.source],ue.removeSource!==void 0&&ue.removeSource(ee)})),this.actor.registerMessageHandler("RM",G=>y._(this,void 0,void 0,function*(){delete this.layerIndexes[G],delete this.availableImages[G],delete this.workerSources[G],delete this.demWorkerSources[G]})),this.actor.registerMessageHandler("SR",(G,ee)=>y._(this,void 0,void 0,function*(){this.referrer=ee})),this.actor.registerMessageHandler("SRPS",(G,ee)=>this._syncRTLPluginState(G,ee)),this.actor.registerMessageHandler("IS",(G,ee)=>y._(this,void 0,void 0,function*(){this.self.importScripts(ee)})),this.actor.registerMessageHandler("SI",(G,ee)=>this._setImages(G,ee)),this.actor.registerMessageHandler("UL",(G,ee)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(G).update(ee.layers,ee.removedIds)})),this.actor.registerMessageHandler("SL",(G,ee)=>y._(this,void 0,void 0,function*(){this._getLayerIndex(G).replace(ee)}))}_setImages(Z,G){return y._(this,void 0,void 0,function*(){this.availableImages[Z]=G;for(const ee in this.workerSources[Z]){const ue=this.workerSources[Z][ee];for(const Se in ue)ue[Se].availableImages=G}})}_syncRTLPluginState(Z,G){return y._(this,void 0,void 0,function*(){if(y.bD.isParsed())return y.bD.getState();if(G.pluginStatus!=="loading")return y.bD.setState(G),G;const ee=G.pluginURL;if(this.self.importScripts(ee),y.bD.isParsed()){const ue={pluginStatus:"loaded",pluginURL:ee};return y.bD.setState(ue),ue}throw y.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${ee}`)})}_getAvailableImages(Z){let G=this.availableImages[Z];return G||(G=[]),G}_getLayerIndex(Z){let G=this.layerIndexes[Z];return G||(G=this.layerIndexes[Z]=new c),G}_getWorkerSource(Z,G,ee){if(this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][G]||(this.workerSources[Z][G]={}),!this.workerSources[Z][G][ee]){const ue={sendAsync:(Se,Ie)=>(Se.targetMapId=Z,this.actor.sendAsync(Se,Ie))};switch(G){case"vector":this.workerSources[Z][G][ee]=new D(ue,this._getLayerIndex(Z),this._getAvailableImages(Z));break;case"geojson":this.workerSources[Z][G][ee]=new Yi(ue,this._getLayerIndex(Z),this._getAvailableImages(Z));break;default:this.workerSources[Z][G][ee]=new this.externalWorkerSourceTypes[G](ue,this._getLayerIndex(Z),this._getAvailableImages(Z))}}return this.workerSources[Z][G][ee]}_getDEMWorkerSource(Z,G){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][G]||(this.demWorkerSources[Z][G]=new A),this.demWorkerSources[Z][G]}}return y.i(self)&&(self.worker=new Pn(self)),Pn}),d("index",["exports","./shared"],function(y,c){var T="4.7.1";let P,R;const D={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:v=>new Promise((r,a)=>{const p=requestAnimationFrame(r);v.signal.addEventListener("abort",()=>{cancelAnimationFrame(p),a(c.c())})}),getImageData(v,r=0){return this.getImageCanvasContext(v).getImageData(-r,-r,v.width+2*r,v.height+2*r)},getImageCanvasContext(v){const r=window.document.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return r.width=v.width,r.height=v.height,a.drawImage(v,0,0,v.width,v.height),a},resolveURL:v=>(P||(P=document.createElement("a")),P.href=v,P.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(R==null&&(R=matchMedia("(prefers-reduced-motion: reduce)")),R.matches)}};class A{static testProp(r){if(!A.docStyle)return r[0];for(let a=0;a<r.length;a++)if(r[a]in A.docStyle)return r[a];return r[0]}static create(r,a,p){const f=window.document.createElement(r);return a!==void 0&&(f.className=a),p&&p.appendChild(f),f}static createNS(r,a){return window.document.createElementNS(r,a)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(r,a){r.style[A.transformProp]=a}static addEventListener(r,a,p,f={}){r.addEventListener(a,p,"passive"in f?f:f.capture)}static removeEventListener(r,a,p,f={}){r.removeEventListener(a,p,"passive"in f?f:f.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(r){const a=r.getBoundingClientRect();return{x:a.width/r.offsetWidth||1,y:a.height/r.offsetHeight||1,boundingClientRect:a}}static getPoint(r,a,p){const f=a.boundingClientRect;return new c.P((p.clientX-f.left)/a.x-r.clientLeft,(p.clientY-f.top)/a.y-r.clientTop)}static mousePos(r,a){const p=A.getScale(r);return A.getPoint(r,p,a)}static touchPos(r,a){const p=[],f=A.getScale(r);for(let _=0;_<a.length;_++)p.push(A.getPoint(r,f,a[_]));return p}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const N={supported:!1,testSupport:function(v){!te&&U&&(F?$(v):X=v)}};let X,U,te=!1,F=!1;function $(v){const r=v.createTexture();v.bindTexture(v.TEXTURE_2D,r);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,U),v.isContextLost())return;N.supported=!0}catch{}v.deleteTexture(r),te=!0}var q;typeof document<"u"&&(U=document.createElement("img"),U.onload=()=>{X&&$(X),X=null,F=!0},U.onerror=()=>{te=!0,X=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let r,a,p,f;v.resetRequestQueue=()=>{r=[],a=0,p=0,f={}},v.addThrottleControl=C=>{const z=p++;return f[z]=C,z},v.removeThrottleControl=C=>{delete f[C],S()},v.getImage=(C,z,O=!0)=>new Promise((B,K)=>{N.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),c.e(C,{type:"image"}),r.push({abortController:z,requestParameters:C,supportImageRefresh:O,state:"queued",onError:Q=>{K(Q)},onSuccess:Q=>{B(Q)}}),S()});const _=C=>c._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:z,supportImageRefresh:O,onError:B,onSuccess:K,abortController:Q}=C,re=O===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((me,we)=>me&&we==="accept",!0));a++;const ce=re?k(z,Q):c.m(z,Q);try{const me=yield ce;delete C.abortController,C.state="completed",me.data instanceof HTMLImageElement||c.b(me.data)?K(me):me.data&&K({data:yield(fe=me.data,typeof createImageBitmap=="function"?c.d(fe):c.f(fe)),cacheControl:me.cacheControl,expires:me.expires})}catch(me){delete C.abortController,B(me)}finally{a--,S()}var fe}),S=()=>{const C=(()=>{for(const z of Object.keys(f))if(f[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=a;z<C&&r.length>0;z++){const O=r.shift();O.abortController.signal.aborted?z--:_(O)}},k=(C,z)=>new Promise((O,B)=>{const K=new Image,Q=C.url,re=C.credentials;re&&re==="include"?K.crossOrigin="use-credentials":(re&&re==="same-origin"||!c.s(Q))&&(K.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{K.src="",B(c.c())}),K.fetchPriority="high",K.onload=()=>{K.onerror=K.onload=null,O({data:K})},K.onerror=()=>{K.onerror=K.onload=null,z.signal.aborted||B(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},K.src=Q})}(q||(q={})),q.resetRequestQueue();class ne{constructor(r){this._transformRequestFn=r}transformRequest(r,a){return this._transformRequestFn&&this._transformRequestFn(r,a)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function se(v){var r=new c.A(3);return r[0]=v[0],r[1]=v[1],r[2]=v[2],r}var Ee,ge=function(v,r,a){return v[0]=r[0]-a[0],v[1]=r[1]-a[1],v[2]=r[2]-a[2],v};Ee=new c.A(3),c.A!=Float32Array&&(Ee[0]=0,Ee[1]=0,Ee[2]=0);var Oe=function(v){var r=v[0],a=v[1];return r*r+a*a};function Fe(v){const r=[];if(typeof v=="string")r.push({id:"default",url:v});else if(v&&v.length>0){const a=[];for(const{id:p,url:f}of v){const _=`${p}${f}`;a.indexOf(_)===-1&&(a.push(_),r.push({id:p,url:f}))}}return r}function Ge(v,r,a){const p=v.split("?");return p[0]+=`${r}${a}`,p.join("?")}(function(){var v=new c.A(2);c.A!=Float32Array&&(v[0]=0,v[1]=0)})();class it{constructor(r,a,p,f){this.context=r,this.format=p,this.texture=r.gl.createTexture(),this.update(a,f)}update(r,a,p){const{width:f,height:_}=r,S=!(this.size&&this.size[0]===f&&this.size[1]===_||p),{context:k}=this,{gl:C}=k;if(this.useMipmap=!!(a&&a.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!a||a.premultiply!==!1)),S)this.size=[f,_],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||c.b(r)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,r):C.texImage2D(C.TEXTURE_2D,0,this.format,f,_,0,this.format,C.UNSIGNED_BYTE,r.data);else{const{x:z,y:O}=p||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||c.b(r)?C.texSubImage2D(C.TEXTURE_2D,0,z,O,C.RGBA,C.UNSIGNED_BYTE,r):C.texSubImage2D(C.TEXTURE_2D,0,z,O,f,_,C.RGBA,C.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(r,a,p){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),p!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=_.LINEAR),r!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,p||r),this.filter=r),a!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function ve(v){const{userImage:r}=v;return!!(r&&r.render&&r.render())&&(v.data.replace(new Uint8Array(r.data.buffer)),!0)}class je extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:a,promiseResolve:p}of this.requestors)p(this._getImagesForIds(a));this.requestors=[]}}getImage(r){const a=this.images[r];if(a&&!a.data&&a.spriteData){const p=a.spriteData;a.data=new c.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),a.spriteData=null}return a}addImage(r,a){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,a)&&(this.images[r]=a)}_validate(r,a){let p=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "stretchX" value`))),p=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "stretchY" value`))),p=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${r}" has invalid "content" value`))),p=!1),p}_validateStretch(r,a){if(!r)return!0;let p=0;for(const f of r){if(f[0]<p||f[1]<f[0]||a<f[1])return!1;p=f[1]}return!0}_validateContent(r,a){if(!r)return!0;if(r.length!==4)return!1;const p=a.spriteData,f=p&&p.width||a.data.width,_=p&&p.height||a.data.height;return!(r[0]<0||f<r[0]||r[1]<0||_<r[1]||r[2]<0||f<r[2]||r[3]<0||_<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,a,p=!0){const f=this.getImage(r);if(p&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[r]=a,this.updatedImages[r]=!0}removeImage(r){const a=this.images[r];delete this.images[r],delete this.patterns[r],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((a,p)=>{let f=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:a})})}_getImagesForIds(r){const a={};for(const p of r){let f=this.getImage(p);f||(this.fire(new c.k("styleimagemissing",{id:p})),f=this.getImage(p)),f?a[p]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:r,height:a}=this.atlasImage;return{width:r,height:a}}getPattern(r){const a=this.patterns[r],p=this.getImage(r);if(!p)return null;if(a&&a.position.version===p.version)return a.position;if(a)a.position.version=p.version;else{const f={w:p.data.width+2,h:p.data.height+2,x:0,y:0},_=new c.I(f,p);this.patterns[r]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const a=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new it(r,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const _ in this.patterns)r.push(this.patterns[_].bin);const{w:a,h:p}=c.p(r),f=this.atlasImage;f.resize({width:a||1,height:p||1});for(const _ in this.patterns){const{bin:S}=this.patterns[_],k=S.x+1,C=S.y+1,z=this.getImage(_).data,O=z.width,B=z.height;c.R.copy(z,f,{x:0,y:0},{x:k,y:C},{width:O,height:B}),c.R.copy(z,f,{x:0,y:B-1},{x:k,y:C-1},{width:O,height:1}),c.R.copy(z,f,{x:0,y:0},{x:k,y:C+B},{width:O,height:1}),c.R.copy(z,f,{x:O-1,y:0},{x:k-1,y:C},{width:1,height:B}),c.R.copy(z,f,{x:0,y:0},{x:k+O,y:C},{width:1,height:B})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const a of r){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const p=this.getImage(a);p||c.w(`Image with ID: "${a}" was not found`),ve(p)&&this.updateImage(a,p)}}}const H=1e20;function Re(v,r,a,p,f,_,S,k,C){for(let z=r;z<r+p;z++)_t(v,a*_+z,_,f,S,k,C);for(let z=a;z<a+f;z++)_t(v,z*_+r,1,p,S,k,C)}function _t(v,r,a,p,f,_,S){_[0]=0,S[0]=-H,S[1]=H,f[0]=v[r];for(let k=1,C=0,z=0;k<p;k++){f[k]=v[r+k*a];const O=k*k;do{const B=_[C];z=(f[k]-f[B]+O-B*B)/(k-B)/2}while(z<=S[C]&&--C>-1);C++,_[C]=k,S[C]=z,S[C+1]=H}for(let k=0,C=0;k<p;k++){for(;S[C+1]<k;)C++;const z=_[C],O=k-z;v[r+k*a]=f[z]+O*O}}class ye{constructor(r,a){this.requestManager=r,this.localIdeographFontFamily=a,this.entries={}}setURL(r){this.url=r}getGlyphs(r){return c._(this,void 0,void 0,function*(){const a=[];for(const _ in r)for(const S of r[_])a.push(this._getAndCacheGlyphsPromise(_,S));const p=yield Promise.all(a),f={};for(const{stack:_,id:S,glyph:k}of p)f[_]||(f[_]={}),f[_][S]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return f})}_getAndCacheGlyphsPromise(r,a){return c._(this,void 0,void 0,function*(){let p=this.entries[r];p||(p=this.entries[r]={glyphs:{},requests:{},ranges:{}});let f=p.glyphs[a];if(f!==void 0)return{stack:r,id:a,glyph:f};if(f=this._tinySDF(p,r,a),f)return p.glyphs[a]=f,{stack:r,id:a,glyph:f};const _=Math.floor(a/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[_])return{stack:r,id:a,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[_]){const k=ye.loadGlyphRange(r,_,this.url,this.requestManager);p.requests[_]=k}const S=yield p.requests[_];for(const k in S)this._doesCharSupportLocalGlyph(+k)||(p.glyphs[+k]=S[+k]);return p.ranges[_]=!0,{stack:r,id:a,glyph:S[a]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(r))}_tinySDF(r,a,p){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(p))return;let _=r.tinySDF;if(!_){let k="400";/bold/i.test(a)?k="900":/medium/i.test(a)?k="500":/light/i.test(a)&&(k="200"),_=r.tinySDF=new ye.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:k})}const S=_.draw(String.fromCharCode(p));return{id:p,bitmap:new c.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}ye.loadGlyphRange=function(v,r,a,p){return c._(this,void 0,void 0,function*(){const f=256*r,_=f+255,S=p.transformRequest(a.replace("{fontstack}",v).replace("{range}",`${f}-${_}`),"Glyphs"),k=yield c.l(S,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${r}, ${f}-${_}`);const C={};for(const z of c.n(k.data))C[z.id]=z;return C})},ye.TinySDF=class{constructor({fontSize:v=24,buffer:r=3,radius:a=8,cutoff:p=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:S="normal"}={}){this.buffer=r,this.cutoff=p,this.radius=a;const k=this.size=v+4*r,C=this._createCanvas(k),z=this.ctx=C.getContext("2d",{willReadFrequently:!0});z.font=`${S} ${_} ${v}px ${f}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(v){const r=document.createElement("canvas");return r.width=r.height=v,r}draw(v){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:p,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(v),S=Math.ceil(a),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),C=Math.min(this.size-this.buffer,S+Math.ceil(p)),z=k+2*this.buffer,O=C+2*this.buffer,B=Math.max(z*O,0),K=new Uint8ClampedArray(B),Q={data:K,width:z,height:O,glyphWidth:k,glyphHeight:C,glyphTop:S,glyphLeft:0,glyphAdvance:r};if(k===0||C===0)return Q;const{ctx:re,buffer:ce,gridInner:fe,gridOuter:me}=this;re.clearRect(ce,ce,k,C),re.fillText(v,ce,ce+S);const we=re.getImageData(ce,ce,k,C);me.fill(H,0,B),fe.fill(0,0,B);for(let ae=0;ae<C;ae++)for(let Ce=0;Ce<k;Ce++){const Pe=we.data[4*(ae*k+Ce)+3]/255;if(Pe===0)continue;const De=(ae+ce)*z+Ce+ce;if(Pe===1)me[De]=0,fe[De]=H;else{const Xe=.5-Pe;me[De]=Xe>0?Xe*Xe:0,fe[De]=Xe<0?Xe*Xe:0}}Re(me,0,0,z,O,z,this.f,this.v,this.z),Re(fe,ce,ce,k,C,z,this.f,this.v,this.z);for(let ae=0;ae<B;ae++){const Ce=Math.sqrt(me[ae])-Math.sqrt(fe[ae]);K[ae]=Math.round(255-255*(Ce/this.radius+this.cutoff))}return Q}};class Be{constructor(){this.specification=c.v.light.position}possiblyEvaluate(r,a){return c.x(r.expression.evaluate(a))}interpolate(r,a,p){return{x:c.y.number(r.x,a.x,p),y:c.y.number(r.y,a.y,p),z:c.y.number(r.z,a.z,p)}}}let Le;class Ke extends c.E{constructor(r){super(),Le=Le||new c.q({anchor:new c.D(c.v.light.anchor),position:new Be,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Le),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,a={}){if(!this._validate(c.r,r,a))for(const p in r){const f=r[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),f):this._transitionable.setValue(p,f)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,a,p){return(!p||p.validate!==!1)&&c.t(this,r.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const xe=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Te extends c.E{constructor(r){super(),this._transitionable=new c.T(xe),this.setSky(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(r,a={}){if(!this._validate(c.B,r,a)){r||(r={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in r){const f=r[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),f):this._transitionable.setValue(p,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,a,p={}){return(p==null?void 0:p.validate)!==!1&&c.t(this,r.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(r){return r<60?0:r<70?(r-60)/10:1}}class ft{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,a){const p=r.join(",")+String(a);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(r,a)),this.dashEntry[p]}getDashRanges(r,a,p){const f=[];let _=r.length%2==1?-r[r.length-1]*p:0,S=r[0]*p,k=!0;f.push({left:_,right:S,isDash:k,zeroLength:r[0]===0});let C=r[0];for(let z=1;z<r.length;z++){k=!k;const O=r[z];_=C*p,C+=O,S=C*p,f.push({left:_,right:S,isDash:k,zeroLength:O===0})}return f}addRoundDash(r,a,p){const f=a/2;for(let _=-p;_<=p;_++){const S=this.width*(this.nextRow+p+_);let k=0,C=r[k];for(let z=0;z<this.width;z++){z/C.right>1&&(C=r[++k]);const O=Math.abs(z-C.left),B=Math.abs(z-C.right),K=Math.min(O,B);let Q;const re=_/p*(f+1);if(C.isDash){const ce=f-Math.abs(re);Q=Math.sqrt(K*K+ce*ce)}else Q=f-Math.sqrt(K*K+re*re);this.data[S+z]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(r){for(let k=r.length-1;k>=0;--k){const C=r[k],z=r[k+1];C.zeroLength?r.splice(k,1):z&&z.isDash===C.isDash&&(z.left=C.left,r.splice(k,1))}const a=r[0],p=r[r.length-1];a.isDash===p.isDash&&(a.left=p.left-this.width,p.right=a.right+this.width);const f=this.width*this.nextRow;let _=0,S=r[_];for(let k=0;k<this.width;k++){k/S.right>1&&(S=r[++_]);const C=Math.abs(k-S.left),z=Math.abs(k-S.right),O=Math.min(C,z);this.data[f+k]=Math.max(0,Math.min(255,(S.isDash?O:-O)+128))}}addDash(r,a){const p=a?7:0,f=2*p+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let _=0;for(let k=0;k<r.length;k++)_+=r[k];if(_!==0){const k=this.width/_,C=this.getDashRanges(r,this.width,k);a?this.addRoundDash(C,k,p):this.addRegularDash(C)}const S={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:_};return this.nextRow+=f,this.dirty=!0,S}bind(r){const a=r.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const nt="maplibre_preloaded_worker_pool";class rt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<rt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[nt]}numActive(){return Object.keys(this.active).length}}const qt=Math.floor(D.hardwareConcurrency/2);let Kt,jt;function Gt(){return Kt||(Kt=new rt),Kt}rt.workerCount=c.C(globalThis)?Math.max(Math.min(qt,3),1):1;class pr{constructor(r,a){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=a;const p=this.workerPool.acquire(a);for(let f=0;f<p.length;f++){const _=new c.F(p[f],a);_.name=`Worker ${f}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,a){const p=[];for(const f of this.actors)p.push(f.sendAsync({type:r,data:a}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,a){for(const p of this.actors)p.registerMessageHandler(r,a)}}function lr(){return jt||(jt=new pr(Gt(),c.G),jt.registerMessageHandler("GR",(v,r,a)=>c.m(r,a))),jt}function gr(v,r){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*v.width,.5*v.height,1]),c.L(a,a,v.calculatePosMatrix(r.toUnwrapped()))}function $r(v,r,a,p,f,_){const S=function(B,K,Q){if(B)for(const re of B){const ce=K[re];if(ce&&ce.source===Q&&ce.type==="fill-extrusion")return!0}else for(const re in K){const ce=K[re];if(ce.source===Q&&ce.type==="fill-extrusion")return!0}return!1}(f&&f.layers,r,v.id),k=_.maxPitchScaleFactor(),C=v.tilesIn(p,k,S);C.sort(V);const z=[];for(const B of C)z.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(r,a,v._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,f,_,k,gr(v.transform,B.tileID))});const O=function(B){const K={},Q={};for(const re of B){const ce=re.queryResults,fe=re.wrappedTileID,me=Q[fe]=Q[fe]||{};for(const we in ce){const ae=ce[we],Ce=me[we]=me[we]||{},Pe=K[we]=K[we]||[];for(const De of ae)Ce[De.featureIndex]||(Ce[De.featureIndex]=!0,Pe.push(De))}}return K}(z);for(const B in O)O[B].forEach(K=>{const Q=K.feature,re=v.getFeatureState(Q.layer["source-layer"],Q.id);Q.source=Q.layer.source,Q.layer["source-layer"]&&(Q.sourceLayer=Q.layer["source-layer"]),Q.state=re});return O}function V(v,r){const a=v.tileID,p=r.tileID;return a.overscaledZ-p.overscaledZ||a.canonical.y-p.canonical.y||a.wrap-p.wrap||a.canonical.x-p.canonical.x}function Ue(v,r,a){return c._(this,void 0,void 0,function*(){let p=v;if(v.url?p=(yield c.h(r.transformRequest(v.url,"Source"),a)).data:yield D.frameAsync(a),!p)return null;const f=c.M(c.e(p,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(f.vectorLayerIds=p.vector_layers.map(_=>_.id)),f})}class ie{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof c.N?new c.N(r.lng,r.lat):c.N.convert(r),this}setSouthWest(r){return this._sw=r instanceof c.N?new c.N(r.lng,r.lat):c.N.convert(r),this}extend(r){const a=this._sw,p=this._ne;let f,_;if(r instanceof c.N)f=r,_=r;else{if(!(r instanceof ie))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(ie.convert(r)):this.extend(c.N.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(c.N.convert(r)):this;if(f=r._sw,_=r._ne,!f||!_)return this}return a||p?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),p.lng=Math.max(_.lng,p.lng),p.lat=Math.max(_.lat,p.lat)):(this._sw=new c.N(f.lng,f.lat),this._ne=new c.N(_.lng,_.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:p}=c.N.convert(r);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&f}static convert(r){return r instanceof ie?r:r&&new ie(r)}static fromLngLat(r,a=0){const p=360*a/40075017,f=p/Math.cos(Math.PI/180*r.lat);return new ie(new c.N(r.lng-f,r.lat-p),new c.N(r.lng+f,r.lat+p))}adjustAntiMeridian(){const r=new c.N(this._sw.lng,this._sw.lat),a=new c.N(this._ne.lng,this._ne.lat);return new ie(r,r.lng>a.lng?new c.N(a.lng+360,a.lat):a)}}class de{constructor(r,a,p){this.bounds=ie.convert(this.validateBounds(r)),this.minzoom=a||0,this.maxzoom=p||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const a=Math.pow(2,r.z),p=Math.floor(c.O(this.bounds.getWest())*a),f=Math.floor(c.Q(this.bounds.getNorth())*a),_=Math.ceil(c.O(this.bounds.getEast())*a),S=Math.ceil(c.Q(this.bounds.getSouth())*a);return r.x>=p&&r.x<_&&r.y>=f&&r.y<S}}class oe extends c.E{constructor(r,a,p,f){if(super(),this.id=r,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Ue(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(c.e(this,r),r.bounds&&(this.tileBounds=new de(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new c.j(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(r){return c._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(a,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};p.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((_,S)=>{r.reloadPromise={resolve:_,reject:S}})}else r.actor=this.dispatcher.getActor(),f="LT";r.abortController=new AbortController;try{const _=yield r.actor.sendAsync({type:f,data:p},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,_)}catch(_){if(delete r.abortController,r.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,a){if(a&&a.resourceTiming&&(r.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&r.setExpiryData(a),r.loadVectorData(a,this.map.painter),r.reloadPromise){const p=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(p.resolve).catch(p.reject)}}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class ke extends c.E{constructor(r,a,p,f){super(),this.id=r,this.dispatcher=p,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Ue(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(c.e(this,r),r.bounds&&(this.tileBounds=new de(r.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new c.j(r))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return c.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return c._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const p=yield q.getImage(this.map._requestManager.transformRequest(a,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&r.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const f=this.map.painter.context,_=f.gl,S=p.data;r.texture=this.map.painter.getTileTexture(S.width),r.texture?r.texture.update(S,{useMipmap:!0}):(r.texture=new it(f,S,_.RGBA,{useMipmap:!0}),r.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),r.state="loaded"}}catch(p){if(delete r.abortController,r.aborted)r.state="unloaded";else if(p)throw r.state="errored",p}})}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class Ze extends ke{constructor(r,a,p,f){super(r,a,p,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(r){return c._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(a,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const f=yield q.getImage(p,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(f&&f.data){const _=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&r.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const S=c.b(_)&&c.U()?_:yield this.readImageNow(_),k={type:this.type,uid:r.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const C=yield r.actor.sendAsync({type:"LDT",data:k});r.dem=C,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(f){if(delete r.abortController,r.aborted)r.state="unloaded";else if(f)throw r.state="errored",f}})}readImageNow(r){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=r.width+2,p=r.height+2;try{return new c.R({width:a,height:p},yield c.W(r,-1,-1,a,p))}catch{}}return D.getImageData(r,1)})}_getNeighboringTiles(r){const a=r.canonical,p=Math.pow(2,a.z),f=(a.x-1+p)%p,_=a.x===0?r.wrap-1:r.wrap,S=(a.x+1+p)%p,k=a.x+1===p?r.wrap+1:r.wrap,C={};return C[new c.S(r.overscaledZ,_,a.z,f,a.y).key]={backfilled:!1},C[new c.S(r.overscaledZ,k,a.z,S,a.y).key]={backfilled:!1},a.y>0&&(C[new c.S(r.overscaledZ,_,a.z,f,a.y-1).key]={backfilled:!1},C[new c.S(r.overscaledZ,r.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},C[new c.S(r.overscaledZ,k,a.z,S,a.y-1).key]={backfilled:!1}),a.y+1<p&&(C[new c.S(r.overscaledZ,_,a.z,f,a.y+1).key]={backfilled:!1},C[new c.S(r.overscaledZ,r.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},C[new c.S(r.overscaledZ,k,a.z,S,a.y+1).key]={backfilled:!1}),C}unloadTile(r){return c._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class tt extends c.E{constructor(r,a,p,f){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(f),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const _=c.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*_,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*_,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*_,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}getData(){return c._(this,void 0,void 0,function*(){const r=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,a,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:a,offset:p}})}_updateWorkerData(r){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);r?a.dataDiff=r:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(D.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let f=null;p.resourceTiming&&p.resourceTiming[this.id]&&(f=p.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&c.e(_,{resourceTiming:f}),this.fire(new c.k("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(p))}})}loaded(){return this._pendingLoads===0}loadTile(r){return c._(this,void 0,void 0,function*(){const a=r.actor?"RT":"LT";r.actor=this.actor;const p={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:p},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(f,this.map.painter,a==="RT")})}abortTile(r){return c._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return c._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ne=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class st extends c.E{constructor(r,a,p,f){super(),this.id=r,this.dispatcher=p,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(r){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield q.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,r&&(this.coordinates=r),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const a=r.map(c.Z.fromLngLat);this.tileID=function(f){let _=1/0,S=1/0,k=-1/0,C=-1/0;for(const K of f)_=Math.min(_,K.x),S=Math.min(S,K.y),k=Math.max(k,K.x),C=Math.max(C,K.y);const z=Math.max(k-_,C-S),O=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),B=Math.pow(2,O);return new c.a1(O,Math.floor((_+k)/2*B),Math.floor((S+C)/2*B))}(a),this.minzoom=this.maxzoom=this.tileID.z;const p=a.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,c.X,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,c.X),this._boundsArray.emplaceBack(p[2].x,p[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,a=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new it(r,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let p=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,p=!0)}p&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class St extends st{constructor(r,a,p,f){super(r,a,p,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const a of r.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const a=this.video.seekable;r<a.start(0)||r>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,a=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new it(r,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let p=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,p=!0)}p&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class at extends st{constructor(r,a,p,f){super(r,a,p,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(S=>typeof S!="number"))||this.fire(new c.j(new c.a2(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${r}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${r}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,p=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ne.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new it(a,this.canvas,p.RGBA,{premultiply:!0});let f=!1;for(const _ in this.tiles){const S=this.tiles[_];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const Lt={},vr=v=>{switch(v){case"geojson":return tt;case"image":return st;case"raster":return ke;case"raster-dem":return Ze;case"vector":return oe;case"video":return St;case"canvas":return at}return Lt[v]},We="RTLPluginLoaded";class Gr extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=lr()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return c._(this,arguments,void 0,function*(a,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=D.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(We))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let nn=null;function on(){return nn||(nn=new Gr),nn}class Qn{constructor(r,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const a=r+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,a,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(f,_){const S={};if(!_)return S;for(const k of f){const C=k.layerIds.map(z=>_.getLayer(z)).filter(Boolean);if(C.length!==0){k.layers=C,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(z=>C.filter(O=>O.id===z)[0]));for(const z of C)S[z.id]=k}}return S}(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a6){if(this.hasSymbolBuckets=!0,!p)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a6&&_.hasRTLText){this.hasRTLText=!0,on().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(_))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const p in this.buckets){const f=this.buckets[p];f.uploadPending()&&f.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new it(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new it(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,p,f,_,S,k,C,z,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:S,tileSize:this.tileSize,pixelPosMatrix:O,transform:C,params:k,queryPadding:this.queryPadding*z},r,a,p):{}}querySourceFeatures(r,a){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const f=p.loadVTLayers(),_=a&&a.sourceLayer?a.sourceLayer:"",S=f._geojsonTileLayer||f[_];if(!S)return;const k=c.a7(a&&a.filter),{z:C,x:z,y:O}=this.tileID.canonical,B={z:C,x:z,y:O};for(let K=0;K<S.length;K++){const Q=S.feature(K);if(k.needGeometry){const fe=c.a8(Q,!0);if(!k.filter(new c.z(this.tileID.overscaledZ),fe,this.tileID.canonical))continue}else if(!k.filter(new c.z(this.tileID.overscaledZ),Q))continue;const re=p.getId(Q,_),ce=new c.a9(Q,C,z,O,re);ce.tile=B,r.push(ce)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const p=c.aa(r.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const p=Date.now();let f=!1;if(this.expirationTime>p)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const _=this.expirationTime-a;_?this.expirationTime=p+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const _=this.buckets[f],S=_.layers[0].sourceLayer||"_geojsonTileLayer",k=p[S],C=r[S];if(!k||!C||Object.keys(C).length===0)continue;_.update(C,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=a&&a.style&&a.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<D.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=D.now()+r}setDependencies(r,a){const p={};for(const f of a)p[f]=!0;this.dependencies[r]=p}hasDependency(r,a){for(const p of r){const f=this.dependencies[p];if(f){for(const _ of a)if(f[_])return!0}}return!1}}class Qe{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,p){const f=r.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:a,timeout:void 0};if(p!==void 0&&(_.timeout=setTimeout(()=>{this.remove(r,_)},p)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const p=r.wrapped().key,f=a===void 0?0:this.data[p].indexOf(a),_=this.data[p][f];return this.data[p].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(_.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const p in this.data)for(const f of this.data[p])r(f.value)||a.push(f);for(const p of a)this.remove(p.value.tileID,p)}}class Wt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,p){const f=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][f]=this.stateChanges[r][f]||{},c.e(this.stateChanges[r][f],p),this.deletedStates[r]===null){this.deletedStates[r]={};for(const _ in this.state[r])_!==f&&(this.deletedStates[r][_]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][f]===null){this.deletedStates[r][f]={};for(const _ in this.state[r][f])p[_]||(this.deletedStates[r][f][_]=null)}else for(const _ in p)this.deletedStates[r]&&this.deletedStates[r][f]&&this.deletedStates[r][f][_]===null&&delete this.deletedStates[r][f][_]}removeFeatureState(r,a,p){if(this.deletedStates[r]===null)return;const f=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},p&&a!==void 0)this.deletedStates[r][f]!==null&&(this.deletedStates[r][f]=this.deletedStates[r][f]||{},this.deletedStates[r][f][p]=null);else if(a!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][f])for(p in this.deletedStates[r][f]={},this.stateChanges[r][f])this.deletedStates[r][f][p]=null;else this.deletedStates[r][f]=null;else this.deletedStates[r]=null}getState(r,a){const p=String(a),f=c.e({},(this.state[r]||{})[p],(this.stateChanges[r]||{})[p]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const _=this.deletedStates[r][a];if(_===null)return{};for(const S in _)delete f[S]}return f}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const p={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const S in this.stateChanges[f])this.state[f][S]||(this.state[f][S]={}),c.e(this.state[f][S],this.stateChanges[f][S]),_[S]=this.state[f][S];p[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const S in this.state[f])_[S]={},this.state[f][S]={};else for(const S in this.deletedStates[f]){if(this.deletedStates[f][S]===null)this.state[f][S]={};else for(const k of Object.keys(this.deletedStates[f][S]))delete this.state[f][S][k];_[S]=this.state[f][S]}p[f]=p[f]||{},c.e(p[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const f in r)r[f].setFeatureState(p,a)}}class Bt extends c.E{constructor(r,a,p){super(),this.id=r,this.dispatcher=p,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,S,k)=>{const C=new(vr(_.type))(f,_,S,k);if(C.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${C.id}`);return C})(r,a,p,this),this._tiles={},this._cache=new Qe(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Wt,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const a=this._tiles[r];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,a,p){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,a,p)}catch(f){r.state="errored",f.status!==404?this._source.fire(new c.j(f,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new c.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const p=this._tiles[a];p.upload(r),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(jr).map(r=>r.key)}getRenderableIds(r){const a=[];for(const p in this._tiles)this._isIdRenderable(p,r)&&a.push(this._tiles[p]);return r?a.sort((p,f)=>{const _=p.tileID,S=f.tileID,k=new c.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),C=new c.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-S.overscaledZ||C.y-k.y||C.x-k.x}).map(p=>p.tileID.key):a.map(p=>p.tileID).sort(jr).map(p=>p.key)}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,a){return c._(this,void 0,void 0,function*(){const p=this._tiles[r];p&&(p.state!=="loading"&&(p.state=a),yield this._loadTile(p,r,a))})}_tileLoaded(r,a,p){r.timeAdded=D.now(),p==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const a=this.getRenderableIds();for(let f=0;f<a.length;f++){const _=a[f];if(r.neighboringTiles&&r.neighboringTiles[_]){const S=this.getTileByID(_);p(r,S),p(S,r)}}function p(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let S=_.tileID.canonical.x-f.tileID.canonical.x;const k=_.tileID.canonical.y-f.tileID.canonical.y,C=Math.pow(2,f.tileID.canonical.z),z=_.tileID.key;S===0&&k===0||Math.abs(k)>1||(Math.abs(S)>1&&(Math.abs(S+C)===1?S+=C:Math.abs(S-C)===1&&(S-=C)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,S,k),f.neighboringTiles&&f.neighboringTiles[z]&&(f.neighboringTiles[z].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,p,f){for(const _ in this._tiles){let S=this._tiles[_];if(f[_]||!S.hasData()||S.tileID.overscaledZ<=a||S.tileID.overscaledZ>p)continue;let k=S.tileID;for(;S&&S.tileID.overscaledZ>a+1;){const z=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[z.key],S&&S.hasData()&&(k=z)}let C=k;for(;C.overscaledZ>a;)if(C=C.scaledTo(C.overscaledZ-1),r[C.key]){f[k.key]=k;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const p=this._loadedParentTiles[r.key];return p&&p.tileID.overscaledZ>=a?p:null}for(let p=r.overscaledZ-1;p>=a;p--){const f=r.scaledTo(p),_=this._getLoadedTile(f);if(_)return _}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const a=Math.ceil(r.width/this._source.tileSize)+1,p=Math.ceil(r.height/this._source.tileSize)+1,f=Math.floor(a*p*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(r){const a=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,a){const p={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+a),p[_.tileID.key]=_}this._tiles=p;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(r,a,p,f,_,S){const k={},C={},z=Object.keys(r),O=D.now();for(const B of z){const K=r[B],Q=this._tiles[B];if(!Q||Q.fadeEndTime!==0&&Q.fadeEndTime<=O)continue;const re=this.findLoadedParent(K,a),ce=this.findLoadedSibling(K),fe=re||ce||null;fe&&(this._addTile(fe.tileID),k[fe.tileID.key]=fe.tileID),C[B]=K}this._retainLoadedChildren(C,f,p,r);for(const B in k)r[B]||(this._coveredTiles[B]=!0,r[B]=k[B]);if(S){const B={},K={};for(const Q of _)this._tiles[Q.key].hasData()?B[Q.key]=Q:K[Q.key]=Q;for(const Q in K){const re=K[Q].children(this._source.maxzoom);this._tiles[re[0].key]&&this._tiles[re[1].key]&&this._tiles[re[2].key]&&this._tiles[re[3].key]&&(B[re[0].key]=r[re[0].key]=re[0],B[re[1].key]=r[re[1].key]=re[1],B[re[2].key]=r[re[2].key]=re[2],B[re[3].key]=r[re[3].key]=re[3],delete K[Q])}for(const Q in K){const re=K[Q],ce=this.findLoadedParent(re,this._source.minzoom),fe=this.findLoadedSibling(re),me=ce||fe||null;if(me){B[me.tileID.key]=r[me.tileID.key]=me.tileID;for(const we in B)B[we].isChildOf(me.tileID)&&delete B[we]}}for(const Q in this._tiles)B[Q]||(this._coveredTiles[Q]=!0)}}update(r,a){if(!this._sourceLoaded||this._paused)return;let p;this.transform=r,this.terrain=a,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new c.S(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(p=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(p=p.filter(O=>this._source.hasTile(O)))):p=[];const f=r.coveringZoomLevel(this._source),_=Math.max(f-Bt.maxOverzooming,this._source.minzoom),S=Math.max(f+Bt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const B of p)if(B.canonical.z>this._source.minzoom){const K=B.scaledTo(B.canonical.z-1);O[K.key]=K;const Q=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));O[Q.key]=Q}p=p.concat(Object.values(O))}const k=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(p,f);ei(this._source.type)&&this._updateCoveredAndRetainedTiles(C,_,S,f,p,a);for(const O in C)this._tiles[O].clearFadeHold();const z=c.ab(this._tiles,C);for(const O of z){const B=this._tiles[O];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,a){var p;const f={},_={},S=Math.max(a-Bt.maxOverzooming,this._source.minzoom),k=Math.max(a+Bt.maxUnderzooming,this._source.minzoom),C={};for(const z of r){const O=this._addTile(z);f[z.key]=z,O.hasData()||a<this._source.maxzoom&&(C[z.key]=z)}this._retainLoadedChildren(C,a,k,f);for(const z of r){let O=this._tiles[z.key];if(O.hasData())continue;if(a+1>this._source.maxzoom){const K=z.children(this._source.maxzoom)[0],Q=this.getTile(K);if(Q&&Q.hasData()){f[K.key]=K;continue}}else{const K=z.children(this._source.maxzoom);if(f[K[0].key]&&f[K[1].key]&&f[K[2].key]&&f[K[3].key])continue}let B=O.wasRequested();for(let K=z.overscaledZ-1;K>=S;--K){const Q=z.scaledTo(K);if(_[Q.key])break;if(_[Q.key]=!0,O=this.getTile(Q),!O&&B&&(O=this._addTile(Q)),O){const re=O.hasData();if((re||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||B)&&(f[Q.key]=Q),B=O.wasRequested(),re)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let p,f=this._tiles[r].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){p=this._loadedParentTiles[f.key];break}a.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(p=this._getLoadedTile(_),p)break;f=_}for(const _ of a)this._loadedParentTiles[_]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const r in this._tiles){const a=this._tiles[r].tileID,p=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=p}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const p=a;return a||(a=new Qn(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(a,r.key,a.state)),a.uses++,this._tiles[r.key]=a,p||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const p=a.getExpiryTimeout();p&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},p))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(r){const a=r.sourceDataType;r.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,a,p){const f=[],_=this.transform;if(!_)return f;const S=p?_.getCameraQueryGeometry(r):r,k=r.map(re=>_.pointCoordinate(re,this.terrain)),C=S.map(re=>_.pointCoordinate(re,this.terrain)),z=this.getIds();let O=1/0,B=1/0,K=-1/0,Q=-1/0;for(const re of C)O=Math.min(O,re.x),B=Math.min(B,re.y),K=Math.max(K,re.x),Q=Math.max(Q,re.y);for(let re=0;re<z.length;re++){const ce=this._tiles[z[re]];if(ce.holdingForFade())continue;const fe=ce.tileID,me=Math.pow(2,_.zoom-ce.tileID.overscaledZ),we=a*ce.queryPadding*c.X/ce.tileSize/me,ae=[fe.getTilePoint(new c.Z(O,B)),fe.getTilePoint(new c.Z(K,Q))];if(ae[0].x-we<c.X&&ae[0].y-we<c.X&&ae[1].x+we>=0&&ae[1].y+we>=0){const Ce=k.map(De=>fe.getTilePoint(De)),Pe=C.map(De=>fe.getTilePoint(De));f.push({tile:ce,tileID:fe,queryGeometry:Ce,cameraQueryGeometry:Pe,scale:me})}}return f}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map(p=>this._tiles[p].tileID);for(const p of a)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(ei(this._source.type)){const r=D.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=r)return!0}return!1}setFeatureState(r,a,p){this._state.updateState(r=r||"_geojsonTileLayer",a,p)}removeFeatureState(r,a,p){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,p)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,p){const f=this._tiles[r];f&&f.setDependencies(a,p)}reloadTilesForDependencies(r,a){for(const p in this._tiles)this._tiles[p].hasDependency(r,a)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(r,a))}}function jr(v,r){const a=Math.abs(2*v.wrap)-+(v.wrap<0),p=Math.abs(2*r.wrap)-+(r.wrap<0);return v.overscaledZ-r.overscaledZ||p-a||r.canonical.y-v.canonical.y||r.canonical.x-v.canonical.x}function ei(v){return v==="raster"||v==="image"||v==="video"}Bt.maxOverzooming=10,Bt.maxUnderzooming=3;class Zt{constructor(r,a){this.reset(r,a)}reset(r,a){this.points=r||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=c.ac(r,0,1);let a=1,p=this._distances[a];const f=r*this.paddedLength+this.padding;for(;p<f&&a<this._distances.length;)p=this._distances[++a];const _=a-1,S=this._distances[_],k=p-S,C=k>0?(f-S)/k:0;return this.points[_].mult(1-C).add(this.points[a].mult(C))}}function Di(v,r){let a=!0;return v==="always"||v!=="never"&&r!=="never"||(a=!1),a}class Ki{constructor(r,a,p){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(r/p),this.yCellCount=Math.ceil(a/p);for(let S=0;S<this.xCellCount*this.yCellCount;S++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=a,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,a,p,f,_){this._forEachCell(a,p,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(r,a,p,f){this._forEachCell(a-f,p-f,a+f,p+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(a),this.circles.push(p),this.circles.push(f)}_insertBoxCell(r,a,p,f,_,S){this.boxCells[_].push(S)}_insertCircleCell(r,a,p,f,_,S){this.circleCells[_].push(S)}_query(r,a,p,f,_,S,k){if(p<0||r>this.width||f<0||a>this.height)return[];const C=[];if(r<=0&&a<=0&&this.width<=p&&this.height<=f){if(_)return[{key:null,x1:r,y1:a,x2:p,y2:f}];for(let z=0;z<this.boxKeys.length;z++)C.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const O=this.circles[3*z],B=this.circles[3*z+1],K=this.circles[3*z+2];C.push({key:this.circleKeys[z],x1:O-K,y1:B-K,x2:O+K,y2:B+K})}}else this._forEachCell(r,a,p,f,this._queryCell,C,{hitTest:_,overlapMode:S,seenUids:{box:{},circle:{}}},k);return C}query(r,a,p,f){return this._query(r,a,p,f,!1,null)}hitTest(r,a,p,f,_,S){return this._query(r,a,p,f,!0,_,S).length>0}hitTestCircle(r,a,p,f,_){const S=r-p,k=r+p,C=a-p,z=a+p;if(k<0||S>this.width||z<0||C>this.height)return!1;const O=[];return this._forEachCell(S,C,k,z,this._queryCellCircle,O,{hitTest:!0,overlapMode:f,circle:{x:r,y:a,radius:p},seenUids:{box:{},circle:{}}},_),O.length>0}_queryCell(r,a,p,f,_,S,k,C){const{seenUids:z,hitTest:O,overlapMode:B}=k,K=this.boxCells[_];if(K!==null){const re=this.bboxes;for(const ce of K)if(!z.box[ce]){z.box[ce]=!0;const fe=4*ce,me=this.boxKeys[ce];if(r<=re[fe+2]&&a<=re[fe+3]&&p>=re[fe+0]&&f>=re[fe+1]&&(!C||C(me))&&(!O||!Di(B,me.overlapMode))&&(S.push({key:me,x1:re[fe],y1:re[fe+1],x2:re[fe+2],y2:re[fe+3]}),O))return!0}}const Q=this.circleCells[_];if(Q!==null){const re=this.circles;for(const ce of Q)if(!z.circle[ce]){z.circle[ce]=!0;const fe=3*ce,me=this.circleKeys[ce];if(this._circleAndRectCollide(re[fe],re[fe+1],re[fe+2],r,a,p,f)&&(!C||C(me))&&(!O||!Di(B,me.overlapMode))){const we=re[fe],ae=re[fe+1],Ce=re[fe+2];if(S.push({key:me,x1:we-Ce,y1:ae-Ce,x2:we+Ce,y2:ae+Ce}),O)return!0}}}return!1}_queryCellCircle(r,a,p,f,_,S,k,C){const{circle:z,seenUids:O,overlapMode:B}=k,K=this.boxCells[_];if(K!==null){const re=this.bboxes;for(const ce of K)if(!O.box[ce]){O.box[ce]=!0;const fe=4*ce,me=this.boxKeys[ce];if(this._circleAndRectCollide(z.x,z.y,z.radius,re[fe+0],re[fe+1],re[fe+2],re[fe+3])&&(!C||C(me))&&!Di(B,me.overlapMode))return S.push(!0),!0}}const Q=this.circleCells[_];if(Q!==null){const re=this.circles;for(const ce of Q)if(!O.circle[ce]){O.circle[ce]=!0;const fe=3*ce,me=this.circleKeys[ce];if(this._circlesCollide(re[fe],re[fe+1],re[fe+2],z.x,z.y,z.radius)&&(!C||C(me))&&!Di(B,me.overlapMode))return S.push(!0),!0}}}_forEachCell(r,a,p,f,_,S,k,C){const z=this._convertToXCellCoord(r),O=this._convertToYCellCoord(a),B=this._convertToXCellCoord(p),K=this._convertToYCellCoord(f);for(let Q=z;Q<=B;Q++)for(let re=O;re<=K;re++)if(_.call(this,r,a,p,f,this.xCellCount*re+Q,S,k,C))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,a,p,f,_,S){const k=f-r,C=_-a,z=p+S;return z*z>k*k+C*C}_circleAndRectCollide(r,a,p,f,_,S,k){const C=(S-f)/2,z=Math.abs(r-(f+C));if(z>C+p)return!1;const O=(k-_)/2,B=Math.abs(a-(_+O));if(B>O+p)return!1;if(z<=C||B<=O)return!0;const K=z-C,Q=B-O;return K*K+Q*Q<=p*p}}function Yi(v,r,a,p,f){const _=c.H();return r?(c.K(_,_,[1/f,1/f,1]),a||c.ad(_,_,p.angle)):c.L(_,p.labelPlaneMatrix,v),_}function Pn(v,r,a,p,f){if(r){const _=c.ae(v);return c.K(_,_,[f,f,1]),a||c.ad(_,_,-p.angle),_}return p.glCoordMatrix}function he(v,r,a,p){let f;p?(f=[v,r,p(v,r),1],c.af(f,f,a)):(f=[v,r,0,1],cr(f,f,a));const _=f[3];return{point:new c.P(f[0]/_,f[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function Z(v,r){return .5+v/r*.5}function G(v,r){return v.x>=-r[0]&&v.x<=r[0]&&v.y>=-r[1]&&v.y<=r[1]}function ee(v,r,a,p,f,_,S,k,C,z,O,B,K,Q,re){const ce=p?v.textSizeData:v.iconSizeData,fe=c.ag(ce,a.transform.zoom),me=[256/a.width*2+1,256/a.height*2+1],we=p?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;we.clear();const ae=v.lineVertexArray,Ce=p?v.text.placedSymbolArray:v.icon.placedSymbolArray,Pe=a.transform.width/a.transform.height;let De=!1;for(let Xe=0;Xe<Ce.length;Xe++){const ot=Ce.get(Xe);if(ot.hidden||ot.writingMode===c.ah.vertical&&!De){Dt(ot.numGlyphs,we);continue}De=!1;const mt=he(ot.anchorX,ot.anchorY,r,re);if(!G(mt.point,me)){Dt(ot.numGlyphs,we);continue}const xt=Z(a.transform.cameraToCenterDistance,mt.signedDistanceFromCamera),ht=c.ai(ce,fe,ot),ct=S?ht/xt:ht*xt,Ct={getElevation:re,labelPlaneMatrix:f,lineVertexArray:ae,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(ot.anchorX,ot.anchorY),unwrappedTileID:O,width:B,height:K,translation:Q},Ht=Ie(Ct,ot,ct,!1,k,r,_,v.glyphOffsetArray,we,Pe,C);De=Ht.useVertical,(Ht.notEnoughRoom||De||Ht.needsFlipping&&Ie(Ct,ot,ct,!0,k,r,_,v.glyphOffsetArray,we,Pe,C).notEnoughRoom)&&Dt(ot.numGlyphs,we)}p?v.text.dynamicLayoutVertexBuffer.updateData(we):v.icon.dynamicLayoutVertexBuffer.updateData(we)}function ue(v,r,a,p,f,_,S,k){const C=_.glyphStartIndex+_.numGlyphs,z=_.lineStartIndex,O=_.lineStartIndex+_.lineLength,B=r.getoffsetX(_.glyphStartIndex),K=r.getoffsetX(C-1),Q=ut(v*B,a,p,f,_.segment,z,O,k,S);if(!Q)return null;const re=ut(v*K,a,p,f,_.segment,z,O,k,S);return re?k.projectionCache.anyProjectionOccluded?null:{first:Q,last:re}:null}function Se(v,r,a,p){return v===c.ah.horizontal&&Math.abs(a.y-r.y)>Math.abs(a.x-r.x)*p?{useVertical:!0}:(v===c.ah.vertical?r.y<a.y:r.x>a.x)?{needsFlipping:!0}:null}function Ie(v,r,a,p,f,_,S,k,C,z,O){const B=a/24,K=r.lineOffsetX*B,Q=r.lineOffsetY*B;let re;if(r.numGlyphs>1){const ce=r.glyphStartIndex+r.numGlyphs,fe=r.lineStartIndex,me=r.lineStartIndex+r.lineLength,we=ue(B,k,K,Q,p,r,O,v);if(!we)return{notEnoughRoom:!0};const ae=he(we.first.point.x,we.first.point.y,S,v.getElevation).point,Ce=he(we.last.point.x,we.last.point.y,S,v.getElevation).point;if(f&&!p){const Pe=Se(r.writingMode,ae,Ce,z);if(Pe)return Pe}re=[we.first];for(let Pe=r.glyphStartIndex+1;Pe<ce-1;Pe++)re.push(ut(B*k.getoffsetX(Pe),K,Q,p,r.segment,fe,me,v,O));re.push(we.last)}else{if(f&&!p){const fe=he(v.tileAnchorPoint.x,v.tileAnchorPoint.y,_,v.getElevation).point,me=r.lineStartIndex+r.segment+1,we=new c.P(v.lineVertexArray.getx(me),v.lineVertexArray.gety(me)),ae=he(we.x,we.y,_,v.getElevation),Ce=ae.signedDistanceFromCamera>0?ae.point:function(De,Xe,ot,mt,xt,ht){return Me(De,Xe,ot,1,xt,ht)}(v.tileAnchorPoint,we,fe,0,_,v),Pe=Se(r.writingMode,fe,Ce,z);if(Pe)return Pe}const ce=ut(B*k.getoffsetX(r.glyphStartIndex),K,Q,p,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,v,O);if(!ce||v.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};re=[ce]}for(const ce of re)c.aj(C,ce.point,ce.angle);return{}}function Me(v,r,a,p,f,_){const S=v.add(v.sub(r)._unit()),k=f!==void 0?he(S.x,S.y,f,_.getElevation).point:He(S.x,S.y,_).point,C=a.sub(k);return a.add(C._mult(p/C.mag()))}function _e(v,r,a){const p=r.projectionCache;if(p.projections[v])return p.projections[v];const f=new c.P(r.lineVertexArray.getx(v),r.lineVertexArray.gety(v)),_=He(f.x,f.y,r);if(_.signedDistanceFromCamera>0)return p.projections[v]=_.point,p.anyProjectionOccluded=p.anyProjectionOccluded||_.isOccluded,_.point;const S=v-a.direction;return function(k,C,z,O,B){return Me(k,C,z,O,void 0,B)}(a.distanceFromAnchor===0?r.tileAnchorPoint:new c.P(r.lineVertexArray.getx(S),r.lineVertexArray.gety(S)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,r)}function He(v,r,a){const p=v+a.translation[0],f=r+a.translation[1];let _;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(_=a.projection.projectTileCoordinates(p,f,a.unwrappedTileID,a.getElevation),_.point.x=(.5*_.point.x+.5)*a.width,_.point.y=(.5*-_.point.y+.5)*a.height):(_=he(p,f,a.labelPlaneMatrix,a.getElevation),_.isOccluded=!1),_}function Ye(v,r,a){return v._unit()._perp()._mult(r*a)}function $e(v,r,a,p,f,_,S,k,C){if(k.projectionCache.offsets[v])return k.projectionCache.offsets[v];const z=a.add(r);if(v+C.direction<p||v+C.direction>=f)return k.projectionCache.offsets[v]=z,z;const O=_e(v+C.direction,k,C),B=Ye(O.sub(a),S,C.direction),K=a.add(B),Q=O.add(B);return k.projectionCache.offsets[v]=c.ak(_,z,K,Q)||z,k.projectionCache.offsets[v]}function ut(v,r,a,p,f,_,S,k,C){const z=p?v-r:v+r;let O=z>0?1:-1,B=0;p&&(O*=-1,B=Math.PI),O<0&&(B+=Math.PI);let K,Q=O>0?_+f:_+f+1;k.projectionCache.cachedAnchorPoint?K=k.projectionCache.cachedAnchorPoint:(K=He(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=K);let re,ce,fe=K,me=K,we=0,ae=0;const Ce=Math.abs(z),Pe=[];let De;for(;we+ae<=Ce;){if(Q+=O,Q<_||Q>=S)return null;we+=ae,me=fe,ce=re;const mt={absOffsetX:Ce,direction:O,distanceFromAnchor:we,previousVertex:me};if(fe=_e(Q,k,mt),a===0)Pe.push(me),De=fe.sub(me);else{let xt;const ht=fe.sub(me);xt=ht.mag()===0?Ye(_e(Q+O,k,mt).sub(fe),a,O):Ye(ht,a,O),ce||(ce=me.add(xt)),re=$e(Q,xt,fe,_,S,ce,a,k,mt),Pe.push(ce),De=re.sub(ce)}ae=De.mag()}const Xe=De._mult((Ce-we)/ae)._add(ce||me),ot=B+Math.atan2(fe.y-me.y,fe.x-me.x);return Pe.push(Xe),{point:Xe,angle:C?ot:0,path:Pe}}const Mt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Dt(v,r){for(let a=0;a<v;a++){const p=r.length;r.resize(p+4),r.float32.set(Mt,3*p)}}function cr(v,r,a){const p=r[0],f=r[1];return v[0]=a[0]*p+a[4]*f+a[12],v[1]=a[1]*p+a[5]*f+a[13],v[3]=a[3]*p+a[7]*f+a[15],v}const Xt=100;class hr{constructor(r,a,p=new Ki(r.width+200,r.height+200,25),f=new Ki(r.width+200,r.height+200,25)){this.transform=r,this.mapProjection=a,this.grid=p,this.ignoredGrid=f,this.pitchFactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+Xt,this.screenBottomBoundary=r.height+Xt,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,a,p,f,_,S,k,C,z,O,B){const K=r.anchorPointX+C[0],Q=r.anchorPointY+C[1],re=this.projectAndGetPerspectiveRatio(f,K,Q,_,O),ce=p*re.perspectiveRatio;let fe;if(S||k)fe=this._projectCollisionBox(r,ce,f,_,S,k,C,re,O,B);else{const Pe=re.point.x+(B?B.x*ce:0),De=re.point.y+(B?B.y*ce:0);fe={allPointsOccluded:!1,box:[Pe+r.x1*ce,De+r.y1*ce,Pe+r.x2*ce,De+r.y2*ce]}}const[me,we,ae,Ce]=fe.box;return this.mapProjection.useSpecialProjectionForSymbols&&(S?fe.allPointsOccluded:this.mapProjection.isOccluded(K,Q,_))||re.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(me,we,ae,Ce)||a!=="always"&&this.grid.hitTest(me,we,ae,Ce,a,z)?{box:[me,we,ae,Ce],placeable:!1,offscreen:!1}:{box:[me,we,ae,Ce],placeable:!0,offscreen:this.isOffscreen(me,we,ae,Ce)}}placeCollisionCircles(r,a,p,f,_,S,k,C,z,O,B,K,Q,re,ce,fe){const me=[],we=new c.P(a.anchorX,a.anchorY),ae=this.getPerspectiveRatio(S,we.x,we.y,k,fe),Ce=(B?_/ae:_*ae)/c.ap,Pe={getElevation:fe,labelPlaneMatrix:C,lineVertexArray:p,pitchWithMap:B,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:we,unwrappedTileID:k,width:this.transform.width,height:this.transform.height,translation:ce},De=ue(Ce,f,a.lineOffsetX*Ce,a.lineOffsetY*Ce,!1,a,!1,Pe);let Xe=!1,ot=!1,mt=!0;if(De){const xt=.5*Q*ae+re,ht=new c.P(-100,-100),ct=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ct=new Zt,Ht=De.first,dt=De.last;let yt=[];for(let Yt=Ht.path.length-1;Yt>=1;Yt--)yt.push(Ht.path[Yt]);for(let Yt=1;Yt<dt.path.length;Yt++)yt.push(dt.path[Yt]);const Ut=2.5*xt;if(z){const Yt=this.projectPathToScreenSpace(yt,Pe,z);yt=Yt.some(nr=>nr.signedDistanceFromCamera<=0)?[]:Yt.map(nr=>nr.point)}let Lr=[];if(yt.length>0){const Yt=yt[0].clone(),nr=yt[0].clone();for(let Fr=1;Fr<yt.length;Fr++)Yt.x=Math.min(Yt.x,yt[Fr].x),Yt.y=Math.min(Yt.y,yt[Fr].y),nr.x=Math.max(nr.x,yt[Fr].x),nr.y=Math.max(nr.y,yt[Fr].y);Lr=Yt.x>=ht.x&&nr.x<=ct.x&&Yt.y>=ht.y&&nr.y<=ct.y?[yt]:nr.x<ht.x||Yt.x>ct.x||nr.y<ht.y||Yt.y>ct.y?[]:c.al([yt],ht.x,ht.y,ct.x,ct.y)}for(const Yt of Lr){Ct.reset(Yt,.25*xt);let nr=0;nr=Ct.length<=.5*xt?1:Math.ceil(Ct.paddedLength/Ut)+1;for(let Fr=0;Fr<nr;Fr++){const Mn=Fr/Math.max(nr-1,1),no=Ct.lerp(Mn),Or=no.x+Xt,ni=no.y+Xt;me.push(Or,ni,xt,0);const Vn=Or-xt,zn=ni-xt,Hn=Or+xt,Io=ni+xt;if(mt=mt&&this.isOffscreen(Vn,zn,Hn,Io),ot=ot||this.isInsideGrid(Vn,zn,Hn,Io),r!=="always"&&this.grid.hitTestCircle(Or,ni,xt,r,K)&&(Xe=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Xe}}}}return{circles:!O&&Xe||!ot||ae<this.perspectiveRatioCutoff?[]:me,offscreen:mt,collisionDetected:Xe}}projectPathToScreenSpace(r,a,p){return r.map(f=>he(f.x,f.y,p,a.getElevation))}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let p=1/0,f=1/0,_=-1/0,S=-1/0;for(const O of r){const B=new c.P(O.x+Xt,O.y+Xt);p=Math.min(p,B.x),f=Math.min(f,B.y),_=Math.max(_,B.x),S=Math.max(S,B.y),a.push(B)}const k=this.grid.query(p,f,_,S).concat(this.ignoredGrid.query(p,f,_,S)),C={},z={};for(const O of k){const B=O.key;if(C[B.bucketInstanceId]===void 0&&(C[B.bucketInstanceId]={}),C[B.bucketInstanceId][B.featureIndex])continue;const K=[new c.P(O.x1,O.y1),new c.P(O.x2,O.y1),new c.P(O.x2,O.y2),new c.P(O.x1,O.y2)];c.am(a,K)&&(C[B.bucketInstanceId][B.featureIndex]=!0,z[B.bucketInstanceId]===void 0&&(z[B.bucketInstanceId]=[]),z[B.bucketInstanceId].push(B.featureIndex))}return z}insertCollisionBox(r,a,p,f,_,S){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:S,overlapMode:a},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,a,p,f,_,S){const k=p?this.ignoredGrid:this.grid,C={bucketInstanceId:f,featureIndex:_,collisionGroupID:S,overlapMode:a};for(let z=0;z<r.length;z+=4)k.insertCircle(C,r[z],r[z+1],r[z+2])}projectAndGetPerspectiveRatio(r,a,p,f,_){let S;_?(S=[a,p,_(a,p),1],c.af(S,S,r)):(S=[a,p,0,1],cr(S,S,r));const k=S[3];return{point:new c.P((S[0]/k+1)/2*this.transform.width+Xt,(-S[1]/k+1)/2*this.transform.height+Xt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}getPerspectiveRatio(r,a,p,f,_){const S=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,p,f,_):he(a,p,r,_);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(r,a,p,f){return p<Xt||r>=this.screenRightBoundary||f<Xt||a>this.screenBottomBoundary}isInsideGrid(r,a,p,f){return p>=0&&r<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const r=c.an([]);return c.J(r,r,[-100,-100,0]),r}_projectCollisionBox(r,a,p,f,_,S,k,C,z,O){let B=new c.P(1,0),K=new c.P(0,1);const Q=new c.P(r.anchorPointX+k[0],r.anchorPointY+k[1]);if(S&&!_){const mt=this.projectAndGetPerspectiveRatio(p,Q.x+1,Q.y,f,z).point.sub(C.point).unit(),xt=Math.atan(mt.y/mt.x)+(mt.x<0?Math.PI:0),ht=Math.sin(xt),ct=Math.cos(xt);B=new c.P(ct,ht),K=new c.P(-ht,ct)}else if(!S&&_){const mt=-this.transform.angle,xt=Math.sin(mt),ht=Math.cos(mt);B=new c.P(ht,xt),K=new c.P(-xt,ht)}let re=C.point,ce=a;if(_){re=Q;const mt=this.transform.zoom-Math.floor(this.transform.zoom);ce=Math.pow(2,-mt),ce*=this.mapProjection.getPitchedTextCorrection(this.transform,Q,f),O||(ce*=c.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}O&&(re=re.add(B.mult(O.x*ce)).add(K.mult(O.y*ce)));const fe=r.x1*ce,me=r.x2*ce,we=(fe+me)/2,ae=r.y1*ce,Ce=r.y2*ce,Pe=(ae+Ce)/2,De=[{offsetX:fe,offsetY:ae},{offsetX:we,offsetY:ae},{offsetX:me,offsetY:ae},{offsetX:me,offsetY:Pe},{offsetX:me,offsetY:Ce},{offsetX:we,offsetY:Ce},{offsetX:fe,offsetY:Ce},{offsetX:fe,offsetY:Pe}];let Xe=[];for(const{offsetX:mt,offsetY:xt}of De)Xe.push(new c.P(re.x+B.x*mt+K.x*xt,re.y+B.y*mt+K.y*xt));let ot=!1;if(_){const mt=Xe.map(xt=>this.projectAndGetPerspectiveRatio(p,xt.x,xt.y,f,z));ot=mt.some(xt=>!xt.isOccluded),Xe=mt.map(xt=>xt.point)}else ot=!0;return{box:c.ao(Xe),allPointsOccluded:!ot}}}function rr(v,r,a){return r*(c.X/(v.tileSize*Math.pow(2,a-v.tileID.overscaledZ)))}class dn{constructor(r,a,p,f){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?a:-a))):f&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Zr{constructor(r,a,p,f,_){this.text=new dn(r?r.text:null,a,p,_),this.icon=new dn(r?r.icon:null,a,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Jt{constructor(r,a,p){this.text=r,this.icon=a,this.skipFade=p}}class Sr{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class Nr{constructor(r,a,p,f,_){this.bucketInstanceId=r,this.featureIndex=a,this.sourceLayerIndex=p,this.bucketIndex=f,this.tileID=_}}class _n{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const a=++this.maxGroupID;this.collisionGroups[r]={ID:a,predicate:p=>p.collisionGroupID===a}}return this.collisionGroups[r]}}function En(v,r,a,p,f){const{horizontalAlign:_,verticalAlign:S}=c.au(v);return new c.P(-(_-.5)*r+p[0]*f,-(S-.5)*a+p[1]*f)}class Un{constructor(r,a,p,f,_,S){this.transform=r.clone(),this.terrain=p,this.collisionIndex=new hr(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new _n(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){const a=this.terrain;return a?(p,f)=>a.getElevation(r,p,f):null}getBucketParts(r,a,p,f){const _=p.getBucket(a),S=p.latestFeatureIndex;if(!_||!S||a.id!==_.layerIds[0])return;const k=p.collisionBoxArray,C=_.layers[0].layout,z=_.layers[0].paint,O=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),B=p.tileSize/c.X,K=p.tileID.toUnwrapped(),Q=this.transform.calculatePosMatrix(K),re=C.get("text-pitch-alignment")==="map",ce=C.get("text-rotation-alignment")==="map",fe=rr(p,1,this.transform.zoom),me=this.collisionIndex.mapProjection.translatePosition(this.transform,p,z.get("text-translate"),z.get("text-translate-anchor")),we=this.collisionIndex.mapProjection.translatePosition(this.transform,p,z.get("icon-translate"),z.get("icon-translate-anchor")),ae=Yi(Q,re,ce,this.transform,fe);let Ce=null;if(re){const De=Pn(Q,re,ce,this.transform,fe);Ce=c.L([],this.transform.labelPlaneMatrix,De)}this.retainedQueryData[_.bucketInstanceId]=new Nr(_.bucketInstanceId,S,_.sourceLayerIndex,_.index,p.tileID);const Pe={bucket:_,layout:C,translationText:me,translationIcon:we,posMatrix:Q,unwrappedTileID:K,textLabelPlaneMatrix:ae,labelToScreenMatrix:Ce,scale:O,textPixelRatio:B,holdingForFade:p.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.ag(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const De of _.sortKeyRanges){const{sortKey:Xe,symbolInstanceStart:ot,symbolInstanceEnd:mt}=De;r.push({sortKey:Xe,symbolInstanceStart:ot,symbolInstanceEnd:mt,parameters:Pe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:Pe})}attemptAnchorPlacement(r,a,p,f,_,S,k,C,z,O,B,K,Q,re,ce,fe,me,we,ae){const Ce=c.aq[r.textAnchor],Pe=[r.textOffset0,r.textOffset1],De=En(Ce,p,f,Pe,_),Xe=this.collisionIndex.placeCollisionBox(a,K,C,z,O,k,S,fe,B.predicate,ae,De);if((!we||this.collisionIndex.placeCollisionBox(we,K,C,z,O,k,S,me,B.predicate,ae,De).placeable)&&Xe.placeable){let ot;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID].text&&(ot=this.prevPlacement.variableOffsets[Q.crossTileID].anchor),Q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Q.crossTileID]={textOffset:Pe,width:p,height:f,anchor:Ce,textBoxScale:_,prevAnchor:ot},this.markUsedJustification(re,Ce,Q,ce),re.allowVerticalPlacement&&(this.markUsedOrientation(re,ce,Q),this.placedOrientations[Q.crossTileID]=ce),{shift:De,placedGlyphBoxes:Xe}}}placeLayerBucketPart(r,a,p){const{bucket:f,layout:_,translationText:S,translationIcon:k,posMatrix:C,unwrappedTileID:z,textLabelPlaneMatrix:O,labelToScreenMatrix:B,textPixelRatio:K,holdingForFade:Q,collisionBoxArray:re,partiallyEvaluatedTextSize:ce,collisionGroup:fe}=r.parameters,me=_.get("text-optional"),we=_.get("icon-optional"),ae=c.ar(_,"text-overlap","text-allow-overlap"),Ce=ae==="always",Pe=c.ar(_,"icon-overlap","icon-allow-overlap"),De=Pe==="always",Xe=_.get("text-rotation-alignment")==="map",ot=_.get("text-pitch-alignment")==="map",mt=_.get("icon-text-fit")!=="none",xt=_.get("symbol-z-order")==="viewport-y",ht=Ce&&(De||!f.hasIconData()||we),ct=De&&(Ce||!f.hasTextData()||me);!f.collisionArrays&&re&&f.deserializeCollisionBoxes(re);const Ct=this._getTerrainElevationFunc(this.retainedQueryData[f.bucketInstanceId].tileID),Ht=(dt,yt,Ut)=>{var Lr,Yt;if(a[dt.crossTileID])return;if(Q)return void(this.placements[dt.crossTileID]=new Jt(!1,!1,!1));let nr=!1,Fr=!1,Mn=!0,no=null,Or={box:null,placeable:!1,offscreen:null},ni={box:null,placeable:!1,offscreen:null},Vn=null,zn=null,Hn=null,Io=0,wa=0,Bu=0;yt.textFeatureIndex?Io=yt.textFeatureIndex:dt.useRuntimeCollisionCircles&&(Io=dt.featureIndex),yt.verticalTextFeatureIndex&&(wa=yt.verticalTextFeatureIndex);const ba=yt.textBox;if(ba){const Ni=kn=>{let Dn=c.ah.horizontal;if(f.allowVerticalPlacement&&!kn&&this.prevPlacement){const vi=this.prevPlacement.placedOrientations[dt.crossTileID];vi&&(this.placedOrientations[dt.crossTileID]=vi,Dn=vi,this.markUsedOrientation(f,Dn,dt))}return Dn},$i=(kn,Dn)=>{if(f.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&yt.verticalTextBox){for(const vi of f.writingModes)if(vi===c.ah.vertical?(Or=Dn(),ni=Or):Or=kn(),Or&&Or.placeable)break}else Or=kn()},ss=dt.textAnchorOffsetStartIndex,io=dt.textAnchorOffsetEndIndex;if(io===ss){const kn=(Dn,vi)=>{const or=this.collisionIndex.placeCollisionBox(Dn,ae,K,C,z,ot,Xe,S,fe.predicate,Ct);return or&&or.placeable&&(this.markUsedOrientation(f,vi,dt),this.placedOrientations[dt.crossTileID]=vi),or};$i(()=>kn(ba,c.ah.horizontal),()=>{const Dn=yt.verticalTextBox;return f.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&Dn?kn(Dn,c.ah.vertical):{box:null,offscreen:null}}),Ni(Or&&Or.placeable)}else{let kn=c.aq[(Yt=(Lr=this.prevPlacement)===null||Lr===void 0?void 0:Lr.variableOffsets[dt.crossTileID])===null||Yt===void 0?void 0:Yt.anchor];const Dn=(or,Rs,Sa)=>{const Ea=or.x2-or.x1,Yp=or.y2-or.y1,by=dt.textBoxScale,Jp=mt&&Pe==="never"?Rs:null;let as=null,Qp=ae==="never"?1:2,$u="never";kn&&Qp++;for(let El=0;El<Qp;El++){for(let ju=ss;ju<io;ju++){const Uu=f.textAnchorOffsets.get(ju);if(kn&&Uu.textAnchor!==kn)continue;const ka=this.attemptAnchorPlacement(Uu,or,Ea,Yp,by,Xe,ot,K,C,z,fe,$u,dt,f,Sa,S,k,Jp,Ct);if(ka&&(as=ka.placedGlyphBoxes,as&&as.placeable))return nr=!0,no=ka.shift,as}kn?kn=null:$u=ae}return p&&!as&&(as={box:this.collisionIndex.placeCollisionBox(ba,"always",K,C,z,ot,Xe,S,fe.predicate,Ct,new c.P(0,0)).box,offscreen:!1,placeable:!1}),as};$i(()=>Dn(ba,yt.iconBox,c.ah.horizontal),()=>{const or=yt.verticalTextBox;return f.allowVerticalPlacement&&(!Or||!Or.placeable)&&dt.numVerticalGlyphVertices>0&&or?Dn(or,yt.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Or&&(nr=Or.placeable,Mn=Or.offscreen);const vi=Ni(Or&&Or.placeable);if(!nr&&this.prevPlacement){const or=this.prevPlacement.variableOffsets[dt.crossTileID];or&&(this.variableOffsets[dt.crossTileID]=or,this.markUsedJustification(f,or.anchor,dt,vi))}}}if(Vn=Or,nr=Vn&&Vn.placeable,Mn=Vn&&Vn.offscreen,dt.useRuntimeCollisionCircles){const Ni=f.text.placedSymbolArray.get(dt.centerJustifiedTextSymbolIndex),$i=c.ai(f.textSizeData,ce,Ni),ss=_.get("text-padding");zn=this.collisionIndex.placeCollisionCircles(ae,Ni,f.lineVertexArray,f.glyphOffsetArray,$i,C,z,O,B,p,ot,fe.predicate,dt.collisionCircleDiameter,ss,S,Ct),zn.circles.length&&zn.collisionDetected&&!p&&c.w("Collisions detected, but collision boxes are not shown"),nr=Ce||zn.circles.length>0&&!zn.collisionDetected,Mn=Mn&&zn.offscreen}if(yt.iconFeatureIndex&&(Bu=yt.iconFeatureIndex),yt.iconBox){const Ni=$i=>this.collisionIndex.placeCollisionBox($i,Pe,K,C,z,ot,Xe,k,fe.predicate,Ct,mt&&no?no:void 0);ni&&ni.placeable&&yt.verticalIconBox?(Hn=Ni(yt.verticalIconBox),Fr=Hn.placeable):(Hn=Ni(yt.iconBox),Fr=Hn.placeable),Mn=Mn&&Hn.offscreen}const Bi=me||dt.numHorizontalGlyphVertices===0&&dt.numVerticalGlyphVertices===0,Nu=we||dt.numIconVertices===0;Bi||Nu?Nu?Bi||(Fr=Fr&&nr):nr=Fr&&nr:Fr=nr=Fr&&nr;const Oh=Fr&&Hn.placeable;if(nr&&Vn.placeable&&this.collisionIndex.insertCollisionBox(Vn.box,ae,_.get("text-ignore-placement"),f.bucketInstanceId,ni&&ni.placeable&&wa?wa:Io,fe.ID),Oh&&this.collisionIndex.insertCollisionBox(Hn.box,Pe,_.get("icon-ignore-placement"),f.bucketInstanceId,Bu,fe.ID),zn&&nr&&this.collisionIndex.insertCollisionCircles(zn.circles,ae,_.get("text-ignore-placement"),f.bucketInstanceId,Io,fe.ID),p&&this.storeCollisionData(f.bucketInstanceId,Ut,yt,Vn,Hn,zn),dt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[dt.crossTileID]=new Jt(nr||ht,Fr||ct,Mn||f.justReloaded),a[dt.crossTileID]=!0};if(xt){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const dt=f.getSortedSymbolIndexes(this.transform.angle);for(let yt=dt.length-1;yt>=0;--yt){const Ut=dt[yt];Ht(f.symbolInstances.get(Ut),f.collisionArrays[Ut],Ut)}}else for(let dt=r.symbolInstanceStart;dt<r.symbolInstanceEnd;dt++)Ht(f.symbolInstances.get(dt),f.collisionArrays[dt],dt);if(p&&f.bucketInstanceId in this.collisionCircleArrays){const dt=this.collisionCircleArrays[f.bucketInstanceId];c.as(dt.invProjMatrix,C),dt.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}storeCollisionData(r,a,p,f,_,S){if(p.textBox||p.iconBox){let k,C;this.collisionBoxArrays.has(r)?k=this.collisionBoxArrays.get(r):(k=new Map,this.collisionBoxArrays.set(r,k)),k.has(a)?C=k.get(a):(C={text:null,icon:null},k.set(a,C)),p.textBox&&(C.text=f.box),p.iconBox&&(C.icon=_.box)}if(S){let k=this.collisionCircleArrays[r];k===void 0&&(k=this.collisionCircleArrays[r]=new Sr);for(let C=0;C<S.circles.length;C+=4)k.circles.push(S.circles[C+0]),k.circles.push(S.circles[C+1]),k.circles.push(S.circles[C+2]),k.circles.push(S.collisionDetected?1:0)}}markUsedJustification(r,a,p,f){let _;_=f===c.ah.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.at(a)];const S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const k of S)k>=0&&(r.text.placedSymbolArray.get(k).crossTileID=_>=0&&k!==_?0:p.crossTileID)}markUsedOrientation(r,a,p){const f=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,_=a===c.ah.vertical?a:0,S=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const k of S)r.text.placedSymbolArray.get(k).placedOrientation=f;p.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let p=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(r):1,_=a?a.opacities:{},S=a?a.variableOffsets:{},k=a?a.placedOrientations:{};for(const C in this.placements){const z=this.placements[C],O=_[C];O?(this.opacities[C]=new Zr(O,f,z.text,z.icon),p=p||z.text!==O.text.placed||z.icon!==O.icon.placed):(this.opacities[C]=new Zr(null,f,z.text,z.icon,z.skipFade),p=p||z.text||z.icon)}for(const C in _){const z=_[C];if(!this.opacities[C]){const O=new Zr(z,f,!1,!1);O.isHidden()||(this.opacities[C]=O,p=p||z.text.placed||z.icon.placed)}}for(const C in S)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=S[C]);for(const C in k)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=k[C]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:r)}updateLayerOpacities(r,a){const p={};for(const f of a){const _=f.getBucket(r);_&&f.latestFeatureIndex&&r.id===_.layerIds[0]&&this.updateBucketOpacities(_,f.tileID,p,f.collisionBoxArray)}}updateBucketOpacities(r,a,p,f){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0],S=_.layout,k=new Zr(null,0,!1,!1,!0),C=S.get("text-allow-overlap"),z=S.get("icon-allow-overlap"),O=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),B=S.get("text-rotation-alignment")==="map",K=S.get("text-pitch-alignment")==="map",Q=S.get("icon-text-fit")!=="none",re=new Zr(null,0,C&&(z||!r.hasIconData()||S.get("icon-optional")),z&&(C||!r.hasTextData()||S.get("text-optional")),!0);!r.collisionArrays&&f&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(f);const ce=(me,we,ae)=>{for(let Ce=0;Ce<we/4;Ce++)me.opacityVertexArray.emplaceBack(ae);me.hasVisibleVertices=me.hasVisibleVertices||ae!==ea},fe=this.collisionBoxArrays.get(r.bucketInstanceId);for(let me=0;me<r.symbolInstances.length;me++){const we=r.symbolInstances.get(me),{numHorizontalGlyphVertices:ae,numVerticalGlyphVertices:Ce,crossTileID:Pe}=we;let De=this.opacities[Pe];p[Pe]?De=k:De||(De=re,this.opacities[Pe]=De),p[Pe]=!0;const Xe=we.numIconVertices>0,ot=this.placedOrientations[we.crossTileID],mt=ot===c.ah.vertical,xt=ot===c.ah.horizontal||ot===c.ah.horizontalOnly;if(ae>0||Ce>0){const ct=gi(De.text);ce(r.text,ae,mt?ea:ct),ce(r.text,Ce,xt?ea:ct);const Ct=De.text.isHidden();[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach(yt=>{yt>=0&&(r.text.placedSymbolArray.get(yt).hidden=Ct||mt?1:0)}),we.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(we.verticalPlacedTextSymbolIndex).hidden=Ct||xt?1:0);const Ht=this.variableOffsets[we.crossTileID];Ht&&this.markUsedJustification(r,Ht.anchor,we,ot);const dt=this.placedOrientations[we.crossTileID];dt&&(this.markUsedJustification(r,"left",we,dt),this.markUsedOrientation(r,dt,we))}if(Xe){const ct=gi(De.icon),Ct=!(Q&&we.verticalPlacedIconSymbolIndex&&mt);we.placedIconSymbolIndex>=0&&(ce(r.icon,we.numIconVertices,Ct?ct:ea),r.icon.placedSymbolArray.get(we.placedIconSymbolIndex).hidden=De.icon.isHidden()),we.verticalPlacedIconSymbolIndex>=0&&(ce(r.icon,we.numVerticalIconVertices,Ct?ea:ct),r.icon.placedSymbolArray.get(we.verticalPlacedIconSymbolIndex).hidden=De.icon.isHidden())}const ht=fe&&fe.has(me)?fe.get(me):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const ct=r.collisionArrays[me];if(ct){let Ct=new c.P(0,0);if(ct.textBox||ct.verticalTextBox){let Ht=!0;if(O){const dt=this.variableOffsets[Pe];dt?(Ct=En(dt.anchor,dt.width,dt.height,dt.textOffset,dt.textBoxScale),B&&Ct._rotate(K?this.transform.angle:-this.transform.angle)):Ht=!1}if(ct.textBox||ct.verticalTextBox){let dt;ct.textBox&&(dt=mt),ct.verticalTextBox&&(dt=xt),Qs(r.textCollisionBox.collisionVertexArray,De.text.placed,!Ht||dt,ht.text,Ct.x,Ct.y)}}if(ct.iconBox||ct.verticalIconBox){const Ht=!!(!xt&&ct.verticalIconBox);let dt;ct.iconBox&&(dt=Ht),ct.verticalIconBox&&(dt=!Ht),Qs(r.iconCollisionBox.collisionVertexArray,De.icon.placed,dt,ht.icon,Q?Ct.x:0,Q?Ct.y:0)}}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=me.invProjMatrix,r.placementViewportMatrix=me.viewportMatrix,r.collisionCircleArray=me.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,a){const p=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*p>r}setStale(){this.stale=!0}}function Qs(v,r,a,p,f,_){p&&p.length!==0||(p=[0,0,0,0]);const S=p[0]-Xt,k=p[1]-Xt,C=p[2]-Xt,z=p[3]-Xt;v.emplaceBack(r?1:0,a?1:0,f||0,_||0,S,k),v.emplaceBack(r?1:0,a?1:0,f||0,_||0,C,k),v.emplaceBack(r?1:0,a?1:0,f||0,_||0,C,z),v.emplaceBack(r?1:0,a?1:0,f||0,_||0,S,z)}const Er=Math.pow(2,25),qc=Math.pow(2,24),Xc=Math.pow(2,17),fi=Math.pow(2,16),mi=Math.pow(2,9),Kg=Math.pow(2,8),Ri=Math.pow(2,1);function gi(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const r=v.placed?1:0,a=Math.floor(127*v.opacity);return a*Er+r*qc+a*Xc+r*fi+a*mi+r*Kg+a*Ri+r}const ea=0;function bs(){return{isOccluded:(v,r,a)=>!1,getPitchedTextCorrection:(v,r,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(v,r,a,p){throw new Error("Not implemented.")},translatePosition:(v,r,a,p)=>function(f,_,S,k,C=!1){if(!S[0]&&!S[1])return[0,0];const z=C?k==="map"?f.angle:0:k==="viewport"?-f.angle:0;if(z){const O=Math.sin(z),B=Math.cos(z);S=[S[0]*B-S[1]*O,S[0]*O+S[1]*B]}return[C?S[0]:rr(_,S[0],f.zoom),C?S[1]:rr(_,S[1],f.zoom)]}(v,r,a,p),getCircleRadiusCorrection:v=>1}}class pn{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,a,p,f,_){const S=this._bucketParts;for(;this._currentTileIndex<r.length;)if(a.getBucketParts(S,f,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((k,C)=>k.sortKey-C.sortKey));this._currentPartIndex<S.length;)if(a.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,_())return!0;return!1}}class sl{constructor(r,a,p,f,_,S,k,C){this.placement=new Un(r,bs(),a,S,k,C),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(r,a,p){const f=D.now(),_=()=>!this._forceFullPlacement&&D.now()-f>2;for(;this._currentPlacementIndex>=0;){const S=a[r[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=k)&&(!S.maxzoom||S.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new pn(S)),this._inProgressLayer.continuePlacement(p[S.source],this.placement,this._showCollisionBoxes,S,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Ji=512/c.X/2;class sn{constructor(r,a,p){this.tileID=r,this.bucketInstanceId=p,this._symbolsByKey={};const f=new Map;for(let _=0;_<a.length;_++){const S=a.get(_),k=S.key,C=f.get(k);C?C.push(S):f.set(k,[S])}for(const[_,S]of f){const k={positions:S.map(C=>({x:Math.floor(C.anchorX*Ji),y:Math.floor(C.anchorY*Ji)})),crossTileIDs:S.map(C=>C.crossTileID)};if(k.positions.length>128){const C=new c.av(k.positions.length,16,Uint16Array);for(const{x:z,y:O}of k.positions)C.add(z,O);C.finish(),delete k.positions,k.index=C}this._symbolsByKey[_]=k}}getScaledCoordinates(r,a){const{x:p,y:f,z:_}=this.tileID.canonical,{x:S,y:k,z:C}=a.canonical,z=Ji/Math.pow(2,C-_),O=(k*c.X+r.anchorY)*z,B=f*c.X*Ji;return{x:Math.floor((S*c.X+r.anchorX)*z-p*c.X*Ji),y:Math.floor(O-B)}}findMatches(r,a,p){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let _=0;_<r.length;_++){const S=r.get(_);if(S.crossTileID)continue;const k=this._symbolsByKey[S.key];if(!k)continue;const C=this.getScaledCoordinates(S,a);if(k.index){const z=k.index.range(C.x-f,C.y-f,C.x+f,C.y+f).sort();for(const O of z){const B=k.crossTileIDs[O];if(!p[B]){p[B]=!0,S.crossTileID=B;break}}}else if(k.positions)for(let z=0;z<k.positions.length;z++){const O=k.positions[z],B=k.crossTileIDs[z];if(Math.abs(O.x-C.x)<=f&&Math.abs(O.y-C.y)<=f&&!p[B]){p[B]=!0,S.crossTileID=B;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class au{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const a=Math.round((r-this.lng)/360);if(a!==0)for(const p in this.indexes){const f=this.indexes[p],_={};for(const S in f){const k=f[S];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+a),_[k.tileID.key]=k}this.indexes[p]=_}this.lng=r}addBucket(r,a,p){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let _=0;_<a.symbolInstances.length;_++)a.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const f=this.usedCrossTileIDs[r.overscaledZ];for(const _ in this.indexes){const S=this.indexes[_];if(Number(_)>r.overscaledZ)for(const k in S){const C=S[k];C.tileID.isChildOf(r)&&C.findMatches(a.symbolInstances,r,f)}else{const k=S[r.scaledTo(Number(_)).key];k&&k.findMatches(a.symbolInstances,r,f)}}for(let _=0;_<a.symbolInstances.length;_++){const S=a.symbolInstances.get(_);S.crossTileID||(S.crossTileID=p.generate(),f[S.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new sn(r,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(r,a){for(const p of a.getCrossTileIDsLists())for(const f of p)delete this.usedCrossTileIDs[r][f]}removeStaleBuckets(r){let a=!1;for(const p in this.indexes){const f=this.indexes[p];for(const _ in f)r[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,f[_]),delete f[_],a=!0)}return a}}class Kc{constructor(){this.layerIndexes={},this.crossTileIDs=new au,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,a,p){let f=this.layerIndexes[r.id];f===void 0&&(f=this.layerIndexes[r.id]=new Qi);let _=!1;const S={};f.handleWrapJump(p);for(const k of a){const C=k.getBucket(r);C&&r.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(k.tileID,C,this.crossTileIDs)&&(_=!0),S[C.bucketInstanceId]=!0)}return f.removeStaleBuckets(S)&&(_=!0),_}pruneUnusedLayers(r){const a={};r.forEach(p=>{a[p]=!0});for(const p in this.layerIndexes)a[p]||delete this.layerIndexes[p]}}const eo=(v,r)=>c.t(v,r&&r.filter(a=>a.identifier!=="source.canvas")),Yg=c.aw();class lu extends c.E{constructor(r,a={}){super(),this._rtlPluginLoaded=()=>{for(const p in this.sourceCaches){const f=this.sourceCaches[p].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[p].reload()}},this.map=r,this.dispatcher=new pr(Gt(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,f)=>this.getGlyphs(p,f)),this.dispatcher.registerMessageHandler("GI",(p,f)=>this.getImages(p,f)),this.imageManager=new je,this.imageManager.setEventedParent(this),this.glyphManager=new ye(r._requestManager,a.localIdeographFontFamily),this.lineAtlas=new ft(256,512),this.crossTileSymbolIndex=new Kc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),on().on(We,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const f=this.sourceCaches[p.sourceId];if(!f)return;const _=f.getSource();if(_&&_.vectorLayerIds)for(const S in this._layers){const k=this._layers[S];k.source===_.id&&this._validateLayer(k)}})}loadURL(r,a={},p){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;c.h(f,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,a,p)}).catch(S=>{this._loadStyleRequest=null,S&&!_.signal.aborted&&this.fire(new c.j(S))})}loadJSON(r,a={},p){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,D.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(r,a,p)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(Yg,{validate:!1})}_load(r,a,p){var f;const _=a.transformStyle?a.transformStyle(p,r):r;if(!a.validate||!eo(this,c.u(_))){this._loaded=!0,this.stylesheet=_;for(const S in _.sources)this.addSource(S,_.sources[S],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new Ke(this.stylesheet.light),this.sky=new Te(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const r=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",r),this._order=r.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of r){const p=c.aA(a);p.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=p}}_loadSprite(r,a=!1,p=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,S,k,C){return c._(this,void 0,void 0,function*(){const z=Fe(_),O=k>1?"@2x":"",B={},K={};for(const{id:Q,url:re}of z){const ce=S.transformRequest(Ge(re,O,".json"),"SpriteJSON");B[Q]=c.h(ce,C);const fe=S.transformRequest(Ge(re,O,".png"),"SpriteImage");K[Q]=q.getImage(fe,C)}return yield Promise.all([...Object.values(B),...Object.values(K)]),function(Q,re){return c._(this,void 0,void 0,function*(){const ce={};for(const fe in Q){ce[fe]={};const me=D.getImageCanvasContext((yield re[fe]).data),we=(yield Q[fe]).data;for(const ae in we){const{width:Ce,height:Pe,x:De,y:Xe,sdf:ot,pixelRatio:mt,stretchX:xt,stretchY:ht,content:ct,textFitWidth:Ct,textFitHeight:Ht}=we[ae];ce[fe][ae]={data:null,pixelRatio:mt,sdf:ot,stretchX:xt,stretchY:ht,content:ct,textFitWidth:Ct,textFitHeight:Ht,spriteData:{width:Ce,height:Pe,x:De,y:Xe,context:me}}}}return ce})}(B,K)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const S in _){this._spritesImagesIds[S]=[];const k=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(C=>!(C in _)):[];for(const C of k)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in _[S]){const z=S==="default"?C:`${S}:${C}`;this._spritesImagesIds[S].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,_[S][C],!1):this.imageManager.addImage(z,_[S][C]),a&&(this._changedImages[z]=!0)}}}).catch(_=>{this._spriteRequest=null,f=_,this.fire(new c.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),p&&p(f)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(r){const a=this.sourceCaches[r.source];if(!a)return;const p=r.sourceLayer;if(!p)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.j(new Error(`Source layer "${p}" does not exist on source "${f.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r,a=!1){const p=this._serializedAllLayers();if(!r||r.length===0)return Object.values(a?c.aB(p):p);const f=[];for(const _ of r)if(p[_]){const S=a?c.aB(p[_]):p[_];f.push(S)}return f}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const a=Object.keys(this._layers);for(const p of a){const f=this._layers[p];f.type!=="custom"&&(r[p]=f.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const S in this._updatedSources){const k=this._updatedSources[S];if(k==="reload")this._reloadSource(S);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(r);this.light.updateTransitions(r),this.sky.updateTransitions(r),this._resetUpdates()}const p={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];p[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(r,this._availableImages),!_.isHidden(r.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in p){const _=this.sourceCaches[f];!!p[f]!=!!_.used&&_.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(r),this.sky.recalculate(r),this.z=r.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,a={}){var p;this._checkLoaded();const f=this.serialize();if(r=a.transformStyle?a.transformStyle(f,r):r,((p=a.validate)===null||p===void 0||p)&&eo(this,c.u(r)))return!1;(r=c.aB(r)).layers=c.az(r.layers);const _=c.aC(f,r),S=this._getOperationsToPerform(_);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const k of S.operations)k();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const a=[],p=[];for(const f of r)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":a.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":a.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,f.args));break;case"setSky":a.push(()=>this.setSky.apply(this,f.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":a.push(()=>{});break;default:p.push(f.command)}return{operations:a,unimplemented:p}}addImage(r,a){if(this.getImage(r))return this.fire(new c.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,a),this._afterImageUpdated(r)}updateImage(r,a){this.imageManager.updateImage(r,a)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new c.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,a,p={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${r}`,a,null,p))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.sourceCaches[r]=new Bt(r,a,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:r})),f.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===r)return this.fire(new c.j(new Error(`Source "${r}" cannot be removed while layer "${p}" is using it.`)));const a=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,a){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const p=this.sourceCaches[r].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(a),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,a,p={}){this._checkLoaded();const f=r.id;if(this.getLayer(f))return void this.fire(new c.j(new Error(`Layer "${f}" already exists on this map.`)));let _;if(r.type==="custom"){if(eo(this,c.aD(r)))return;_=c.aA(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(f,r.source),r=c.aB(r),r=c.e(r,{source:f})),this._validate(c.u.layer,`layers.${f}`,r,{arrayIndex:-1},p))return;_=c.aA(r),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const S=a?this._order.indexOf(a):this._order.length;if(a&&S===-1)this.fire(new c.j(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(S,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const k=this._removedLayers[f];delete this._removedLayers[f],k.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(r,a){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new c.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===a)return;const p=this._order.indexOf(r);this._order.splice(p,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new c.j(new Error(`Cannot move layer "${r}" before non-existing layer "${a}".`))):(this._order.splice(f,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const a=this._layers[r];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${r}".`)));a.setEventedParent(null);const p=this._order.indexOf(r);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=a,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],a.onRemove&&a.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,a,p){this._checkLoaded();const f=this.getLayer(r);f?f.minzoom===a&&f.maxzoom===p||(a!=null&&(f.minzoom=a),p!=null&&(f.maxzoom=p),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,a,p={}){this._checkLoaded();const f=this.getLayer(r);if(f){if(!c.aE(f.filter,a))return a==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(c.u.filter,`layers.${f.id}.filter`,a,null,p)||(f.filter=c.aB(a),this._updateLayer(f)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return c.aB(this.getLayer(r).filter)}setLayoutProperty(r,a,p,f={}){this._checkLoaded();const _=this.getLayer(r);_?c.aE(_.getLayoutProperty(a),p)||(_.setLayoutProperty(a,p,f),this._updateLayer(_)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,a){const p=this.getLayer(r);if(p)return p.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,a,p,f={}){this._checkLoaded();const _=this.getLayer(r);_?c.aE(_.getPaintProperty(a),p)||(_.setPaintProperty(a,p,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[r]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,a){return this.getLayer(r).getPaintProperty(a)}setFeatureState(r,a){this._checkLoaded();const p=r.source,f=r.sourceLayer,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new c.j(new Error(`The source '${p}' does not exist in the map's style.`)));const S=_.getSource().type;S==="geojson"&&f?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||f?(r.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,r.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,a){this._checkLoaded();const p=r.source,f=this.sourceCaches[p];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${p}' does not exist in the map's style.`)));const _=f.getSource().type,S=_==="vector"?r.sourceLayer:void 0;_!=="vector"||S?a&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(S,r.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const a=r.source,p=r.sourceLayer,f=this.sourceCaches[a];if(f!==void 0)return f.getSource().type!=="vector"||p?(r.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(p,r.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=c.aF(this.sourceCaches,_=>_.serialize()),a=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,f=this.stylesheet;return c.aG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:r,layers:a,terrain:p},_=>_!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const a=S=>this._layers[S].type==="fill-extrusion",p={},f=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(a(k)){p[k]=S;for(const C of r){const z=C[k];if(z)for(const O of z)f.push(O)}}}f.sort((S,k)=>k.intersectionZ-S.intersectionZ);const _=[];for(let S=this._order.length-1;S>=0;S--){const k=this._order[S];if(a(k))for(let C=f.length-1;C>=0;C--){const z=f[C].feature;if(p[z.layer.id]<S)break;_.push(z),f.pop()}else for(const C of r){const z=C[k];if(z)for(const O of z)_.push(O.feature)}}return _}queryRenderedFeatures(r,a,p){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const k of a.layers){const C=this._layers[k];if(!C)return this.fire(new c.j(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];f[C.source]=!0}}const _=[];a.availableImages=this._availableImages;const S=this._serializedAllLayers();for(const k in this.sourceCaches)a.layers&&!f[k]||_.push($r(this.sourceCaches[k],this._layers,S,r,a,p));return this.placement&&_.push(function(k,C,z,O,B,K,Q){const re={},ce=K.queryRenderedSymbols(O),fe=[];for(const me of Object.keys(ce).map(Number))fe.push(Q[me]);fe.sort(V);for(const me of fe){const we=me.featureIndex.lookupSymbolFeatures(ce[me.bucketInstanceId],C,me.bucketIndex,me.sourceLayerIndex,B.filter,B.layers,B.availableImages,k);for(const ae in we){const Ce=re[ae]=re[ae]||[],Pe=we[ae];Pe.sort((De,Xe)=>{const ot=me.featureSortOrder;if(ot){const mt=ot.indexOf(De.featureIndex);return ot.indexOf(Xe.featureIndex)-mt}return Xe.featureIndex-De.featureIndex});for(const De of Pe)Ce.push(De)}}for(const me in re)re[me].forEach(we=>{const ae=we.feature,Ce=z[k[me].source].getFeatureState(ae.layer["source-layer"],ae.id);ae.source=ae.layer.source,ae.layer["source-layer"]&&(ae.sourceLayer=ae.layer["source-layer"]),ae.state=Ce});return re}(this._layers,S,this.sourceCaches,r,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(r,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const p=this.sourceCaches[r];return p?function(f,_){const S=f.getRenderableIds().map(z=>f.getTileByID(z)),k=[],C={};for(let z=0;z<S.length;z++){const O=S[z],B=O.tileID.canonical.key;C[B]||(C[B]=!0,O.querySourceFeatures(k,_))}return k}(p,a):[]}getLight(){return this.light.getLight()}setLight(r,a={}){this._checkLoaded();const p=this.light.getLight();let f=!1;for(const S in r)if(!c.aE(r[S],p[S])){f=!0;break}if(!f)return;const _={now:D.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,a),this.light.updateTransitions(_)}getSky(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.sky}setSky(r,a={}){const p=this.getSky();let f=!1;if(!r&&!p)return;if(r&&!p)f=!0;else if(!r&&p)f=!0;else for(const S in r)if(!c.aE(r[S],p[S])){f=!0;break}if(!f)return;const _={now:D.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=r,this.sky.setSky(r,a),this.sky.updateTransitions(_)}_validate(r,a,p,f,_={}){return(!_||_.validate!==!1)&&eo(this,r.call(c.u,c.e({key:a,style:this.serialize(),value:p,styleSpec:c.v},f)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),on().off(We,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const p=this.sourceCaches[a];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const a in this.sourceCaches)this.sourceCaches[a].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,a,p,f,_=!1){let S=!1,k=!1;const C={};for(const z of this._order){const O=this._layers[z];if(O.type!=="symbol")continue;if(!C[O.source]){const K=this.sourceCaches[O.source];C[O.source]=K.getRenderableIds(!0).map(Q=>K.getTileByID(Q)).sort((Q,re)=>re.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(re.tileID)?-1:1))}const B=this.crossTileSymbolIndex.addLayer(O,C[O.source],r.center.lng);S=S||B}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(D.now(),r.zoom))&&(this.pauseablePlacement=new sl(r,this.map.terrain,this._order,_,a,p,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(D.now()),k=!0),S&&this.pauseablePlacement.placement.setStale()),k||S)for(const z of this._order){const O=this._layers[z];O.type==="symbol"&&this.placement.updateLayerOpacities(O,C[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(D.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,a){return c._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),p})}getGlyphs(r,a){return c._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(a.stacks),f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,a={}){this._checkLoaded(),r&&this._validate(c.u.glyphs,"glyphs",r,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,a,p={},f){this._checkLoaded();const _=[{id:r,url:a}],S=[...Fe(this.stylesheet.sprite),..._];this._validate(c.u.sprite,"sprite",S,null,p)||(this.stylesheet.sprite=S,this._loadSprite(_,!0,f))}removeSprite(r){this._checkLoaded();const a=Fe(this.stylesheet.sprite);if(a.find(p=>p.id===r)){if(this._spritesImagesIds[r])for(const p of this._spritesImagesIds[r])this.imageManager.removeImage(p),this._changedImages[p]=!0;a.splice(a.findIndex(p=>p.id===r),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return Fe(this.stylesheet.sprite)}setSprite(r,a={},p){this._checkLoaded(),r&&this._validate(c.u.sprite,"sprite",r,null,a)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,p):(this._unloadSprite(),p&&p(null)))}}var Ss=c.Y([{name:"a_pos",type:"Int16",components:2}]);const is={prelude:yr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:yr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:yr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:yr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:yr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:yr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:yr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:yr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:yr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:yr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:yr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:yr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:yr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:yr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:yr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:yr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:yr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:yr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:yr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:yr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:yr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:yr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:yr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:yr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:yr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:yr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function yr(v,r){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=r.match(/attribute ([\w]+) ([\w]+)/g),f=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=_?_.concat(f):f,k={};return{fragmentSource:v=v.replace(a,(C,z,O,B,K)=>(k[K]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${K}
varying ${O} ${B} ${K};
#else
uniform ${O} ${B} u_${K};
#endif
`:`
#ifdef HAS_UNIFORM_u_${K}
    ${O} ${B} ${K} = u_${K};
#endif
`)),vertexSource:r=r.replace(a,(C,z,O,B,K)=>{const Q=B==="float"?"vec2":"vec4",re=K.match(/color/)?"color":Q;return k[K]?z==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
attribute ${O} ${Q} a_${K};
varying ${O} ${B} ${K};
#else
uniform ${O} ${B} u_${K};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = a_${K};
#else
    ${O} ${B} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = unpack_mix_${re}(a_${K}, u_${K}_t);
#else
    ${O} ${B} ${K} = u_${K};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
attribute ${O} ${Q} a_${K};
#else
uniform ${O} ${B} u_${K};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${O} ${B} ${K} = a_${K};
#else
    ${O} ${B} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${O} ${B} ${K} = unpack_mix_${re}(a_${K}, u_${K}_t);
#else
    ${O} ${B} ${K} = u_${K};
#endif
`}),staticAttributes:p,staticUniforms:S}}class Yc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,a,p,f,_,S,k,C,z){this.context=r;let O=this.boundPaintVertexBuffers.length!==f.length;for(let B=0;!O&&B<f.length;B++)this.boundPaintVertexBuffers[B]!==f[B]&&(O=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==p||O||this.boundIndexBuffer!==_||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==z?this.freshBind(a,p,f,_,S,k,C,z):(r.bindVertexArray.set(this.vao),k&&k.bind(),_&&_.dynamicDraw&&_.bind(),C&&C.bind(),z&&z.bind())}freshBind(r,a,p,f,_,S,k,C){const z=r.numAttributes,O=this.context,B=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=C,a.enableAttributes(B,r);for(const K of p)K.enableAttributes(B,r);S&&S.enableAttributes(B,r),k&&k.enableAttributes(B,r),C&&C.enableAttributes(B,r),a.bind(),a.setVertexAttribPointers(B,r,_);for(const K of p)K.bind(),K.setVertexAttribPointers(B,r,_);S&&(S.bind(),S.setVertexAttribPointers(B,r,_)),f&&f.bind(),k&&(k.bind(),k.setVertexAttribPointers(B,r,_)),C&&(C.bind(),C.setVertexAttribPointers(B,r,_)),O.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Jc=(v,r,a,p,f)=>({u_matrix:v,u_texture:0,u_ele_delta:r,u_fog_matrix:a,u_fog_color:p?p.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:p?p.calculateFogBlendOpacity(f):0,u_horizon_color:p?p.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1});function ta(v){const r=[];for(let a=0;a<v.length;a++){if(v[a]===null)continue;const p=v[a].split(" ");r.push(p.pop())}return r}class Qc{constructor(r,a,p,f,_,S){const k=r.gl;this.program=k.createProgram();const C=ta(a.staticAttributes),z=p?p.getBinderAttributes():[],O=C.concat(z),B=is.prelude.staticUniforms?ta(is.prelude.staticUniforms):[],K=a.staticUniforms?ta(a.staticUniforms):[],Q=p?p.getBinderUniforms():[],re=B.concat(K).concat(Q),ce=[];for(const De of re)ce.indexOf(De)<0&&ce.push(De);const fe=p?p.defines():[];_&&fe.push("#define OVERDRAW_INSPECTOR;"),S&&fe.push("#define TERRAIN3D;");const me=fe.concat(is.prelude.fragmentSource,a.fragmentSource).join(`
`),we=fe.concat(is.prelude.vertexSource,a.vertexSource).join(`
`),ae=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ae,me),k.compileShader(ae),!k.getShaderParameter(ae,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(ae)}`);k.attachShader(this.program,ae);const Ce=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Ce,we),k.compileShader(Ce),!k.getShaderParameter(Ce,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Ce)}`);k.attachShader(this.program,Ce),this.attributes={};const Pe={};this.numAttributes=O.length;for(let De=0;De<this.numAttributes;De++)O[De]&&(k.bindAttribLocation(this.program,De,O[De]),this.attributes[O[De]]=De);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Ce),k.deleteShader(ae);for(let De=0;De<ce.length;De++){const Xe=ce[De];if(Xe&&!Pe[Xe]){const ot=k.getUniformLocation(this.program,Xe);ot&&(Pe[Xe]=ot)}}this.fixedUniforms=f(r,Pe),this.terrainUniforms=((De,Xe)=>({u_depth:new c.aH(De,Xe.u_depth),u_terrain:new c.aH(De,Xe.u_terrain),u_terrain_dim:new c.aI(De,Xe.u_terrain_dim),u_terrain_matrix:new c.aJ(De,Xe.u_terrain_matrix),u_terrain_unpack:new c.aK(De,Xe.u_terrain_unpack),u_terrain_exaggeration:new c.aI(De,Xe.u_terrain_exaggeration)}))(r,Pe),this.binderUniforms=p?p.getUniforms(r,Pe):[]}draw(r,a,p,f,_,S,k,C,z,O,B,K,Q,re,ce,fe,me,we){const ae=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(p),r.setStencilMode(f),r.setColorMode(_),r.setCullFace(S),C){r.activeTexture.set(ae.TEXTURE2),ae.bindTexture(ae.TEXTURE_2D,C.depthTexture),r.activeTexture.set(ae.TEXTURE3),ae.bindTexture(ae.TEXTURE_2D,C.texture);for(const Pe in this.terrainUniforms)this.terrainUniforms[Pe].set(C[Pe])}for(const Pe in this.fixedUniforms)this.fixedUniforms[Pe].set(k[Pe]);ce&&ce.setUniforms(r,this.binderUniforms,Q,{zoom:re});let Ce=0;switch(a){case ae.LINES:Ce=2;break;case ae.TRIANGLES:Ce=3;break;case ae.LINE_STRIP:Ce=1}for(const Pe of K.get()){const De=Pe.vaos||(Pe.vaos={});(De[z]||(De[z]=new Yc)).bind(r,this,O,ce?ce.getPaintVertexBuffers():[],B,Pe.vertexOffset,fe,me,we),ae.drawElements(a,Pe.primitiveLength*Ce,ae.UNSIGNED_SHORT,Pe.primitiveOffset*Ce*2)}}}function uu(v,r,a){const p=1/rr(a,1,r.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),_=a.tileSize*Math.pow(2,r.transform.tileZoom)/f,S=_*(a.tileID.canonical.x+a.tileID.wrap*f),k=_*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[p,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[S>>16,k>>16],u_pixel_coord_lower:[65535&S,65535&k]}}const al=(v,r,a,p)=>{const f=r.style.light,_=f.properties.get("position"),S=[_.x,_.y,_.z],k=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();f.properties.get("anchor")==="viewport"&&function(z,O){var B=Math.sin(O),K=Math.cos(O);z[0]=K,z[1]=B,z[2]=0,z[3]=-B,z[4]=K,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(k,-r.transform.angle),function(z,O,B){var K=O[0],Q=O[1],re=O[2];z[0]=K*B[0]+Q*B[3]+re*B[6],z[1]=K*B[1]+Q*B[4]+re*B[7],z[2]=K*B[2]+Q*B[5]+re*B[8]}(S,S,k);const C=f.properties.get("color");return{u_matrix:v,u_lightpos:S,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+a,u_opacity:p}},cu=(v,r,a,p,f,_,S)=>c.e(al(v,r,a,p),uu(_,r,S),{u_height_factor:-Math.pow(2,f.overscaledZ)/S.tileSize/8}),ra=v=>({u_matrix:v}),_p=(v,r,a,p)=>c.e(ra(v),uu(a,r,p)),Jg=(v,r)=>({u_matrix:v,u_world:r}),vp=(v,r,a,p,f)=>c.e(_p(v,r,a,p),{u_world:f}),Qg=(v,r,a,p)=>{const f=v.transform;let _,S;if(p.paint.get("circle-pitch-alignment")==="map"){const k=rr(a,1,f.zoom);_=!0,S=[k,k]}else _=!1,S=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:v.translatePosMatrix(r.posMatrix,a,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:S}},Es=(v,r,a)=>({u_matrix:v,u_inv_matrix:r,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),ll=(v,r,a=1)=>({u_matrix:v,u_color:r,u_overlay:0,u_overlay_scale:a}),ti=v=>({u_matrix:v}),ri=(v,r,a,p)=>({u_matrix:v,u_extrude_scale:rr(r,1,a),u_intensity:p}),hu=(v,r,a,p)=>{const f=c.H();c.aP(f,0,v.width,v.height,0,0,1);const _=v.context.gl;return{u_matrix:f,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:a,u_color_ramp:p,u_opacity:r.paint.get("heatmap-opacity")}};function du(v,r){const a=Math.pow(2,r.canonical.z),p=r.canonical.y;return[new c.Z(0,p/a).toLngLat().lat,new c.Z(0,(p+1)/a).toLngLat().lat]}const pu=(v,r,a,p)=>{const f=v.transform;return{u_matrix:bp(v,r,a,p),u_ratio:1/rr(r,1,f.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},xp=(v,r,a,p,f)=>c.e(pu(v,r,a,f),{u_image:0,u_image_height:p}),na=(v,r,a,p,f)=>{const _=v.transform,S=wp(r,_);return{u_matrix:bp(v,r,a,f),u_texsize:r.imageAtlasTexture.size,u_ratio:1/rr(r,1,_.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[S,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},ey=(v,r,a,p,f,_)=>{const S=v.lineAtlas,k=wp(r,v.transform),C=a.layout.get("line-cap")==="round",z=S.getDash(p.from,C),O=S.getDash(p.to,C),B=z.width*f.fromScale,K=O.width*f.toScale;return c.e(pu(v,r,a,_),{u_patternscale_a:[k/B,-z.height/2],u_patternscale_b:[k/K,-O.height/2],u_sdfgamma:S.width/(256*Math.min(B,K)*v.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:O.y,u_mix:f.t})};function wp(v,r){return 1/rr(v,1,r.tileZoom)}function bp(v,r,a,p){return v.translatePosMatrix(p?p.posMatrix:r.tileID.posMatrix,r,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const ty=(v,r,a,p,f)=>{return{u_matrix:v,u_tl_parent:r,u_scale_parent:a,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(_=f.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:ry(f.paint.get("raster-hue-rotate"))};var _,S};function ry(v){v*=Math.PI/180;const r=Math.sin(v),a=Math.cos(v);return[(2*a+1)/3,(-Math.sqrt(3)*r-a+1)/3,(Math.sqrt(3)*r-a+1)/3]}const Sp=(v,r,a,p,f,_,S,k,C,z,O,B,K,Q)=>{const re=S.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:re.width/re.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:C,u_coord_matrix:z,u_is_text:+B,u_pitch_with_map:+p,u_is_along_line:f,u_is_variable_anchor:_,u_texsize:K,u_texture:0,u_translation:O,u_pitched_scale:Q}},ul=(v,r,a,p,f,_,S,k,C,z,O,B,K,Q,re)=>{const ce=S.transform;return c.e(Sp(v,r,a,p,f,_,S,k,C,z,O,B,K,re),{u_gamma_scale:p?Math.cos(ce._pitch)*ce.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:+Q})},eh=(v,r,a,p,f,_,S,k,C,z,O,B,K,Q)=>c.e(ul(v,r,a,p,f,_,S,k,C,z,O,!0,B,!0,Q),{u_texsize_icon:K,u_texture_icon:1}),fu=(v,r,a)=>({u_matrix:v,u_opacity:r,u_color:a}),th=(v,r,a,p,f,_)=>c.e(function(S,k,C,z){const O=C.imageManager.getPattern(S.from.toString()),B=C.imageManager.getPattern(S.to.toString()),{width:K,height:Q}=C.imageManager.getPixelSize(),re=Math.pow(2,z.tileID.overscaledZ),ce=z.tileSize*Math.pow(2,C.transform.tileZoom)/re,fe=ce*(z.tileID.canonical.x+z.tileID.wrap*re),me=ce*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:B.tl,u_pattern_br_b:B.br,u_texsize:[K,Q],u_mix:k.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:B.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/rr(z,1,C.transform.tileZoom),u_pixel_coord_upper:[fe>>16,me>>16],u_pixel_coord_lower:[65535&fe,65535&me]}}(p,_,a,f),{u_matrix:v,u_opacity:r}),rh={fillExtrusion:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_lightpos:new c.aN(v,r.u_lightpos),u_lightintensity:new c.aI(v,r.u_lightintensity),u_lightcolor:new c.aN(v,r.u_lightcolor),u_vertical_gradient:new c.aI(v,r.u_vertical_gradient),u_opacity:new c.aI(v,r.u_opacity)}),fillExtrusionPattern:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_lightpos:new c.aN(v,r.u_lightpos),u_lightintensity:new c.aI(v,r.u_lightintensity),u_lightcolor:new c.aN(v,r.u_lightcolor),u_vertical_gradient:new c.aI(v,r.u_vertical_gradient),u_height_factor:new c.aI(v,r.u_height_factor),u_image:new c.aH(v,r.u_image),u_texsize:new c.aO(v,r.u_texsize),u_pixel_coord_upper:new c.aO(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,r.u_pixel_coord_lower),u_scale:new c.aN(v,r.u_scale),u_fade:new c.aI(v,r.u_fade),u_opacity:new c.aI(v,r.u_opacity)}),fill:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix)}),fillPattern:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_image:new c.aH(v,r.u_image),u_texsize:new c.aO(v,r.u_texsize),u_pixel_coord_upper:new c.aO(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,r.u_pixel_coord_lower),u_scale:new c.aN(v,r.u_scale),u_fade:new c.aI(v,r.u_fade)}),fillOutline:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_world:new c.aO(v,r.u_world)}),fillOutlinePattern:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_world:new c.aO(v,r.u_world),u_image:new c.aH(v,r.u_image),u_texsize:new c.aO(v,r.u_texsize),u_pixel_coord_upper:new c.aO(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,r.u_pixel_coord_lower),u_scale:new c.aN(v,r.u_scale),u_fade:new c.aI(v,r.u_fade)}),circle:(v,r)=>({u_camera_to_center_distance:new c.aI(v,r.u_camera_to_center_distance),u_scale_with_map:new c.aH(v,r.u_scale_with_map),u_pitch_with_map:new c.aH(v,r.u_pitch_with_map),u_extrude_scale:new c.aO(v,r.u_extrude_scale),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_matrix:new c.aJ(v,r.u_matrix)}),collisionBox:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_pixel_extrude_scale:new c.aO(v,r.u_pixel_extrude_scale)}),collisionCircle:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_inv_matrix:new c.aJ(v,r.u_inv_matrix),u_camera_to_center_distance:new c.aI(v,r.u_camera_to_center_distance),u_viewport_size:new c.aO(v,r.u_viewport_size)}),debug:(v,r)=>({u_color:new c.aL(v,r.u_color),u_matrix:new c.aJ(v,r.u_matrix),u_overlay:new c.aH(v,r.u_overlay),u_overlay_scale:new c.aI(v,r.u_overlay_scale)}),clippingMask:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix)}),heatmap:(v,r)=>({u_extrude_scale:new c.aI(v,r.u_extrude_scale),u_intensity:new c.aI(v,r.u_intensity),u_matrix:new c.aJ(v,r.u_matrix)}),heatmapTexture:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_world:new c.aO(v,r.u_world),u_image:new c.aH(v,r.u_image),u_color_ramp:new c.aH(v,r.u_color_ramp),u_opacity:new c.aI(v,r.u_opacity)}),hillshade:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_image:new c.aH(v,r.u_image),u_latrange:new c.aO(v,r.u_latrange),u_light:new c.aO(v,r.u_light),u_shadow:new c.aL(v,r.u_shadow),u_highlight:new c.aL(v,r.u_highlight),u_accent:new c.aL(v,r.u_accent)}),hillshadePrepare:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_image:new c.aH(v,r.u_image),u_dimension:new c.aO(v,r.u_dimension),u_zoom:new c.aI(v,r.u_zoom),u_unpack:new c.aK(v,r.u_unpack)}),line:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_ratio:new c.aI(v,r.u_ratio),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,r.u_units_to_pixels)}),lineGradient:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_ratio:new c.aI(v,r.u_ratio),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,r.u_units_to_pixels),u_image:new c.aH(v,r.u_image),u_image_height:new c.aI(v,r.u_image_height)}),linePattern:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_texsize:new c.aO(v,r.u_texsize),u_ratio:new c.aI(v,r.u_ratio),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_image:new c.aH(v,r.u_image),u_units_to_pixels:new c.aO(v,r.u_units_to_pixels),u_scale:new c.aN(v,r.u_scale),u_fade:new c.aI(v,r.u_fade)}),lineSDF:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_ratio:new c.aI(v,r.u_ratio),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_units_to_pixels:new c.aO(v,r.u_units_to_pixels),u_patternscale_a:new c.aO(v,r.u_patternscale_a),u_patternscale_b:new c.aO(v,r.u_patternscale_b),u_sdfgamma:new c.aI(v,r.u_sdfgamma),u_image:new c.aH(v,r.u_image),u_tex_y_a:new c.aI(v,r.u_tex_y_a),u_tex_y_b:new c.aI(v,r.u_tex_y_b),u_mix:new c.aI(v,r.u_mix)}),raster:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_tl_parent:new c.aO(v,r.u_tl_parent),u_scale_parent:new c.aI(v,r.u_scale_parent),u_buffer_scale:new c.aI(v,r.u_buffer_scale),u_fade_t:new c.aI(v,r.u_fade_t),u_opacity:new c.aI(v,r.u_opacity),u_image0:new c.aH(v,r.u_image0),u_image1:new c.aH(v,r.u_image1),u_brightness_low:new c.aI(v,r.u_brightness_low),u_brightness_high:new c.aI(v,r.u_brightness_high),u_saturation_factor:new c.aI(v,r.u_saturation_factor),u_contrast_factor:new c.aI(v,r.u_contrast_factor),u_spin_weights:new c.aN(v,r.u_spin_weights)}),symbolIcon:(v,r)=>({u_is_size_zoom_constant:new c.aH(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,r.u_is_size_feature_constant),u_size_t:new c.aI(v,r.u_size_t),u_size:new c.aI(v,r.u_size),u_camera_to_center_distance:new c.aI(v,r.u_camera_to_center_distance),u_pitch:new c.aI(v,r.u_pitch),u_rotate_symbol:new c.aH(v,r.u_rotate_symbol),u_aspect_ratio:new c.aI(v,r.u_aspect_ratio),u_fade_change:new c.aI(v,r.u_fade_change),u_matrix:new c.aJ(v,r.u_matrix),u_label_plane_matrix:new c.aJ(v,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,r.u_coord_matrix),u_is_text:new c.aH(v,r.u_is_text),u_pitch_with_map:new c.aH(v,r.u_pitch_with_map),u_is_along_line:new c.aH(v,r.u_is_along_line),u_is_variable_anchor:new c.aH(v,r.u_is_variable_anchor),u_texsize:new c.aO(v,r.u_texsize),u_texture:new c.aH(v,r.u_texture),u_translation:new c.aO(v,r.u_translation),u_pitched_scale:new c.aI(v,r.u_pitched_scale)}),symbolSDF:(v,r)=>({u_is_size_zoom_constant:new c.aH(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,r.u_is_size_feature_constant),u_size_t:new c.aI(v,r.u_size_t),u_size:new c.aI(v,r.u_size),u_camera_to_center_distance:new c.aI(v,r.u_camera_to_center_distance),u_pitch:new c.aI(v,r.u_pitch),u_rotate_symbol:new c.aH(v,r.u_rotate_symbol),u_aspect_ratio:new c.aI(v,r.u_aspect_ratio),u_fade_change:new c.aI(v,r.u_fade_change),u_matrix:new c.aJ(v,r.u_matrix),u_label_plane_matrix:new c.aJ(v,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,r.u_coord_matrix),u_is_text:new c.aH(v,r.u_is_text),u_pitch_with_map:new c.aH(v,r.u_pitch_with_map),u_is_along_line:new c.aH(v,r.u_is_along_line),u_is_variable_anchor:new c.aH(v,r.u_is_variable_anchor),u_texsize:new c.aO(v,r.u_texsize),u_texture:new c.aH(v,r.u_texture),u_gamma_scale:new c.aI(v,r.u_gamma_scale),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_is_halo:new c.aH(v,r.u_is_halo),u_translation:new c.aO(v,r.u_translation),u_pitched_scale:new c.aI(v,r.u_pitched_scale)}),symbolTextAndIcon:(v,r)=>({u_is_size_zoom_constant:new c.aH(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(v,r.u_is_size_feature_constant),u_size_t:new c.aI(v,r.u_size_t),u_size:new c.aI(v,r.u_size),u_camera_to_center_distance:new c.aI(v,r.u_camera_to_center_distance),u_pitch:new c.aI(v,r.u_pitch),u_rotate_symbol:new c.aH(v,r.u_rotate_symbol),u_aspect_ratio:new c.aI(v,r.u_aspect_ratio),u_fade_change:new c.aI(v,r.u_fade_change),u_matrix:new c.aJ(v,r.u_matrix),u_label_plane_matrix:new c.aJ(v,r.u_label_plane_matrix),u_coord_matrix:new c.aJ(v,r.u_coord_matrix),u_is_text:new c.aH(v,r.u_is_text),u_pitch_with_map:new c.aH(v,r.u_pitch_with_map),u_is_along_line:new c.aH(v,r.u_is_along_line),u_is_variable_anchor:new c.aH(v,r.u_is_variable_anchor),u_texsize:new c.aO(v,r.u_texsize),u_texsize_icon:new c.aO(v,r.u_texsize_icon),u_texture:new c.aH(v,r.u_texture),u_texture_icon:new c.aH(v,r.u_texture_icon),u_gamma_scale:new c.aI(v,r.u_gamma_scale),u_device_pixel_ratio:new c.aI(v,r.u_device_pixel_ratio),u_is_halo:new c.aH(v,r.u_is_halo),u_translation:new c.aO(v,r.u_translation),u_pitched_scale:new c.aI(v,r.u_pitched_scale)}),background:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_opacity:new c.aI(v,r.u_opacity),u_color:new c.aL(v,r.u_color)}),backgroundPattern:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_opacity:new c.aI(v,r.u_opacity),u_image:new c.aH(v,r.u_image),u_pattern_tl_a:new c.aO(v,r.u_pattern_tl_a),u_pattern_br_a:new c.aO(v,r.u_pattern_br_a),u_pattern_tl_b:new c.aO(v,r.u_pattern_tl_b),u_pattern_br_b:new c.aO(v,r.u_pattern_br_b),u_texsize:new c.aO(v,r.u_texsize),u_mix:new c.aI(v,r.u_mix),u_pattern_size_a:new c.aO(v,r.u_pattern_size_a),u_pattern_size_b:new c.aO(v,r.u_pattern_size_b),u_scale_a:new c.aI(v,r.u_scale_a),u_scale_b:new c.aI(v,r.u_scale_b),u_pixel_coord_upper:new c.aO(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(v,r.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(v,r.u_tile_units_to_pixels)}),terrain:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_texture:new c.aH(v,r.u_texture),u_ele_delta:new c.aI(v,r.u_ele_delta),u_fog_matrix:new c.aJ(v,r.u_fog_matrix),u_fog_color:new c.aL(v,r.u_fog_color),u_fog_ground_blend:new c.aI(v,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(v,r.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(v,r.u_horizon_color),u_horizon_fog_blend:new c.aI(v,r.u_horizon_fog_blend)}),terrainDepth:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_ele_delta:new c.aI(v,r.u_ele_delta)}),terrainCoords:(v,r)=>({u_matrix:new c.aJ(v,r.u_matrix),u_texture:new c.aH(v,r.u_texture),u_terrain_coords_id:new c.aI(v,r.u_terrain_coords_id),u_ele_delta:new c.aI(v,r.u_ele_delta)}),sky:(v,r)=>({u_sky_color:new c.aL(v,r.u_sky_color),u_horizon_color:new c.aL(v,r.u_horizon_color),u_horizon:new c.aI(v,r.u_horizon),u_sky_horizon_blend:new c.aI(v,r.u_sky_horizon_blend)})};class ko{constructor(r,a,p){this.context=r;const f=r.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ny={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class nh{constructor(r,a,p,f){this.length=a.length,this.attributes=p,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=r;const _=r.gl;this.buffer=_.createBuffer(),r.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,a){for(let p=0;p<this.attributes.length;p++){const f=a.attributes[this.attributes[p].name];f!==void 0&&r.enableVertexAttribArray(f)}}setVertexAttribPointers(r,a,p){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],S=a.attributes[_.name];S!==void 0&&r.vertexAttribPointer(S,_.components,r[ny[_.type]],!1,this.itemSize,_.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ks=new WeakMap;function os(v){var r;if(ks.has(v))return ks.get(v);{const a=(r=v.getParameter(v.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return ks.set(v,a),a}}class xr{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mu extends xr{getDefault(){return c.aM.transparent}set(r){const a=this.current;(r.r!==a.r||r.g!==a.g||r.b!==a.b||r.a!==a.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class iy extends xr{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class ia extends xr{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class oy extends xr{getDefault(){return[!0,!0,!0,!0]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||r[3]!==a[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ep extends xr{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class sy extends xr{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class kp extends xr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const a=this.current;(r.func!==a.func||r.ref!==a.ref||r.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class ih extends xr{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Tp extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=r,this.dirty=!1}}class Cp extends xr{getDefault(){return[0,1]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ip extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=r,this.dirty=!1}}class Pp extends xr{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Ts extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.BLEND):a.disable(a.BLEND),this.current=r,this.dirty=!1}}class Ap extends xr{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class ay extends xr{getDefault(){return c.aM.transparent}set(r){const a=this.current;(r.r!==a.r||r.g!==a.g||r.b!==a.b||r.a!==a.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Mp extends xr{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class cl extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=r,this.dirty=!1}}class ly extends xr{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class gu extends xr{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class uy extends xr{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class cy extends xr{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class zp extends xr{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||r[3]!==a[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Dp extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Rp extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class oh extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Lp extends xr{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class yu extends xr{getDefault(){return null}set(r){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class jo extends xr{getDefault(){return null}set(r){var a;if(r===this.current&&!this.dirty)return;const p=this.gl;os(p)?p.bindVertexArray(r):(a=p.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class sh extends xr{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class ah extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class lh extends xr{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class _u extends xr{constructor(r,a){super(r),this.context=r,this.parent=a}getDefault(){return null}}class uh extends _u{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Cs extends _u{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class ch extends _u{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class hy{constructor(r,a,p,f,_){this.context=r,this.width=a,this.height=p;const S=r.gl,k=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new uh(r,k),f)this.depthAttachment=_?new ch(r,k):new Cs(r,k);else if(_)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,a=this.colorAttachment.get();if(a&&r.deleteTexture(a),this.depthAttachment){const p=this.depthAttachment.get();p&&r.deleteRenderbuffer(p)}r.deleteFramebuffer(this.framebuffer)}}class Qr{constructor(r,a,p){this.blendFunction=r,this.blendColor=a,this.mask=p}}Qr.Replace=[1,0],Qr.disabled=new Qr(Qr.Replace,c.aM.transparent,[!1,!1,!1,!1]),Qr.unblended=new Qr(Qr.Replace,c.aM.transparent,[!0,!0,!0,!0]),Qr.alphaBlended=new Qr([1,771],c.aM.transparent,[!0,!0,!0,!0]);class dy{constructor(r){var a,p;if(this.gl=r,this.clearColor=new mu(this),this.clearDepth=new iy(this),this.clearStencil=new ia(this),this.colorMask=new oy(this),this.depthMask=new Ep(this),this.stencilMask=new sy(this),this.stencilFunc=new kp(this),this.stencilOp=new ih(this),this.stencilTest=new Tp(this),this.depthRange=new Cp(this),this.depthTest=new Ip(this),this.depthFunc=new Pp(this),this.blend=new Ts(this),this.blendFunc=new Ap(this),this.blendColor=new ay(this),this.blendEquation=new Mp(this),this.cullFace=new cl(this),this.cullFaceSide=new ly(this),this.frontFace=new gu(this),this.program=new uy(this),this.activeTexture=new cy(this),this.viewport=new zp(this),this.bindFramebuffer=new Dp(this),this.bindRenderbuffer=new Rp(this),this.bindTexture=new oh(this),this.bindVertexBuffer=new Lp(this),this.bindElementBuffer=new yu(this),this.bindVertexArray=new jo(this),this.pixelStoreUnpack=new sh(this),this.pixelStoreUnpackPremultiplyAlpha=new ah(this),this.pixelStoreUnpackFlipY=new lh(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),os(r)){this.HALF_FLOAT=r.HALF_FLOAT;const f=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=r.RGBA16F)!==null&&a!==void 0?a:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(p=r.RGB16F)!==null&&p!==void 0?p:f==null?void 0:f.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const f=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,a){return new ko(this,r,a)}createVertexBuffer(r,a,p){return new nh(this,r,a,p)}createRenderbuffer(r,a,p){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,r,a,p),this.bindRenderbuffer.set(null),_}createFramebuffer(r,a,p,f){return new hy(this,r,a,p,f)}clear({color:r,depth:a,stencil:p}){const f=this.gl;let _=0;r&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),p!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),f.clear(_)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){c.aE(r.blendFunction,Qr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return os(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var a;return os(this.gl)?this.gl.deleteVertexArray(r):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class er{constructor(r,a,p){this.func=r,this.mask=a,this.range=p}}er.ReadOnly=!1,er.ReadWrite=!0,er.disabled=new er(519,er.ReadOnly,[0,1]);const vu=7680;class Ar{constructor(r,a,p,f,_,S){this.test=r,this.ref=a,this.mask=p,this.fail=f,this.depthFail=_,this.pass=S}}Ar.disabled=new Ar({func:519,mask:0},0,0,vu,vu,vu);class kr{constructor(r,a,p){this.enable=r,this.mode=a,this.frontFace=p}}let Is;function hl(v,r,a,p,f){const _=v.context,S=_.gl,k=v.useProgram("collisionBox"),C=[];let z=0,O=0;for(let me=0;me<p.length;me++){const we=p[me],ae=r.getTile(we).getBucket(a);if(!ae)continue;const Ce=f?ae.textCollisionBox:ae.iconCollisionBox,Pe=ae.collisionCircleArray;if(Pe.length>0){const De=c.H();c.aQ(De,ae.placementInvProjMatrix,v.transform.glCoordMatrix),c.aQ(De,De,ae.placementViewportMatrix),C.push({circleArray:Pe,circleOffset:O,transform:we.posMatrix,invTransform:De,coord:we}),z+=Pe.length/4,O=z}Ce&&k.draw(_,S.LINES,er.disabled,Ar.disabled,v.colorModeForRenderPass(),kr.disabled,{u_matrix:we.posMatrix,u_pixel_extrude_scale:[1/(B=v.transform).width,1/B.height]},v.style.map.terrain&&v.style.map.terrain.getTerrainData(we),a.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,null,v.transform.zoom,null,null,Ce.collisionVertexBuffer)}var B;if(!f||!C.length)return;const K=v.useProgram("collisionCircle"),Q=new c.aR;Q.resize(4*z),Q._trim();let re=0;for(const me of C)for(let we=0;we<me.circleArray.length/4;we++){const ae=4*we,Ce=me.circleArray[ae+0],Pe=me.circleArray[ae+1],De=me.circleArray[ae+2],Xe=me.circleArray[ae+3];Q.emplace(re++,Ce,Pe,De,Xe,0),Q.emplace(re++,Ce,Pe,De,Xe,1),Q.emplace(re++,Ce,Pe,De,Xe,2),Q.emplace(re++,Ce,Pe,De,Xe,3)}(!Is||Is.length<2*z)&&(Is=function(me){const we=2*me,ae=new c.aT;ae.resize(we),ae._trim();for(let Ce=0;Ce<we;Ce++){const Pe=6*Ce;ae.uint16[Pe+0]=4*Ce+0,ae.uint16[Pe+1]=4*Ce+1,ae.uint16[Pe+2]=4*Ce+2,ae.uint16[Pe+3]=4*Ce+2,ae.uint16[Pe+4]=4*Ce+3,ae.uint16[Pe+5]=4*Ce+0}return ae}(z));const ce=_.createIndexBuffer(Is,!0),fe=_.createVertexBuffer(Q,c.aS.members,!0);for(const me of C){const we=Es(me.transform,me.invTransform,v.transform);K.draw(_,S.TRIANGLES,er.disabled,Ar.disabled,v.colorModeForRenderPass(),kr.disabled,we,v.style.map.terrain&&v.style.map.terrain.getTerrainData(me.coord),a.id,fe,ce,c.a0.simpleSegment(0,2*me.circleOffset,me.circleArray.length,me.circleArray.length/2),null,v.transform.zoom,null,null,null)}fe.destroy(),ce.destroy()}kr.disabled=new kr(!1,1029,2305),kr.backCCW=new kr(!0,1029,2305);const dl=c.an(new Float32Array(16));function hh(v,r,a,p,f,_){const{horizontalAlign:S,verticalAlign:k}=c.au(v);return new c.P((-(S-.5)*r/f+p[0])*_,(-(k-.5)*a/f+p[1])*_)}function Ps(v,r,a,p,f,_){const S=r.tileAnchorPoint.add(new c.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let k=p.mult(_);a||(k=k.rotate(-f));const C=S.add(k);return he(C.x,C.y,r.labelPlaneMatrix,r.getElevation).point}if(a){const k=He(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(v),C=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return v.add(p.rotate(C))}return v.add(p)}function oa(v,r,a,p,f,_,S,k,C,z,O,B,K,Q){const re=v.text.placedSymbolArray,ce=v.text.dynamicLayoutVertexArray,fe=v.icon.dynamicLayoutVertexArray,me={};ce.clear();for(let we=0;we<re.length;we++){const ae=re.get(we),Ce=ae.hidden||!ae.crossTileID||v.allowVerticalPlacement&&!ae.placedOrientation?null:p[ae.crossTileID];if(Ce){const Pe=new c.P(ae.anchorX,ae.anchorY),De={getElevation:Q,width:f.width,height:f.height,labelPlaneMatrix:_,lineVertexArray:null,pitchWithMap:a,projection:O,projectionCache:null,tileAnchorPoint:Pe,translation:B,unwrappedTileID:K},Xe=a?he(Pe.x,Pe.y,S,Q):He(Pe.x,Pe.y,De),ot=Z(f.cameraToCenterDistance,Xe.signedDistanceFromCamera);let mt=c.ai(v.textSizeData,C,ae)*ot/c.ap;a&&(mt*=v.tilePixelRatio/k);const{width:xt,height:ht,anchor:ct,textOffset:Ct,textBoxScale:Ht}=Ce,dt=hh(ct,xt,ht,Ct,Ht,mt),yt=O.getPitchedTextCorrection(f,Pe.add(new c.P(B[0],B[1])),K),Ut=Ps(Xe.point,De,r,dt,f.angle,yt),Lr=v.allowVerticalPlacement&&ae.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let Yt=0;Yt<ae.numGlyphs;Yt++)c.aj(ce,Ut,Lr);z&&ae.associatedIconIndex>=0&&(me[ae.associatedIconIndex]={shiftedAnchor:Ut,angle:Lr})}else Dt(ae.numGlyphs,ce)}if(z){fe.clear();const we=v.icon.placedSymbolArray;for(let ae=0;ae<we.length;ae++){const Ce=we.get(ae);if(Ce.hidden)Dt(Ce.numGlyphs,fe);else{const Pe=me[ae];if(Pe)for(let De=0;De<Ce.numGlyphs;De++)c.aj(fe,Pe.shiftedAnchor,Pe.angle);else Dt(Ce.numGlyphs,fe)}}v.icon.dynamicLayoutVertexBuffer.updateData(fe)}v.text.dynamicLayoutVertexBuffer.updateData(ce)}function Li(v,r,a){return a.iconsInText&&r?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function dh(v,r,a,p,f,_,S,k,C,z,O,B){const K=v.context,Q=K.gl,re=v.transform,ce=bs(),fe=k==="map",me=C==="map",we=k!=="viewport"&&a.layout.get("symbol-placement")!=="point",ae=fe&&!me&&!we,Ce=!me&&we,Pe=!a.layout.get("symbol-sort-key").isConstant();let De=!1;const Xe=v.depthModeForSublayer(0,er.ReadOnly),ot=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),mt=[],xt=ce.getCircleRadiusCorrection(re);for(const ht of p){const ct=r.getTile(ht),Ct=ct.getBucket(a);if(!Ct)continue;const Ht=f?Ct.text:Ct.icon;if(!Ht||!Ht.segments.get().length||!Ht.hasVisibleVertices)continue;const dt=Ht.programConfigurations.get(a.id),yt=f||Ct.sdfIcons,Ut=f?Ct.textSizeData:Ct.iconSizeData,Lr=me||re.pitch!==0,Yt=v.useProgram(Li(yt,f,Ct),dt),nr=c.ag(Ut,re.zoom),Fr=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ht);let Mn,no,Or,ni,Vn=[0,0],zn=null;if(f)no=ct.glyphAtlasTexture,Or=Q.LINEAR,Mn=ct.glyphAtlasTexture.size,Ct.iconsInText&&(Vn=ct.imageAtlasTexture.size,zn=ct.imageAtlasTexture,ni=Lr||v.options.rotating||v.options.zooming||Ut.kind==="composite"||Ut.kind==="camera"?Q.LINEAR:Q.NEAREST);else{const or=a.layout.get("icon-size").constantOr(0)!==1||Ct.iconsNeedLinear;no=ct.imageAtlasTexture,Or=yt||v.options.rotating||v.options.zooming||or||Lr?Q.LINEAR:Q.NEAREST,Mn=ct.imageAtlasTexture.size}const Hn=rr(ct,1,v.transform.zoom),Io=Ce?ht.posMatrix:dl,wa=Yi(Io,me,fe,v.transform,Hn),Bu=Pn(Io,me,fe,v.transform,Hn),ba=Pn(ht.posMatrix,me,fe,v.transform,Hn),Bi=ce.translatePosition(v.transform,ct,_,S),Nu=ot&&Ct.hasTextData(),Oh=a.layout.get("icon-text-fit")!=="none"&&Nu&&Ct.hasIconData();if(we){const or=v.style.map.terrain?(Sa,Ea)=>v.style.map.terrain.getElevation(ht,Sa,Ea):null,Rs=a.layout.get("text-rotation-alignment")==="map";ee(Ct,ht.posMatrix,v,f,wa,ba,me,z,Rs,ce,ht.toUnwrapped(),re.width,re.height,Bi,or)}const Ni=ht.posMatrix,$i=f&&ot||Oh,ss=we||$i?dl:wa,io=Bu,kn=yt&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Dn;Dn=yt?Ct.iconsInText?eh(Ut.kind,nr,ae,me,we,$i,v,Ni,ss,io,Bi,Mn,Vn,xt):ul(Ut.kind,nr,ae,me,we,$i,v,Ni,ss,io,Bi,f,Mn,!0,xt):Sp(Ut.kind,nr,ae,me,we,$i,v,Ni,ss,io,Bi,f,Mn,xt);const vi={program:Yt,buffers:Ht,uniformValues:Dn,atlasTexture:no,atlasTextureIcon:zn,atlasInterpolation:Or,atlasInterpolationIcon:ni,isSDF:yt,hasHalo:kn};if(Pe&&Ct.canOverlap){De=!0;const or=Ht.segments.get();for(const Rs of or)mt.push({segments:new c.a0([Rs]),sortKey:Rs.sortKey,state:vi,terrainData:Fr})}else mt.push({segments:Ht.segments,sortKey:0,state:vi,terrainData:Fr})}De&&mt.sort((ht,ct)=>ht.sortKey-ct.sortKey);for(const ht of mt){const ct=ht.state;if(K.activeTexture.set(Q.TEXTURE0),ct.atlasTexture.bind(ct.atlasInterpolation,Q.CLAMP_TO_EDGE),ct.atlasTextureIcon&&(K.activeTexture.set(Q.TEXTURE1),ct.atlasTextureIcon&&ct.atlasTextureIcon.bind(ct.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),ct.isSDF){const Ct=ct.uniformValues;ct.hasHalo&&(Ct.u_is_halo=1,ph(ct.buffers,ht.segments,a,v,ct.program,Xe,O,B,Ct,ht.terrainData)),Ct.u_is_halo=0}ph(ct.buffers,ht.segments,a,v,ct.program,Xe,O,B,ct.uniformValues,ht.terrainData)}}function ph(v,r,a,p,f,_,S,k,C,z){const O=p.context;f.draw(O,O.gl.TRIANGLES,_,S,k,kr.disabled,C,z,a.id,v.layoutVertexBuffer,v.indexBuffer,r,a.paint,p.transform.zoom,v.programConfigurations.get(a.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function fh(v,r,a,p){const f=v.context,_=f.gl,S=Ar.disabled,k=new Qr([_.ONE,_.ONE],c.aM.transparent,[!0,!0,!0,!0]),C=r.getBucket(a);if(!C)return;const z=p.key;let O=a.heatmapFbos.get(z);O||(O=pl(f,r.tileSize,r.tileSize),a.heatmapFbos.set(z,O)),f.bindFramebuffer.set(O.framebuffer),f.viewport.set([0,0,r.tileSize,r.tileSize]),f.clear({color:c.aM.transparent});const B=C.programConfigurations.get(a.id),K=v.useProgram("heatmap",B),Q=v.style.map.terrain.getTerrainData(p);K.draw(f,_.TRIANGLES,er.disabled,S,k,kr.disabled,ri(p.posMatrix,r,v.transform.zoom,a.paint.get("heatmap-intensity")),Q,a.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,a.paint,v.transform.zoom,B)}function As(v,r,a){const p=v.context,f=p.gl;p.setColorMode(v.colorModeForRenderPass());const _=fl(p,r),S=a.key,k=r.heatmapFbos.get(S);k&&(p.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,k.colorAttachment.get()),p.activeTexture.set(f.TEXTURE1),_.bind(f.LINEAR,f.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(p,f.TRIANGLES,er.disabled,Ar.disabled,v.colorModeForRenderPass(),kr.disabled,hu(v,r,0,1),null,r.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,r.paint,v.transform.zoom),k.destroy(),r.heatmapFbos.delete(S))}function pl(v,r,a){var p,f;const _=v.gl,S=_.createTexture();_.bindTexture(_.TEXTURE_2D,S),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const k=(p=v.HALF_FLOAT)!==null&&p!==void 0?p:_.UNSIGNED_BYTE,C=(f=v.RGBA16F)!==null&&f!==void 0?f:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,C,r,a,0,_.RGBA,k,null);const z=v.createFramebuffer(r,a,!1,!1);return z.colorAttachment.set(S),z}function fl(v,r){return r.colorRampTexture||(r.colorRampTexture=new it(v,r.colorRamp,v.gl.RGBA)),r.colorRampTexture}function sa(v,r,a,p,f){if(!a||!p||!p.imageAtlas)return;const _=p.imageAtlas.patternPositions;let S=_[a.to.toString()],k=_[a.from.toString()];if(!S&&k&&(S=k),!k&&S&&(k=S),!S||!k){const C=f.getPaintProperty(r);S=_[C],k=_[C]}S&&k&&v.setConstantPatternPositions(S,k)}function ml(v,r,a,p,f,_,S){const k=v.context.gl,C="fill-pattern",z=a.paint.get(C),O=z&&z.constantOr(1),B=a.getCrossfadeParameters();let K,Q,re,ce,fe;S?(Q=O&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",K=k.LINES):(Q=O?"fillPattern":"fill",K=k.TRIANGLES);const me=z.constantOr(null);for(const we of p){const ae=r.getTile(we);if(O&&!ae.patternsLoaded())continue;const Ce=ae.getBucket(a);if(!Ce)continue;const Pe=Ce.programConfigurations.get(a.id),De=v.useProgram(Q,Pe),Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(we);O&&(v.context.activeTexture.set(k.TEXTURE0),ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Pe.updatePaintBuffers(B)),sa(Pe,C,me,ae,a);const ot=Xe?we:null,mt=v.translatePosMatrix(ot?ot.posMatrix:we.posMatrix,ae,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(S){ce=Ce.indexBuffer2,fe=Ce.segments2;const xt=[k.drawingBufferWidth,k.drawingBufferHeight];re=Q==="fillOutlinePattern"&&O?vp(mt,v,B,ae,xt):Jg(mt,xt)}else ce=Ce.indexBuffer,fe=Ce.segments,re=O?_p(mt,v,B,ae):ra(mt);De.draw(v.context,K,f,v.stencilModeForClipping(we),_,kr.disabled,re,Xe,a.id,Ce.layoutVertexBuffer,ce,fe,a.paint,v.transform.zoom,Pe)}}function xu(v,r,a,p,f,_,S){const k=v.context,C=k.gl,z="fill-extrusion-pattern",O=a.paint.get(z),B=O.constantOr(1),K=a.getCrossfadeParameters(),Q=a.paint.get("fill-extrusion-opacity"),re=O.constantOr(null);for(const ce of p){const fe=r.getTile(ce),me=fe.getBucket(a);if(!me)continue;const we=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ce),ae=me.programConfigurations.get(a.id),Ce=v.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ae);B&&(v.context.activeTexture.set(C.TEXTURE0),fe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),ae.updatePaintBuffers(K)),sa(ae,z,re,fe,a);const Pe=v.translatePosMatrix(ce.posMatrix,fe,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),De=a.paint.get("fill-extrusion-vertical-gradient"),Xe=B?cu(Pe,v,De,Q,ce,K,fe):al(Pe,v,De,Q);Ce.draw(k,k.gl.TRIANGLES,f,_,S,kr.backCCW,Xe,we,a.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,a.paint,v.transform.zoom,ae,v.style.map.terrain&&me.centroidVertexBuffer)}}function aa(v,r,a,p,f,_,S){const k=v.context,C=k.gl,z=a.fbo;if(!z)return;const O=v.useProgram("hillshade"),B=v.style.map.terrain&&v.style.map.terrain.getTerrainData(r);k.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,z.colorAttachment.get()),O.draw(k,C.TRIANGLES,f,_,S,kr.disabled,((K,Q,re,ce)=>{const fe=re.paint.get("hillshade-shadow-color"),me=re.paint.get("hillshade-highlight-color"),we=re.paint.get("hillshade-accent-color");let ae=re.paint.get("hillshade-illumination-direction")*(Math.PI/180);re.paint.get("hillshade-illumination-anchor")==="viewport"&&(ae-=K.transform.angle);const Ce=!K.options.moving;return{u_matrix:ce?ce.posMatrix:K.transform.calculatePosMatrix(Q.tileID.toUnwrapped(),Ce),u_image:0,u_latrange:du(0,Q.tileID),u_light:[re.paint.get("hillshade-exaggeration"),ae],u_shadow:fe,u_highlight:me,u_accent:we}})(v,a,p,B?r:null),B,p.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}function la(v,r,a,p,f,_){const S=v.context,k=S.gl,C=r.dem;if(C&&C.data){const z=C.dim,O=C.stride,B=C.getPixels();if(S.activeTexture.set(k.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||v.getTileTexture(O),r.demTexture){const Q=r.demTexture;Q.update(B,{premultiply:!1}),Q.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else r.demTexture=new it(S,B,k.RGBA,{premultiply:!1}),r.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);S.activeTexture.set(k.TEXTURE0);let K=r.fbo;if(!K){const Q=new it(S,{width:z,height:z,data:null},k.RGBA);Q.bind(k.LINEAR,k.CLAMP_TO_EDGE),K=r.fbo=S.createFramebuffer(z,z,!0,!1),K.colorAttachment.set(Q.texture)}S.bindFramebuffer.set(K.framebuffer),S.viewport.set([0,0,z,z]),v.useProgram("hillshadePrepare").draw(S,k.TRIANGLES,p,f,_,kr.disabled,((Q,re)=>{const ce=re.stride,fe=c.H();return c.aP(fe,0,c.X,-c.X,0,0,1),c.J(fe,fe,[0,-c.X,0]),{u_matrix:fe,u_image:1,u_dimension:[ce,ce],u_zoom:Q.overscaledZ,u_unpack:re.getUnpackVector()}})(r.tileID,C),null,a.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Fp(v,r,a,p,f,_){const S=p.paint.get("raster-fade-duration");if(!_&&S>0){const k=D.now(),C=(k-v.timeAdded)/S,z=r?(k-r.timeAdded)/S:-1,O=a.getSource(),B=f.coveringZoomLevel({tileSize:O.tileSize,roundZoom:O.roundZoom}),K=!r||Math.abs(r.tileID.overscaledZ-B)>Math.abs(v.tileID.overscaledZ-B),Q=K&&v.refreshedUponExpiration?1:c.ac(K?C:1-z,0,1);return v.refreshedUponExpiration&&C>=1&&(v.refreshedUponExpiration=!1),r?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const mh=new c.aM(1,0,0,1),fr=new c.aM(0,1,0,1),wu=new c.aM(0,0,1,1),py=new c.aM(1,0,1,1),Op=new c.aM(0,1,1,1);function ua(v,r,a,p){bu(v,0,r+a/2,v.transform.width,a,p)}function Bp(v,r,a,p){bu(v,r-a/2,0,a,v.transform.height,p)}function bu(v,r,a,p,f,_){const S=v.context,k=S.gl;k.enable(k.SCISSOR_TEST),k.scissor(r*v.pixelRatio,a*v.pixelRatio,p*v.pixelRatio,f*v.pixelRatio),S.clear({color:_}),k.disable(k.SCISSOR_TEST)}function Np(v,r,a){const p=v.context,f=p.gl,_=a.posMatrix,S=v.useProgram("debug"),k=er.disabled,C=Ar.disabled,z=v.colorModeForRenderPass(),O="$debug",B=v.style.map.terrain&&v.style.map.terrain.getTerrainData(a);p.activeTexture.set(f.TEXTURE0);const K=r.getTileByID(a.key).latestRawTileData,Q=Math.floor((K&&K.byteLength||0)/1024),re=r.getTile(a).tileSize,ce=512/Math.min(re,512)*(a.overscaledZ/v.transform.zoom)*.5;let fe=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(fe+=` => ${a.overscaledZ}`),function(me,we){me.initDebugOverlayCanvas();const ae=me.debugOverlayCanvas,Ce=me.context.gl,Pe=me.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,ae.width,ae.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(we,5,5),Pe.strokeText(we,5,5),me.debugOverlayTexture.update(ae),me.debugOverlayTexture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE)}(v,`${fe} ${Q}kB`),S.draw(p,f.TRIANGLES,k,C,Qr.alphaBlended,kr.disabled,ll(_,c.aM.transparent,ce),null,O,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),S.draw(p,f.LINE_STRIP,k,C,z,kr.disabled,ll(_,c.aM.red),B,O,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function $p(v,r,a){const p=v.context,f=p.gl,_=v.colorModeForRenderPass(),S=new er(f.LEQUAL,er.ReadWrite,v.depthRangeFor3D),k=v.useProgram("terrain"),C=r.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,v.width,v.height]);for(const z of a){const O=v.renderToTexture.getTexture(z),B=r.getTerrainData(z.tileID);p.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,O.texture);const K=v.transform.calculatePosMatrix(z.tileID.toUnwrapped()),Q=r.getMeshFrameDelta(v.transform.zoom),re=v.transform.calculateFogMatrix(z.tileID.toUnwrapped()),ce=Jc(K,Q,re,v.style.sky,v.transform.pitch);k.draw(p,f.TRIANGLES,S,Ar.disabled,_,kr.backCCW,ce,B,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class Su{constructor(r,a,p){this.vertexBuffer=r,this.indexBuffer=a,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Eu{constructor(r,a){this.context=new dy(r),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Bt.maxUnderzooming+Bt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Kc}resize(r,a,p){if(this.width=Math.floor(r*p),this.height=Math.floor(a*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const r=this.context,a=new c.aX;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=r.createVertexBuffer(a,Ss.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const p=new c.aX;p.emplaceBack(0,0),p.emplaceBack(c.X,0),p.emplaceBack(0,c.X),p.emplaceBack(c.X,c.X),this.debugBuffer=r.createVertexBuffer(p,Ss.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const f=new c.$;f.emplaceBack(0,0,0,0),f.emplaceBack(c.X,0,c.X,0),f.emplaceBack(0,c.X,0,c.X),f.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=r.createVertexBuffer(f,Ne.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const _=new c.aX;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(_,Ss.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const S=new c.aZ;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(S);const k=new c.aY;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(k);const C=this.context.gl;this.stencilClearMode=new Ar({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const r=this.context,a=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.H();c.aP(p,0,this.width,this.height,0,0,1),c.K(p,p,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,a.TRIANGLES,er.disabled,this.stencilClearMode,Qr.disabled,kr.disabled,ti(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,a){if(this.currentStencilSource===r.source||!r.isTileClipped()||!a||!a.length)return;this.currentStencilSource=r.source;const p=this.context,f=p.gl;this.nextStencilID+a.length>256&&this.clearStencil(),p.setColorMode(Qr.disabled),p.setDepthMode(er.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of a){const k=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S);_.draw(p,f.TRIANGLES,er.disabled,new Ar({func:f.ALWAYS,mask:0},k,255,f.KEEP,f.KEEP,f.REPLACE),Qr.disabled,kr.disabled,ti(S.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,a=this.context.gl;return new Ar({func:a.NOTEQUAL,mask:255},r,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(r){const a=this.context.gl;return new Ar({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(r){const a=this.context.gl,p=r.sort((S,k)=>k.overscaledZ-S.overscaledZ),f=p[p.length-1].overscaledZ,_=p[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const S={};for(let k=0;k<_;k++)S[k+f]=new Ar({func:a.GEQUAL,mask:255},k+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=_,[S,p]}return[{[f]:Ar.disabled},p]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Qr([r.CONSTANT_COLOR,r.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Qr.unblended:Qr.alphaBlended}depthModeForSublayer(r,a,p){if(!this.opaquePassEnabledForLayer())return er.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new er(p||this.context.gl.LEQUAL,a,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,a){this.style=r,this.options=a,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(D.now()),this.imageManager.beginFrame();const p=this.style._order,f=this.style.sourceCaches,_={},S={},k={};for(const C in f){const z=f[C];z.used&&z.prepare(this.context),_[C]=z.getVisibleCoordinates(),S[C]=_[C].slice().reverse(),k[C]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<p.length;C++)if(this.style._layers[p[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of p){const z=this.style._layers[C];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const O=S[z.source];(z.type==="custom"||O.length)&&this.renderLayer(this,f[z.source],z,O)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(C,z){const O=C.context,B=O.gl,K=((me,we,ae)=>({u_sky_color:me.properties.get("sky-color"),u_horizon_color:me.properties.get("horizon-color"),u_horizon:(we.height/2+we.getHorizon())*ae,u_sky_horizon_blend:me.properties.get("sky-horizon-blend")*we.height/2*ae}))(z,C.style.map.transform,C.pixelRatio),Q=new er(B.LEQUAL,er.ReadWrite,[0,1]),re=Ar.disabled,ce=C.colorModeForRenderPass(),fe=C.useProgram("sky");if(!z.mesh){const me=new c.aX;me.emplaceBack(-1,-1),me.emplaceBack(1,-1),me.emplaceBack(1,1),me.emplaceBack(-1,1);const we=new c.aY;we.emplaceBack(0,1,2),we.emplaceBack(0,2,3),z.mesh=new Su(O.createVertexBuffer(me,Ss.members),O.createIndexBuffer(we),c.a0.simpleSegment(0,0,me.length,we.length))}fe.draw(O,B.TRIANGLES,Q,re,ce,kr.disabled,K,void 0,"sky",z.mesh.vertexBuffer,z.mesh.indexBuffer,z.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[p[this.currentLayer]],z=f[C.source],O=_[C.source];this._renderTileClippingMasks(C,O),this.renderLayer(this,z,C,O)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const C=this.style._layers[p[this.currentLayer]],z=f[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const O=(C.type==="symbol"?k:S)[C.source];this._renderTileClippingMasks(C,_[C.source]),this.renderLayer(this,z,C,O)}if(this.options.showTileBoundaries){const C=function(z,O){let B=null;const K=Object.values(z._layers).flatMap(fe=>fe.source&&!fe.isHidden(O)?[z.sourceCaches[fe.source]]:[]),Q=K.filter(fe=>fe.getSource().type==="vector"),re=K.filter(fe=>fe.getSource().type!=="vector"),ce=fe=>{(!B||B.getSource().maxzoom<fe.getSource().maxzoom)&&(B=fe)};return Q.forEach(fe=>ce(fe)),B||re.forEach(fe=>ce(fe)),B}(this.style,this.transform.zoom);C&&function(z,O,B){for(let K=0;K<B.length;K++)Np(z,O,B[K])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const z=C.transform.padding;ua(C,C.transform.height-(z.top||0),3,mh),ua(C,z.bottom||0,3,fr),Bp(C,z.left||0,3,wu),Bp(C,C.transform.width-(z.right||0),3,py);const O=C.transform.centerPoint;(function(B,K,Q,re){bu(B,K-1,Q-10,2,20,re),bu(B,K-10,Q-1,20,2,re)})(C,O.x,C.transform.height-O.y,Op)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=r?!c.a_(a,p):!c.a$(a,p)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(c.b0(a,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,S){const k=_.context,C=k.gl,z=Qr.unblended,O=new er(C.LEQUAL,er.ReadWrite,[0,1]),B=S.getTerrainMesh(),K=S.sourceCache.getRenderableTiles(),Q=_.useProgram("terrainDepth");k.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),k.clear({color:c.aM.transparent,depth:1});for(const re of K){const ce=S.getTerrainData(re.tileID),fe={u_matrix:_.transform.calculatePosMatrix(re.tileID.toUnwrapped()),u_ele_delta:S.getMeshFrameDelta(_.transform.zoom)};Q.draw(k,C.TRIANGLES,O,Ar.disabled,z,kr.backCCW,fe,ce,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,S){const k=_.context,C=k.gl,z=Qr.unblended,O=new er(C.LEQUAL,er.ReadWrite,[0,1]),B=S.getTerrainMesh(),K=S.getCoordsTexture(),Q=S.sourceCache.getRenderableTiles(),re=_.useProgram("terrainCoords");k.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),k.clear({color:c.aM.transparent,depth:1}),S.coordsIndex=[];for(const ce of Q){const fe=S.getTerrainData(ce.tileID);k.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,K.texture);const me={u_matrix:_.transform.calculatePosMatrix(ce.tileID.toUnwrapped()),u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(_.transform.zoom)};re.draw(k,C.TRIANGLES,O,Ar.disabled,z,kr.backCCW,me,fe,"terrain",B.vertexBuffer,B.indexBuffer,B.segments),S.coordsIndex.push(ce.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(r,a,p,f){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(f||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(_,S,k,C,z){if(_.renderPass!=="translucent")return;const O=Ar.disabled,B=_.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(K,Q,re,ce,fe,me,we,ae,Ce){const Pe=Q.transform,De=bs(),Xe=fe==="map",ot=me==="map";for(const mt of K){const xt=ce.getTile(mt),ht=xt.getBucket(re);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const ct=c.ag(ht.textSizeData,Pe.zoom),Ct=rr(xt,1,Q.transform.zoom),Ht=Yi(mt.posMatrix,ot,Xe,Q.transform,Ct),dt=re.layout.get("icon-text-fit")!=="none"&&ht.hasIconData();if(ct){const yt=Math.pow(2,Pe.zoom-xt.tileID.overscaledZ),Ut=Q.style.map.terrain?(Yt,nr)=>Q.style.map.terrain.getElevation(mt,Yt,nr):null,Lr=De.translatePosition(Pe,xt,we,ae);oa(ht,Xe,ot,Ce,Pe,Ht,mt.posMatrix,yt,ct,dt,De,Lr,mt.toUnwrapped(),Ut)}}}(C,_,k,S,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),z),k.paint.get("icon-opacity").constantOr(1)!==0&&dh(_,S,k,C,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),O,B),k.paint.get("text-opacity").constantOr(1)!==0&&dh(_,S,k,C,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),O,B),S.map.showCollisionBoxes&&(hl(_,S,k,C,!0),hl(_,S,k,C,!1))})(r,a,p,f,this.style.placement.variableOffsets);break;case"circle":(function(_,S,k,C){if(_.renderPass!=="translucent")return;const z=k.paint.get("circle-opacity"),O=k.paint.get("circle-stroke-width"),B=k.paint.get("circle-stroke-opacity"),K=!k.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(O.constantOr(1)===0||B.constantOr(1)===0))return;const Q=_.context,re=Q.gl,ce=_.depthModeForSublayer(0,er.ReadOnly),fe=Ar.disabled,me=_.colorModeForRenderPass(),we=[];for(let ae=0;ae<C.length;ae++){const Ce=C[ae],Pe=S.getTile(Ce),De=Pe.getBucket(k);if(!De)continue;const Xe=De.programConfigurations.get(k.id),ot=_.useProgram("circle",Xe),mt=De.layoutVertexBuffer,xt=De.indexBuffer,ht=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ce),ct={programConfiguration:Xe,program:ot,layoutVertexBuffer:mt,indexBuffer:xt,uniformValues:Qg(_,Ce,Pe,k),terrainData:ht};if(K){const Ct=De.segments.get();for(const Ht of Ct)we.push({segments:new c.a0([Ht]),sortKey:Ht.sortKey,state:ct})}else we.push({segments:De.segments,sortKey:0,state:ct})}K&&we.sort((ae,Ce)=>ae.sortKey-Ce.sortKey);for(const ae of we){const{programConfiguration:Ce,program:Pe,layoutVertexBuffer:De,indexBuffer:Xe,uniformValues:ot,terrainData:mt}=ae.state;Pe.draw(Q,re.TRIANGLES,ce,fe,me,kr.disabled,ot,mt,k.id,De,Xe,ae.segments,k.paint,_.transform.zoom,Ce)}})(r,a,p,f);break;case"heatmap":(function(_,S,k,C){if(k.paint.get("heatmap-opacity")===0)return;const z=_.context;if(_.style.map.terrain){for(const O of C){const B=S.getTile(O);S.hasRenderableParent(O)||(_.renderPass==="offscreen"?fh(_,B,k,O):_.renderPass==="translucent"&&As(_,k,O))}z.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?function(O,B,K,Q){const re=O.context,ce=re.gl,fe=Ar.disabled,me=new Qr([ce.ONE,ce.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(we,ae,Ce){const Pe=we.gl;we.activeTexture.set(Pe.TEXTURE1),we.viewport.set([0,0,ae.width/4,ae.height/4]);let De=Ce.heatmapFbos.get(c.aU);De?(Pe.bindTexture(Pe.TEXTURE_2D,De.colorAttachment.get()),we.bindFramebuffer.set(De.framebuffer)):(De=pl(we,ae.width/4,ae.height/4),Ce.heatmapFbos.set(c.aU,De))})(re,O,K),re.clear({color:c.aM.transparent});for(let we=0;we<Q.length;we++){const ae=Q[we];if(B.hasRenderableParent(ae))continue;const Ce=B.getTile(ae),Pe=Ce.getBucket(K);if(!Pe)continue;const De=Pe.programConfigurations.get(K.id),Xe=O.useProgram("heatmap",De),{zoom:ot}=O.transform;Xe.draw(re,ce.TRIANGLES,er.disabled,fe,me,kr.disabled,ri(ae.posMatrix,Ce,ot,K.paint.get("heatmap-intensity")),null,K.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,K.paint,O.transform.zoom,De)}re.viewport.set([0,0,O.width,O.height])}(_,S,k,C):_.renderPass==="translucent"&&function(O,B){const K=O.context,Q=K.gl;K.setColorMode(O.colorModeForRenderPass());const re=B.heatmapFbos.get(c.aU);re&&(K.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,re.colorAttachment.get()),K.activeTexture.set(Q.TEXTURE1),fl(K,B).bind(Q.LINEAR,Q.CLAMP_TO_EDGE),O.useProgram("heatmapTexture").draw(K,Q.TRIANGLES,er.disabled,Ar.disabled,O.colorModeForRenderPass(),kr.disabled,hu(O,B,0,1),null,B.id,O.viewportBuffer,O.quadTriangleIndexBuffer,O.viewportSegments,B.paint,O.transform.zoom))}(_,k)})(r,a,p,f);break;case"line":(function(_,S,k,C){if(_.renderPass!=="translucent")return;const z=k.paint.get("line-opacity"),O=k.paint.get("line-width");if(z.constantOr(1)===0||O.constantOr(1)===0)return;const B=_.depthModeForSublayer(0,er.ReadOnly),K=_.colorModeForRenderPass(),Q=k.paint.get("line-dasharray"),re=k.paint.get("line-pattern"),ce=re.constantOr(1),fe=k.paint.get("line-gradient"),me=k.getCrossfadeParameters(),we=ce?"linePattern":Q?"lineSDF":fe?"lineGradient":"line",ae=_.context,Ce=ae.gl;let Pe=!0;for(const De of C){const Xe=S.getTile(De);if(ce&&!Xe.patternsLoaded())continue;const ot=Xe.getBucket(k);if(!ot)continue;const mt=ot.programConfigurations.get(k.id),xt=_.context.program.get(),ht=_.useProgram(we,mt),ct=Pe||ht.program!==xt,Ct=_.style.map.terrain&&_.style.map.terrain.getTerrainData(De),Ht=re.constantOr(null);if(Ht&&Xe.imageAtlas){const Ut=Xe.imageAtlas,Lr=Ut.patternPositions[Ht.to.toString()],Yt=Ut.patternPositions[Ht.from.toString()];Lr&&Yt&&mt.setConstantPatternPositions(Lr,Yt)}const dt=Ct?De:null,yt=ce?na(_,Xe,k,me,dt):Q?ey(_,Xe,k,Q,me,dt):fe?xp(_,Xe,k,ot.lineClipsArray.length,dt):pu(_,Xe,k,dt);if(ce)ae.activeTexture.set(Ce.TEXTURE0),Xe.imageAtlasTexture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),mt.updatePaintBuffers(me);else if(Q&&(ct||_.lineAtlas.dirty))ae.activeTexture.set(Ce.TEXTURE0),_.lineAtlas.bind(ae);else if(fe){const Ut=ot.gradients[k.id];let Lr=Ut.texture;if(k.gradientVersion!==Ut.version){let Yt=256;if(k.stepInterpolant){const nr=S.getSource().maxzoom,Fr=De.canonical.z===nr?Math.ceil(1<<_.transform.maxZoom-De.canonical.z):1;Yt=c.ac(c.aV(ot.maxLineLength/c.X*1024*Fr),256,ae.maxTextureSize)}Ut.gradient=c.aW({expression:k.gradientExpression(),evaluationKey:"lineProgress",resolution:Yt,image:Ut.gradient||void 0,clips:ot.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new it(ae,Ut.gradient,Ce.RGBA),Ut.version=k.gradientVersion,Lr=Ut.texture}ae.activeTexture.set(Ce.TEXTURE0),Lr.bind(k.stepInterpolant?Ce.NEAREST:Ce.LINEAR,Ce.CLAMP_TO_EDGE)}ht.draw(ae,Ce.TRIANGLES,B,_.stencilModeForClipping(De),K,kr.disabled,yt,Ct,k.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,k.paint,_.transform.zoom,mt,ot.layoutVertexBuffer2),Pe=!1}})(r,a,p,f);break;case"fill":(function(_,S,k,C){const z=k.paint.get("fill-color"),O=k.paint.get("fill-opacity");if(O.constantOr(1)===0)return;const B=_.colorModeForRenderPass(),K=k.paint.get("fill-pattern"),Q=_.opaquePassEnabledForLayer()&&!K.constantOr(1)&&z.constantOr(c.aM.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===Q){const re=_.depthModeForSublayer(1,_.renderPass==="opaque"?er.ReadWrite:er.ReadOnly);ml(_,S,k,C,re,B,!1)}if(_.renderPass==="translucent"&&k.paint.get("fill-antialias")){const re=_.depthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,er.ReadOnly);ml(_,S,k,C,re,B,!0)}})(r,a,p,f);break;case"fill-extrusion":(function(_,S,k,C){const z=k.paint.get("fill-extrusion-opacity");if(z!==0&&_.renderPass==="translucent"){const O=new er(_.context.gl.LEQUAL,er.ReadWrite,_.depthRangeFor3D);if(z!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))xu(_,S,k,C,O,Ar.disabled,Qr.disabled),xu(_,S,k,C,O,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const B=_.colorModeForRenderPass();xu(_,S,k,C,O,Ar.disabled,B)}}})(r,a,p,f);break;case"hillshade":(function(_,S,k,C){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const z=_.context,O=_.depthModeForSublayer(0,er.ReadOnly),B=_.colorModeForRenderPass(),[K,Q]=_.renderPass==="translucent"?_.stencilConfigForOverlap(C):[{},C];for(const re of Q){const ce=S.getTile(re);ce.needsHillshadePrepare!==void 0&&ce.needsHillshadePrepare&&_.renderPass==="offscreen"?la(_,ce,k,O,Ar.disabled,B):_.renderPass==="translucent"&&aa(_,re,ce,k,O,K[re.overscaledZ],B)}z.viewport.set([0,0,_.width,_.height])})(r,a,p,f);break;case"raster":(function(_,S,k,C){if(_.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!C.length)return;const z=_.context,O=z.gl,B=S.getSource(),K=_.useProgram("raster"),Q=_.colorModeForRenderPass(),[re,ce]=B instanceof st?[{},C]:_.stencilConfigForOverlap(C),fe=ce[ce.length-1].overscaledZ,me=!_.options.moving;for(const we of ce){const ae=_.depthModeForSublayer(we.overscaledZ-fe,k.paint.get("raster-opacity")===1?er.ReadWrite:er.ReadOnly,O.LESS),Ce=S.getTile(we);Ce.registerFadeDuration(k.paint.get("raster-fade-duration"));const Pe=S.findLoadedParent(we,0),De=S.findLoadedSibling(we),Xe=Fp(Ce,Pe||De||null,S,k,_.transform,_.style.map.terrain);let ot,mt;const xt=k.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;z.activeTexture.set(O.TEXTURE0),Ce.texture.bind(xt,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(O.TEXTURE1),Pe?(Pe.texture.bind(xt,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),ot=Math.pow(2,Pe.tileID.overscaledZ-Ce.tileID.overscaledZ),mt=[Ce.tileID.canonical.x*ot%1,Ce.tileID.canonical.y*ot%1]):Ce.texture.bind(xt,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),Ce.texture.useMipmap&&z.extTextureFilterAnisotropic&&_.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const ht=_.style.map.terrain&&_.style.map.terrain.getTerrainData(we),ct=ht?we:null,Ct=ct?ct.posMatrix:_.transform.calculatePosMatrix(we.toUnwrapped(),me),Ht=ty(Ct,mt||[0,0],ot||1,Xe,k);B instanceof st?K.draw(z,O.TRIANGLES,ae,Ar.disabled,Q,kr.disabled,Ht,ht,k.id,B.boundsBuffer,_.quadTriangleIndexBuffer,B.boundsSegments):K.draw(z,O.TRIANGLES,ae,re[we.overscaledZ],Q,kr.disabled,Ht,ht,k.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}})(r,a,p,f);break;case"background":(function(_,S,k,C){const z=k.paint.get("background-color"),O=k.paint.get("background-opacity");if(O===0)return;const B=_.context,K=B.gl,Q=_.transform,re=Q.tileSize,ce=k.paint.get("background-pattern");if(_.isPatternMissing(ce))return;const fe=!ce&&z.a===1&&O===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==fe)return;const me=Ar.disabled,we=_.depthModeForSublayer(0,fe==="opaque"?er.ReadWrite:er.ReadOnly),ae=_.colorModeForRenderPass(),Ce=_.useProgram(ce?"backgroundPattern":"background"),Pe=C||Q.coveringTiles({tileSize:re,terrain:_.style.map.terrain});ce&&(B.activeTexture.set(K.TEXTURE0),_.imageManager.bind(_.context));const De=k.getCrossfadeParameters();for(const Xe of Pe){const ot=C?Xe.posMatrix:_.transform.calculatePosMatrix(Xe.toUnwrapped()),mt=ce?th(ot,O,_,ce,{tileID:Xe,tileSize:re},De):fu(ot,O,z),xt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Xe);Ce.draw(B,K.TRIANGLES,we,me,ae,kr.disabled,mt,xt,k.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}})(r,0,p,f);break;case"custom":(function(_,S,k){const C=_.context,z=k.implementation;if(_.renderPass==="offscreen"){const O=z.prerender;O&&(_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),O.call(z,C.gl,_.transform.customLayerMatrix()),C.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),C.setColorMode(_.colorModeForRenderPass()),C.setStencilMode(Ar.disabled);const O=z.renderingMode==="3d"?new er(_.context.gl.LEQUAL,er.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,er.ReadOnly);C.setDepthMode(O),z.render(C.gl,_.transform.customLayerMatrix(),{farZ:_.transform.farZ,nearZ:_.transform.nearZ,fov:_.transform._fov,modelViewProjectionMatrix:_.transform.modelViewProjectionMatrix,projectionMatrix:_.transform.projectionMatrix}),C.setDirty(),_.setBaseState(),C.bindFramebuffer.set(null)}})(r,0,p)}}translatePosMatrix(r,a,p,f,_){if(!p[0]&&!p[1])return r;const S=_?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(S){const z=Math.sin(S),O=Math.cos(S);p=[p[0]*O-p[1]*z,p[0]*z+p[1]*O]}const k=[_?p[0]:rr(a,p[0],this.transform.zoom),_?p[1]:rr(a,p[1],this.transform.zoom),0],C=new Float32Array(16);return c.J(C,r,k),C}saveTileTexture(r){const a=this._tileTextures[r.size[0]];a?a.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const a=this._tileTextures[r];return a&&a.length>0?a.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const a=this.imageManager.getPattern(r.from.toString()),p=this.imageManager.getPattern(r.to.toString());return!a||!p}useProgram(r,a){this.cache=this.cache||{};const p=r+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new Qc(this.context,is[r],a,rh[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new it(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:a}=this.context.gl;return this.width!==r||this.height!==a}}class ca{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,p){const f=Math.pow(2,p),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const C=1/(k=c.af([],k,r))[3]/a*f;return c.b1(k,k,[C,C,1/k[3],C])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const C=function(K,Q){var re=Q[0],ce=Q[1],fe=Q[2],me=re*re+ce*ce+fe*fe;return me>0&&(me=1/Math.sqrt(me)),K[0]=Q[0]*me,K[1]=Q[1]*me,K[2]=Q[2]*me,K}([],function(K,Q,re){var ce=Q[0],fe=Q[1],me=Q[2],we=re[0],ae=re[1],Ce=re[2];return K[0]=fe*Ce-me*ae,K[1]=me*we-ce*Ce,K[2]=ce*ae-fe*we,K}([],ge([],_[k[0]],_[k[1]]),ge([],_[k[2]],_[k[1]]))),z=-((O=C)[0]*(B=_[k[1]])[0]+O[1]*B[1]+O[2]*B[2]);var O,B;return C.concat(z)});return new ca(_,S)}}class ha{constructor(r,a){this.min=r,this.max=a,this.center=function(p,f,_){return p[0]=.5*f[0],p[1]=.5*f[1],p[2]=.5*f[2],p}([],function(p,f,_){return p[0]=f[0]+_[0],p[1]=f[1]+_[1],p[2]=f[2]+_[2],p}([],this.min,this.max))}quadrant(r){const a=[r%2==0,r<2],p=se(this.min),f=se(this.max);for(let _=0;_<a.length;_++)p[_]=a[_]?this.min[_]:this.center[_],f[_]=a[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new ha(p,f)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let f=0;f<r.planes.length;f++){const _=r.planes[f];let S=0;for(let k=0;k<a.length;k++)c.b2(_,a[k])>=0&&S++;if(S===0)return 0;S!==a.length&&(p=!1)}if(p)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,S=-Number.MAX_VALUE;for(let k=0;k<r.points.length;k++){const C=r.points[k][f]-this.min[f];_=Math.min(_,C),S=Math.max(S,C)}if(S<0||_>this.max[f]-this.min[f])return 0}return 1}}class da{constructor(r=0,a=0,p=0,f=0){if(isNaN(r)||r<0||isNaN(a)||a<0||isNaN(p)||p<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=a,this.left=p,this.right=f}interpolate(r,a,p){return a.top!=null&&r.top!=null&&(this.top=c.y.number(r.top,a.top,p)),a.bottom!=null&&r.bottom!=null&&(this.bottom=c.y.number(r.bottom,a.bottom,p)),a.left!=null&&r.left!=null&&(this.left=c.y.number(r.left,a.left,p)),a.right!=null&&r.right!=null&&(this.right=c.y.number(r.right,a.right,p)),this}getCenter(r,a){const p=c.ac((this.left+r-this.right)/2,0,r),f=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(p,f)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new da(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const gh=85.051129;class pa{constructor(r,a,p,f,_){this.tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=r||0,this._maxZoom=a||22,this._minPitch=p??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new da,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const r=new pa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.lngRange=r.lngRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.minElevationForCurrentTile=r.minElevationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const a=-c.b3(r,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var p=new c.A(4);return c.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,f,_){var S=f[0],k=f[1],C=f[2],z=f[3],O=Math.sin(_),B=Math.cos(_);p[0]=S*B+C*O,p[1]=k*B+z*O,p[2]=S*-O+C*B,p[3]=k*-O+z*B}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const a=c.ac(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const a=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,a,p){this._unmodified=!1,this._edgeInsets.interpolate(r,a,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const a=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(r){const a=[new c.b4(0,r)];if(this._renderWorldCopies){const p=this.pointCoordinate(new c.P(0,0)),f=this.pointCoordinate(new c.P(this.width,0)),_=this.pointCoordinate(new c.P(this.width,this.height)),S=this.pointCoordinate(new c.P(0,this.height)),k=Math.floor(Math.min(p.x,f.x,_.x,S.x)),C=Math.floor(Math.max(p.x,f.x,_.x,S.x)),z=1;for(let O=k-z;O<=C+z;O++)O!==0&&a.push(new c.b4(O,r))}return a}coveringTiles(r){var a,p;let f=this.coveringZoomLevel(r);const _=f;if(r.minzoom!==void 0&&f<r.minzoom)return[];r.maxzoom!==void 0&&f>r.maxzoom&&(f=r.maxzoom);const S=this.pointCoordinate(this.getCameraPoint()),k=c.Z.fromLngLat(this.center),C=Math.pow(2,f),z=[C*S.x,C*S.y,0],O=[C*k.x,C*k.y,0],B=ca.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,f);let K=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(K=f);const Q=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,re=ae=>({aabb:new ha([ae*C,0,0],[(ae+1)*C,C,0]),zoom:0,x:0,y:0,wrap:ae,fullyVisible:!1}),ce=[],fe=[],me=f,we=r.reparseOverscaled?_:f;if(this._renderWorldCopies)for(let ae=1;ae<=3;ae++)ce.push(re(-ae)),ce.push(re(ae));for(ce.push(re(0));ce.length>0;){const ae=ce.pop(),Ce=ae.x,Pe=ae.y;let De=ae.fullyVisible;if(!De){const ht=ae.aabb.intersects(B);if(ht===0)continue;De=ht===2}const Xe=r.terrain?z:O,ot=ae.aabb.distanceX(Xe),mt=ae.aabb.distanceY(Xe),xt=Math.max(Math.abs(ot),Math.abs(mt));if(ae.zoom===me||xt>Q+(1<<me-ae.zoom)-2&&ae.zoom>=K){const ht=me-ae.zoom,ct=z[0]-.5-(Ce<<ht),Ct=z[1]-.5-(Pe<<ht);fe.push({tileID:new c.S(ae.zoom===me?we:ae.zoom,ae.wrap,ae.zoom,Ce,Pe),distanceSq:Oe([O[0]-.5-Ce,O[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(ct*ct+Ct*Ct)})}else for(let ht=0;ht<4;ht++){const ct=(Ce<<1)+ht%2,Ct=(Pe<<1)+(ht>>1),Ht=ae.zoom+1;let dt=ae.aabb.quadrant(ht);if(r.terrain){const yt=new c.S(Ht,ae.wrap,Ht,ct,Ct),Ut=r.terrain.getMinMaxElevation(yt),Lr=(a=Ut.minElevation)!==null&&a!==void 0?a:this.elevation,Yt=(p=Ut.maxElevation)!==null&&p!==void 0?p:this.elevation;dt=new ha([dt.min[0],dt.min[1],Lr],[dt.max[0],dt.max[1],Yt])}ce.push({aabb:dt,zoom:Ht,x:ct,y:Ct,wrap:ae.wrap,fullyVisible:De})}}return fe.sort((ae,Ce)=>ae.distanceSq-Ce.distanceSq).map(ae=>ae.tileID)}resize(r,a){this.width=r,this.height=a,this.pixelsToGLUnits=[2/r,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const a=c.ac(r.lat,-85.051129,gh);return new c.P(c.O(r.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(r){return new c.Z(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const a=this.elevation,p=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,r),_=r.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-_))return;const S=p+a-_,k=Math.cos(this._pitch)*this.cameraToCenterDistance/S/c.b5(1,f.lat),C=this.scaleZoom(k/this.tileSize);this._elevation=_,this._center=f,this.zoom=C}setLocationAtPoint(r,a){const p=this.pointCoordinate(a),f=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(r),S=new c.Z(_.x-(p.x-f.x),_.y-(p.y-f.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,a){return a?this.coordinatePoint(this.locationCoordinate(r),a.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,a){return this.coordinateLocation(this.pointCoordinate(r,a))}locationCoordinate(r){return c.Z.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,a){if(a){const K=a.pointCoordinate(r);if(K!=null)return K}const p=[r.x,r.y,0,1],f=[r.x,r.y,1,1];c.af(p,p,this.pixelMatrixInverse),c.af(f,f,this.pixelMatrixInverse);const _=p[3],S=f[3],k=p[1]/_,C=f[1]/S,z=p[2]/_,O=f[2]/S,B=z===O?0:(0-z)/(O-z);return new c.Z(c.y.number(p[0]/_,f[0]/S,B)/this.worldSize,c.y.number(k,C,B)/this.worldSize)}coordinatePoint(r,a=0,p=this.pixelMatrix){const f=[r.x*this.worldSize,r.y*this.worldSize,a,1];return c.af(f,f,p),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new ie().extend(this.pointLocation(new c.P(0,r))).extend(this.pointLocation(new c.P(this.width,r))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ie([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,gh])}calculateTileMatrix(r){const a=r.canonical,p=this.worldSize/this.zoomScale(a.z),f=a.x+Math.pow(2,a.z)*r.wrap,_=c.an(new Float64Array(16));return c.J(_,_,[f*p,a.y*p,0]),c.K(_,_,[p/c.X,p/c.X,1]),_}calculatePosMatrix(r,a=!1){const p=r.key,f=a?this._alignedPosMatrixCache:this._posMatrixCache;if(f[p])return f[p];const _=this.calculateTileMatrix(r);return c.L(_,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,_),f[p]=new Float32Array(_),f[p]}calculateFogMatrix(r){const a=r.key,p=this._fogMatrixCache;if(p[a])return p[a];const f=this.calculateTileMatrix(r);return c.L(f,this.fogMatrix,f),p[a]=new Float32Array(f),p[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(r,a){a=c.ac(+a,this.minZoom,this.maxZoom);const p={center:new c.N(r.lng,r.lat),zoom:a};let f=this.lngRange;if(!this._renderWorldCopies&&f===null){const ae=179.9999999999;f=[-ae,ae]}const _=this.tileSize*this.zoomScale(p.zoom);let S=0,k=_,C=0,z=_,O=0,B=0;const{x:K,y:Q}=this.size;if(this.latRange){const ae=this.latRange;S=c.Q(ae[1])*_,k=c.Q(ae[0])*_,k-S<Q&&(O=Q/(k-S))}f&&(C=c.b3(c.O(f[0])*_,0,_),z=c.b3(c.O(f[1])*_,0,_),z<C&&(z+=_),z-C<K&&(B=K/(z-C)));const{x:re,y:ce}=this.project.call({worldSize:_},r);let fe,me;const we=Math.max(B||0,O||0);if(we){const ae=new c.P(B?(z+C)/2:re,O?(k+S)/2:ce);return p.center=this.unproject.call({worldSize:_},ae).wrap(),p.zoom+=this.scaleZoom(we),p}if(this.latRange){const ae=Q/2;ce-ae<S&&(me=S+ae),ce+ae>k&&(me=k-ae)}if(f){const ae=(C+z)/2;let Ce=re;this._renderWorldCopies&&(Ce=c.b3(re,ae-_/2,ae+_/2));const Pe=K/2;Ce-Pe<C&&(fe=C+Pe),Ce+Pe>z&&(fe=z-Pe)}if(fe!==void 0||me!==void 0){const ae=new c.P(fe??re,me??ce);p.center=this.unproject.call({worldSize:_},ae).wrap()}return p}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:a,zoom:p}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=p,this._unmodified=r,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,a=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let f=c.an(new Float64Array(16));c.K(f,f,[this.width/2,-this.height/2,1]),c.J(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=c.an(new Float64Array(16)),c.K(f,f,[1,-1,1]),c.J(f,f,[-1,-1,0]),c.K(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const _=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),S=Math.min(this.elevation,this.minElevationForCurrentTile),k=_-S*this._pixelPerMeter/Math.cos(this._pitch),C=S<0?k:_,z=Math.PI/2+this._pitch,O=this._fov*(.5+r.y/this.height),B=Math.sin(O)*C/Math.sin(c.ac(Math.PI-z-O,.01,Math.PI-.01)),K=this.getHorizon(),Q=2*Math.atan(K/this.cameraToCenterDistance)*(.5+r.y/(2*K)),re=Math.sin(Q)*C/Math.sin(c.ac(Math.PI-z-Q,.01,Math.PI-.01)),ce=Math.min(B,re);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ce+C),this.nearZ=this.height/50,f=new Float64Array(16),c.b6(f,this._fov,this.width/this.height,this.nearZ,this.farZ),f[8]=2*-r.x/this.width,f[9]=2*r.y/this.height,this.projectionMatrix=c.ae(f),c.K(f,f,[1,-1,1]),c.J(f,f,[0,0,-this.cameraToCenterDistance]),c.b7(f,f,this._pitch),c.ad(f,f,this.angle),c.J(f,f,[-a,-p,0]),this.mercatorMatrix=c.K([],f,[this.worldSize,this.worldSize,this.worldSize]),c.K(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,f),c.J(f,f,[0,0,-this.elevation]),this.modelViewProjectionMatrix=f,this.invModelViewProjectionMatrix=c.as([],f),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,_,this.farZ),this.fogMatrix[8]=2*-r.x/this.width,this.fogMatrix[9]=2*r.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-p,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,f);const fe=this.width%2/2,me=this.height%2/2,we=Math.cos(this.angle),ae=Math.sin(this.angle),Ce=a-Math.round(a)+we*fe+ae*me,Pe=p-Math.round(p)+we*me+ae*fe,De=new Float64Array(f);if(c.J(De,De,[Ce>.5?Ce-1:Ce,Pe>.5?Pe-1:Pe,0]),this.alignedModelViewProjectionMatrix=De,f=c.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new c.P(0,0)),a=[r.x*this.worldSize,r.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,r))}getCameraQueryGeometry(r){const a=this.getCameraPoint();if(r.length===1)return[r[0],a];{let p=a.x,f=a.y,_=a.x,S=a.y;for(const k of r)p=Math.min(p,k.x),f=Math.min(f,k.y),_=Math.max(_,k.x),S=Math.max(S,k.y);return[new c.P(p,f),new c.P(_,f),new c.P(_,S),new c.P(p,S),new c.P(p,f)]}}lngLatToCameraDepth(r,a){const p=this.locationCoordinate(r),f=[p.x*this.worldSize,p.y*this.worldSize,a,1];return c.af(f,f,this.modelViewProjectionMatrix),f[2]/f[3]}}function gl(v,r){let a,p=!1,f=null,_=null;const S=()=>{f=null,p&&(v.apply(_,a),f=setTimeout(S,r),p=!1)};return(...k)=>(p=!0,_=this,a=k,f||S(),f)}class ku{constructor(r){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let p;return a.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(p=f)}),(p&&p[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:p,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const p=a.join("/");let f=p;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${p}`);let _=window.location.hash.replace(f,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let S=window.location.href.replace(/(#.+)?$/,_);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=gl(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(r){const a=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,f=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),S=Math.round(a.lng*_)/_,k=Math.round(a.lat*_)/_,C=this._map.getBearing(),z=this._map.getPitch();let O="";if(O+=r?`/${S}/${k}/${p}`:`${p}/${k}/${S}`,(C||z)&&(O+="/"+Math.round(10*C)/10),z&&(O+=`/${Math.round(z)}`),this._hashName){const B=this._hashName;let K=!1;const Q=window.location.hash.slice(1).split("&").map(re=>{const ce=re.split("=")[0];return ce===B?(K=!0,`${ce}=${O}`):re}).filter(re=>re);return K||Q.push(`${B}=${O}`),`#${Q.join("&")}`}return`#${O}`}}const Tu={linearity:.3,easing:c.b8(0,0,.3,1)},yh=c.e({deceleration:2500,maxSpeed:1400},Tu),fy=c.e({deceleration:20,maxSpeed:1400},Tu),jp=c.e({deceleration:1e3,maxSpeed:360},Tu),Cu=c.e({deceleration:1e3,maxSpeed:90},Tu);class _h{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:D.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,a=D.now();for(;r.length>0&&a-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)a.zoom+=_.zoomDelta||0,a.bearing+=_.bearingDelta||0,a.pitch+=_.pitchDelta||0,_.panDelta&&a.pan._add(_.panDelta),_.around&&(a.around=_.around),_.pinchAround&&(a.pinchAround=_.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const _=_l(a.pan.mag(),p,c.e({},yh,r||{}));f.offset=a.pan.mult(_.amount/a.pan.mag()),f.center=this._map.transform.center,yl(f,_)}if(a.zoom){const _=_l(a.zoom,p,fy);f.zoom=this._map.transform.zoom+_.amount,yl(f,_)}if(a.bearing){const _=_l(a.bearing,p,jp);f.bearing=this._map.transform.bearing+c.ac(_.amount,-179,179),yl(f,_)}if(a.pitch){const _=_l(a.pitch,p,Cu);f.pitch=this._map.transform.pitch+_.amount,yl(f,_)}if(f.zoom||f.bearing){const _=a.pinchAround===void 0?a.around:a.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function yl(v,r){(!v.duration||v.duration<r.duration)&&(v.duration=r.duration,v.easing=r.easing)}function _l(v,r,a){const{maxSpeed:p,linearity:f,deceleration:_}=a,S=c.ac(v*f/(r/1e3),-p,p),k=Math.abs(S)/(_*f);return{easing:a.easing,duration:1e3*k,amount:S*(k/2)}}class An extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,p,f={}){const _=A.mousePos(a.getCanvas(),p),S=a.unproject(_);super(r,c.e({point:_,lngLat:S,originalEvent:p},f)),this._defaultPrevented=!1,this.target=a}}class Ms extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,p){const f=r==="touchend"?p.changedTouches:p.touches,_=A.touchPos(a.getCanvasContainer(),f),S=_.map(C=>a.unproject(C)),k=_.reduce((C,z,O,B)=>C.add(z.div(B.length)),new c.P(0,0));super(r,{points:_,point:k,lngLats:S,lngLat:a.unproject(k),originalEvent:p}),this._defaultPrevented=!1}}class Up extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,p){super(r,{originalEvent:p}),this._defaultPrevented=!1}}class Vp{constructor(r,a){this._map=r,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Up(r.type,this._map,r))}mousedown(r,a){return this._mousedownPos=a,this._firePreventable(new An(r.type,this._map,r))}mouseup(r){this._map.fire(new An(r.type,this._map,r))}click(r,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new An(r.type,this._map,r))}dblclick(r){return this._firePreventable(new An(r.type,this._map,r))}mouseover(r){this._map.fire(new An(r.type,this._map,r))}mouseout(r){this._map.fire(new An(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ms(r.type,this._map,r))}touchmove(r){this._map.fire(new Ms(r.type,this._map,r))}touchend(r){this._map.fire(new Ms(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ms(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class en{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new An(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new An("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new An(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class to{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(c.P.convert(r),this._map.terrain)}}class yi{constructor(r,a){this._map=r,this._tr=new to(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,a){this.isEnabled()&&r.shiftKey&&r.button===0&&(A.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(r,a){if(!this._active)return;const p=a;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=p,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const _=Math.min(f.x,p.x),S=Math.max(f.x,p.x),k=Math.min(f.y,p.y),C=Math.max(f.y,p.y);A.setTransform(this._box,`translate(${_}px,${k}px)`),this._box.style.width=S-_+"px",this._box.style.height=C-k+"px"}mouseupWindow(r,a){if(!this._active||r.button!==0)return;const p=this._startPos,f=a;if(this.reset(),A.suppressClick(),p.x!==f.x||p.y!==f.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:r})),{cameraAnimation:_=>_.fitScreenCoordinates(p,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,a){return this._map.fire(new c.k(r,{originalEvent:a}))}}function vl(v,r){if(v.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${r.length}`);const a={};for(let p=0;p<v.length;p++)a[v[p].identifier]=r[p];return a}class vh{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,a,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),p.length===this.numTouches&&(this.centroid=function(f){const _=new c.P(0,0);for(const S of f)_._add(S);return _.div(f.length)}(a),this.touches=vl(p,a)))}touchmove(r,a,p){if(this.aborted||!this.centroid)return;const f=vl(p,a);for(const _ in this.touches){const S=f[_];(!S||S.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(r,a,p){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Iu{constructor(r){this.singleTap=new vh(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,a,p){this.singleTap.touchstart(r,a,p)}touchmove(r,a,p){this.singleTap.touchmove(r,a,p)}touchend(r,a,p){const f=this.singleTap.touchend(r,a,p);if(f){const _=r.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(f)<30;if(_&&S||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class fa{constructor(r){this._tr=new to(r),this._zoomIn=new Iu({numTouches:1,numTaps:2}),this._zoomOut=new Iu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,a,p){this._zoomIn.touchstart(r,a,p),this._zoomOut.touchstart(r,a,p)}touchmove(r,a,p){this._zoomIn.touchmove(r,a,p),this._zoomOut.touchmove(r,a,p)}touchend(r,a,p){const f=this._zoomIn.touchend(r,a,p),_=this._zoomOut.touchend(r,a,p),S=this._tr;return f?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(f)},{originalEvent:r})}):_?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(_)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uo{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const a=this._moveFunction(...r);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(r,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,a){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const f=a.length?a[0]:a;return!this._moved&&f.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(p,f))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&A.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const xh={0:1,2:2};class Pu{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const a=A.mouseButton(r);this._eventButton=a}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(a,p){const f=xh[p];return a.buttons===void 0||(a.buttons&f)!==f}(r,this._eventButton)}isValidEndEvent(r){return A.mouseButton(r)===this._eventButton}}class wh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const Au=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=r=>{r.preventDefault()}},bh=({enable:v,clickTolerance:r,bearingDegreesPerPixelMoved:a=.8})=>{const p=new Pu({checkCorrectEvent:f=>A.mouseButton(f)===0&&f.ctrlKey||A.mouseButton(f)===2});return new Uo({clickTolerance:r,move:(f,_)=>({bearingDelta:(_.x-f.x)*a}),moveStateManager:p,enable:v,assignEvents:Au})},Sh=({enable:v,clickTolerance:r,pitchDegreesPerPixelMoved:a=-.5})=>{const p=new Pu({checkCorrectEvent:f=>A.mouseButton(f)===0&&f.ctrlKey||A.mouseButton(f)===2});return new Uo({clickTolerance:r,move:(f,_)=>({pitchDelta:(_.y-f.y)*a}),moveStateManager:p,enable:v,assignEvents:Au})};class zs{constructor(r,a){this._clickTolerance=r.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(r){return r<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(r,a,p){return this._calculateTransform(r,a,p)}touchmove(r,a,p){if(this._active){if(!this._shouldBePrevented(p.length))return r.preventDefault(),this._calculateTransform(r,a,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",r)}}touchend(r,a,p){this._calculateTransform(r,a,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,a,p){p.length>0&&(this._active=!0);const f=vl(p,a),_=new c.P(0,0),S=new c.P(0,0);let k=0;for(const z in f){const O=f[z],B=this._touches[z];B&&(_._add(O),S._add(O.sub(B)),k++,f[z]=O)}if(this._touches=f,this._shouldBePrevented(k)||!S.mag())return;const C=S.div(k);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(k),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,a,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([a[0],a[1]]))}touchmove(r,a,p){if(!this._firstTwoTouches)return;r.preventDefault();const[f,_]=this._firstTwoTouches,S=xl(p,a,f),k=xl(p,a,_);if(!S||!k)return;const C=this._aroundCenter?null:S.add(k).div(2);return this._move([S,k],C,r)}touchend(r,a,p){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,S=xl(p,a,f),k=xl(p,a,_);S&&k||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function xl(v,r,a){for(let p=0;p<v.length;p++)if(v[p].identifier===a)return r[p]}function Eh(v,r){return Math.log(v/r)/Math.LN2}class kh extends Mu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,a){const p=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Eh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Eh(this._distance,p),pinchAround:a}}}function Th(v,r){return 180*v.angleWith(r)/Math.PI}class Ch extends Mu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,a,p){const f=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Th(this._vector,f),pinchAround:a}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const a=25/(Math.PI*this._minDiameter)*360,p=Th(r,this._startVector);return Math.abs(p)<a}}function zu(v){return Math.abs(v.y)>Math.abs(v.x)}class ma extends Mu{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,a,p){super.touchstart(r,a,p),this._currentTouchCount=p.length}_start(r){this._lastPoints=r,zu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,a,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=r[0].sub(this._lastPoints[0]),_=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,p.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(r,a,p){if(this._valid!==void 0)return this._valid;const f=r.mag()>=2,_=a.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const S=r.y>0==a.y>0;return zu(r)&&zu(a)&&S}}const Hp={panStep:100,bearingStep:15,pitchStep:10};class Fi{constructor(r){this._tr=new to(r);const a=Hp;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let a=0,p=0,f=0,_=0,S=0;switch(r.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:r.shiftKey?p=-1:(r.preventDefault(),_=-1);break;case 39:r.shiftKey?p=1:(r.preventDefault(),_=1);break;case 38:r.shiftKey?f=1:(r.preventDefault(),S=-1);break;case 40:r.shiftKey?f=-1:(r.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(p=0,f=0),{cameraAnimation:k=>{const C=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:To,zoom:a?Math.round(C.zoom)+a*(r.shiftKey?2:1):C.zoom,bearing:C.bearing+p*this._bearingStep,pitch:C.pitch+f*this._pitchStep,offset:[-_*this._panStep,-S*this._panStep],center:C.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function To(v){return v*(2-v)}const Ih=4.000244140625;class ro{constructor(r,a){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=r,this._tr=new to(r),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(r){return!!this._map.cooperativeGestures.isEnabled()&&!(r.ctrlKey||this._map.cooperativeGestures.isBypassed(r))}wheel(r){if(!this.isEnabled())return;if(this._shouldBePrevented(r))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",r);let a=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const p=D.now(),f=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,a!==0&&a%Ih==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),r.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=r,this._delta-=a,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=A.mousePos(this._map.getCanvas(),r),p=this._tr;this._around=a.y>p.transform.height/2-p.transform.getHorizon()?c.N.convert(this._aroundCenter?p.center:p.unproject(a)):c.N.convert(p.center),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Ih?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&z!==0&&(z=1/z);const O=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(O*z))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,p=this._startZoom,f=this._easing;let _,S=!1;const k=D.now()-this._lastWheelEventTime;if(this._type==="wheel"&&p&&f&&k){const C=Math.min(k/200,1),z=f(C);_=c.y.number(p,a,z),C<1?this._frameId||(this._frameId=!0):S=!0}else _=a,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:_-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let a=c.b9;if(this._prevEase){const p=this._prevEase,f=(D.now()-p.start)/p.duration,_=p.easing(f+.01)-p.easing(f),S=.27/Math.sqrt(_*_+1e-4)*.01,k=Math.sqrt(.0729-S*S);a=c.b8(S,k,.25,1)}return this._prevEase={start:D.now(),duration:r,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ds{constructor(r,a){this._clickZoom=r,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class my{constructor(r){this._tr=new to(r),this.reset()}reset(){this._active=!1}dblclick(r,a){return r.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gy{constructor(){this._tap=new Iu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,a,p){if(!this._swipePoint)if(this._tapTime){const f=a[0],_=r.timeStamp-this._tapTime<500,S=this._tapPoint.dist(f)<30;_&&S?p.length>0&&(this._swipePoint=f,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(r,a,p)}touchmove(r,a,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const f=a[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,r.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(r,a,p)}touchend(r,a,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const f=this._tap.touchend(r,a,p);f&&(this._tapTime=r.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gp{constructor(r,a,p){this._el=r,this._mousePan=a,this._touchPan=p}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Zp{constructor(r,a,p){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=a,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ph{constructor(r,a,p,f){this._el=r,this._touchZoom=a,this._touchRotate=p,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ga{constructor(r,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",r);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=p,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(r){return r[this._bypassKey]}notifyGestureBlocked(r,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:r,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Oi=v=>v.zoom||v.drag||v.pitch||v.rotate;class bt extends c.k{}function Du(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class Ah{constructor(r,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=f.type==="renderFrame"?void 0:f,k={needsRenderFrame:!1},C={},z={},O=f.touches,B=O?this._getMapTouches(O):void 0,K=B?A.touchPos(this._map.getCanvas(),B):A.mousePos(this._map.getCanvas(),f);for(const{handlerName:ce,handler:fe,allowed:me}of this._handlers){if(!fe.isEnabled())continue;let we;this._blockedByActive(z,me,ce)?fe.reset():fe[_||f.type]&&(we=fe[_||f.type](f,K,B),this.mergeHandlerResult(k,C,we,ce,S),we&&we.needsRenderFrame&&this._triggerRenderFrame()),(we||fe.isActive())&&(z[ce]=fe)}const Q={};for(const ce in this._previousActiveHandlers)z[ce]||(Q[ce]=S);this._previousActiveHandlers=z,(Object.keys(Q).length||Du(k))&&(this._changes.push([k,C,Q]),this._triggerRenderFrame()),(Object.keys(z).length||Du(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=k;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _h(r),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,S]of this._listeners)A.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[r,a,p]of this._listeners)A.removeEventListener(r,a,r===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(r){const a=this._map,p=a.getCanvasContainer();this._add("mapEvent",new Vp(a,r));const f=a.boxZoom=new yi(a,r);this._add("boxZoom",f),r.interactive&&r.boxZoom&&f.enable();const _=a.cooperativeGestures=new ga(a,r.cooperativeGestures);this._add("cooperativeGestures",_),r.cooperativeGestures&&_.enable();const S=new fa(a),k=new my(a);a.doubleClickZoom=new Ds(k,S),this._add("tapZoom",S),this._add("clickZoom",k),r.interactive&&r.doubleClickZoom&&a.doubleClickZoom.enable();const C=new gy;this._add("tapDragZoom",C);const z=a.touchPitch=new ma(a);this._add("touchPitch",z),r.interactive&&r.touchPitch&&a.touchPitch.enable(r.touchPitch);const O=bh(r),B=Sh(r);a.dragRotate=new Zp(r,O,B),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]),r.interactive&&r.dragRotate&&a.dragRotate.enable();const K=(({enable:we,clickTolerance:ae})=>{const Ce=new Pu({checkCorrectEvent:Pe=>A.mouseButton(Pe)===0&&!Pe.ctrlKey});return new Uo({clickTolerance:ae,move:(Pe,De)=>({around:De,panDelta:De.sub(Pe)}),activateOnStart:!0,moveStateManager:Ce,enable:we,assignEvents:Au})})(r),Q=new zs(r,a);a.dragPan=new Gp(p,K,Q),this._add("mousePan",K),this._add("touchPan",Q,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&a.dragPan.enable(r.dragPan);const re=new Ch,ce=new kh;a.touchZoomRotate=new Ph(p,ce,re,C),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&a.touchZoomRotate.enable(r.touchZoomRotate);const fe=a.scrollZoom=new ro(a,()=>this._triggerRenderFrame());this._add("scrollZoom",fe,["mousePan"]),r.interactive&&r.scrollZoom&&a.scrollZoom.enable(r.scrollZoom);const me=a.keyboard=new Fi(a);this._add("keyboard",me),r.interactive&&r.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new en(a))}_add(r,a,p){this._handlers.push({handlerName:r,handler:a,allowed:p}),this._handlersById[r]=a}stop(r){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Oi(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,a,p){for(const f in r)if(f!==p&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(r){const a=[];for(const p of r)this._el.contains(p.target)&&a.push(p);return a}mergeHandlerResult(r,a,p,f,_){if(!p)return;c.e(r,p);const S={handlerName:f,originalEvent:p.originalEvent||_};p.zoomDelta!==void 0&&(a.zoom=S),p.panDelta!==void 0&&(a.drag=S),p.pitchDelta!==void 0&&(a.pitch=S),p.bearingDelta!==void 0&&(a.rotate=S)}_applyChanges(){const r={},a={},p={};for(const[f,_,S]of this._changes)f.panDelta&&(r.panDelta=(r.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(r.around=f.around),f.pinchAround!==void 0&&(r.pinchAround=f.pinchAround),f.noInertia&&(r.noInertia=f.noInertia),c.e(a,_),c.e(p,S);this._updateMapTransform(r,a,p),this._changes=[]}_updateMapTransform(r,a,p){const f=this._map,_=f._getTransformForUpdate(),S=f.terrain;if(!(Du(r)||S&&this._terrainMovement))return this._fireEvents(a,p,!0);let{panDelta:k,zoomDelta:C,bearingDelta:z,pitchDelta:O,around:B,pinchAround:K}=r;K!==void 0&&(B=K),f._stop(!0),B=B||f.transform.centerPoint;const Q=_.pointLocation(k?B.sub(k):B);z&&(_.bearing+=z),O&&(_.pitch+=O),C&&(_.zoom+=C),S?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?_.center=_.pointLocation(_.centerPoint.sub(k)):_.setLocationAtPoint(Q,B):(this._terrainMovement=!0,this._map._elevationFreeze=!0,_.setLocationAtPoint(Q,B)):_.setLocationAtPoint(Q,B),f._applyUpdatedTransform(_),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(a,p,!0)}_fireEvents(r,a,p){const f=Oi(this._eventsInProgress),_=Oi(r),S={};for(const B in r){const{originalEvent:K}=r[B];this._eventsInProgress[B]||(S[`${B}start`]=K),this._eventsInProgress[B]=r[B]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const B in S)this._fireEvent(B,S[B]);_&&this._fireEvent("move",_.originalEvent);for(const B in r){const{originalEvent:K}=r[B];this._fireEvent(B,K)}const k={};let C;for(const B in this._eventsInProgress){const{handlerName:K,originalEvent:Q}=this._eventsInProgress[B];this._handlersById[K].isActive()||(delete this._eventsInProgress[B],C=a[K]||Q,k[`${B}end`]=C)}for(const B in k)this._fireEvent(B,k[B]);const z=Oi(this._eventsInProgress),O=(f||_)&&!z;if(O&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const B=this._map._getTransformForUpdate();B.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(B)}if(p&&O){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;!B||!B.essential&&D.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:C})),K(this._map.getBearing())&&this._map.resetNorth()):(K(B.bearing||this._map.getBearing())&&(B.bearing=0),B.freezeElevation=!0,this._map.easeTo(B,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(r,a){this._map.fire(new c.k(r,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new bt("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Wp extends c.E{constructor(r,a){super(),this._renderFrameCallback=()=>{const p=Math.min((D.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(r,a){return this.jumpTo({center:r},a)}panBy(r,a,p){return r=c.P.convert(r).mult(-1),this.panTo(this.transform.center,c.e({offset:r},a),p)}panTo(r,a,p){return this.easeTo(c.e({center:r},a),p)}getZoom(){return this.transform.zoom}setZoom(r,a){return this.jumpTo({zoom:r},a),this}zoomTo(r,a,p){return this.easeTo(c.e({zoom:r},a),p)}zoomIn(r,a){return this.zoomTo(this.getZoom()+1,r,a),this}zoomOut(r,a){return this.zoomTo(this.getZoom()-1,r,a),this}getBearing(){return this.transform.bearing}setBearing(r,a){return this.jumpTo({bearing:r},a),this}getPadding(){return this.transform.padding}setPadding(r,a){return this.jumpTo({padding:r},a),this}rotateTo(r,a,p){return this.easeTo(c.e({bearing:r},a),p)}resetNorth(r,a){return this.rotateTo(0,c.e({duration:1e3},r),a),this}resetNorthPitch(r,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},r),a),this}snapToNorth(r,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,a):this}getPitch(){return this.transform.pitch}setPitch(r,a){return this.jumpTo({pitch:r},a),this}cameraForBounds(r,a){r=ie.convert(r).adjustAntiMeridian();const p=a&&a.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),p,a)}_cameraForBoxAndBearing(r,a,p,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const ht=f.padding;f.padding={top:ht,bottom:ht,right:ht,left:ht}}f.padding=c.e(_,f.padding);const S=this.transform,k=S.padding,C=new ie(r,a),z=S.project(C.getNorthWest()),O=S.project(C.getNorthEast()),B=S.project(C.getSouthEast()),K=S.project(C.getSouthWest()),Q=c.ba(-p),re=z.rotate(Q),ce=O.rotate(Q),fe=B.rotate(Q),me=K.rotate(Q),we=new c.P(Math.max(re.x,ce.x,me.x,fe.x),Math.max(re.y,ce.y,me.y,fe.y)),ae=new c.P(Math.min(re.x,ce.x,me.x,fe.x),Math.min(re.y,ce.y,me.y,fe.y)),Ce=we.sub(ae),Pe=(S.width-(k.left+k.right+f.padding.left+f.padding.right))/Ce.x,De=(S.height-(k.top+k.bottom+f.padding.top+f.padding.bottom))/Ce.y;if(De<0||Pe<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Xe=Math.min(S.scaleZoom(S.scale*Math.min(Pe,De)),f.maxZoom),ot=c.P.convert(f.offset),mt=new c.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(c.ba(p)),xt=ot.add(mt).mult(S.scale/S.zoomScale(Xe));return{center:S.unproject(z.add(B).div(2).sub(xt)),zoom:Xe,bearing:p}}fitBounds(r,a,p){return this._fitInternal(this.cameraForBounds(r,a),a,p)}fitScreenCoordinates(r,a,p,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(r)),this.transform.pointLocation(c.P.convert(a)),p,f),f,_)}_fitInternal(r,a,p){return r?(delete(a=c.e(r,a)).padding,a.linear?this.easeTo(a,p):this.flyTo(a,p)):this}jumpTo(r,a){this.stop();const p=this._getTransformForUpdate();let f=!1,_=!1,S=!1;return"zoom"in r&&p.zoom!==+r.zoom&&(f=!0,p.zoom=+r.zoom),r.center!==void 0&&(p.center=c.N.convert(r.center)),"bearing"in r&&p.bearing!==+r.bearing&&(_=!0,p.bearing=+r.bearing),"pitch"in r&&p.pitch!==+r.pitch&&(S=!0,p.pitch=+r.pitch),r.padding==null||p.isPaddingEqual(r.padding)||(p.padding=r.padding),this._applyUpdatedTransform(p),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),f&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),_&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),S&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(r,a,p,f=0){const _=c.Z.fromLngLat(r,a),S=c.Z.fromLngLat(p,f),k=S.x-_.x,C=S.y-_.y,z=S.z-_.z,O=Math.hypot(k,C,z);if(O===0)throw new Error("Can't calculate camera options with same From and To");const B=Math.hypot(k,C),K=this.transform.scaleZoom(this.transform.cameraToCenterDistance/O/this.transform.tileSize),Q=180*Math.atan2(k,-C)/Math.PI;let re=180*Math.acos(B/O)/Math.PI;return re=z<0?90-re:90+re,{center:S.toLngLat(),zoom:K,pitch:re,bearing:Q}}easeTo(r,a){var p;this._stop(!1,r.easeId),((r=c.e({offset:[0,0],duration:500,easing:c.b9},r)).animate===!1||!r.essential&&D.prefersReducedMotion)&&(r.duration=0);const f=this._getTransformForUpdate(),_=f.zoom,S=f.bearing,k=f.pitch,C=f.padding,z="bearing"in r?this._normalizeBearing(r.bearing,S):S,O="pitch"in r?+r.pitch:k,B="padding"in r?r.padding:f.padding,K=c.P.convert(r.offset);let Q=f.centerPoint.add(K);const re=f.pointLocation(Q),{center:ce,zoom:fe}=f.getConstrained(c.N.convert(r.center||re),(p=r.zoom)!==null&&p!==void 0?p:_);this._normalizeCenter(ce,f);const me=f.project(re),we=f.project(ce).sub(me),ae=f.zoomScale(fe-_);let Ce,Pe;r.around&&(Ce=c.N.convert(r.around),Pe=f.locationPoint(Ce));const De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||fe!==_,this._rotating=this._rotating||S!==z,this._pitching=this._pitching||O!==k,this._padding=!f.isPaddingEqual(B),this._easeId=r.easeId,this._prepareEase(a,r.noMoveStart,De),this.terrain&&this._prepareElevation(ce),this._ease(Xe=>{if(this._zooming&&(f.zoom=c.y.number(_,fe,Xe)),this._rotating&&(f.bearing=c.y.number(S,z,Xe)),this._pitching&&(f.pitch=c.y.number(k,O,Xe)),this._padding&&(f.interpolatePadding(C,B,Xe),Q=f.centerPoint.add(K)),this.terrain&&!r.freezeElevation&&this._updateElevation(Xe),Ce)f.setLocationAtPoint(Ce,Pe);else{const ot=f.zoomScale(f.zoom-_),mt=fe>_?Math.min(2,ae):Math.max(.5,ae),xt=Math.pow(mt,1-Xe),ht=f.unproject(me.add(we.mult(Xe*xt)).mult(ot));f.setLocationAtPoint(f.renderWorldCopies?ht.wrap():ht,Q)}this._applyUpdatedTransform(f),this._fireMoveEvents(a)},Xe=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Xe)},r),this}_prepareEase(r,a,p={}){this._moving=!0,a||p.moving||this.fire(new c.k("movestart",r)),this._zooming&&!p.zooming&&this.fire(new c.k("zoomstart",r)),this._rotating&&!p.rotating&&this.fire(new c.k("rotatestart",r)),this._pitching&&!p.pitching&&this.fire(new c.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&a!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(p-(a-(p*r+this._elevationStart))/(1-r)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(r){const a=r.getCameraPosition(),p=this.terrain.getElevationForLngLatZoom(a.lngLat,r.zoom);if(a.altitude<p){const f=this.calculateCameraOptionsFromTo(a.lngLat,p,r.center,r.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(r){const a=[];if(this.terrain&&a.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&a.push(f=>this.transformCameraUpdate(f)),!a.length)return;const p=r.clone();for(const f of a){const _=p.clone(),{center:S,zoom:k,pitch:C,bearing:z,elevation:O}=f(_);S&&(_.center=S),k!==void 0&&(_.zoom=k),C!==void 0&&(_.pitch=C),z!==void 0&&(_.bearing=z),O!==void 0&&(_.elevation=O),p.apply(_)}this.transform.apply(p)}_fireMoveEvents(r){this.fire(new c.k("move",r)),this._zooming&&this.fire(new c.k("zoom",r)),this._rotating&&this.fire(new c.k("rotate",r)),this._pitching&&this.fire(new c.k("pitch",r))}_afterEase(r,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const p=this._zooming,f=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new c.k("zoomend",r)),f&&this.fire(new c.k("rotateend",r)),_&&this.fire(new c.k("pitchend",r)),this.fire(new c.k("moveend",r))}flyTo(r,a){var p;if(!r.essential&&D.prefersReducedMotion){const yt=c.M(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(yt,a)}this.stop(),r=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},r);const f=this._getTransformForUpdate(),_=f.zoom,S=f.bearing,k=f.pitch,C=f.padding,z="bearing"in r?this._normalizeBearing(r.bearing,S):S,O="pitch"in r?+r.pitch:k,B="padding"in r?r.padding:f.padding,K=c.P.convert(r.offset);let Q=f.centerPoint.add(K);const re=f.pointLocation(Q),{center:ce,zoom:fe}=f.getConstrained(c.N.convert(r.center||re),(p=r.zoom)!==null&&p!==void 0?p:_);this._normalizeCenter(ce,f);const me=f.zoomScale(fe-_),we=f.project(re),ae=f.project(ce).sub(we);let Ce=r.curve;const Pe=Math.max(f.width,f.height),De=Pe/me,Xe=ae.mag();if("minZoom"in r){const yt=c.ac(Math.min(r.minZoom,_,fe),f.minZoom,f.maxZoom),Ut=Pe/f.zoomScale(yt-_);Ce=Math.sqrt(Ut/Xe*2)}const ot=Ce*Ce;function mt(yt){const Ut=(De*De-Pe*Pe+(yt?-1:1)*ot*ot*Xe*Xe)/(2*(yt?De:Pe)*ot*Xe);return Math.log(Math.sqrt(Ut*Ut+1)-Ut)}function xt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function ht(yt){return(Math.exp(yt)+Math.exp(-yt))/2}const ct=mt(!1);let Ct=function(yt){return ht(ct)/ht(ct+Ce*yt)},Ht=function(yt){return Pe*((ht(ct)*(xt(Ut=ct+Ce*yt)/ht(Ut))-xt(ct))/ot)/Xe;var Ut},dt=(mt(!0)-ct)/Ce;if(Math.abs(Xe)<1e-6||!isFinite(dt)){if(Math.abs(Pe-De)<1e-6)return this.easeTo(r,a);const yt=De<Pe?-1:1;dt=Math.abs(Math.log(De/Pe))/Ce,Ht=()=>0,Ct=Ut=>Math.exp(yt*Ce*Ut)}return r.duration="duration"in r?+r.duration:1e3*dt/("screenSpeed"in r?+r.screenSpeed/Ce:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=S!==z,this._pitching=O!==k,this._padding=!f.isPaddingEqual(B),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ce),this._ease(yt=>{const Ut=yt*dt,Lr=1/Ct(Ut);f.zoom=yt===1?fe:_+f.scaleZoom(Lr),this._rotating&&(f.bearing=c.y.number(S,z,yt)),this._pitching&&(f.pitch=c.y.number(k,O,yt)),this._padding&&(f.interpolatePadding(C,B,yt),Q=f.centerPoint.add(K)),this.terrain&&!r.freezeElevation&&this._updateElevation(yt);const Yt=yt===1?ce:f.unproject(we.add(ae.mult(Ht(Ut))).mult(Lr));f.setLocationAtPoint(f.renderWorldCopies?Yt.wrap():Yt,Q),this._applyUpdatedTransform(f),this._fireMoveEvents(a)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,a){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return r||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(r,a,p){p.animate===!1||p.duration===0?(r(1),a()):(this._easeStart=D.now(),this._easeOptions=p,this._onEaseFrame=r,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,a){r=c.b3(r,-180,180);const p=Math.abs(r-a);return Math.abs(r-360-a)<p&&(r-=360),Math.abs(r+360-a)<p&&(r+=360),r}_normalizeCenter(r,a){if(!a.renderWorldCopies||a.lngRange)return;const p=r.lng-a.center.lng;r.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}const ya={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class _a{constructor(r=ya){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,a){const p=this._map._getUIString(`AttributionControl.${a}`);r.title=p,r.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.sourceCaches;for(const f in a){const _=a[f];if(_.used||_.usedForTerrain){const S=_.getSource();S.attribution&&r.indexOf(S.attribution)<0&&r.push(S.attribution)}}r=r.filter(f=>String(f).trim()),r.sort((f,_)=>f.length-_.length),r=r.filter((f,_)=>{for(let S=_+1;S<r.length;S++)if(r[S].indexOf(f)>=0)return!1;return!0});const p=r.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,r.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Mh{constructor(r={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const p=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const a=A.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ir{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const a=++this._id;return this._queue.push({callback:r,id:a,cancelled:!1}),a}remove(r){const a=this._currentlyRunning,p=a?this._queue.concat(a):this._queue;for(const f of p)if(f.id===r)return void(f.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const p of a)if(!p.cancelled&&(p.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var zh=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class yy extends c.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,a){this.sourceCache.update(r,a),this._renderableTilesKeys=[];const p={};for(const f of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))p[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),c.aP(f.posMatrix,0,c.X,0,c.X,0,1),this._tiles[f.key]=new Qn(f,this.tileSize));for(const f in this._tiles)p[f]||delete this._tiles[f]}freeRtt(r){for(const a in this._tiles){const p=this._tiles[a];(!r||p.tileID.equals(r)||p.tileID.isChildOf(r)||r.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const a={};for(const p of this._renderableTilesKeys){const f=this._tiles[p].tileID;if(f.canonical.equals(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16),c.aP(_.posMatrix,0,c.X,0,c.X,0,1),a[p]=_}else if(f.canonical.isChildOf(r.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const S=f.canonical.z-r.canonical.z,k=f.canonical.x-(f.canonical.x>>S<<S),C=f.canonical.y-(f.canonical.y>>S<<S),z=c.X>>S;c.aP(_.posMatrix,0,z,0,z,0,1),c.J(_.posMatrix,_.posMatrix,[-k*z,-C*z,0]),a[p]=_}else if(r.canonical.isChildOf(f.canonical)){const _=r.clone();_.posMatrix=new Float64Array(16);const S=r.canonical.z-f.canonical.z,k=r.canonical.x-(r.canonical.x>>S<<S),C=r.canonical.y-(r.canonical.y>>S<<S),z=c.X>>S;c.aP(_.posMatrix,0,c.X,0,c.X,0,1),c.J(_.posMatrix,_.posMatrix,[k*z,C*z,0]),c.K(_.posMatrix,_.posMatrix,[1/2**S,1/2**S,0]),a[p]=_}}return a}getSourceTile(r,a){const p=this.sourceCache._source;let f=r.overscaledZ-this.deltaZoom;if(f>p.maxzoom&&(f=p.maxzoom),f<p.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!_||!_.dem)&&a)for(;f>=p.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(r.scaledTo(f--).key);return _}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=r)}}class Dh{constructor(r,a,p){this.painter=r,this.sourceCache=new yy(a),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,a,p,f=c.X){var _;if(!(a>=0&&a<f&&p>=0&&p<f))return 0;const S=this.getTerrainData(r),k=(_=S.tile)===null||_===void 0?void 0:_.dem;if(!k)return 0;const C=function(re,ce,fe){var me=ce[0],we=ce[1];return re[0]=fe[0]*me+fe[4]*we+fe[12],re[1]=fe[1]*me+fe[5]*we+fe[13],re}([],[a/f*c.X,p/f*c.X],S.u_terrain_matrix),z=[C[0]*k.dim,C[1]*k.dim],O=Math.floor(z[0]),B=Math.floor(z[1]),K=z[0]-O,Q=z[1]-B;return k.get(O,B)*(1-K)*(1-Q)+k.get(O+1,B)*K*(1-Q)+k.get(O,B+1)*(1-K)*Q+k.get(O+1,B+1)*K*Q}getElevationForLngLatZoom(r,a){if(!c.bb(a,r.wrap()))return 0;const{tileID:p,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(r,a);return this.getElevation(p,f%c.X,_%c.X,c.X)}getElevation(r,a,p,f=c.X){return this.getDEMElevation(r,a,p,f)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const f=this.painter.context,_=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new it(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new it(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(r,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new it(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const p=a&&a+a.tileID.key+r.key;if(p&&!this._demMatrixCache[p]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=r.canonical.z-a.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=f?_=r.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=r.canonical.x-(r.canonical.x>>_<<_),k=r.canonical.y-(r.canonical.y>>_<<_),C=c.bc(new Float64Array(16),[1/(c.X<<_),1/(c.X<<_),0]);c.J(C,C,[S*c.X,k*c.X,0]),this._demMatrixCache[r.key]={matrix:C,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(r){const a=this.painter,p=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new it(a.context,{width:p,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new it(a.context,{width:p,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(p,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,p,f))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,S=0;_<this._coordsTextureSize;_++)for(let k=0;k<this._coordsTextureSize;k++,S+=4)a[S+0]=255&k,a[S+1]=255&_,a[S+2]=k>>8<<4|_>>8,a[S+3]=0;const p=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new it(r,p,r.gl.RGBA,{premultiply:!1});return f.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),p=this.painter.context,f=p.gl,_=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(_,k-S-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),p.bindFramebuffer.set(null);const C=a[0]+(a[2]>>4<<8),z=a[1]+((15&a[2])<<8),O=this.coordsIndex[255-a[3]],B=O&&this.sourceCache.getTileByID(O);if(!B)return null;const K=this._coordsTextureSize,Q=(1<<B.tileID.canonical.z)*K;return new c.Z((B.tileID.canonical.x*K+C)/Q+B.tileID.wrap,(B.tileID.canonical.y*K+z)/Q,this.getElevation(B.tileID,C,z,K))}depthAtPoint(r){const a=new Uint8Array(4),p=this.painter.context,f=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),p.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,a=new c.bd,p=new c.aY,f=this.meshSize,_=c.X/f,S=f*f;for(let B=0;B<=f;B++)for(let K=0;K<=f;K++)a.emplaceBack(K*_,B*_,0);for(let B=0;B<S;B+=f+1)for(let K=0;K<f;K++)p.emplaceBack(K+B,f+K+B+1,f+K+B+2),p.emplaceBack(K+B,f+K+B+2,K+B+1);const k=a.length,C=k+2*(f+1);for(const B of[0,1])for(let K=0;K<=f;K++)for(const Q of[0,1])a.emplaceBack(K*_,B*c.X,Q);for(let B=0;B<2*f;B+=2)p.emplaceBack(C+B,C+B+1,C+B+3),p.emplaceBack(C+B,C+B+3,C+B+2),p.emplaceBack(k+B,k+B+3,k+B+1),p.emplaceBack(k+B,k+B+2,k+B+3);const z=a.length,O=z+2*(f+1);for(const B of[0,1])for(let K=0;K<=f;K++)for(const Q of[0,1])a.emplaceBack(B*c.X,K*_,Q);for(let B=0;B<2*f;B+=2)p.emplaceBack(z+B,z+B+1,z+B+3),p.emplaceBack(z+B,z+B+3,z+B+2),p.emplaceBack(O+B,O+B+3,O+B+1),p.emplaceBack(O+B,O+B+2,O+B+3);return this._mesh=new Su(r.createVertexBuffer(a,zh.members),r.createIndexBuffer(p),c.a0.simpleSegment(0,0,a.length,p.length)),this._mesh}getMeshFrameDelta(r){return 2*Math.PI*c.be/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,a){var p;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(r,a);return(p=this.getMinMaxElevation(f).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(r){const a=this.getTerrainData(r).tile,p={minElevation:null,maxElevation:null};return a&&a.dem&&(p.minElevation=a.dem.min*this.exaggeration,p.maxElevation=a.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(r,a){const p=c.Z.fromLngLat(r.wrap()),f=(1<<a)*c.X,_=p.x*f,S=p.y*f,k=Math.floor(_/c.X),C=Math.floor(S/c.X);return{tileID:new c.S(a,0,a,k,C),mercatorX:_,mercatorY:S}}}class _y{constructor(r,a,p){this._context=r,this._size=a,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new it(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(p.texture),{id:r,fbo:a,texture:p,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>r.id!==a),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const va={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class qp{constructor(r,a){this.painter=r,this.terrain=a,this.pool=new _y(r.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(p=>!r._layers[p].isHidden(a)),this._coordsDescendingInv={};for(const p in r.sourceCaches){this._coordsDescendingInv[p]={};const f=r.sourceCaches[p].getVisibleCoordinates();for(const _ of f){const S=this.terrain.sourceCache.getTerrainCoords(_);for(const k in S)this._coordsDescendingInv[p][k]||(this._coordsDescendingInv[p][k]=[]),this._coordsDescendingInv[p][k].push(S[k])}}this._coordsDescendingInvStr={};for(const p of r._order){const f=r._layers[p],_=f.source;if(va[f.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const S in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][S]=this._coordsDescendingInv[_][S].map(k=>k.key).sort().join()}}for(const p of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[f][p.tileID.key];_&&_!==p.rttCoords[f]&&(p.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const a=r.type,p=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(va[a]&&(this._prevType&&va[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(r.id),!f))return!0;if(va[this._prevType]||va[a]&&f){this._prevType=a;const _=this._stacks.length-1,S=this._stacks[_]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&($p(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[_]){const z=this.pool.getObjectForId(k.rtt[_].id);if(z.stamp===k.rtt[_].stamp){this.pool.useObject(z);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),k.rtt[_]={id:C.id,stamp:C.stamp},p.context.bindFramebuffer.set(C.fbo.framebuffer),p.context.clear({color:c.aM.transparent,stencil:0}),p.currentStencilSource=void 0;for(let z=0;z<S.length;z++){const O=p.style._layers[S[z]],B=O.source?this._coordsDescendingInv[O.source][k.tileID.key]:[k.tileID];p.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),p._renderTileClippingMasks(O,B),p.renderLayer(p,p.style.sourceCaches[O.source],O,B),O.source&&(k.rttCoords[O.source]=this._coordsDescendingInvStr[O.source][k.tileID.key])}}return $p(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),va[a]}return!1}}const Rh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Xp=T,vy={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ya,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Lh=v=>{v.touchstart=v.dragStart,v.touchmoveWindow=v.dragMove,v.touchend=v.dragEnd},xy={showCompass:!0,showZoom:!0,visualizePitch:!1};class wy{constructor(r,a,p=!1){this.mousedown=S=>{this.startMouse(c.e({},S,{ctrlKey:!0,preventDefault:()=>S.preventDefault()}),A.mousePos(this.element,S)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.moveMouse(S,A.mousePos(this.element,S))},this.mouseup=S=>{this.mouseRotate.dragEnd(S),this.mousePitch&&this.mousePitch.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,S.targetTouches)[0],this.startTouch(S,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,S.targetTouches)[0],this.moveTouch(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=r.dragRotate._mouseRotate.getClickTolerance(),_=r.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=bh({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:S,clickTolerance:k,bearingDegreesPerPixelMoved:C=.8})=>{const z=new wh;return new Uo({clickTolerance:k,move:(O,B)=>({bearingDelta:(B.x-O.x)*C}),moveStateManager:z,enable:S,assignEvents:Lh})})({clickTolerance:f,enable:!0}),this.map=r,p&&(this.mousePitch=Sh({clickTolerance:_,enable:!0}),this.touchPitch=(({enable:S,clickTolerance:k,pitchDegreesPerPixelMoved:C=-.5})=>{const z=new wh;return new Uo({clickTolerance:k,move:(O,B)=>({pitchDelta:(B.y-O.y)*C}),moveStateManager:z,enable:S,assignEvents:Lh})})({clickTolerance:_,enable:!0})),A.addEventListener(a,"mousedown",this.mousedown),A.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(a,"touchcancel",this.reset)}startMouse(r,a){this.mouseRotate.dragStart(r,a),this.mousePitch&&this.mousePitch.dragStart(r,a),A.disableDrag()}startTouch(r,a){this.touchRotate.dragStart(r,a),this.touchPitch&&this.touchPitch.dragStart(r,a),A.disableDrag()}moveMouse(r,a){const p=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(r,a)||{};if(f&&p.setBearing(p.getBearing()+f),this.mousePitch){const{pitchDelta:_}=this.mousePitch.dragMove(r,a)||{};_&&p.setPitch(p.getPitch()+_)}}moveTouch(r,a){const p=this.map,{bearingDelta:f}=this.touchRotate.dragMove(r,a)||{};if(f&&p.setBearing(p.getBearing()+f),this.touchPitch){const{pitchDelta:_}=this.touchPitch.dragMove(r,a)||{};_&&p.setPitch(p.getPitch()+_)}}off(){const r=this.element;A.removeEventListener(r,"mousedown",this.mousedown),A.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let _i;function Rr(v,r,a){const p=new c.N(v.lng,v.lat);if(v=new c.N(v.lng,v.lat),r){const f=new c.N(v.lng-360,v.lat),_=new c.N(v.lng+360,v.lat),S=a.locationPoint(v).distSqr(r);a.locationPoint(f).distSqr(r)<S?v=f:a.locationPoint(_).distSqr(r)<S&&(v=_)}for(;Math.abs(v.lng-a.center.lng)>180;){const f=a.locationPoint(v);if(f.x>=0&&f.y>=0&&f.x<=a.width&&f.y<=a.height)break;v.lng>a.center.lng?v.lng-=360:v.lng+=360}return v.lng!==p.lng&&a.locationPoint(v).y>a.height/2-a.getHorizon()?v:p}const xa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ru(v,r,a){const p=v.classList;for(const f in xa)p.remove(`maplibregl-${a}-anchor-${f}`);p.add(`maplibregl-${a}-anchor-${r}`)}class Lu extends c.E{constructor(r){if(super(),this._onKeyPress=a=>{const p=a.code,f=a.charCode||a.keyCode;p!=="Space"&&p!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const p=a.originalEvent.target,f=this._element;this._popup&&(p===f||f.contains(p))&&this.togglePopup()},this._update=a=>{var p;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Rr(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${xa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${_}`),D.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._subpixelPositioning=r&&r.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=c.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const a=A.createNS("http://www.w3.org/2000/svg","svg"),p=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${p}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${p}`);const _=A.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const S=A.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const k=A.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const me of C){const we=A.createNS("http://www.w3.org/2000/svg","ellipse");we.setAttributeNS(null,"opacity","0.04"),we.setAttributeNS(null,"cx","10.5"),we.setAttributeNS(null,"cy","5.80029008"),we.setAttributeNS(null,"rx",me.rx),we.setAttributeNS(null,"ry",me.ry),k.appendChild(we)}const z=A.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const O=A.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(O);const B=A.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"opacity","0.25"),B.setAttributeNS(null,"fill","#000000");const K=A.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),B.appendChild(K);const Q=A.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const re=A.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ce=A.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#000000"),ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962");const fe=A.createNS("http://www.w3.org/2000/svg","circle");fe.setAttributeNS(null,"fill","#FFFFFF"),fe.setAttributeNS(null,"cx","5.5"),fe.setAttributeNS(null,"cy","5.5"),fe.setAttributeNS(null,"r","5.4999962"),re.appendChild(ce),re.appendChild(fe),S.appendChild(k),S.appendChild(z),S.appendChild(B),S.appendChild(Q),S.appendChild(re),a.appendChild(S),a.setAttributeNS(null,"height",p*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Ru(this._element,this._anchor,"marker"),r&&r.className)for(const a of r.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=c.N.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const f=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(r){return this._subpixelPositioning=r,this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var a,p;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,_=f.terrain.depthAtPoint(this._pos),S=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,S)-_<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/f.transform._pixelPerMeter,C=Math.sin(f.getPitch()*Math.PI/180)*k,z=f.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),O=f.transform.lngLatToCameraDepth(this._lngLat,S+C)-z>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&O&&this._popup.remove(),this._element.style.opacity=O?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=c.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,a){return r===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Kp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let wl=0,bl=!1;const Co={maxWidth:100,unit:"metric"};function Sl(v,r,a){const p=a&&a.maxWidth||100,f=v._container.clientHeight/2,_=v.unproject([0,f]),S=v.unproject([p,f]),k=_.distanceTo(S);if(a&&a.unit==="imperial"){const C=3.2808*k;C>5280?Tt(r,p,C/5280,v._getUIString("ScaleControl.Miles")):Tt(r,p,C,v._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Tt(r,p,k/1852,v._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Tt(r,p,k/1e3,v._getUIString("ScaleControl.Kilometers")):Tt(r,p,k,v._getUIString("ScaleControl.Meters"))}function Tt(v,r,a,p){const f=function(_){const S=Math.pow(10,`${Math.floor(_)}`.length-1);let k=_/S;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(C){const z=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*z)/z}(k),S*k}(a);v.style.width=r*(f/a)+"px",v.innerHTML=`${f}&nbsp;${p}`}const Nt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Fu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ou(v){if(v){if(typeof v=="number"){const r=Math.round(Math.abs(v)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,v),"top-left":new c.P(r,r),"top-right":new c.P(-r,r),bottom:new c.P(0,-v),"bottom-left":new c.P(r,-r),"bottom-right":new c.P(-r,-r),left:new c.P(v,0),right:new c.P(-v,0)}}if(v instanceof c.P||Array.isArray(v)){const r=c.P.convert(v);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:c.P.convert(v.center||[0,0]),top:c.P.convert(v.top||[0,0]),"top-left":c.P.convert(v["top-left"]||[0,0]),"top-right":c.P.convert(v["top-right"]||[0,0]),bottom:c.P.convert(v.bottom||[0,0]),"bottom-left":c.P.convert(v["bottom-left"]||[0,0]),"bottom-right":c.P.convert(v["bottom-right"]||[0,0]),left:c.P.convert(v.left||[0,0]),right:c.P.convert(v.right||[0,0])}}return Ou(new c.P(0,0))}const Fh=T;y.AJAXError=c.bh,y.Evented=c.E,y.LngLat=c.N,y.MercatorCoordinate=c.Z,y.Point=c.P,y.addProtocol=c.bi,y.config=c.a,y.removeProtocol=c.bj,y.AttributionControl=_a,y.BoxZoomHandler=yi,y.CanvasSource=at,y.CooperativeGesturesHandler=ga,y.DoubleClickZoomHandler=Ds,y.DragPanHandler=Gp,y.DragRotateHandler=Zp,y.EdgeInsets=da,y.FullscreenControl=class extends c.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var r;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=a==null?void 0:a.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},y.GeoJSONSource=tt,y.GeolocateControl=class extends c.E{constructor(v){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const a=new c.N(r.coords.longitude,r.coords.latitude),p=r.coords.accuracy,f=this._map.getBearing(),_=c.e({bearing:f},this.options.fitBoundsOptions),S=ie.fromLngLat(a,p);this._map.fitBounds(S,_,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const a=new c.N(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&bl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=r=>{if(this._map){if(r===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Lu({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Kp,v)}onAdd(v){return this._map=v,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(r=!1){if(_i!==void 0&&!r)return _i;if(window.navigator.permissions===void 0)return _i=!!window.navigator.geolocation,_i;try{_i=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{_i=!!window.navigator.geolocation}return _i})}().then(r=>this._finishSetupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,wl=0,bl=!1}_isOutOfMapMaxBounds(v){const r=this._map.getMaxBounds(),a=v.coords;return r&&(a.longitude<r.getWest()||a.longitude>r.getEast()||a.latitude<r.getSouth()||a.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const v=this._map.getBounds(),r=v.getSouthEast(),a=v.getNorthEast(),p=r.distanceTo(a),f=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":wl--,bl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),wl++,wl>1?(v={maximumAge:6e5,timeout:0},bl=!0):(v=this.options.positionOptions,bl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},y.Hash=ku,y.ImageSource=st,y.KeyboardHandler=Fi,y.LngLatBounds=ie,y.LogoControl=Mh,y.Map=class extends Wp{constructor(v){c.bf.mark(c.bg.create);const r=Object.assign(Object.assign({},vy),v);if(r.minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new pa(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ir,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=r.preserveDrawingBuffer===!0,this._antialias=r.antialias===!0,this._trackResize=r.trackResize===!0,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles===!0,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=r.crossSourceCollisions===!0,this._collectResourceTiming=r.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Rh),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=r.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=q.addThrottleControl(()=>this.isMoving()),this._requestManager=new ne(r.transformRequest),typeof r.container=="string"){if(this._container=document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const p=gl(f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())},50);this._resizeObserver=new ResizeObserver(f=>{a?p(f):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ah(this,r),this._hash=r.hash&&new ku(typeof r.hash=="string"&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,c.e({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new _a(typeof r.attributionControl=="boolean"?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new Mh,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(v,r){if(r===void 0&&(r=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=v.onAdd(this);this._controls.push(v);const p=this._controlPositions[r];return r.indexOf("bottom")!==-1?p.insertBefore(a,p.firstChild):p.appendChild(a),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(v);return r>-1&&this._controls.splice(r,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}calculateCameraOptionsFromTo(v,r,a,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,r,a,p)}resize(v){var r;const a=this._containerDimensions(),p=a[0],f=a[1],_=this._getClampedPixelRatio(p,f);if(this._resizeCanvas(p,f,_),this.painter.resize(p,f,_),this.painter.overLimit()){const k=this.painter.context.gl;this._maxCanvasSize=[k.drawingBufferWidth,k.drawingBufferHeight];const C=this._getClampedPixelRatio(p,f);this._resizeCanvas(p,f,C),this.painter.resize(p,f,C)}this.transform.resize(p,f),(r=this._requestedCameraState)===null||r===void 0||r.resize(p,f);const S=!this._moving;return S&&(this.stop(),this.fire(new c.k("movestart",v)).fire(new c.k("move",v))),this.fire(new c.k("resize",v)),S&&this.fire(new c.k("moveend",v)),this}_getClampedPixelRatio(v,r){const{0:a,1:p}=this._maxCanvasSize,f=this.getPixelRatio(),_=v*f,S=r*f;return Math.min(_>a?a/_:1,S>p?p/S:1)*f}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(ie.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this._update()}project(v){return this.transform.locationPoint(c.N.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.pointLocation(c.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,r,a){if(v==="mouseenter"||v==="mouseover"){let p=!1;return{layers:r,listener:a,delegates:{mousemove:_=>{const S=r.filter(C=>this.getLayer(C)),k=S.length!==0?this.queryRenderedFeatures(_.point,{layers:S}):[];k.length?p||(p=!0,a.call(this,new An(v,this,_.originalEvent,{features:k}))):p=!1},mouseout:()=>{p=!1}}}}if(v==="mouseleave"||v==="mouseout"){let p=!1;return{layers:r,listener:a,delegates:{mousemove:S=>{const k=r.filter(C=>this.getLayer(C));(k.length!==0?this.queryRenderedFeatures(S.point,{layers:k}):[]).length?p=!0:p&&(p=!1,a.call(this,new An(v,this,S.originalEvent)))},mouseout:S=>{p&&(p=!1,a.call(this,new An(v,this,S.originalEvent)))}}}}{const p=f=>{const _=r.filter(k=>this.getLayer(k)),S=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];S.length&&(f.features=S,a.call(this,f),delete f.features)};return{layers:r,listener:a,delegates:{[v]:p}}}}_saveDelegatedListener(v,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(r)}_removeDelegatedListener(v,r,a){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const p=this._delegatedListeners[v];for(let f=0;f<p.length;f++){const _=p[f];if(_.listener===a&&_.layers.length===r.length&&_.layers.every(S=>r.includes(S))){for(const S in _.delegates)this.off(S,_.delegates[S]);return void p.splice(f,1)}}}on(v,r,a){if(a===void 0)return super.on(v,r);const p=this._createDelegatedListener(v,typeof r=="string"?[r]:r,a);this._saveDelegatedListener(v,p);for(const f in p.delegates)this.on(f,p.delegates[f]);return this}once(v,r,a){if(a===void 0)return super.once(v,r);const p=typeof r=="string"?[r]:r,f=this._createDelegatedListener(v,p,a);for(const _ in f.delegates){const S=f.delegates[_];f.delegates[_]=(...k)=>{this._removeDelegatedListener(v,p,a),S(...k)}}this._saveDelegatedListener(v,f);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(v,r,a){return a===void 0?super.off(v,r):(this._removeDelegatedListener(v,typeof r=="string"?[r]:r,a),this)}queryRenderedFeatures(v,r){if(!this.style)return[];let a;const p=v instanceof c.P||Array.isArray(v),f=p?v:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(p?{}:v)||{},f instanceof c.P||typeof f[0]=="number")a=[c.P.convert(f)];else{const _=c.P.convert(f[0]),S=c.P.convert(f[1]);a=[_,new c.P(S.x,_.y),S,new c.P(_.x,S.y),_]}return this.style.queryRenderedFeatures(a,r,this.transform)}querySourceFeatures(v,r){return this.style.querySourceFeatures(v,r)}setStyle(v,r){return(r=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(v,r))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const r=this._locale[v];if(r==null)throw new Error(`Missing UI string '${v}'`);return r}_updateStyle(v,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,r));const a=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new lu(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,r,a):this.style.loadJSON(v,r,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new lu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,r){if(typeof v=="string"){const a=this._requestManager.transformRequest(v,"Style");c.h(a,new AbortController).then(p=>{this._updateDiff(p.data,r)}).catch(p=>{p&&this.fire(new c.j(p))})}else typeof v=="object"&&this._updateDiff(v,r)}_updateDiff(v,r){try{this.style.setState(v,r)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(v,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(v,r){return this._lazyInitEmptyStyle(),this.style.addSource(v,r),this._update(!0)}isSourceLoaded(v){const r=this.style&&this.style.sourceCaches[v];if(r!==void 0)return r.loaded();this.fire(new c.j(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const r=this.style.sourceCaches[v.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&r.reload();for(const a in this.style._layers){const p=this.style._layers[a];p.type==="hillshade"&&p.source===v.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Dh(this.painter,r,v),this.painter.renderToTexture=new qp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==v.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:v})),this}getTerrain(){var v,r;return(r=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const r in v){const a=v[r]._tiles;for(const p in a){const f=a[p];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,r,a={}){const{pixelRatio:p=1,sdf:f=!1,stretchX:_,stretchY:S,content:k,textFitWidth:C,textFitHeight:z}=a;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||c.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:O,height:B,data:K}=r,Q=r;return this.style.addImage(v,{data:new c.R({width:O,height:B},new Uint8Array(K)),pixelRatio:p,stretchX:_,stretchY:S,content:k,textFitWidth:C,textFitHeight:z,sdf:f,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,v),this}}{const{width:O,height:B,data:K}=D.getImageData(r);this.style.addImage(v,{data:new c.R({width:O,height:B},K),pixelRatio:p,stretchX:_,stretchY:S,content:k,textFitWidth:C,textFitHeight:z,sdf:f,version:0})}}updateImage(v,r){const a=this.style.getImage(v);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=r instanceof HTMLImageElement||c.b(r)?D.getImageData(r):r,{width:f,height:_,data:S}=p;if(f===void 0||_===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||_!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(r instanceof HTMLImageElement||c.b(r));return a.data.replace(S,k),this.style.updateImage(v,a),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return q.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,r){return this._lazyInitEmptyStyle(),this.style.addLayer(v,r),this._update(!0)}moveLayer(v,r){return this.style.moveLayer(v,r),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,r,a){return this.style.setLayerZoomRange(v,r,a),this._update(!0)}setFilter(v,r,a={}){return this.style.setFilter(v,r,a),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,r,a,p={}){return this.style.setPaintProperty(v,r,a,p),this._update(!0)}getPaintProperty(v,r){return this.style.getPaintProperty(v,r)}setLayoutProperty(v,r,a,p={}){return this.style.setLayoutProperty(v,r,a,p),this._update(!0)}getLayoutProperty(v,r){return this.style.getLayoutProperty(v,r)}setGlyphs(v,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,r,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,r,a,p=>{p||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,r,a=>{a||this._update(!0)}),this}setLight(v,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(v){return this._lazyInitEmptyStyle(),this.style.setSky(v),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,r){return this.style.setFeatureState(v,r),this._update()}removeFeatureState(v,r){return this.style.removeFeatureState(v,r),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,r=0;return this._container&&(v=this._container.clientWidth||400,r=this._container.clientHeight||300),[v,r]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const r=this._canvasContainer=A.create("div","maplibregl-canvas-container",v);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),p=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],p);const f=this._controlContainer=A.create("div","maplibregl-control-container",v),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{_[S]=A.create("div",`maplibregl-ctrl-${S} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,r,a){this._canvas.width=Math.floor(a*v),this._canvas.height=Math.floor(a*r),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const v={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{r={requestedAttributes:v},p&&(r.statusMessage=p.statusMessage,r.type=p.type)},{once:!0});const a=this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v);if(!a){const p="Failed to initialize WebGL";throw r?(r.message=p,new Error(JSON.stringify(r))):new Error(p)}this.painter=new Eu(a,this.transform),N.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,_=D.now();this.style.zoomHistory.update(f,_);const S=new c.z(f,{now:_,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=S.crossFadingFactor();k===1&&k===this._crossFadingFactor||(a=!0,this._crossFadingFactor=k),this.style.update(S)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),q.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,D.frameAsync(this._frameRequest).then(v=>{c.bf.frame(v),this._frameRequest=null,this._render(v)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return Xp}getCameraTargetElevation(){return this.transform.elevation}},y.MapMouseEvent=An,y.MapTouchEvent=Ms,y.MapWheelEvent=Up,y.Marker=Lu,y.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const r=this._map.getZoom(),a=r===this._map.getMaxZoom(),p=r===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,a)=>{const p=this._map._getUIString(`NavigationControl.${a}`);r.title=p,r.setAttribute("aria-label",p)},this.options=c.e({},xy,v),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new wy(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,r){const a=A.create("button",v,this._container);return a.type="button",a.addEventListener("click",r),a}},y.Popup=class extends c.E{constructor(v){super(),this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const k of this.options.className.split(" "))this._container.classList.add(k);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Rr(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!r)return;const p=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor;const _=Ou(this.options.offset);if(!f){const k=this._container.offsetWidth,C=this._container.offsetHeight;let z;z=p.y+_.bottom.y<C?["top"]:p.y>this._map.transform.height-C?["bottom"]:[],p.x<k/2?z.push("left"):p.x>this._map.transform.width-k/2&&z.push("right"),f=z.length===0?"bottom":z.join("-")}let S=p.add(_[f]);this.options.subpixelPositioning||(S=S.round()),A.setTransform(this._container,`${xa[f]} translate(${S.x}px,${S.y}px)`),Ru(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Nt),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=c.N.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const r=document.createDocumentFragment(),a=document.createElement("body");let p;for(a.innerHTML=v;p=a.firstChild,p;)r.appendChild(p);return this.setDOMContent(r)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Fu);v&&v.focus()}},y.RasterDEMTileSource=Ze,y.RasterTileSource=ke,y.ScaleControl=class{constructor(v){this._onMove=()=>{Sl(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,Sl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Co),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},y.ScrollZoomHandler=ro,y.Style=lu,y.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},y.TwoFingersTouchPitchHandler=ma,y.TwoFingersTouchRotateHandler=Ch,y.TwoFingersTouchZoomHandler=kh,y.TwoFingersTouchZoomRotateHandler=Ph,y.VectorTileSource=oe,y.VideoSource=St,y.addSourceType=(v,r)=>c._(void 0,void 0,void 0,function*(){if(vr(v))throw new Error(`A source type called "${v}" already exists.`);((a,p)=>{Lt[a]=p})(v,r)}),y.clearPrewarmedResources=function(){const v=Kt;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(nt),Kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},y.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},y.getRTLTextPluginStatus=function(){return on().getRTLTextPluginStatus()},y.getVersion=function(){return Fh},y.getWorkerCount=function(){return rt.workerCount},y.getWorkerUrl=function(){return c.a.WORKER_URL},y.importScriptInWorkers=function(v){return lr().broadcast("IS",v)},y.prewarm=function(){Gt().acquire(nt)},y.setMaxParallelImageRequests=function(v){c.a.MAX_PARALLEL_IMAGE_REQUESTS=v},y.setRTLTextPlugin=function(v,r){return on().setRTLTextPlugin(v,r)},y.setWorkerCount=function(v){rt.workerCount=v},y.setWorkerUrl=function(v){c.a.WORKER_URL=v}});var g=i;return g})})(WT);var y5=WT.exports;const XT=ip(y5),_5={version:8,sources:{osm:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap Contributors",maxzoom:19}},layers:[{id:"osm",type:"raster",source:"osm"}]};var Hc={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KT=$t;function tr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ui=Object.prototype.hasOwnProperty,v5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,P2={},A2={};function YT(e){return Ui.call(A2,e)?!0:Ui.call(P2,e)?!1:v5.test(e)?A2[e]=!0:(P2[e]=!0,!1)}function Mi(e,t,i,u,d,g,y){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=y}var Yn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Yn[e]=new Mi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Yn[t]=new Mi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Yn[e]=new Mi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Yn[e]=new Mi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Yn[e]=new Mi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Yn[e]=new Mi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Yn[e]=new Mi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Yn[e]=new Mi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Yn[e]=new Mi(e,5,!1,e.toLowerCase(),null,!1,!1)});var F1=/[\-:]([a-z])/g;function O1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(F1,O1);Yn[t]=new Mi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(F1,O1);Yn[t]=new Mi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(F1,O1);Yn[t]=new Mi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Yn[e]=new Mi(e,1,!1,e.toLowerCase(),null,!1,!1)});Yn.xlinkHref=new Mi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Yn[e]=new Mi(e,1,!1,e.toLowerCase(),null,!0,!0)});var dm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x5=["Webkit","ms","Moz","O"];Object.keys(dm).forEach(function(e){x5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),dm[t]=dm[e]})});var w5=/["'&<>]/;function Ci(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=w5.exec(e);if(t){var i="",u,d=0;for(u=t.index;u<e.length;u++){switch(e.charCodeAt(u)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}d!==u&&(i+=e.substring(d,u)),d=u+1,i+=t}e=d!==u?i+e.substring(d,u):i}return e}var b5=/([A-Z])/g,S5=/^ms-/,fv=Array.isArray;function Ns(e,t){return{insertionMode:e,selectedValue:t}}function E5(e,t,i){switch(t){case"select":return Ns(1,i.value!=null?i.value:i.defaultValue);case"svg":return Ns(2,null);case"math":return Ns(3,null);case"foreignObject":return Ns(1,null);case"table":return Ns(4,null);case"thead":case"tbody":case"tfoot":return Ns(5,null);case"colgroup":return Ns(7,null);case"tr":return Ns(6,null)}return 4<=e.insertionMode||e.insertionMode===0?Ns(1,null):e}var M2=new Map;function JT(e,t,i){if(typeof i!="object")throw Error(tr(62));t=!0;for(var u in i)if(Ui.call(i,u)){var d=i[u];if(d!=null&&typeof d!="boolean"&&d!==""){if(u.indexOf("--")===0){var g=Ci(u);d=Ci((""+d).trim())}else{g=u;var y=M2.get(g);y!==void 0||(y=Ci(g.replace(b5,"-$1").toLowerCase().replace(S5,"-ms-")),M2.set(g,y)),g=y,d=typeof d=="number"?d===0||Ui.call(dm,u)?""+d:d+"px":Ci((""+d).trim())}t?(t=!1,e.push(' style="',g,":",d)):e.push(";",g,":",d)}}t||e.push('"')}function co(e,t,i,u){switch(i){case"style":JT(e,t,u);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N"){if(t=Yn.hasOwnProperty(i)?Yn[i]:null,t!==null){switch(typeof u){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(i=t.attributeName,t.type){case 3:u&&e.push(" ",i,'=""');break;case 4:u===!0?e.push(" ",i,'=""'):u!==!1&&e.push(" ",i,'="',Ci(u),'"');break;case 5:isNaN(u)||e.push(" ",i,'="',Ci(u),'"');break;case 6:!isNaN(u)&&1<=u&&e.push(" ",i,'="',Ci(u),'"');break;default:t.sanitizeURL&&(u=""+u),e.push(" ",i,'="',Ci(u),'"')}}else if(YT(i)){switch(typeof u){case"function":case"symbol":return;case"boolean":if(t=i.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(" ",i,'="',Ci(u),'"')}}}function pm(e,t,i){if(t!=null){if(i!=null)throw Error(tr(60));if(typeof t!="object"||!("__html"in t))throw Error(tr(61));t=t.__html,t!=null&&e.push(""+t)}}function k5(e){var t="";return KT.Children.forEach(e,function(i){i!=null&&(t+=i)}),t}function Z_(e,t,i,u){e.push(ps(i));var d=i=null,g;for(g in t)if(Ui.call(t,g)){var y=t[g];if(y!=null)switch(g){case"children":i=y;break;case"dangerouslySetInnerHTML":d=y;break;default:co(e,u,g,y)}}return e.push(">"),pm(e,d,i),typeof i=="string"?(e.push(Ci(i)),null):i}var T5=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,z2=new Map;function ps(e){var t=z2.get(e);if(t===void 0){if(!T5.test(e))throw Error(tr(65,e));t="<"+e,z2.set(e,t)}return t}function C5(e,t,i,u,d){switch(t){case"select":e.push(ps("select"));var g=null,y=null;for(R in i)if(Ui.call(i,R)){var c=i[R];if(c!=null)switch(R){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;case"defaultValue":case"value":break;default:co(e,u,R,c)}}return e.push(">"),pm(e,y,g),g;case"option":y=d.selectedValue,e.push(ps("option"));var T=c=null,P=null,R=null;for(g in i)if(Ui.call(i,g)){var D=i[g];if(D!=null)switch(g){case"children":c=D;break;case"selected":P=D;break;case"dangerouslySetInnerHTML":R=D;break;case"value":T=D;default:co(e,u,g,D)}}if(y!=null)if(i=T!==null?""+T:k5(c),fv(y)){for(u=0;u<y.length;u++)if(""+y[u]===i){e.push(' selected=""');break}}else""+y===i&&e.push(' selected=""');else P&&e.push(' selected=""');return e.push(">"),pm(e,R,c),c;case"textarea":e.push(ps("textarea")),R=y=g=null;for(c in i)if(Ui.call(i,c)&&(T=i[c],T!=null))switch(c){case"children":R=T;break;case"value":g=T;break;case"defaultValue":y=T;break;case"dangerouslySetInnerHTML":throw Error(tr(91));default:co(e,u,c,T)}if(g===null&&y!==null&&(g=y),e.push(">"),R!=null){if(g!=null)throw Error(tr(92));if(fv(R)&&1<R.length)throw Error(tr(93));g=""+R}return typeof g=="string"&&g[0]===`
`&&e.push(`
`),g!==null&&e.push(Ci(""+g)),null;case"input":e.push(ps("input")),T=R=c=g=null;for(y in i)if(Ui.call(i,y)&&(P=i[y],P!=null))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(tr(399,"input"));case"defaultChecked":T=P;break;case"defaultValue":c=P;break;case"checked":R=P;break;case"value":g=P;break;default:co(e,u,y,P)}return R!==null?co(e,u,"checked",R):T!==null&&co(e,u,"checked",T),g!==null?co(e,u,"value",g):c!==null&&co(e,u,"value",c),e.push("/>"),null;case"menuitem":e.push(ps("menuitem"));for(var A in i)if(Ui.call(i,A)&&(g=i[A],g!=null))switch(A){case"children":case"dangerouslySetInnerHTML":throw Error(tr(400));default:co(e,u,A,g)}return e.push(">"),null;case"title":e.push(ps("title")),g=null;for(D in i)if(Ui.call(i,D)&&(y=i[D],y!=null))switch(D){case"children":g=y;break;case"dangerouslySetInnerHTML":throw Error(tr(434));default:co(e,u,D,y)}return e.push(">"),g;case"listing":case"pre":e.push(ps(t)),y=g=null;for(T in i)if(Ui.call(i,T)&&(c=i[T],c!=null))switch(T){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;default:co(e,u,T,c)}if(e.push(">"),y!=null){if(g!=null)throw Error(tr(60));if(typeof y!="object"||!("__html"in y))throw Error(tr(61));i=y.__html,i!=null&&(typeof i=="string"&&0<i.length&&i[0]===`
`?e.push(`
`,i):e.push(""+i))}return typeof g=="string"&&g[0]===`
`&&e.push(`
`),g;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(ps(t));for(var N in i)if(Ui.call(i,N)&&(g=i[N],g!=null))switch(N){case"children":case"dangerouslySetInnerHTML":throw Error(tr(399,t));default:co(e,u,N,g)}return e.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Z_(e,i,t,u);case"html":return d.insertionMode===0&&e.push("<!DOCTYPE html>"),Z_(e,i,t,u);default:if(t.indexOf("-")===-1&&typeof i.is!="string")return Z_(e,i,t,u);e.push(ps(t)),y=g=null;for(P in i)if(Ui.call(i,P)&&(c=i[P],c!=null))switch(P){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;case"style":JT(e,u,c);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:YT(P)&&typeof c!="function"&&typeof c!="symbol"&&e.push(" ",P,'="',Ci(c),'"')}return e.push(">"),pm(e,y,g),g}}function D2(e,t,i){if(e.push('<!--$?--><template id="'),i===null)throw Error(tr(395));return e.push(i),e.push('"></template>')}function I5(e,t,i,u){switch(i.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 4:return e.push('<table hidden id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(t.segmentPrefix),t=u.toString(16),e.push(t),e.push('">');default:throw Error(tr(397))}}function P5(e,t){switch(t.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(tr(397))}}var A5=/[<\u2028\u2029]/g;function W_(e){return JSON.stringify(e).replace(A5,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function M5(e,t){return t=t===void 0?"":t,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:t+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}function R2(e,t,i,u){return i.generateStaticMarkup?(e.push(Ci(t)),!1):(t===""?e=u:(u&&e.push("<!-- -->"),e.push(Ci(t)),e=!0),e)}var Ad=Object.assign,z5=Symbol.for("react.element"),QT=Symbol.for("react.portal"),eC=Symbol.for("react.fragment"),tC=Symbol.for("react.strict_mode"),rC=Symbol.for("react.profiler"),nC=Symbol.for("react.provider"),iC=Symbol.for("react.context"),oC=Symbol.for("react.forward_ref"),sC=Symbol.for("react.suspense"),aC=Symbol.for("react.suspense_list"),lC=Symbol.for("react.memo"),B1=Symbol.for("react.lazy"),D5=Symbol.for("react.scope"),R5=Symbol.for("react.debug_trace_mode"),L5=Symbol.for("react.legacy_hidden"),F5=Symbol.for("react.default_value"),L2=Symbol.iterator;function mv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case eC:return"Fragment";case QT:return"Portal";case rC:return"Profiler";case tC:return"StrictMode";case sC:return"Suspense";case aC:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case iC:return(e.displayName||"Context")+".Consumer";case nC:return(e._context.displayName||"Context")+".Provider";case oC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lC:return t=e.displayName||null,t!==null?t:mv(e.type)||"Memo";case B1:t=e._payload,e=e._init;try{return mv(e(t))}catch{}}return null}var uC={};function F2(e,t){if(e=e.contextTypes,!e)return uC;var i={},u;for(u in e)i[u]=t[u];return i}var Vl=null;function Vg(e,t){if(e!==t){e.context._currentValue2=e.parentValue,e=e.parent;var i=t.parent;if(e===null){if(i!==null)throw Error(tr(401))}else{if(i===null)throw Error(tr(401));Vg(e,i)}t.context._currentValue2=t.value}}function cC(e){e.context._currentValue2=e.parentValue,e=e.parent,e!==null&&cC(e)}function hC(e){var t=e.parent;t!==null&&hC(t),e.context._currentValue2=e.value}function dC(e,t){if(e.context._currentValue2=e.parentValue,e=e.parent,e===null)throw Error(tr(402));e.depth===t.depth?Vg(e,t):dC(e,t)}function pC(e,t){var i=t.parent;if(i===null)throw Error(tr(402));e.depth===i.depth?Vg(e,i):pC(e,i),t.context._currentValue2=t.value}function Km(e){var t=Vl;t!==e&&(t===null?hC(e):e===null?cC(t):t.depth===e.depth?Vg(t,e):t.depth>e.depth?dC(t,e):pC(t,e),Vl=e)}var O2={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function B2(e,t,i,u){var d=e.state!==void 0?e.state:null;e.updater=O2,e.props=i,e.state=d;var g={queue:[],replace:!1};e._reactInternals=g;var y=t.contextType;if(e.context=typeof y=="object"&&y!==null?y._currentValue2:u,y=t.getDerivedStateFromProps,typeof y=="function"&&(y=y(i,d),d=y==null?d:Ad({},d,y),e.state=d),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&O2.enqueueReplaceState(e,e.state,null),g.queue!==null&&0<g.queue.length)if(t=g.queue,y=g.replace,g.queue=null,g.replace=!1,y&&t.length===1)e.state=t[0];else{for(g=y?t[0]:e.state,d=!0,y=y?1:0;y<t.length;y++){var c=t[y];c=typeof c=="function"?c.call(e,g,i,u):c,c!=null&&(d?(d=!1,g=Ad({},g,c)):Ad(g,c))}e.state=g}else g.queue=null}var O5={id:1,overflow:""};function gv(e,t,i){var u=e.id;e=e.overflow;var d=32-fm(u)-1;u&=~(1<<d),i+=1;var g=32-fm(t)+d;if(30<g){var y=d-d%5;return g=(u&(1<<y)-1).toString(32),u>>=y,d-=y,{id:1<<32-fm(t)+d|i<<d|u,overflow:g+e}}return{id:1<<g|i<<d|u,overflow:e}}var fm=Math.clz32?Math.clz32:$5,B5=Math.log,N5=Math.LN2;function $5(e){return e>>>=0,e===0?32:31-(B5(e)/N5|0)|0}function j5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var U5=typeof Object.is=="function"?Object.is:j5,Ks=null,N1=null,mm=null,Ur=null,gd=!1,Ym=!1,Jd=0,Va=null,Hg=0;function Fl(){if(Ks===null)throw Error(tr(321));return Ks}function N2(){if(0<Hg)throw Error(tr(312));return{memoizedState:null,queue:null,next:null}}function $1(){return Ur===null?mm===null?(gd=!1,mm=Ur=N2()):(gd=!0,Ur=mm):Ur.next===null?(gd=!1,Ur=Ur.next=N2()):(gd=!0,Ur=Ur.next),Ur}function j1(){N1=Ks=null,Ym=!1,mm=null,Hg=0,Ur=Va=null}function fC(e,t){return typeof t=="function"?t(e):t}function $2(e,t,i){if(Ks=Fl(),Ur=$1(),gd){var u=Ur.queue;if(t=u.dispatch,Va!==null&&(i=Va.get(u),i!==void 0)){Va.delete(u),u=Ur.memoizedState;do u=e(u,i.action),i=i.next;while(i!==null);return Ur.memoizedState=u,[u,t]}return[Ur.memoizedState,t]}return e=e===fC?typeof t=="function"?t():t:i!==void 0?i(t):t,Ur.memoizedState=e,e=Ur.queue={last:null,dispatch:null},e=e.dispatch=V5.bind(null,Ks,e),[Ur.memoizedState,e]}function j2(e,t){if(Ks=Fl(),Ur=$1(),t=t===void 0?null:t,Ur!==null){var i=Ur.memoizedState;if(i!==null&&t!==null){var u=i[1];e:if(u===null)u=!1;else{for(var d=0;d<u.length&&d<t.length;d++)if(!U5(t[d],u[d])){u=!1;break e}u=!0}if(u)return i[0]}}return e=e(),Ur.memoizedState=[e,t],e}function V5(e,t,i){if(25<=Hg)throw Error(tr(301));if(e===Ks)if(Ym=!0,e={action:i,next:null},Va===null&&(Va=new Map),i=Va.get(t),i===void 0)Va.set(t,e);else{for(t=i;t.next!==null;)t=t.next;t.next=e}}function H5(){throw Error(tr(394))}function Vf(){}var U2={readContext:function(e){return e._currentValue2},useContext:function(e){return Fl(),e._currentValue2},useMemo:j2,useReducer:$2,useRef:function(e){Ks=Fl(),Ur=$1();var t=Ur.memoizedState;return t===null?(e={current:e},Ur.memoizedState=e):t},useState:function(e){return $2(fC,e)},useInsertionEffect:Vf,useLayoutEffect:function(){},useCallback:function(e,t){return j2(function(){return e},t)},useImperativeHandle:Vf,useEffect:Vf,useDebugValue:Vf,useDeferredValue:function(e){return Fl(),e},useTransition:function(){return Fl(),[!1,H5]},useId:function(){var e=N1.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-fm(e)-1)).toString(32)+t;var i=gm;if(i===null)throw Error(tr(404));return t=Jd++,e=":"+i.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Fl(),t(e._source)},useSyncExternalStore:function(e,t,i){if(i===void 0)throw Error(tr(407));return i()}},gm=null,q_=KT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function G5(e){return console.error(e),null}function yd(){}function Z5(e,t,i,u,d,g,y,c,T){var P=[],R=new Set;return t={destination:null,responseState:t,progressiveChunkSize:u===void 0?12800:u,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:R,pingedTasks:P,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:d===void 0?G5:d,onAllReady:yd,onShellReady:y===void 0?yd:y,onShellError:yd,onFatalError:yd},i=Jm(t,0,null,i,!1,!1),i.parentFlushed=!0,e=U1(t,e,null,i,R,uC,null,O5),P.push(e),t}function U1(e,t,i,u,d,g,y,c){e.allPendingTasks++,i===null?e.pendingRootTasks++:i.pendingTasks++;var T={node:t,ping:function(){var P=e.pingedTasks;P.push(T),P.length===1&&yC(e)},blockedBoundary:i,blockedSegment:u,abortSet:d,legacyContext:g,context:y,treeContext:c};return d.add(T),T}function Jm(e,t,i,u,d,g){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:u,boundary:i,lastPushedText:d,textEmbedded:g}}function Qd(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Qm(e,t){var i=e.onShellError;i(t),i=e.onFatalError,i(t),e.destination!==null?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function V2(e,t,i,u,d){for(Ks={},N1=t,Jd=0,e=i(u,d);Ym;)Ym=!1,Jd=0,Hg+=1,Ur=null,e=i(u,d);return j1(),e}function H2(e,t,i,u){var d=i.render(),g=u.childContextTypes;if(g!=null){var y=t.legacyContext;if(typeof i.getChildContext!="function")u=y;else{i=i.getChildContext();for(var c in i)if(!(c in g))throw Error(tr(108,mv(u)||"Unknown",c));u=Ad({},y,i)}t.legacyContext=u,mo(e,t,d),t.legacyContext=y}else mo(e,t,d)}function G2(e,t){if(e&&e.defaultProps){t=Ad({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function yv(e,t,i,u,d){if(typeof i=="function")if(i.prototype&&i.prototype.isReactComponent){d=F2(i,t.legacyContext);var g=i.contextType;g=new i(u,typeof g=="object"&&g!==null?g._currentValue2:d),B2(g,i,u,d),H2(e,t,g,i)}else{g=F2(i,t.legacyContext),d=V2(e,t,i,u,g);var y=Jd!==0;if(typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0)B2(d,i,u,g),H2(e,t,d,i);else if(y){u=t.treeContext,t.treeContext=gv(u,1,0);try{mo(e,t,d)}finally{t.treeContext=u}}else mo(e,t,d)}else if(typeof i=="string"){switch(d=t.blockedSegment,g=C5(d.chunks,i,u,e.responseState,d.formatContext),d.lastPushedText=!1,y=d.formatContext,d.formatContext=E5(y,i,u),_v(e,t,g),d.formatContext=y,i){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:d.chunks.push("</",i,">")}d.lastPushedText=!1}else{switch(i){case L5:case R5:case tC:case rC:case eC:mo(e,t,u.children);return;case aC:mo(e,t,u.children);return;case D5:throw Error(tr(343));case sC:e:{i=t.blockedBoundary,d=t.blockedSegment,g=u.fallback,u=u.children,y=new Set;var c={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:y,errorDigest:null},T=Jm(e,d.chunks.length,c,d.formatContext,!1,!1);d.children.push(T),d.lastPushedText=!1;var P=Jm(e,0,null,d.formatContext,!1,!1);P.parentFlushed=!0,t.blockedBoundary=c,t.blockedSegment=P;try{if(_v(e,t,u),e.responseState.generateStaticMarkup||P.lastPushedText&&P.textEmbedded&&P.chunks.push("<!-- -->"),P.status=1,eg(c,P),c.pendingTasks===0)break e}catch(R){P.status=4,c.forceClientRender=!0,c.errorDigest=Qd(e,R)}finally{t.blockedBoundary=i,t.blockedSegment=d}t=U1(e,g,i,T,y,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof i=="object"&&i!==null)switch(i.$$typeof){case oC:if(u=V2(e,t,i.render,u,d),Jd!==0){i=t.treeContext,t.treeContext=gv(i,1,0);try{mo(e,t,u)}finally{t.treeContext=i}}else mo(e,t,u);return;case lC:i=i.type,u=G2(i,u),yv(e,t,i,u,d);return;case nC:if(d=u.children,i=i._context,u=u.value,g=i._currentValue2,i._currentValue2=u,y=Vl,Vl=u={parent:y,depth:y===null?0:y.depth+1,context:i,parentValue:g,value:u},t.context=u,mo(e,t,d),e=Vl,e===null)throw Error(tr(403));u=e.parentValue,e.context._currentValue2=u===F5?e.context._defaultValue:u,e=Vl=e.parent,t.context=e;return;case iC:u=u.children,u=u(i._currentValue2),mo(e,t,u);return;case B1:d=i._init,i=d(i._payload),u=G2(i,u),yv(e,t,i,u,void 0);return}throw Error(tr(130,i==null?i:typeof i,""))}}function mo(e,t,i){if(t.node=i,typeof i=="object"&&i!==null){switch(i.$$typeof){case z5:yv(e,t,i.type,i.props,i.ref);return;case QT:throw Error(tr(257));case B1:var u=i._init;i=u(i._payload),mo(e,t,i);return}if(fv(i)){Z2(e,t,i);return}if(i===null||typeof i!="object"?u=null:(u=L2&&i[L2]||i["@@iterator"],u=typeof u=="function"?u:null),u&&(u=u.call(i))){if(i=u.next(),!i.done){var d=[];do d.push(i.value),i=u.next();while(!i.done);Z2(e,t,d)}return}throw e=Object.prototype.toString.call(i),Error(tr(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}typeof i=="string"?(u=t.blockedSegment,u.lastPushedText=R2(t.blockedSegment.chunks,i,e.responseState,u.lastPushedText)):typeof i=="number"&&(u=t.blockedSegment,u.lastPushedText=R2(t.blockedSegment.chunks,""+i,e.responseState,u.lastPushedText))}function Z2(e,t,i){for(var u=i.length,d=0;d<u;d++){var g=t.treeContext;t.treeContext=gv(g,u,d);try{_v(e,t,i[d])}finally{t.treeContext=g}}}function _v(e,t,i){var u=t.blockedSegment.formatContext,d=t.legacyContext,g=t.context;try{return mo(e,t,i)}catch(T){if(j1(),typeof T=="object"&&T!==null&&typeof T.then=="function"){i=T;var y=t.blockedSegment,c=Jm(e,y.chunks.length,null,y.formatContext,y.lastPushedText,!0);y.children.push(c),y.lastPushedText=!1,e=U1(e,t.node,t.blockedBoundary,c,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,i.then(e,e),t.blockedSegment.formatContext=u,t.legacyContext=d,t.context=g,Km(g)}else throw t.blockedSegment.formatContext=u,t.legacyContext=d,t.context=g,Km(g),T}}function W5(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,gC(this,t,e)}function mC(e,t,i){var u=e.blockedBoundary;e.blockedSegment.status=3,u===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.push(null))):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,e=i===void 0?Error(tr(432)):i,u.errorDigest=t.onError(e),u.parentFlushed&&t.clientRenderedBoundaries.push(u)),u.fallbackAbortableTasks.forEach(function(d){return mC(d,t,i)}),u.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(u=t.onAllReady,u()))}function eg(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var i=t.children[0];i.id=t.id,i.parentFlushed=!0,i.status===1&&eg(e,i)}else e.completedSegments.push(t)}function gC(e,t,i){if(t===null){if(i.parentFlushed){if(e.completedRootSegment!==null)throw Error(tr(389));e.completedRootSegment=i}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=yd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(i.parentFlushed&&i.status===1&&eg(t,i),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(W5,e),t.fallbackAbortableTasks.clear()):i.parentFlushed&&i.status===1&&(eg(t,i),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function yC(e){if(e.status!==2){var t=Vl,i=q_.current;q_.current=U2;var u=gm;gm=e.responseState;try{var d=e.pingedTasks,g;for(g=0;g<d.length;g++){var y=d[g],c=e,T=y.blockedSegment;if(T.status===0){Km(y.context);try{mo(c,y,y.node),c.responseState.generateStaticMarkup||T.lastPushedText&&T.textEmbedded&&T.chunks.push("<!-- -->"),y.abortSet.delete(y),T.status=1,gC(c,y.blockedBoundary,T)}catch(X){if(j1(),typeof X=="object"&&X!==null&&typeof X.then=="function"){var P=y.ping;X.then(P,P)}else{y.abortSet.delete(y),T.status=4;var R=y.blockedBoundary,D=X,A=Qd(c,D);if(R===null?Qm(c,D):(R.pendingTasks--,R.forceClientRender||(R.forceClientRender=!0,R.errorDigest=A,R.parentFlushed&&c.clientRenderedBoundaries.push(R))),c.allPendingTasks--,c.allPendingTasks===0){var N=c.onAllReady;N()}}}finally{}}}d.splice(0,g),e.destination!==null&&V1(e,e.destination)}catch(X){Qd(e,X),Qm(e,X)}finally{gm=u,q_.current=i,i===U2&&Km(t)}}}function Hf(e,t,i){switch(i.parentFlushed=!0,i.status){case 0:var u=i.id=e.nextSegmentId++;return i.lastPushedText=!1,i.textEmbedded=!1,e=e.responseState,t.push('<template id="'),t.push(e.placeholderPrefix),e=u.toString(16),t.push(e),t.push('"></template>');case 1:i.status=2;var d=!0;u=i.chunks;var g=0;i=i.children;for(var y=0;y<i.length;y++){for(d=i[y];g<d.index;g++)t.push(u[g]);d=Gg(e,t,d)}for(;g<u.length-1;g++)t.push(u[g]);return g<u.length&&(d=t.push(u[g])),d;default:throw Error(tr(390))}}function Gg(e,t,i){var u=i.boundary;if(u===null)return Hf(e,t,i);if(u.parentFlushed=!0,u.forceClientRender)return e.responseState.generateStaticMarkup||(u=u.errorDigest,t.push("<!--$!-->"),t.push("<template"),u&&(t.push(' data-dgst="'),u=Ci(u),t.push(u),t.push('"')),t.push("></template>")),Hf(e,t,i),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e;if(0<u.pendingTasks){u.rootSegmentID=e.nextSegmentId++,0<u.completedSegments.length&&e.partialBoundaries.push(u);var d=e.responseState,g=d.nextSuspenseID++;return d=d.boundaryPrefix+g.toString(16),u=u.id=d,D2(t,e.responseState,u),Hf(e,t,i),t.push("<!--/$-->")}if(u.byteSize>e.progressiveChunkSize)return u.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(u),D2(t,e.responseState,u.id),Hf(e,t,i),t.push("<!--/$-->");if(e.responseState.generateStaticMarkup||t.push("<!--$-->"),i=u.completedSegments,i.length!==1)throw Error(tr(391));return Gg(e,t,i[0]),e=e.responseState.generateStaticMarkup?!0:t.push("<!--/$-->"),e}function W2(e,t,i){return I5(t,e.responseState,i.formatContext,i.id),Gg(e,t,i),P5(t,i.formatContext)}function q2(e,t,i){for(var u=i.completedSegments,d=0;d<u.length;d++)_C(e,t,i,u[d]);if(u.length=0,e=e.responseState,u=i.id,i=i.rootSegmentID,t.push(e.startInlineScript),e.sentCompleteBoundaryFunction?t.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,t.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),u===null)throw Error(tr(395));return i=i.toString(16),t.push(u),t.push('","'),t.push(e.segmentPrefix),t.push(i),t.push('")<\/script>')}function _C(e,t,i,u){if(u.status===2)return!0;var d=u.id;if(d===-1){if((u.id=i.rootSegmentID)===-1)throw Error(tr(392));return W2(e,t,u)}return W2(e,t,u),e=e.responseState,t.push(e.startInlineScript),e.sentCompleteSegmentFunction?t.push('$RS("'):(e.sentCompleteSegmentFunction=!0,t.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),t.push(e.segmentPrefix),d=d.toString(16),t.push(d),t.push('","'),t.push(e.placeholderPrefix),t.push(d),t.push('")<\/script>')}function V1(e,t){try{var i=e.completedRootSegment;if(i!==null&&e.pendingRootTasks===0){Gg(e,t,i),e.completedRootSegment=null;var u=e.responseState.bootstrapChunks;for(i=0;i<u.length-1;i++)t.push(u[i]);i<u.length&&t.push(u[i])}var d=e.clientRenderedBoundaries,g;for(g=0;g<d.length;g++){var y=d[g];u=t;var c=e.responseState,T=y.id,P=y.errorDigest,R=y.errorMessage,D=y.errorComponentStack;if(u.push(c.startInlineScript),c.sentClientRenderFunction?u.push('$RX("'):(c.sentClientRenderFunction=!0,u.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),T===null)throw Error(tr(395));if(u.push(T),u.push('"'),P||R||D){u.push(",");var A=W_(P||"");u.push(A)}if(R||D){u.push(",");var N=W_(R||"");u.push(N)}if(D){u.push(",");var X=W_(D);u.push(X)}if(!u.push(")<\/script>")){e.destination=null,g++,d.splice(0,g);return}}d.splice(0,g);var U=e.completedBoundaries;for(g=0;g<U.length;g++)if(!q2(e,t,U[g])){e.destination=null,g++,U.splice(0,g);return}U.splice(0,g);var te=e.partialBoundaries;for(g=0;g<te.length;g++){var F=te[g];e:{d=e,y=t;var $=F.completedSegments;for(c=0;c<$.length;c++)if(!_C(d,y,F,$[c])){c++,$.splice(0,c);var q=!1;break e}$.splice(0,c),q=!0}if(!q){e.destination=null,g++,te.splice(0,g);return}}te.splice(0,g);var ne=e.completedBoundaries;for(g=0;g<ne.length;g++)if(!q2(e,t,ne[g])){e.destination=null,g++,ne.splice(0,g);return}ne.splice(0,g)}finally{e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.push(null)}}function q5(e,t){try{var i=e.abortableTasks;i.forEach(function(u){return mC(u,e,t)}),i.clear(),e.destination!==null&&V1(e,e.destination)}catch(u){Qd(e,u),Qm(e,u)}}function X5(){}function vC(e,t,i,u){var d=!1,g=null,y="",c={push:function(P){return P!==null&&(y+=P),!0},destroy:function(P){d=!0,g=P}},T=!1;if(e=Z5(e,M5(i,t?t.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,X5,void 0,function(){T=!0}),yC(e),q5(e,u),e.status===1)e.status=2,c.destroy(e.fatalError);else if(e.status!==2&&e.destination===null){e.destination=c;try{V1(e,c)}catch(P){Qd(e,P),Qm(e,P)}}if(d)throw g;if(!T)throw Error(tr(426));return y}Hc.renderToNodeStream=function(){throw Error(tr(207))};Hc.renderToStaticMarkup=function(e,t){return vC(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Hc.renderToStaticNodeStream=function(){throw Error(tr(208))};Hc.renderToString=function(e,t){return vC(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Hc.version="18.3.1";var H1={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xC=$t;function ar(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var go=null,yo=0;function Ot(e,t){if(t.length!==0)if(512<t.length)0<yo&&(e.enqueue(new Uint8Array(go.buffer,0,yo)),go=new Uint8Array(512),yo=0),e.enqueue(t);else{var i=go.length-yo;i<t.length&&(i===0?e.enqueue(go):(go.set(t.subarray(0,i),yo),e.enqueue(go),t=t.subarray(i)),go=new Uint8Array(512),yo=0),go.set(t,yo),yo+=t.length}}function Yr(e,t){return Ot(e,t),!0}function X2(e){go&&0<yo&&(e.enqueue(new Uint8Array(go.buffer,0,yo)),go=null,yo=0)}var wC=new TextEncoder;function ur(e){return wC.encode(e)}function kt(e){return wC.encode(e)}function bC(e,t){typeof e.error=="function"?e.error(t):e.close()}var Vi=Object.prototype.hasOwnProperty,K5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,K2={},Y2={};function SC(e){return Vi.call(Y2,e)?!0:Vi.call(K2,e)?!1:K5.test(e)?Y2[e]=!0:(K2[e]=!0,!1)}function zi(e,t,i,u,d,g,y){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=d,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=g,this.removeEmptyString=y}var Jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Jn[e]=new zi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Jn[t]=new zi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Jn[e]=new zi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Jn[e]=new zi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Jn[e]=new zi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Jn[e]=new zi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Jn[e]=new zi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Jn[e]=new zi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Jn[e]=new zi(e,5,!1,e.toLowerCase(),null,!1,!1)});var G1=/[\-:]([a-z])/g;function Z1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(G1,Z1);Jn[t]=new zi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(G1,Z1);Jn[t]=new zi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(G1,Z1);Jn[t]=new zi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Jn[e]=new zi(e,1,!1,e.toLowerCase(),null,!1,!1)});Jn.xlinkHref=new zi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Jn[e]=new zi(e,1,!1,e.toLowerCase(),null,!0,!0)});var ym={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Y5=["Webkit","ms","Moz","O"];Object.keys(ym).forEach(function(e){Y5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ym[t]=ym[e]})});var J5=/["'&<>]/;function qn(e){if(typeof e=="boolean"||typeof e=="number")return""+e;e=""+e;var t=J5.exec(e);if(t){var i="",u,d=0;for(u=t.index;u<e.length;u++){switch(e.charCodeAt(u)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}d!==u&&(i+=e.substring(d,u)),d=u+1,i+=t}e=d!==u?i+e.substring(d,u):i}return e}var Q5=/([A-Z])/g,eR=/^ms-/,vv=Array.isArray,tR=kt("<script>"),rR=kt("<\/script>"),nR=kt('<script src="'),iR=kt('<script type="module" src="'),J2=kt('" async=""><\/script>'),oR=/(<\/|<)(s)(cript)/gi;function sR(e,t,i,u){return""+t+(i==="s"?"\\u0073":"\\u0053")+u}function aR(e,t,i,u,d){e=e===void 0?"":e,t=t===void 0?tR:kt('<script nonce="'+qn(t)+'">');var g=[];if(i!==void 0&&g.push(t,ur((""+i).replace(oR,sR)),rR),u!==void 0)for(i=0;i<u.length;i++)g.push(nR,ur(qn(u[i])),J2);if(d!==void 0)for(u=0;u<d.length;u++)g.push(iR,ur(qn(d[u])),J2);return{bootstrapChunks:g,startInlineScript:t,placeholderPrefix:kt(e+"P:"),segmentPrefix:kt(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function fs(e,t){return{insertionMode:e,selectedValue:t}}function lR(e){return fs(e==="http://www.w3.org/2000/svg"?2:e==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function uR(e,t,i){switch(t){case"select":return fs(1,i.value!=null?i.value:i.defaultValue);case"svg":return fs(2,null);case"math":return fs(3,null);case"foreignObject":return fs(1,null);case"table":return fs(4,null);case"thead":case"tbody":case"tfoot":return fs(5,null);case"colgroup":return fs(7,null);case"tr":return fs(6,null)}return 4<=e.insertionMode||e.insertionMode===0?fs(1,null):e}var W1=kt("<!-- -->");function Q2(e,t,i,u){return t===""?u:(u&&e.push(W1),e.push(ur(qn(t))),!0)}var eS=new Map,cR=kt(' style="'),tS=kt(":"),hR=kt(";");function EC(e,t,i){if(typeof i!="object")throw Error(ar(62));t=!0;for(var u in i)if(Vi.call(i,u)){var d=i[u];if(d!=null&&typeof d!="boolean"&&d!==""){if(u.indexOf("--")===0){var g=ur(qn(u));d=ur(qn((""+d).trim()))}else{g=u;var y=eS.get(g);y!==void 0||(y=kt(qn(g.replace(Q5,"-$1").toLowerCase().replace(eR,"-ms-"))),eS.set(g,y)),g=y,d=typeof d=="number"?d===0||Vi.call(ym,u)?ur(""+d):ur(d+"px"):ur(qn((""+d).trim()))}t?(t=!1,e.push(cR,g,tS,d)):e.push(hR,g,tS,d)}}t||e.push(Ol)}var La=kt(" "),nc=kt('="'),Ol=kt('"'),rS=kt('=""');function ho(e,t,i,u){switch(i){case"style":EC(e,t,u);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N"){if(t=Jn.hasOwnProperty(i)?Jn[i]:null,t!==null){switch(typeof u){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(i=ur(t.attributeName),t.type){case 3:u&&e.push(La,i,rS);break;case 4:u===!0?e.push(La,i,rS):u!==!1&&e.push(La,i,nc,ur(qn(u)),Ol);break;case 5:isNaN(u)||e.push(La,i,nc,ur(qn(u)),Ol);break;case 6:!isNaN(u)&&1<=u&&e.push(La,i,nc,ur(qn(u)),Ol);break;default:t.sanitizeURL&&(u=""+u),e.push(La,i,nc,ur(qn(u)),Ol)}}else if(SC(i)){switch(typeof u){case"function":case"symbol":return;case"boolean":if(t=i.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-")return}e.push(La,ur(i),nc,ur(qn(u)),Ol)}}}var Fa=kt(">"),nS=kt("/>");function _m(e,t,i){if(t!=null){if(i!=null)throw Error(ar(60));if(typeof t!="object"||!("__html"in t))throw Error(ar(61));t=t.__html,t!=null&&e.push(ur(""+t))}}function dR(e){var t="";return xC.Children.forEach(e,function(i){i!=null&&(t+=i)}),t}var X_=kt(' selected=""');function K_(e,t,i,u){e.push(ms(i));var d=i=null,g;for(g in t)if(Vi.call(t,g)){var y=t[g];if(y!=null)switch(g){case"children":i=y;break;case"dangerouslySetInnerHTML":d=y;break;default:ho(e,u,g,y)}}return e.push(Fa),_m(e,d,i),typeof i=="string"?(e.push(ur(qn(i))),null):i}var Y_=kt(`
`),pR=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,iS=new Map;function ms(e){var t=iS.get(e);if(t===void 0){if(!pR.test(e))throw Error(ar(65,e));t=kt("<"+e),iS.set(e,t)}return t}var fR=kt("<!DOCTYPE html>");function mR(e,t,i,u,d){switch(t){case"select":e.push(ms("select"));var g=null,y=null;for(R in i)if(Vi.call(i,R)){var c=i[R];if(c!=null)switch(R){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;case"defaultValue":case"value":break;default:ho(e,u,R,c)}}return e.push(Fa),_m(e,y,g),g;case"option":y=d.selectedValue,e.push(ms("option"));var T=c=null,P=null,R=null;for(g in i)if(Vi.call(i,g)){var D=i[g];if(D!=null)switch(g){case"children":c=D;break;case"selected":P=D;break;case"dangerouslySetInnerHTML":R=D;break;case"value":T=D;default:ho(e,u,g,D)}}if(y!=null)if(i=T!==null?""+T:dR(c),vv(y)){for(u=0;u<y.length;u++)if(""+y[u]===i){e.push(X_);break}}else""+y===i&&e.push(X_);else P&&e.push(X_);return e.push(Fa),_m(e,R,c),c;case"textarea":e.push(ms("textarea")),R=y=g=null;for(c in i)if(Vi.call(i,c)&&(T=i[c],T!=null))switch(c){case"children":R=T;break;case"value":g=T;break;case"defaultValue":y=T;break;case"dangerouslySetInnerHTML":throw Error(ar(91));default:ho(e,u,c,T)}if(g===null&&y!==null&&(g=y),e.push(Fa),R!=null){if(g!=null)throw Error(ar(92));if(vv(R)&&1<R.length)throw Error(ar(93));g=""+R}return typeof g=="string"&&g[0]===`
`&&e.push(Y_),g!==null&&e.push(ur(qn(""+g))),null;case"input":e.push(ms("input")),T=R=c=g=null;for(y in i)if(Vi.call(i,y)&&(P=i[y],P!=null))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(ar(399,"input"));case"defaultChecked":T=P;break;case"defaultValue":c=P;break;case"checked":R=P;break;case"value":g=P;break;default:ho(e,u,y,P)}return R!==null?ho(e,u,"checked",R):T!==null&&ho(e,u,"checked",T),g!==null?ho(e,u,"value",g):c!==null&&ho(e,u,"value",c),e.push(nS),null;case"menuitem":e.push(ms("menuitem"));for(var A in i)if(Vi.call(i,A)&&(g=i[A],g!=null))switch(A){case"children":case"dangerouslySetInnerHTML":throw Error(ar(400));default:ho(e,u,A,g)}return e.push(Fa),null;case"title":e.push(ms("title")),g=null;for(D in i)if(Vi.call(i,D)&&(y=i[D],y!=null))switch(D){case"children":g=y;break;case"dangerouslySetInnerHTML":throw Error(ar(434));default:ho(e,u,D,y)}return e.push(Fa),g;case"listing":case"pre":e.push(ms(t)),y=g=null;for(T in i)if(Vi.call(i,T)&&(c=i[T],c!=null))switch(T){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;default:ho(e,u,T,c)}if(e.push(Fa),y!=null){if(g!=null)throw Error(ar(60));if(typeof y!="object"||!("__html"in y))throw Error(ar(61));i=y.__html,i!=null&&(typeof i=="string"&&0<i.length&&i[0]===`
`?e.push(Y_,ur(i)):e.push(ur(""+i)))}return typeof g=="string"&&g[0]===`
`&&e.push(Y_),g;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":e.push(ms(t));for(var N in i)if(Vi.call(i,N)&&(g=i[N],g!=null))switch(N){case"children":case"dangerouslySetInnerHTML":throw Error(ar(399,t));default:ho(e,u,N,g)}return e.push(nS),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return K_(e,i,t,u);case"html":return d.insertionMode===0&&e.push(fR),K_(e,i,t,u);default:if(t.indexOf("-")===-1&&typeof i.is!="string")return K_(e,i,t,u);e.push(ms(t)),y=g=null;for(P in i)if(Vi.call(i,P)&&(c=i[P],c!=null))switch(P){case"children":g=c;break;case"dangerouslySetInnerHTML":y=c;break;case"style":EC(e,u,c);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:SC(P)&&typeof c!="function"&&typeof c!="symbol"&&e.push(La,ur(P),nc,ur(qn(c)),Ol)}return e.push(Fa),_m(e,y,g),g}}var gR=kt("</"),yR=kt(">"),_R=kt('<template id="'),vR=kt('"></template>'),xR=kt("<!--$-->"),wR=kt('<!--$?--><template id="'),bR=kt('"></template>'),SR=kt("<!--$!-->"),ER=kt("<!--/$-->"),kR=kt("<template"),TR=kt('"'),CR=kt(' data-dgst="');kt(' data-msg="');kt(' data-stck="');var IR=kt("></template>");function oS(e,t,i){if(Ot(e,wR),i===null)throw Error(ar(395));return Ot(e,i),Yr(e,bR)}var PR=kt('<div hidden id="'),AR=kt('">'),MR=kt("</div>"),zR=kt('<svg aria-hidden="true" style="display:none" id="'),DR=kt('">'),RR=kt("</svg>"),LR=kt('<math aria-hidden="true" style="display:none" id="'),FR=kt('">'),OR=kt("</math>"),BR=kt('<table hidden id="'),NR=kt('">'),$R=kt("</table>"),jR=kt('<table hidden><tbody id="'),UR=kt('">'),VR=kt("</tbody></table>"),HR=kt('<table hidden><tr id="'),GR=kt('">'),ZR=kt("</tr></table>"),WR=kt('<table hidden><colgroup id="'),qR=kt('">'),XR=kt("</colgroup></table>");function KR(e,t,i,u){switch(i.insertionMode){case 0:case 1:return Ot(e,PR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,AR);case 2:return Ot(e,zR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,DR);case 3:return Ot(e,LR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,FR);case 4:return Ot(e,BR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,NR);case 5:return Ot(e,jR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,UR);case 6:return Ot(e,HR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,GR);case 7:return Ot(e,WR),Ot(e,t.segmentPrefix),Ot(e,ur(u.toString(16))),Yr(e,qR);default:throw Error(ar(397))}}function YR(e,t){switch(t.insertionMode){case 0:case 1:return Yr(e,MR);case 2:return Yr(e,RR);case 3:return Yr(e,OR);case 4:return Yr(e,$R);case 5:return Yr(e,VR);case 6:return Yr(e,ZR);case 7:return Yr(e,XR);default:throw Error(ar(397))}}var JR=kt('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),QR=kt('$RS("'),e4=kt('","'),t4=kt('")<\/script>'),r4=kt('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),n4=kt('$RC("'),i4=kt('","'),o4=kt('")<\/script>'),s4=kt('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),a4=kt('$RX("'),l4=kt('"'),u4=kt(")<\/script>"),J_=kt(","),c4=/[<\u2028\u2029]/g;function Q_(e){return JSON.stringify(e).replace(c4,function(t){switch(t){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Md=Object.assign,h4=Symbol.for("react.element"),kC=Symbol.for("react.portal"),TC=Symbol.for("react.fragment"),CC=Symbol.for("react.strict_mode"),IC=Symbol.for("react.profiler"),PC=Symbol.for("react.provider"),AC=Symbol.for("react.context"),MC=Symbol.for("react.forward_ref"),zC=Symbol.for("react.suspense"),DC=Symbol.for("react.suspense_list"),RC=Symbol.for("react.memo"),q1=Symbol.for("react.lazy"),d4=Symbol.for("react.scope"),p4=Symbol.for("react.debug_trace_mode"),f4=Symbol.for("react.legacy_hidden"),m4=Symbol.for("react.default_value"),sS=Symbol.iterator;function xv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case TC:return"Fragment";case kC:return"Portal";case IC:return"Profiler";case CC:return"StrictMode";case zC:return"Suspense";case DC:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case AC:return(e.displayName||"Context")+".Consumer";case PC:return(e._context.displayName||"Context")+".Provider";case MC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case RC:return t=e.displayName||null,t!==null?t:xv(e.type)||"Memo";case q1:t=e._payload,e=e._init;try{return xv(e(t))}catch{}}return null}var LC={};function aS(e,t){if(e=e.contextTypes,!e)return LC;var i={},u;for(u in e)i[u]=t[u];return i}var Hl=null;function Zg(e,t){if(e!==t){e.context._currentValue=e.parentValue,e=e.parent;var i=t.parent;if(e===null){if(i!==null)throw Error(ar(401))}else{if(i===null)throw Error(ar(401));Zg(e,i)}t.context._currentValue=t.value}}function FC(e){e.context._currentValue=e.parentValue,e=e.parent,e!==null&&FC(e)}function OC(e){var t=e.parent;t!==null&&OC(t),e.context._currentValue=e.value}function BC(e,t){if(e.context._currentValue=e.parentValue,e=e.parent,e===null)throw Error(ar(402));e.depth===t.depth?Zg(e,t):BC(e,t)}function NC(e,t){var i=t.parent;if(i===null)throw Error(ar(402));e.depth===i.depth?Zg(e,i):NC(e,i),t.context._currentValue=t.value}function tg(e){var t=Hl;t!==e&&(t===null?OC(e):e===null?FC(t):t.depth===e.depth?Zg(t,e):t.depth>e.depth?BC(t,e):NC(t,e),Hl=e)}var lS={isMounted:function(){return!1},enqueueSetState:function(e,t){e=e._reactInternals,e.queue!==null&&e.queue.push(t)},enqueueReplaceState:function(e,t){e=e._reactInternals,e.replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function uS(e,t,i,u){var d=e.state!==void 0?e.state:null;e.updater=lS,e.props=i,e.state=d;var g={queue:[],replace:!1};e._reactInternals=g;var y=t.contextType;if(e.context=typeof y=="object"&&y!==null?y._currentValue:u,y=t.getDerivedStateFromProps,typeof y=="function"&&(y=y(i,d),d=y==null?d:Md({},d,y),e.state=d),typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function"&&(typeof e.UNSAFE_componentWillMount=="function"||typeof e.componentWillMount=="function"))if(t=e.state,typeof e.componentWillMount=="function"&&e.componentWillMount(),typeof e.UNSAFE_componentWillMount=="function"&&e.UNSAFE_componentWillMount(),t!==e.state&&lS.enqueueReplaceState(e,e.state,null),g.queue!==null&&0<g.queue.length)if(t=g.queue,y=g.replace,g.queue=null,g.replace=!1,y&&t.length===1)e.state=t[0];else{for(g=y?t[0]:e.state,d=!0,y=y?1:0;y<t.length;y++){var c=t[y];c=typeof c=="function"?c.call(e,g,i,u):c,c!=null&&(d?(d=!1,g=Md({},g,c)):Md(g,c))}e.state=g}else g.queue=null}var g4={id:1,overflow:""};function wv(e,t,i){var u=e.id;e=e.overflow;var d=32-vm(u)-1;u&=~(1<<d),i+=1;var g=32-vm(t)+d;if(30<g){var y=d-d%5;return g=(u&(1<<y)-1).toString(32),u>>=y,d-=y,{id:1<<32-vm(t)+d|i<<d|u,overflow:g+e}}return{id:1<<g|i<<d|u,overflow:e}}var vm=Math.clz32?Math.clz32:v4,y4=Math.log,_4=Math.LN2;function v4(e){return e>>>=0,e===0?32:31-(y4(e)/_4|0)|0}function x4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var w4=typeof Object.is=="function"?Object.is:x4,Ys=null,X1=null,xm=null,Vr=null,_d=!1,rg=!1,ep=0,Ha=null,Wg=0;function Bl(){if(Ys===null)throw Error(ar(321));return Ys}function cS(){if(0<Wg)throw Error(ar(312));return{memoizedState:null,queue:null,next:null}}function K1(){return Vr===null?xm===null?(_d=!1,xm=Vr=cS()):(_d=!0,Vr=xm):Vr.next===null?(_d=!1,Vr=Vr.next=cS()):(_d=!0,Vr=Vr.next),Vr}function Y1(){X1=Ys=null,rg=!1,xm=null,Wg=0,Vr=Ha=null}function $C(e,t){return typeof t=="function"?t(e):t}function hS(e,t,i){if(Ys=Bl(),Vr=K1(),_d){var u=Vr.queue;if(t=u.dispatch,Ha!==null&&(i=Ha.get(u),i!==void 0)){Ha.delete(u),u=Vr.memoizedState;do u=e(u,i.action),i=i.next;while(i!==null);return Vr.memoizedState=u,[u,t]}return[Vr.memoizedState,t]}return e=e===$C?typeof t=="function"?t():t:i!==void 0?i(t):t,Vr.memoizedState=e,e=Vr.queue={last:null,dispatch:null},e=e.dispatch=b4.bind(null,Ys,e),[Vr.memoizedState,e]}function dS(e,t){if(Ys=Bl(),Vr=K1(),t=t===void 0?null:t,Vr!==null){var i=Vr.memoizedState;if(i!==null&&t!==null){var u=i[1];e:if(u===null)u=!1;else{for(var d=0;d<u.length&&d<t.length;d++)if(!w4(t[d],u[d])){u=!1;break e}u=!0}if(u)return i[0]}}return e=e(),Vr.memoizedState=[e,t],e}function b4(e,t,i){if(25<=Wg)throw Error(ar(301));if(e===Ys)if(rg=!0,e={action:i,next:null},Ha===null&&(Ha=new Map),i=Ha.get(t),i===void 0)Ha.set(t,e);else{for(t=i;t.next!==null;)t=t.next;t.next=e}}function S4(){throw Error(ar(394))}function Gf(){}var pS={readContext:function(e){return e._currentValue},useContext:function(e){return Bl(),e._currentValue},useMemo:dS,useReducer:hS,useRef:function(e){Ys=Bl(),Vr=K1();var t=Vr.memoizedState;return t===null?(e={current:e},Vr.memoizedState=e):t},useState:function(e){return hS($C,e)},useInsertionEffect:Gf,useLayoutEffect:function(){},useCallback:function(e,t){return dS(function(){return e},t)},useImperativeHandle:Gf,useEffect:Gf,useDebugValue:Gf,useDeferredValue:function(e){return Bl(),e},useTransition:function(){return Bl(),[!1,S4]},useId:function(){var e=X1.treeContext,t=e.overflow;e=e.id,e=(e&~(1<<32-vm(e)-1)).toString(32)+t;var i=wm;if(i===null)throw Error(ar(404));return t=ep++,e=":"+i.idPrefix+"R"+e,0<t&&(e+="H"+t.toString(32)),e+":"},useMutableSource:function(e,t){return Bl(),t(e._source)},useSyncExternalStore:function(e,t,i){if(i===void 0)throw Error(ar(407));return i()}},wm=null,e0=xC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function E4(e){return console.error(e),null}function vd(){}function k4(e,t,i,u,d,g,y,c,T){var P=[],R=new Set;return t={destination:null,responseState:t,progressiveChunkSize:u===void 0?12800:u,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:R,pingedTasks:P,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:d===void 0?E4:d,onAllReady:g===void 0?vd:g,onShellReady:y===void 0?vd:y,onShellError:c===void 0?vd:c,onFatalError:T===void 0?vd:T},i=ng(t,0,null,i,!1,!1),i.parentFlushed=!0,e=J1(t,e,null,i,R,LC,null,g4),P.push(e),t}function J1(e,t,i,u,d,g,y,c){e.allPendingTasks++,i===null?e.pendingRootTasks++:i.pendingTasks++;var T={node:t,ping:function(){var P=e.pingedTasks;P.push(T),P.length===1&&VC(e)},blockedBoundary:i,blockedSegment:u,abortSet:d,legacyContext:g,context:y,treeContext:c};return d.add(T),T}function ng(e,t,i,u,d,g){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:u,boundary:i,lastPushedText:d,textEmbedded:g}}function tp(e,t){if(e=e.onError(t),e!=null&&typeof e!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function ig(e,t){var i=e.onShellError;i(t),i=e.onFatalError,i(t),e.destination!==null?(e.status=2,bC(e.destination,t)):(e.status=1,e.fatalError=t)}function fS(e,t,i,u,d){for(Ys={},X1=t,ep=0,e=i(u,d);rg;)rg=!1,ep=0,Wg+=1,Vr=null,e=i(u,d);return Y1(),e}function mS(e,t,i,u){var d=i.render(),g=u.childContextTypes;if(g!=null){var y=t.legacyContext;if(typeof i.getChildContext!="function")u=y;else{i=i.getChildContext();for(var c in i)if(!(c in g))throw Error(ar(108,xv(u)||"Unknown",c));u=Md({},y,i)}t.legacyContext=u,_o(e,t,d),t.legacyContext=y}else _o(e,t,d)}function gS(e,t){if(e&&e.defaultProps){t=Md({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function bv(e,t,i,u,d){if(typeof i=="function")if(i.prototype&&i.prototype.isReactComponent){d=aS(i,t.legacyContext);var g=i.contextType;g=new i(u,typeof g=="object"&&g!==null?g._currentValue:d),uS(g,i,u,d),mS(e,t,g,i)}else{g=aS(i,t.legacyContext),d=fS(e,t,i,u,g);var y=ep!==0;if(typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0)uS(d,i,u,g),mS(e,t,d,i);else if(y){u=t.treeContext,t.treeContext=wv(u,1,0);try{_o(e,t,d)}finally{t.treeContext=u}}else _o(e,t,d)}else if(typeof i=="string"){switch(d=t.blockedSegment,g=mR(d.chunks,i,u,e.responseState,d.formatContext),d.lastPushedText=!1,y=d.formatContext,d.formatContext=uR(y,i,u),Sv(e,t,g),d.formatContext=y,i){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:d.chunks.push(gR,ur(i),yR)}d.lastPushedText=!1}else{switch(i){case f4:case p4:case CC:case IC:case TC:_o(e,t,u.children);return;case DC:_o(e,t,u.children);return;case d4:throw Error(ar(343));case zC:e:{i=t.blockedBoundary,d=t.blockedSegment,g=u.fallback,u=u.children,y=new Set;var c={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:y,errorDigest:null},T=ng(e,d.chunks.length,c,d.formatContext,!1,!1);d.children.push(T),d.lastPushedText=!1;var P=ng(e,0,null,d.formatContext,!1,!1);P.parentFlushed=!0,t.blockedBoundary=c,t.blockedSegment=P;try{if(Sv(e,t,u),P.lastPushedText&&P.textEmbedded&&P.chunks.push(W1),P.status=1,og(c,P),c.pendingTasks===0)break e}catch(R){P.status=4,c.forceClientRender=!0,c.errorDigest=tp(e,R)}finally{t.blockedBoundary=i,t.blockedSegment=d}t=J1(e,g,i,T,y,t.legacyContext,t.context,t.treeContext),e.pingedTasks.push(t)}return}if(typeof i=="object"&&i!==null)switch(i.$$typeof){case MC:if(u=fS(e,t,i.render,u,d),ep!==0){i=t.treeContext,t.treeContext=wv(i,1,0);try{_o(e,t,u)}finally{t.treeContext=i}}else _o(e,t,u);return;case RC:i=i.type,u=gS(i,u),bv(e,t,i,u,d);return;case PC:if(d=u.children,i=i._context,u=u.value,g=i._currentValue,i._currentValue=u,y=Hl,Hl=u={parent:y,depth:y===null?0:y.depth+1,context:i,parentValue:g,value:u},t.context=u,_o(e,t,d),e=Hl,e===null)throw Error(ar(403));u=e.parentValue,e.context._currentValue=u===m4?e.context._defaultValue:u,e=Hl=e.parent,t.context=e;return;case AC:u=u.children,u=u(i._currentValue),_o(e,t,u);return;case q1:d=i._init,i=d(i._payload),u=gS(i,u),bv(e,t,i,u,void 0);return}throw Error(ar(130,i==null?i:typeof i,""))}}function _o(e,t,i){if(t.node=i,typeof i=="object"&&i!==null){switch(i.$$typeof){case h4:bv(e,t,i.type,i.props,i.ref);return;case kC:throw Error(ar(257));case q1:var u=i._init;i=u(i._payload),_o(e,t,i);return}if(vv(i)){yS(e,t,i);return}if(i===null||typeof i!="object"?u=null:(u=sS&&i[sS]||i["@@iterator"],u=typeof u=="function"?u:null),u&&(u=u.call(i))){if(i=u.next(),!i.done){var d=[];do d.push(i.value),i=u.next();while(!i.done);yS(e,t,d)}return}throw e=Object.prototype.toString.call(i),Error(ar(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}typeof i=="string"?(u=t.blockedSegment,u.lastPushedText=Q2(t.blockedSegment.chunks,i,e.responseState,u.lastPushedText)):typeof i=="number"&&(u=t.blockedSegment,u.lastPushedText=Q2(t.blockedSegment.chunks,""+i,e.responseState,u.lastPushedText))}function yS(e,t,i){for(var u=i.length,d=0;d<u;d++){var g=t.treeContext;t.treeContext=wv(g,u,d);try{Sv(e,t,i[d])}finally{t.treeContext=g}}}function Sv(e,t,i){var u=t.blockedSegment.formatContext,d=t.legacyContext,g=t.context;try{return _o(e,t,i)}catch(T){if(Y1(),typeof T=="object"&&T!==null&&typeof T.then=="function"){i=T;var y=t.blockedSegment,c=ng(e,y.chunks.length,null,y.formatContext,y.lastPushedText,!0);y.children.push(c),y.lastPushedText=!1,e=J1(e,t.node,t.blockedBoundary,c,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,i.then(e,e),t.blockedSegment.formatContext=u,t.legacyContext=d,t.context=g,tg(g)}else throw t.blockedSegment.formatContext=u,t.legacyContext=d,t.context=g,tg(g),T}}function T4(e){var t=e.blockedBoundary;e=e.blockedSegment,e.status=3,UC(this,t,e)}function jC(e,t,i){var u=e.blockedBoundary;e.blockedSegment.status=3,u===null?(t.allPendingTasks--,t.status!==2&&(t.status=2,t.destination!==null&&t.destination.close())):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,e=i===void 0?Error(ar(432)):i,u.errorDigest=t.onError(e),u.parentFlushed&&t.clientRenderedBoundaries.push(u)),u.fallbackAbortableTasks.forEach(function(d){return jC(d,t,i)}),u.fallbackAbortableTasks.clear(),t.allPendingTasks--,t.allPendingTasks===0&&(u=t.onAllReady,u()))}function og(e,t){if(t.chunks.length===0&&t.children.length===1&&t.children[0].boundary===null){var i=t.children[0];i.id=t.id,i.parentFlushed=!0,i.status===1&&og(e,i)}else e.completedSegments.push(t)}function UC(e,t,i){if(t===null){if(i.parentFlushed){if(e.completedRootSegment!==null)throw Error(ar(389));e.completedRootSegment=i}e.pendingRootTasks--,e.pendingRootTasks===0&&(e.onShellError=vd,t=e.onShellReady,t())}else t.pendingTasks--,t.forceClientRender||(t.pendingTasks===0?(i.parentFlushed&&i.status===1&&og(t,i),t.parentFlushed&&e.completedBoundaries.push(t),t.fallbackAbortableTasks.forEach(T4,e),t.fallbackAbortableTasks.clear()):i.parentFlushed&&i.status===1&&(og(t,i),t.completedSegments.length===1&&t.parentFlushed&&e.partialBoundaries.push(t)));e.allPendingTasks--,e.allPendingTasks===0&&(e=e.onAllReady,e())}function VC(e){if(e.status!==2){var t=Hl,i=e0.current;e0.current=pS;var u=wm;wm=e.responseState;try{var d=e.pingedTasks,g;for(g=0;g<d.length;g++){var y=d[g],c=e,T=y.blockedSegment;if(T.status===0){tg(y.context);try{_o(c,y,y.node),T.lastPushedText&&T.textEmbedded&&T.chunks.push(W1),y.abortSet.delete(y),T.status=1,UC(c,y.blockedBoundary,T)}catch(X){if(Y1(),typeof X=="object"&&X!==null&&typeof X.then=="function"){var P=y.ping;X.then(P,P)}else{y.abortSet.delete(y),T.status=4;var R=y.blockedBoundary,D=X,A=tp(c,D);if(R===null?ig(c,D):(R.pendingTasks--,R.forceClientRender||(R.forceClientRender=!0,R.errorDigest=A,R.parentFlushed&&c.clientRenderedBoundaries.push(R))),c.allPendingTasks--,c.allPendingTasks===0){var N=c.onAllReady;N()}}}finally{}}}d.splice(0,g),e.destination!==null&&Q1(e,e.destination)}catch(X){tp(e,X),ig(e,X)}finally{wm=u,e0.current=i,i===pS&&tg(t)}}}function Zf(e,t,i){switch(i.parentFlushed=!0,i.status){case 0:var u=i.id=e.nextSegmentId++;return i.lastPushedText=!1,i.textEmbedded=!1,e=e.responseState,Ot(t,_R),Ot(t,e.placeholderPrefix),e=ur(u.toString(16)),Ot(t,e),Yr(t,vR);case 1:i.status=2;var d=!0;u=i.chunks;var g=0;i=i.children;for(var y=0;y<i.length;y++){for(d=i[y];g<d.index;g++)Ot(t,u[g]);d=qg(e,t,d)}for(;g<u.length-1;g++)Ot(t,u[g]);return g<u.length&&(d=Yr(t,u[g])),d;default:throw Error(ar(390))}}function qg(e,t,i){var u=i.boundary;if(u===null)return Zf(e,t,i);if(u.parentFlushed=!0,u.forceClientRender)u=u.errorDigest,Yr(t,SR),Ot(t,kR),u&&(Ot(t,CR),Ot(t,ur(qn(u))),Ot(t,TR)),Yr(t,IR),Zf(e,t,i);else if(0<u.pendingTasks){u.rootSegmentID=e.nextSegmentId++,0<u.completedSegments.length&&e.partialBoundaries.push(u);var d=e.responseState,g=d.nextSuspenseID++;d=kt(d.boundaryPrefix+g.toString(16)),u=u.id=d,oS(t,e.responseState,u),Zf(e,t,i)}else if(u.byteSize>e.progressiveChunkSize)u.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(u),oS(t,e.responseState,u.id),Zf(e,t,i);else{if(Yr(t,xR),i=u.completedSegments,i.length!==1)throw Error(ar(391));qg(e,t,i[0])}return Yr(t,ER)}function _S(e,t,i){return KR(t,e.responseState,i.formatContext,i.id),qg(e,t,i),YR(t,i.formatContext)}function vS(e,t,i){for(var u=i.completedSegments,d=0;d<u.length;d++)HC(e,t,i,u[d]);if(u.length=0,e=e.responseState,u=i.id,i=i.rootSegmentID,Ot(t,e.startInlineScript),e.sentCompleteBoundaryFunction?Ot(t,n4):(e.sentCompleteBoundaryFunction=!0,Ot(t,r4)),u===null)throw Error(ar(395));return i=ur(i.toString(16)),Ot(t,u),Ot(t,i4),Ot(t,e.segmentPrefix),Ot(t,i),Yr(t,o4)}function HC(e,t,i,u){if(u.status===2)return!0;var d=u.id;if(d===-1){if((u.id=i.rootSegmentID)===-1)throw Error(ar(392));return _S(e,t,u)}return _S(e,t,u),e=e.responseState,Ot(t,e.startInlineScript),e.sentCompleteSegmentFunction?Ot(t,QR):(e.sentCompleteSegmentFunction=!0,Ot(t,JR)),Ot(t,e.segmentPrefix),d=ur(d.toString(16)),Ot(t,d),Ot(t,e4),Ot(t,e.placeholderPrefix),Ot(t,d),Yr(t,t4)}function Q1(e,t){go=new Uint8Array(512),yo=0;try{var i=e.completedRootSegment;if(i!==null&&e.pendingRootTasks===0){qg(e,t,i),e.completedRootSegment=null;var u=e.responseState.bootstrapChunks;for(i=0;i<u.length-1;i++)Ot(t,u[i]);i<u.length&&Yr(t,u[i])}var d=e.clientRenderedBoundaries,g;for(g=0;g<d.length;g++){var y=d[g];u=t;var c=e.responseState,T=y.id,P=y.errorDigest,R=y.errorMessage,D=y.errorComponentStack;if(Ot(u,c.startInlineScript),c.sentClientRenderFunction?Ot(u,a4):(c.sentClientRenderFunction=!0,Ot(u,s4)),T===null)throw Error(ar(395));Ot(u,T),Ot(u,l4),(P||R||D)&&(Ot(u,J_),Ot(u,ur(Q_(P||"")))),(R||D)&&(Ot(u,J_),Ot(u,ur(Q_(R||"")))),D&&(Ot(u,J_),Ot(u,ur(Q_(D)))),Yr(u,u4)}d.splice(0,g);var A=e.completedBoundaries;for(g=0;g<A.length;g++)vS(e,t,A[g]);A.splice(0,g),X2(t),go=new Uint8Array(512),yo=0;var N=e.partialBoundaries;for(g=0;g<N.length;g++){var X=N[g];e:{d=e,y=t;var U=X.completedSegments;for(c=0;c<U.length;c++)if(!HC(d,y,X,U[c])){c++,U.splice(0,c);var te=!1;break e}U.splice(0,c),te=!0}if(!te){e.destination=null,g++,N.splice(0,g);return}}N.splice(0,g);var F=e.completedBoundaries;for(g=0;g<F.length;g++)vS(e,t,F[g]);F.splice(0,g)}finally{X2(t),e.allPendingTasks===0&&e.pingedTasks.length===0&&e.clientRenderedBoundaries.length===0&&e.completedBoundaries.length===0&&t.close()}}function xS(e,t){try{var i=e.abortableTasks;i.forEach(function(u){return jC(u,e,t)}),i.clear(),e.destination!==null&&Q1(e,e.destination)}catch(u){tp(e,u),ig(e,u)}}H1.renderToReadableStream=function(e,t){return new Promise(function(i,u){var d,g,y=new Promise(function(R,D){g=R,d=D}),c=k4(e,aR(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),lR(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,g,function(){var R=new ReadableStream({type:"bytes",pull:function(D){if(c.status===1)c.status=2,bC(D,c.fatalError);else if(c.status!==2&&c.destination===null){c.destination=D;try{Q1(c,D)}catch(A){tp(c,A),ig(c,A)}}},cancel:function(){xS(c)}},{highWaterMark:0});R.allReady=y,i(R)},function(R){y.catch(function(){}),u(R)},d);if(t&&t.signal){var T=t.signal,P=function(){xS(c,T.reason),T.removeEventListener("abort",P)};T.addEventListener("abort",P)}VC(c)})};H1.version="18.3.1";var Gc,GC;Gc=Hc,GC=H1;Gc.version;var C4=Gc.renderToString;Gc.renderToStaticMarkup;Gc.renderToNodeStream;Gc.renderToStaticNodeStream;GC.renderToReadableStream;function I4({latitude:e,longitude:t,children:i,closeOnMove:u,closeButton:d,closeOnClick:g,popupRef:y}){return $t.useEffect(()=>{y.current||(y.current=new XT.Popup({closeOnClick:!1,closeOnMove:u,closeButton:d,className:"popup"})),y.current.setLngLat([t,e]).setHTML(C4(i))},[e,t,i,g,u,d,y]),null}var mp={};function ZC(e,t,i){var u,d,g,y,c,T,P,R,D=0,A,N=e.type==="FeatureCollection",X=e.type==="Feature",U=N?e.features.length:1;for(u=0;u<U;u++)for(R=N?e.features[u].geometry:X?e.geometry:e,A=R.type==="GeometryCollection",T=A?R.geometries.length:1,y=0;y<T;y++)if(c=A?R.geometries[y]:R,P=c.coordinates,D=i&&(c.type==="Polygon"||c.type==="MultiPolygon")?1:0,c.type==="Point")t(P);else if(c.type==="LineString"||c.type==="MultiPoint")for(d=0;d<P.length;d++)t(P[d]);else if(c.type==="Polygon"||c.type==="MultiLineString")for(d=0;d<P.length;d++)for(g=0;g<P[d].length-D;g++)t(P[d][g]);else if(c.type==="MultiPolygon")for(d=0;d<P.length;d++)for(g=0;g<P[d].length;g++)for(l=0;l<P[d][g].length-D;l++)t(P[d][g][l]);else throw new Error("Unknown Geometry Type")}mp.coordEach=ZC;function P4(e,t,i,u){return ZC(e,function(d){i=t(i,d)},u),i}mp.coordReduce=P4;function WC(e,t){var i;switch(e.type){case"FeatureCollection":for(features=e.features,i=0;i<e.features.length;i++)t(e.features[i].properties);break;case"Feature":t(e.properties);break}}mp.propEach=WC;function A4(e,t,i){return WC(e,function(u){i=t(i,u)}),i}mp.propReduce=A4;var M4=mp.coordEach,z4=function(e){var t=[1/0,1/0,-1/0,-1/0];return M4(e,function(i){t[0]>i[0]&&(t[0]=i[0]),t[1]>i[1]&&(t[1]=i[1]),t[2]<i[0]&&(t[2]=i[0]),t[3]<i[1]&&(t[3]=i[1])}),t};const D4=ip(z4);function R4({data:e,dataFiles:t}){const i=$t.useRef(null),u=$t.useRef(null),[d,g]=$t.useState(null),y=$t.useRef(null),c=T=>{if(T){const P=new Date(T);return P.getDate()+"/"+P.getMonth()+"/"+P.getFullYear()+" "+String(P.getHours()).padStart(2,"0")+":"+String(P.getMinutes()).padStart(2,"0")}return"unknown"};return $t.useEffect(()=>{u.current||(u.current=new XT.Map({container:i.current,center:[0,0],zoom:17,style:_5}),u.current.on("load",()=>{u.current.setCenter(e.features[0].geometry.coordinates),u.current.addSource("locations",{data:e,type:"geojson"});const T=D4(e);u.current.fitBounds(T,{padding:50}),u.current.on("mouseenter","pois",()=>{u.current.getCanvas().style.cursor="pointer"}),u.current.on("mouseleave","pois",()=>{u.current.getCanvas().style.cursor="inherit"}),u.current.addLayer({id:"pois",type:"circle",source:"locations",layout:{},paint:{"circle-color":"#D63F40","circle-radius":10}}),u.current.on("click","pois",P=>{g(P.features[0])})}))},[e,y]),$t.useEffect(()=>{!u.current||!d||(g(d),y.current.addTo(u.current))},[d]),Je.jsxs("div",{className:"map-wrap",children:[Je.jsx("div",{ref:i,className:"map"}),u.current&&d&&Je.jsx(I4,{longitude:d.geometry.coordinates[0],latitude:d.geometry.coordinates[1],popupRef:y,closeOnMove:!1,closeButton:!0,children:Je.jsxs("div",{className:"activePopupFeatureContent",children:[Je.jsxs("p",{children:[Je.jsx("span",{className:"msgUsername",children:d.properties.username}),Je.jsx("span",{className:"msgDatetime",children:c(d.properties.datetime)})]}),Je.jsx("p",{children:d.properties.file&&d.properties.file in t?Je.jsx("img",{className:"popupImage",alt:"Message attached file",src:URL.createObjectURL(t[d.properties.file])}):d.properties.message})]})})]})}function L4({data:e,filename:t}){const i=u=>"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(u));return Je.jsx("a",{className:"primaryButton",href:i(e),download:`${t}.geojson`,children:Je.jsx(ln,{id:"app.download",defaultMessage:"Download"})})}function F4({onOptionClick:e}){return Je.jsx(Je.Fragment,{children:Je.jsx("div",{className:"appNav",children:Je.jsx("button",{className:"textButton",onClick:()=>e("options"),children:Je.jsx(ln,{id:"app.options",defaultMessage:"Options"})})})})}var Ev={exports:{}},nu={},qC={exports:{}},O4="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",B4=O4,N4=B4;function XC(){}function KC(){}KC.resetWarningCache=XC;var $4=function(){function e(u,d,g,y,c,T){if(T!==N4){var P=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw P.name="Invariant Violation",P}}e.isRequired=e;function t(){return e}var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:KC,resetWarningCache:XC};return i.PropTypes=i,i};qC.exports=$4();var YC=qC.exports,kv={exports:{}},rs={},Tv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=R;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var i="none",u="contents",d=/input|select|textarea|button|object|iframe/;function g(D,A){return A.getPropertyValue("overflow")!=="visible"||D.scrollWidth<=0&&D.scrollHeight<=0}function y(D){var A=D.offsetWidth<=0&&D.offsetHeight<=0;if(A&&!D.innerHTML)return!0;try{var N=window.getComputedStyle(D),X=N.getPropertyValue("display");return A?X!==u&&g(D,N):X===i}catch{return console.warn("Failed to inspect element style"),!1}}function c(D){for(var A=D,N=D.getRootNode&&D.getRootNode();A&&A!==document.body;){if(N&&A===N&&(A=N.host.parentNode),y(A))return!1;A=A.parentNode}return!0}function T(D,A){var N=D.nodeName.toLowerCase(),X=d.test(N)&&!D.disabled||N==="a"&&D.href||A;return X&&c(D)}function P(D){var A=D.getAttribute("tabindex");A===null&&(A=void 0);var N=isNaN(A);return(N||A>=0)&&T(D,!N)}function R(D){var A=[].slice.call(D.querySelectorAll("*"),0).reduce(function(N,X){return N.concat(X.shadowRoot?R(X.shadowRoot):[X])},[]);return A.filter(P)}e.exports=t.default})(Tv,Tv.exports);var JC=Tv.exports;Object.defineProperty(rs,"__esModule",{value:!0});rs.resetState=H4;rs.log=G4;rs.handleBlur=rp;rs.handleFocus=np;rs.markForFocusLater=Z4;rs.returnFocus=W4;rs.popWithoutFocus=q4;rs.setupScopedFocus=X4;rs.teardownScopedFocus=K4;var j4=JC,U4=V4(j4);function V4(e){return e&&e.__esModule?e:{default:e}}var Nc=[],yc=null,Cv=!1;function H4(){Nc=[]}function G4(){}function rp(){Cv=!0}function np(){if(Cv){if(Cv=!1,!yc)return;setTimeout(function(){if(!yc.contains(document.activeElement)){var e=(0,U4.default)(yc)[0]||yc;e.focus()}},0)}}function Z4(){Nc.push(document.activeElement)}function W4(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{Nc.length!==0&&(t=Nc.pop(),t.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function q4(){Nc.length>0&&Nc.pop()}function X4(e){yc=e,window.addEventListener?(window.addEventListener("blur",rp,!1),document.addEventListener("focus",np,!0)):(window.attachEvent("onBlur",rp),document.attachEvent("onFocus",np))}function K4(){yc=null,window.addEventListener?(window.removeEventListener("blur",rp),document.removeEventListener("focus",np)):(window.detachEvent("onBlur",rp),document.detachEvent("onFocus",np))}var Iv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=y;var i=JC,u=d(i);function d(c){return c&&c.__esModule?c:{default:c}}function g(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return c.activeElement.shadowRoot?g(c.activeElement.shadowRoot):c.activeElement}function y(c,T){var P=(0,u.default)(c);if(!P.length){T.preventDefault();return}var R=void 0,D=T.shiftKey,A=P[0],N=P[P.length-1],X=g();if(c===X){if(!D)return;R=N}if(N===X&&!D&&(R=A),A===X&&D&&(R=N),R){T.preventDefault(),R.focus();return}var U=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),te=U!=null&&U[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(te){var F=P.indexOf(X);if(F>-1&&(F+=D?-1:1),R=P[F],typeof R>"u"){T.preventDefault(),R=D?N:A,R.focus();return}T.preventDefault(),R.focus()}}e.exports=t.default})(Iv,Iv.exports);var Y4=Iv.exports,ns={},J4=function(){},Q4=J4,es={},QC={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),i={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=i:window.ExecutionEnvironment=i})()})(QC);var eL=QC.exports;Object.defineProperty(es,"__esModule",{value:!0});es.canUseDOM=es.SafeNodeList=es.SafeHTMLCollection=void 0;var tL=eL,rL=nL(tL);function nL(e){return e&&e.__esModule?e:{default:e}}var Xg=rL.default,iL=Xg.canUseDOM?window.HTMLElement:{};es.SafeHTMLCollection=Xg.canUseDOM?window.HTMLCollection:{};es.SafeNodeList=Xg.canUseDOM?window.NodeList:{};es.canUseDOM=Xg.canUseDOM;es.default=iL;Object.defineProperty(ns,"__esModule",{value:!0});ns.resetState=uL;ns.log=cL;ns.assertNodeList=eI;ns.setElement=hL;ns.validateElement=ex;ns.hide=dL;ns.show=pL;ns.documentNotReadyOrSSRTesting=fL;var oL=Q4,sL=lL(oL),aL=es;function lL(e){return e&&e.__esModule?e:{default:e}}var Mo=null;function uL(){Mo&&(Mo.removeAttribute?Mo.removeAttribute("aria-hidden"):Mo.length!=null?Mo.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(Mo).forEach(function(e){return e.removeAttribute("aria-hidden")})),Mo=null}function cL(){}function eI(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function hL(e){var t=e;if(typeof t=="string"&&aL.canUseDOM){var i=document.querySelectorAll(t);eI(i,t),t=i}return Mo=t||Mo,Mo}function ex(e){var t=e||Mo;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,sL.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function dL(e){var t=!0,i=!1,u=void 0;try{for(var d=ex(e)[Symbol.iterator](),g;!(t=(g=d.next()).done);t=!0){var y=g.value;y.setAttribute("aria-hidden","true")}}catch(c){i=!0,u=c}finally{try{!t&&d.return&&d.return()}finally{if(i)throw u}}}function pL(e){var t=!0,i=!1,u=void 0;try{for(var d=ex(e)[Symbol.iterator](),g;!(t=(g=d.next()).done);t=!0){var y=g.value;y.removeAttribute("aria-hidden")}}catch(c){i=!0,u=c}finally{try{!t&&d.return&&d.return()}finally{if(i)throw u}}}function fL(){Mo=null}var Zc={};Object.defineProperty(Zc,"__esModule",{value:!0});Zc.resetState=mL;Zc.log=gL;var zd={},Dd={};function wS(e,t){e.classList.remove(t)}function mL(){var e=document.getElementsByTagName("html")[0];for(var t in zd)wS(e,zd[t]);var i=document.body;for(var u in Dd)wS(i,Dd[u]);zd={},Dd={}}function gL(){}var yL=function(t,i){return t[i]||(t[i]=0),t[i]+=1,i},_L=function(t,i){return t[i]&&(t[i]-=1),i},vL=function(t,i,u){u.forEach(function(d){yL(i,d),t.add(d)})},xL=function(t,i,u){u.forEach(function(d){_L(i,d),i[d]===0&&t.remove(d)})};Zc.add=function(t,i){return vL(t.classList,t.nodeName.toLowerCase()=="html"?zd:Dd,i.split(" "))};Zc.remove=function(t,i){return xL(t.classList,t.nodeName.toLowerCase()=="html"?zd:Dd,i.split(" "))};var Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.log=bL;Wc.resetState=SL;function wL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var tI=function e(){var t=this;wL(this,e),this.register=function(i){t.openInstances.indexOf(i)===-1&&(t.openInstances.push(i),t.emit("register"))},this.deregister=function(i){var u=t.openInstances.indexOf(i);u!==-1&&(t.openInstances.splice(u,1),t.emit("deregister"))},this.subscribe=function(i){t.subscribers.push(i)},this.emit=function(i){t.subscribers.forEach(function(u){return u(i,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},sg=new tI;function bL(){console.log("portalOpenInstances ----------"),console.log(sg.openInstances.length),sg.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function SL(){sg=new tI}Wc.default=sg;var tx={};Object.defineProperty(tx,"__esModule",{value:!0});tx.resetState=CL;tx.log=IL;var EL=Wc,kL=TL(EL);function TL(e){return e&&e.__esModule?e:{default:e}}var hi=void 0,qo=void 0,Kl=[];function CL(){for(var e=[hi,qo],t=0;t<e.length;t++){var i=e[t];i&&i.parentNode&&i.parentNode.removeChild(i)}hi=qo=null,Kl=[]}function IL(){console.log("bodyTrap ----------"),console.log(Kl.length);for(var e=[hi,qo],t=0;t<e.length;t++){var i=e[t],u=i||{};console.log(u.nodeName,u.className,u.id)}console.log("edn bodyTrap ----------")}function bS(){Kl.length!==0&&Kl[Kl.length-1].focusContent()}function PL(e,t){!hi&&!qo&&(hi=document.createElement("div"),hi.setAttribute("data-react-modal-body-trap",""),hi.style.position="absolute",hi.style.opacity="0",hi.setAttribute("tabindex","0"),hi.addEventListener("focus",bS),qo=hi.cloneNode(),qo.addEventListener("focus",bS)),Kl=t,Kl.length>0?(document.body.firstChild!==hi&&document.body.insertBefore(hi,document.body.firstChild),document.body.lastChild!==qo&&document.body.appendChild(qo)):(hi.parentElement&&hi.parentElement.removeChild(hi),qo.parentElement&&qo.parentElement.removeChild(qo))}kL.default.subscribe(PL);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(H){for(var Re=1;Re<arguments.length;Re++){var _t=arguments[Re];for(var ye in _t)Object.prototype.hasOwnProperty.call(_t,ye)&&(H[ye]=_t[ye])}return H},u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},d=function(){function H(Re,_t){for(var ye=0;ye<_t.length;ye++){var Be=_t[ye];Be.enumerable=Be.enumerable||!1,Be.configurable=!0,"value"in Be&&(Be.writable=!0),Object.defineProperty(Re,Be.key,Be)}}return function(Re,_t,ye){return _t&&H(Re.prototype,_t),ye&&H(Re,ye),Re}}(),g=$t,y=YC,c=se(y),T=rs,P=ne(T),R=Y4,D=se(R),A=ns,N=ne(A),X=Zc,U=ne(X),te=es,F=se(te),$=Wc,q=se($);function ne(H){if(H&&H.__esModule)return H;var Re={};if(H!=null)for(var _t in H)Object.prototype.hasOwnProperty.call(H,_t)&&(Re[_t]=H[_t]);return Re.default=H,Re}function se(H){return H&&H.__esModule?H:{default:H}}function Ee(H,Re){if(!(H instanceof Re))throw new TypeError("Cannot call a class as a function")}function ge(H,Re){if(!H)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Re&&(typeof Re=="object"||typeof Re=="function")?Re:H}function Oe(H,Re){if(typeof Re!="function"&&Re!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Re);H.prototype=Object.create(Re&&Re.prototype,{constructor:{value:H,enumerable:!1,writable:!0,configurable:!0}}),Re&&(Object.setPrototypeOf?Object.setPrototypeOf(H,Re):H.__proto__=Re)}var Fe={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},Ge=function(Re){return Re.code==="Tab"||Re.keyCode===9},it=function(Re){return Re.code==="Escape"||Re.keyCode===27},ve=0,je=function(H){Oe(Re,H);function Re(_t){Ee(this,Re);var ye=ge(this,(Re.__proto__||Object.getPrototypeOf(Re)).call(this,_t));return ye.setOverlayRef=function(Be){ye.overlay=Be,ye.props.overlayRef&&ye.props.overlayRef(Be)},ye.setContentRef=function(Be){ye.content=Be,ye.props.contentRef&&ye.props.contentRef(Be)},ye.afterClose=function(){var Be=ye.props,Le=Be.appElement,Ke=Be.ariaHideApp,xe=Be.htmlOpenClassName,Te=Be.bodyOpenClassName,ft=Be.parentSelector,nt=ft&&ft().ownerDocument||document;Te&&U.remove(nt.body,Te),xe&&U.remove(nt.getElementsByTagName("html")[0],xe),Ke&&ve>0&&(ve-=1,ve===0&&N.show(Le)),ye.props.shouldFocusAfterRender&&(ye.props.shouldReturnFocusAfterClose?(P.returnFocus(ye.props.preventScroll),P.teardownScopedFocus()):P.popWithoutFocus()),ye.props.onAfterClose&&ye.props.onAfterClose(),q.default.deregister(ye)},ye.open=function(){ye.beforeOpen(),ye.state.afterOpen&&ye.state.beforeClose?(clearTimeout(ye.closeTimer),ye.setState({beforeClose:!1})):(ye.props.shouldFocusAfterRender&&(P.setupScopedFocus(ye.node),P.markForFocusLater()),ye.setState({isOpen:!0},function(){ye.openAnimationFrame=requestAnimationFrame(function(){ye.setState({afterOpen:!0}),ye.props.isOpen&&ye.props.onAfterOpen&&ye.props.onAfterOpen({overlayEl:ye.overlay,contentEl:ye.content})})}))},ye.close=function(){ye.props.closeTimeoutMS>0?ye.closeWithTimeout():ye.closeWithoutTimeout()},ye.focusContent=function(){return ye.content&&!ye.contentHasFocus()&&ye.content.focus({preventScroll:!0})},ye.closeWithTimeout=function(){var Be=Date.now()+ye.props.closeTimeoutMS;ye.setState({beforeClose:!0,closesAt:Be},function(){ye.closeTimer=setTimeout(ye.closeWithoutTimeout,ye.state.closesAt-Date.now())})},ye.closeWithoutTimeout=function(){ye.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},ye.afterClose)},ye.handleKeyDown=function(Be){Ge(Be)&&(0,D.default)(ye.content,Be),ye.props.shouldCloseOnEsc&&it(Be)&&(Be.stopPropagation(),ye.requestClose(Be))},ye.handleOverlayOnClick=function(Be){ye.shouldClose===null&&(ye.shouldClose=!0),ye.shouldClose&&ye.props.shouldCloseOnOverlayClick&&(ye.ownerHandlesClose()?ye.requestClose(Be):ye.focusContent()),ye.shouldClose=null},ye.handleContentOnMouseUp=function(){ye.shouldClose=!1},ye.handleOverlayOnMouseDown=function(Be){!ye.props.shouldCloseOnOverlayClick&&Be.target==ye.overlay&&Be.preventDefault()},ye.handleContentOnClick=function(){ye.shouldClose=!1},ye.handleContentOnMouseDown=function(){ye.shouldClose=!1},ye.requestClose=function(Be){return ye.ownerHandlesClose()&&ye.props.onRequestClose(Be)},ye.ownerHandlesClose=function(){return ye.props.onRequestClose},ye.shouldBeClosed=function(){return!ye.state.isOpen&&!ye.state.beforeClose},ye.contentHasFocus=function(){return document.activeElement===ye.content||ye.content.contains(document.activeElement)},ye.buildClassName=function(Be,Le){var Ke=(typeof Le>"u"?"undefined":u(Le))==="object"?Le:{base:Fe[Be],afterOpen:Fe[Be]+"--after-open",beforeClose:Fe[Be]+"--before-close"},xe=Ke.base;return ye.state.afterOpen&&(xe=xe+" "+Ke.afterOpen),ye.state.beforeClose&&(xe=xe+" "+Ke.beforeClose),typeof Le=="string"&&Le?xe+" "+Le:xe},ye.attributesFromObject=function(Be,Le){return Object.keys(Le).reduce(function(Ke,xe){return Ke[Be+"-"+xe]=Le[xe],Ke},{})},ye.state={afterOpen:!1,beforeClose:!1},ye.shouldClose=null,ye.moveFromContentToOverlay=null,ye}return d(Re,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(ye,Be){this.props.isOpen&&!ye.isOpen?this.open():!this.props.isOpen&&ye.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!Be.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var ye=this.props,Be=ye.appElement,Le=ye.ariaHideApp,Ke=ye.htmlOpenClassName,xe=ye.bodyOpenClassName,Te=ye.parentSelector,ft=Te&&Te().ownerDocument||document;xe&&U.add(ft.body,xe),Ke&&U.add(ft.getElementsByTagName("html")[0],Ke),Le&&(ve+=1,N.hide(Be)),q.default.register(this)}},{key:"render",value:function(){var ye=this.props,Be=ye.id,Le=ye.className,Ke=ye.overlayClassName,xe=ye.defaultStyles,Te=ye.children,ft=Le?{}:xe.content,nt=Ke?{}:xe.overlay;if(this.shouldBeClosed())return null;var rt={ref:this.setOverlayRef,className:this.buildClassName("overlay",Ke),style:i({},nt,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},qt=i({id:Be,ref:this.setContentRef,style:i({},ft,this.props.style.content),className:this.buildClassName("content",Le),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",i({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),Kt=this.props.contentElement(qt,Te);return this.props.overlayElement(rt,Kt)}}]),Re}(g.Component);je.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},je.propTypes={isOpen:c.default.bool.isRequired,defaultStyles:c.default.shape({content:c.default.object,overlay:c.default.object}),style:c.default.shape({content:c.default.object,overlay:c.default.object}),className:c.default.oneOfType([c.default.string,c.default.object]),overlayClassName:c.default.oneOfType([c.default.string,c.default.object]),parentSelector:c.default.func,bodyOpenClassName:c.default.string,htmlOpenClassName:c.default.string,ariaHideApp:c.default.bool,appElement:c.default.oneOfType([c.default.instanceOf(F.default),c.default.instanceOf(te.SafeHTMLCollection),c.default.instanceOf(te.SafeNodeList),c.default.arrayOf(c.default.instanceOf(F.default))]),onAfterOpen:c.default.func,onAfterClose:c.default.func,onRequestClose:c.default.func,closeTimeoutMS:c.default.number,shouldFocusAfterRender:c.default.bool,shouldCloseOnOverlayClick:c.default.bool,shouldReturnFocusAfterClose:c.default.bool,preventScroll:c.default.bool,role:c.default.string,contentLabel:c.default.string,aria:c.default.object,data:c.default.object,children:c.default.node,shouldCloseOnEsc:c.default.bool,overlayRef:c.default.func,contentRef:c.default.func,id:c.default.string,overlayElement:c.default.func,contentElement:c.default.func,testId:c.default.string},t.default=je,e.exports=t.default})(kv,kv.exports);var AL=kv.exports;function rI(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function nI(e){function t(i){var u=this.constructor.getDerivedStateFromProps(e,i);return u??null}this.setState(t.bind(this))}function iI(e,t){try{var i=this.props,u=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(i,u)}finally{this.props=i,this.state=u}}rI.__suppressDeprecationWarning=!0;nI.__suppressDeprecationWarning=!0;iI.__suppressDeprecationWarning=!0;function ML(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var i=null,u=null,d=null;if(typeof t.componentWillMount=="function"?i="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(i="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?u="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(u="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?d="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(d="UNSAFE_componentWillUpdate"),i!==null||u!==null||d!==null){var g=e.displayName||e.name,y=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+g+" uses "+y+" but also contains the following legacy lifecycles:"+(i!==null?`
  `+i:"")+(u!==null?`
  `+u:"")+(d!==null?`
  `+d:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=rI,t.componentWillReceiveProps=nI),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=iI;var c=t.componentDidUpdate;t.componentDidUpdate=function(P,R,D){var A=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:D;c.call(this,P,R,A)}}return e}const zL=Object.freeze(Object.defineProperty({__proto__:null,polyfill:ML},Symbol.toStringTag,{value:"Module"})),DL=eA(zL);Object.defineProperty(nu,"__esModule",{value:!0});nu.bodyOpenClassName=nu.portalClassName=void 0;var SS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var u in i)Object.prototype.hasOwnProperty.call(i,u)&&(e[u]=i[u])}return e},RL=function(){function e(t,i){for(var u=0;u<i.length;u++){var d=i[u];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(t,d.key,d)}}return function(t,i,u){return i&&e(t.prototype,i),u&&e(t,u),t}}(),oI=$t,ag=gp(oI),LL=jk,lg=gp(LL),FL=YC,Qt=gp(FL),OL=AL,ES=gp(OL),BL=ns,NL=jL(BL),Ga=es,kS=gp(Ga),$L=DL;function jL(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function gp(e){return e&&e.__esModule?e:{default:e}}function UL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TS(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function VL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var HL=nu.portalClassName="ReactModalPortal",GL=nu.bodyOpenClassName="ReactModal__Body--open",Ll=Ga.canUseDOM&&lg.default.createPortal!==void 0,CS=function(t){return document.createElement(t)},IS=function(){return Ll?lg.default.createPortal:lg.default.unstable_renderSubtreeIntoContainer};function Wf(e){return e()}var yp=function(e){VL(t,e);function t(){var i,u,d,g;UL(this,t);for(var y=arguments.length,c=Array(y),T=0;T<y;T++)c[T]=arguments[T];return g=(u=(d=TS(this,(i=t.__proto__||Object.getPrototypeOf(t)).call.apply(i,[this].concat(c))),d),d.removePortal=function(){!Ll&&lg.default.unmountComponentAtNode(d.node);var P=Wf(d.props.parentSelector);P&&P.contains(d.node)?P.removeChild(d.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},d.portalRef=function(P){d.portal=P},d.renderPortal=function(P){var R=IS(),D=R(d,ag.default.createElement(ES.default,SS({defaultStyles:t.defaultStyles},P)),d.node);d.portalRef(D)},u),TS(d,g)}return RL(t,[{key:"componentDidMount",value:function(){if(Ga.canUseDOM){Ll||(this.node=CS("div")),this.node.className=this.props.portalClassName;var u=Wf(this.props.parentSelector);u.appendChild(this.node),!Ll&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(u){var d=Wf(u.parentSelector),g=Wf(this.props.parentSelector);return{prevParent:d,nextParent:g}}},{key:"componentDidUpdate",value:function(u,d,g){if(Ga.canUseDOM){var y=this.props,c=y.isOpen,T=y.portalClassName;u.portalClassName!==T&&(this.node.className=T);var P=g.prevParent,R=g.nextParent;R!==P&&(P.removeChild(this.node),R.appendChild(this.node)),!(!u.isOpen&&!c)&&!Ll&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!Ga.canUseDOM||!this.node||!this.portal)){var u=this.portal.state,d=Date.now(),g=u.isOpen&&this.props.closeTimeoutMS&&(u.closesAt||d+this.props.closeTimeoutMS);g?(u.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,g-d)):this.removePortal()}}},{key:"render",value:function(){if(!Ga.canUseDOM||!Ll)return null;!this.node&&Ll&&(this.node=CS("div"));var u=IS();return u(ag.default.createElement(ES.default,SS({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(u){NL.setElement(u)}}]),t}(oI.Component);yp.propTypes={isOpen:Qt.default.bool.isRequired,style:Qt.default.shape({content:Qt.default.object,overlay:Qt.default.object}),portalClassName:Qt.default.string,bodyOpenClassName:Qt.default.string,htmlOpenClassName:Qt.default.string,className:Qt.default.oneOfType([Qt.default.string,Qt.default.shape({base:Qt.default.string.isRequired,afterOpen:Qt.default.string.isRequired,beforeClose:Qt.default.string.isRequired})]),overlayClassName:Qt.default.oneOfType([Qt.default.string,Qt.default.shape({base:Qt.default.string.isRequired,afterOpen:Qt.default.string.isRequired,beforeClose:Qt.default.string.isRequired})]),appElement:Qt.default.oneOfType([Qt.default.instanceOf(kS.default),Qt.default.instanceOf(Ga.SafeHTMLCollection),Qt.default.instanceOf(Ga.SafeNodeList),Qt.default.arrayOf(Qt.default.instanceOf(kS.default))]),onAfterOpen:Qt.default.func,onRequestClose:Qt.default.func,closeTimeoutMS:Qt.default.number,ariaHideApp:Qt.default.bool,shouldFocusAfterRender:Qt.default.bool,shouldCloseOnOverlayClick:Qt.default.bool,shouldReturnFocusAfterClose:Qt.default.bool,preventScroll:Qt.default.bool,parentSelector:Qt.default.func,aria:Qt.default.object,data:Qt.default.object,role:Qt.default.string,contentLabel:Qt.default.string,shouldCloseOnEsc:Qt.default.bool,overlayRef:Qt.default.func,contentRef:Qt.default.func,id:Qt.default.string,overlayElement:Qt.default.func,contentElement:Qt.default.func};yp.defaultProps={isOpen:!1,portalClassName:HL,bodyOpenClassName:GL,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,i){return ag.default.createElement("div",t,i)},contentElement:function(t,i){return ag.default.createElement("div",t,i)}};yp.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,$L.polyfill)(yp);nu.default=yp;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=nu,u=d(i);function d(g){return g&&g.__esModule?g:{default:g}}t.default=u.default,e.exports=t.default})(Ev,Ev.exports);var ZL=Ev.exports;const sI=ip(ZL);sI.setAppElement("#root");function WL({isOpen:e,afterOpen:t,onClose:i,content:u}){const d={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",minWidth:"60vw",minHeight:"60vh",textAlign:"center"}};return Je.jsx(sI,{isOpen:e,onAfterOpen:t,onRequestClose:i,style:d,contentLabel:"Example Modal",children:u})}function t0({img:e,title:t,children:i,selected:u,onClick:d,name:g}){return Je.jsxs("div",{onClick:()=>d(g),className:["cardOption",u?"cardOptionSelected":""].join(" "),children:[Je.jsx("img",{className:"cardOptionImage",src:e,alt:t}),Je.jsx("h3",{children:t}),i]})}function qL({settings:e,onChange:t}){const i=u=>{t({...e,msgPosition:u})};return Je.jsx("div",{className:"",children:Je.jsxs("div",{className:"cardOptions",children:[Je.jsxs(t0,{selected:e.msgPosition==="closest",img:"img/config-closest.png",name:"closest",title:Je.jsx(ln,{id:"app.config.closestMsg",defaultMessage:"closest"}),onClick:i,children:[Je.jsx(ln,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",Je.jsxs("strong",{children:[" ",Je.jsx(ln,{id:"app.config.closestMsg",defaultMessage:"closest"})," "]})," ",Je.jsx(ln,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]}),Je.jsxs(t0,{selected:e.msgPosition==="after",img:"img/config-after.png",name:"after",title:Je.jsx(ln,{id:"app.config.closestNextMsg",defaultMessage:"next"}),onClick:i,children:[Je.jsx(ln,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",Je.jsx("strong",{children:Je.jsx(ln,{id:"app.config.closestNextMsg",defaultMessage:"next"})})," ",Je.jsx(ln,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]}),Je.jsxs(t0,{selected:e.msgPosition==="before",img:"img/config-before.png",name:"before",title:Je.jsx(ln,{id:"app.config.closestPreviousMsg",defaultMessage:"previous"}),onClick:i,children:[Je.jsx(ln,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",Je.jsx("strong",{children:Je.jsx(ln,{id:"app.config.previousNextMsg",defaultMessage:"next"})})," ",Je.jsx(ln,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]})]})})}function XL(e){const[t,i]=$t.useState(e);return[t,g=>{i(g)},()=>{i(e)}]}const KL=/[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/,Pv={IOS:/\[(.*)\] (.*): (.*)/,ANDROID:/(.*) - (.*): (.*)/},YL=e=>{const t=e.match(Pv.IOS),i=e.match(Pv.ANDROID);return t?"IOS":i?"ANDROID":"UNKNOWN"},JL=e=>{const t=e.match(KL);return t?t[0].split(",").map(i=>parseFloat(i)):null},QL=(e,t)=>{const i=e.match(Pv[t]);if(i){let u=i[2];const d=u.indexOf(":");d>-1&&(u=u.substring(0,d));let g={datetime:t==="ANDROID"?t6(i[1]):e6(i[1]),username:u,message:i[3]};const y=g.message.toLowerCase().indexOf(".jpg");return y>0&&(g.file=g.message.substring(0,y+4)),g}},e6=e=>{const t=e.split(","),i=t[0].split("/"),u=[[i[2],i[1],i[0]].join("/"),t[1]].join(" ");return new Date(u)},t6=e=>{let t=e.replace("a. m.","AM").replace("p. m.","PM").split(" ");const i=t[0].split("/"),u=[[i[1],i[0],i[2]].join("/"),t[1]].join(" ");return new Date(u)},r6=(e,t)=>{let i=t-1,u=t+1,d,g,y=e[t];for(;(e[i]||e[u])&&!(g&&d);){if(e[i]&&e[i].username===y.username&&!d){const c=Math.abs(e[t].datetime-e[i].datetime);d={index:i,delta:c}}if(e[u]&&e[u].username===y.username&&!g){const c=Math.abs(e[t].datetime-e[u].datetime);g={index:u,delta:c}}i--,u++}if(d&&g){if(d.delta===g.delta)return{...e[d.index],message:e[d.index].message+". "+e[g.index].message};if(d.delta<g.delta)return e[d.index];if(d.delta>g.delta)return e[g.index]}else{if(d)return e[d.index];if(g)return e[g.index]}return y},n6=(e,t)=>aI(e,t,1),i6=(e,t)=>aI(e,t,-1),aI=(e,t,i)=>{let u=t+i,d,g=e[t];for(;e[u]&&!d;){if(e[u]&&e[u].username===g.username&&!d){const y=Math.abs(e[t].datetime-e[u].datetime);d={index:u,delta:y}}u+=i}return d?e[d.index]:g},o6=(e,t)=>{let i=0;const u={};return e.forEach(d=>{d=d.replaceAll(/[\u200E\u200F\u202A-\u202E\u200B]/g,"");const g=QL(d,t);g&&(u[i]=g,i++)}),u};function s6({text:e,msgPosition:t}){const[i,u]=$t.useState(null);return $t.useEffect(()=>{if(!e)return;const d=e.split(`
`),g={type:"FeatureCollection",features:[]};let y={},c=!1,T;for(let D=0;D<d.length&&(T=YL(d[D]),T==="UNKNOWN");D++);const P=o6(d,T),R=Object.values(P);R.forEach((D,A)=>{if(D.message){const N=JL(D.message);N&&(c||(y={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[parseFloat(N[1]),parseFloat(N[0])]}},c=!0));const X=N&&A===R.length-1;if(!N&&c||X){const U=X?A:A-1;switch(t){case"before":y.properties={...i6(P,U)};break;case"after":y.properties={...n6(P,U)};break;default:y.properties={...r6(P,U)};break}g.features.push(y),y={},c=!1}}}),c&&g.features.push(y),u(g)},[e,t]),[i]}function a6(){const[e,t]=$t.useState(null),[i,u]=$t.useState(null),[d,g]=$t.useState({}),[y,c]=$t.useState(null),[T,P]=XL({msgPosition:"closest"}),[R]=s6({text:e,msgPosition:T.msgPosition}),D=te=>{t(te)},A=(te,F)=>{g($=>({...$,[te]:F}))};$t.useEffect(()=>{R&&u(R)},[R]);const N=()=>{t(null),u(null)},X=()=>{c(null)};$t.useEffect(()=>{u(null),c(null)},[T.msgPosition]);let U;return T.msgPosition==="before"?U=Je.jsx(ln,{id:"app.config.closestPreviousMsg",defaultMessage:"previous"}):T.msgPosition==="after"?U=Je.jsx(ln,{id:"app.config.closestNextMsg",defaultMessage:"next"}):U=Je.jsx(ln,{id:"app.config.closestMsg",defaultMessage:"closest"}),Je.jsxs("div",{className:"app",children:[Je.jsxs("header",{className:"header",children:[Je.jsxs("div",{className:"top",children:[Je.jsx(F4,{onOptionClick:te=>{te==="options"&&c(Je.jsx(qL,{settings:T,onChange:P}))}}),Je.jsx(WL,{isOpen:y!==null,onClose:X,content:y})]}),Je.jsxs("h1",{className:i&&i.features.length>0?"titleSmall":"",children:["WhatsApp ",Je.jsx("strong",{children:"ChatMap"})]}),i&&i.features.length>0?Je.jsxs("div",{className:"fileOtions",children:[Je.jsx(L4,{data:i,filename:"whatsapp-locations"}),Je.jsx("button",{onClick:N,className:"secondaryButton",children:Je.jsx(ln,{id:"app.uploadNewFile",defaultMessage:"Upload new file"})})]}):Je.jsxs(Je.Fragment,{children:[Je.jsx("p",{children:Je.jsx(ln,{id:"app.subtitle",defaultMessage:"Export a chat from the app and visualize the locations shared in the conversation"})}),Je.jsxs("div",{className:"copy",children:[Je.jsx("span",{children:"Free and Open Source Software by"}),Je.jsx("img",{src:T3,className:"logo",alt:"logo"})]})]})]}),!e&&Je.jsxs(Je.Fragment,{children:[Je.jsx("div",{className:"fileUpload",children:Je.jsx(g5,{onDataFileLoad:A,onFileLoad:D})}),Je.jsxs("p",{children:[Je.jsx(ln,{id:"app.config.msgPositionTextStart",defaultMessage:"It will search for locations and the"})," ",Je.jsx("strong",{children:U})," ",Je.jsx(ln,{id:"app.config.msgPositionTextEnd",defaultMessage:"message from the same user."})]}),Je.jsx("a",{className:"githubLink",href:"https://github.com/hotosm/chatmap",children:"https://github.com/hotosm/chatmap"})]}),i&&i.features.length>0&&Je.jsx("div",{className:"data",children:Je.jsx("div",{className:"map",children:Je.jsx(R4,{data:i,dataFiles:d})})}),i&&i.features.length===0&&Je.jsxs(Je.Fragment,{children:[Je.jsx("h2",{children:"No locations found in this file."}),Je.jsx("button",{onClick:N,className:"secondaryButton",children:Je.jsx(ln,{id:"app.uploadNewFile",defaultMessage:"Upload new file"})})]})]})}const l6={"app.subtitle":"Export a chat from the app and visualize the locations shared in the conversation","app.config.msgPositionTextStart":"It will search for locations and the","app.config.msgPositionTextEnd":"message from the same user.","app.config.closestPreviousMsg":"previous","app.config.closestNextMsg":"next","app.config.closestMsg":"closest","app.uploadNewFile":"Upload new file","app.download":"Download","app.options":"Options","app.uploadLabel":"Upload or drag a file right here"},u6={"app.subtitle":"Exporta un chat desde la aplicación y visualiza las ubicaciones compartidas en la conversación","app.config.msgPositionTextStart":"Buscará localizaciones y el","app.config.msgPositionTextEnd":"mensaje del mismo usuario.","app.config.closestPreviousMsg":"anterior","app.config.closestNextMsg":"siguiente","app.config.closestMsg":"más cercano","app.uploadNewFile":"Subir un nuevo archivo","app.download":"Descargar","app.options":"Opciones","app.uploadLabel":"Sube o arrastra un archivo aquí mismo"},r0={en:l6,es:u6},c6=()=>{const e=navigator.language.slice(0,2);return e in r0?r0[e]:r0.en},h6=n0.createRoot(document.getElementById("root"));h6.render(Je.jsx(Ec.StrictMode,{children:Je.jsx(p5,{locale:navigator.language,messages:c6(),children:Je.jsx(a6,{})})}));
//# sourceMappingURL=index-CCGiTHqm.js.map
